function _autoload(){$.each(ACC,function(section,obj){$.isArray(obj._autoload)&&$.each(obj._autoload,function(key,value){$.isArray(value)?value[1]?"function"==typeof ACC[section][value[0]]&&ACC[section][value[0]]():value[2]&&"function"==typeof ACC[section][value[2]]&&ACC[section][value[2]]():"function"==typeof ACC[section][value]&&ACC[section][value]()})})}var screenXs="480px",screenSm="640px",screenMd="1024px",screenLg="1240px",screenXsMin="480px",screenSmMin="640px",screenMdMin="1024px",screenLgMin="1240px",screenXsMax="639px",screenSmMax="1023px",screenMdMax="1239px",certonaHelper={HomePageType:"HOME",CartPageType:"CART",EmptyCartPageType:"EMPTYCART",CategoryPageType:"CATEGORY",NotFoundErrorPageType:"404ERROR",SearchPageType:"SEARCH",NoSearchPageType:"NOSEARCH",ProductPageType:"PRODUCT",PopupCartPageType:"POPUPCART",EmptyPopupCartPageType:"EMPTYPOPUPCART",OrderConfirmationPageType:"PURCHASE",BrandPageType:"BRAND",MerchantPageType:"MERCHANT",stringFormat:function(){for(var theString=arguments[0],i=1;i<arguments.length;i++){var regEx=new RegExp("\\{"+(i-1)+"\\}","gm");theString=theString.replace(regEx,arguments[i])}return theString},moveCertonaRR1:function(){$("#js-product-classifications").length>0&&$(".rcm-top-position").length>0&&(0==$(".rcm-top-position").find(".product1_rr_wrapper").length&&$(".rcm-top-position").append($(".product1_rr_wrapper").parent()),$("#js-product-classifications").before($(".rcm-top-position"))),$(".condition-deal").length>0&&$(".rcm-top-position").length>0&&(0==$(".rcm-top-position").find(".product1_rr_wrapper").length&&$(".rcm-top-position").append($(".product1_rr_wrapper")),$(".condition-deal").before($(".rcm-top-position")))},getDeviceType:function(){return null!=ACC.devices.name?ACC.devices.name.toUpperCase():navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?"MOBILE":"DESKTOP"},processString:function(inputStr){return inputStr&&"UNKNOWN"!=inputStr?inputStr.trim():""},getUserLocationId:function(inputStr){if(inputStr)return inputStr.split(",")},initLazyLoadForImg:function(elements){var DOMSelector=elements+":not(.lazy-initialized)";$(DOMSelector).lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}).addClass("lazy-initialized"),ACC.global.imgLazyLoadStopper()},generateProductRecommendationBlock:function(objJson,number,csign,tagTxt,tagMultiPrice,tagNormalPrice,vinidPercentage,width,height,isShowPrice,isShowPromotion,isShowFlashSale,isShowVinID,isShowAverageRating,isShowAddCart){""===csign&&(csign="đ"),""===tagMultiPrice&&(tagMultiPrice="Giá từ"),""===tagNormalPrice&&(tagNormalPrice="Giá tham khảo"),null!=objJson&&null!=objJson.resonance&&null!=objJson.resonance.schemes&&this.updateCertonaData(objJson,function(){objJson.resonance.schemes.forEach(function(schemeItem){var divId=schemeItem.scheme.toUpperCase();if($("#"+divId).length>0){var divContent="";if("yes"===schemeItem.display.toLowerCase()&&schemeItem.items.length>0){var size=number;(!size||size<=0)&&(size=schemeItem.items.length);var isBrandOrMerchantDesktop=!0;for(-1==divId.toLowerCase().indexOf("brand1_rr")&&-1==divId.toLowerCase().indexOf("merchant1_rr")||(isBrandOrMerchantDesktop="desktop"==ACC.devices.name),i=0;i<size;i++){var product=schemeItem.items[i],markup="",price=parseInt(product.Price),salePrice=parseInt(product.SalePrice),discountPercentage=Math.round(100-100*salePrice/price),itmParam=certonaHelper.stringFormat("&itm_source={0}&itm_medium={1}&itm_campaign={2}",divId,certonaHelper.getDeviceType(),certonaHelper.processString(product.ItemID)),isShowCertonaAddToCart=!1;if(-1!=divId.toLowerCase().indexOf("product2_rr")&&"mobile"!==ACC.devices.name||!isBrandOrMerchantDesktop){markup="<li class='space-col-16px d-most-watch-products-list__item'>",markup+="<a id='"+product.BaseProductID+"' href='"+product.ProductLink+itmParam+"'><section class='d-product-box d-product-box--most-watch'>",markup+="\t  <div class='d-product-box__image'>",markup+="\t\t<img data-src='"+product.ProductImage+"' data-original='"+product.ProductImage+"' class='rcm-lazy' alt='"+certonaHelper.stringBeautifier(product.ProductName)+"' title='"+certonaHelper.stringBeautifier(product.ProductName)+"'/>",null!=isShowPromotion&&"true"==isShowPromotion&&(product.StopperLeft&&(markup+="     <div class='d-product-box__ticket d-product-box__ticket--top-left'><img class='stopper-top-lazy' data-original='"+product.StopperLeft+"' alt='' title=''/></div>"),product.StopperRight&&(markup+="     <div class='d-product-box__ticket d-product-box__ticket--top-right'><img class='stopper-top-lazy' data-original='"+product.StopperRight+"'  alt='' title=''/></div>"),product.StopperBottom&&(markup+="     <div class='d-product-box__ticket d-product-box__ticket--bottom'><img class='stopper-bottom-lazy' data-original='"+product.StopperBottom+"' alt='' title=''/></div>")),markup+="\t  </div>",markup+="\t  <div class='d-product-box__text space-row-left-16px'>",markup+="\t\t<p class='h5-rbt-re color-2 d-product-box__state'>"+certonaHelper.stringBeautifier(product.ProductName)+"</p>",null!=isShowPrice&&"true"==isShowPrice&&(markup+="\t\t<p class='h7-rbt-re color-gray-500 space-col-top-4px d-product-box__considered-price'>"+("true"===product.MultiplePrice.toLowerCase()?tagMultiPrice:tagNormalPrice)+"</p>",markup+="\t\t<p class='h2-rbt-bo color-primary-500 d-product-box__current-price'>"+certonaHelper.formatPrice(product.SalePrice)+csign+"</p>",discountPercentage>0&&discountPercentage<=50&&(markup+="\t\t<div class='d-product-box__bottom-combo'>",price>salePrice&&(markup+="<div class='h5-rbt-re color-gray-500 space-row-right-8px d-product-box__old-price'><span>"+certonaHelper.formatPrice(product.Price)+csign+"</span></div>"),markup+="\t\t  <div class='d-ticket d-ticket--sale-off'>",markup+="\t\t\t<span class='color-1 h6-rbt-re space-row-8px'>-"+discountPercentage+"%</span>",markup+="\t\t  </div>",markup+="\t\t</div>"),discountPercentage>50&&(markup+="\t\t<div class='d-ticket d-ticket--super-sale'>",markup+="\t\t  <span class='color-1 h6-rbt-re space-row-8px'>"+tagTxt+"</span>",markup+="\t\t</div>",markup+="\t\t<div class='d-ticket d-ticket--super-sale'>",markup+="\t\t  <span class='color-1 h6-rbt-re space-row-8px'>50%++</span>",markup+="\t\t</div>"));var averageRatingValue=0;null!=product.AverageRating&&(averageRatingValue=20*parseFloat(product.AverageRating)),null!=isShowAverageRating&&"true"==isShowAverageRating&&averageRatingValue>0&&(markup+="         <div class='adr-rating-plp-view adr-rating-plp-view-sm'>",markup+="             <div class='rating-plp-view-list'>",markup+="                 <i class='glyphicon glyphicon-star'></i>",markup+="                 <i class='glyphicon glyphicon-star'></i>",markup+="                 <i class='glyphicon glyphicon-star'></i>",markup+="                 <i class='glyphicon glyphicon-star'></i>",markup+="                 <i class='glyphicon glyphicon-star'></i>",markup+="             </div>",markup+="             <div class='rating-plp-view-active' style='width: "+averageRatingValue+"%'>",markup+="                 <div class='rating-plp-view-active-container'>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="\t\t            </div>",markup+="\t\t        </div>",markup+="\t\t    </div>"),markup+="\t  </div>",markup+="\t</section>",markup+="</li></a>"}else{markup="<div class='items'>","desktop"==ACC.devices.name?markup+="\t<section class='d-product-box-hover'>":markup+="\t<section class='d-product-box'>",markup+="<a id='"+product.BaseProductID+"' href='"+product.ProductLink+itmParam+"'>",markup+="\t    <div class='d-product-box__image'>",markup+="\t\t        <img  data-src='"+product.ProductImage+"' data-original='"+product.ProductImage+"' class='rcm-lazy' alt='"+certonaHelper.stringBeautifier(product.ProductName)+"' title='"+certonaHelper.stringBeautifier(product.ProductName)+"'/>",null!=isShowPromotion&&"true"==isShowPromotion&&(product.StopperLeft&&(markup+="     <div class='d-product-box__ticket d-product-box__ticket--top-left'><img class='stopper-top-lazy' data-original='"+product.StopperLeft+"' alt='' title=''/></div>"),product.StopperRight&&(markup+="     <div class='d-product-box__ticket d-product-box__ticket--top-right'><img class='stopper-top-lazy' data-original='"+product.StopperRight+"' alt='' title=''/></div>"),product.StopperBottom&&(markup+="     <div class='d-product-box__ticket d-product-box__ticket--bottom'><img class='stopper-bottom-lazy' data-original='"+product.StopperBottom+"' alt='' title=''/></div>")),markup+="\t    </div>","desktop"==ACC.devices.name?(markup+="\t<div class='d-product-box__text space-col-top-16px'>",markup+="\t\t<p class='h5-rbt-re color-2 d-product-box__state'>"+certonaHelper.stringBeautifier(product.ProductName)+"</p>",null!=isShowPrice&&"true"==isShowPrice&&(markup+="\t<p class='color-gray-500 space-col-top-4px d-product-box__considered-price'>"+("true"===product.MultiplePrice.toLowerCase()?tagMultiPrice:tagNormalPrice)+"</p>",markup+=" <div class='hover-tab-services'>",markup+="\t    <div class='d-product-box__bottom-combo'>",markup+="\t\t    <p class='color-primary-500 d-product-box__current-price'>"+certonaHelper.formatPrice(product.SalePrice)+csign+"</p>",discountPercentage>0&&discountPercentage<=50&&(price>salePrice&&(markup+="\t<div class='color-gray-500 space-row-right-8px d-product-box__old-price'><span>"+certonaHelper.formatPrice(product.Price)+csign+"</span></div>"),markup+="\t\t<div class='d-ticket d-ticket--sale-off'>",markup+="\t\t    <span class='color-1'>-"+discountPercentage+"%</span>",markup+="\t\t</div>"),discountPercentage>50&&(markup+=" \t<div class='d-ticket d-ticket--super-sale'>",markup+="         <span class='color-1'>"+tagTxt+"</span>",markup+="     </div>",markup+=" \t<div class='d-ticket d-ticket--super-sale'>",markup+="         <span class='color-1'>50%++</span>",markup+="     </div>"),markup+="\t    </div>",markup+="</div>"),markup+="</div>"):(markup+="\t\t<div class='d-product-box__text space-col-top-16px'>",markup+="\t\t\t<p class='h5-rbt-re color-2 d-product-box__state'>"+certonaHelper.stringBeautifier(product.ProductName)+"</p>",null!=isShowPrice&&"true"==isShowPrice&&(markup+="\t\t<p class='color-gray-500 space-col-top-4px d-product-box__considered-price'>"+("true"===product.MultiplePrice.toLowerCase()?tagMultiPrice:tagNormalPrice)+"</p>",markup+="     <div class='hover-tab-services'>",markup+="\t\t\t<p class='color-primary-500 d-product-box__current-price'>"+certonaHelper.formatPrice(product.SalePrice)+csign+"</p>",discountPercentage>0&&discountPercentage<=50&&(markup+="\t\t<div class='d-product-box__bottom-combo'>",price>salePrice&&(markup+="\t    <div class='color-gray-500 space-row-right-8px d-product-box__old-price'><span>"+certonaHelper.formatPrice(product.Price)+csign+"</span></div>"),markup+="\t\t\t<div class='d-ticket d-ticket--sale-off'>",markup+="\t\t\t\t<span class='color-1'>-"+discountPercentage+"%</span>",markup+="\t\t\t</div>",markup+="\t\t</div>"),discountPercentage>50&&(markup+=" \t<div class='d-ticket d-ticket--super-sale'>",markup+="         <span class='color-1'>"+tagTxt+"</span>",markup+="     </div>",markup+=" \t<div class='d-ticket d-ticket--super-sale'>",markup+="         <span class='color-1'>50%++</span>",markup+="     </div>"),markup+="    </div>"),markup+="     </div>");var averageRatingValue=0;null!=product.AverageRating&&(averageRatingValue=20*parseFloat(product.AverageRating)),null!=isShowAverageRating&&"true"==isShowAverageRating&&averageRatingValue>0&&(markup+=" \t\t    <div class='adr-rating-plp-view adr-rating-plp-view-sm'>",markup+="                 <div class='rating-plp-view-list'>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="                     <i class='glyphicon glyphicon-star'></i>",markup+="\t\t            </div>",markup+="                 <div class='rating-plp-view-active' style='width: "+averageRatingValue+"%'>",markup+="                     <div class='rating-plp-view-active-container'>",markup+="                         <i class='glyphicon glyphicon-star'></i>",markup+="                         <i class='glyphicon glyphicon-star'></i>",markup+="                         <i class='glyphicon glyphicon-star'></i>",markup+="                         <i class='glyphicon glyphicon-star'></i>",markup+="                         <i class='glyphicon glyphicon-star'></i>",markup+="\t\t                </div>",markup+="\t\t            </div>",markup+="\t\t        </div>"),"desktop"==ACC.devices.name?(markup+="         <div class='vin-id-reward-wrapper'>",markup+="             <div class='vin-id-reward-content'>",null==isShowVinID||"true"!=isShowVinID||_.isEmpty(product.RewardRatePLPMessage)||(markup+="                 <div class='d-icon'><i class='polish-version-icon-VinID-Logo'></i></div>",markup+="                 <div class='vin-id-reward-wrapper-text'>",markup+="                     <span class='product-item__info-vinid'>",markup+=product.RewardRatePLPMessage,markup+="                     </span>",markup+="                 </div>"),markup+="                   </div>               </div>",markup+="         <div class='certona-promotio-stopper'>",null==isShowPromotion||"true"!=isShowPromotion||_.isEmpty(product.CouponStopperText)||(markup+="         <div class='vinid-coupon__wrapper'>",markup+="             <div class='product-item__info-coupon'>",markup+="                 <div class='d-icon text-icon-tab__left-icon'>",markup+="                     <i class='polish-version-icon-giftcode-16px'></i>",markup+="                 </div>                       <div class='rc__coupon--code'>",$.each(product.CouponStopperText,function(i,v){markup+="                 <div class='coupon--title'>"+v+"</div>"}),markup+="                 </div>                   </div>               </div>"),null==isShowPromotion||"true"!=isShowPromotion||_.isEmpty(product.BestFreeGiftStopper)||(markup+="         <div class='vinid-coupon__wrapper'>",markup+="             <div class='product-item__info-coupon'>",markup+="                 <div class='d-icon text-icon-tab__left-icon'>",markup+="                     <i class='polish-version-icon-gift-16px'></i>",markup+="                 </div>                       <div class='rc__coupon--code'><span>",markup+=product.BestFreeGiftStopper,markup+="              </span></div>                   </div>               </div>"),markup+="         </div>",markup+="     </a>",null!=isShowAddCart&&"true"==isShowAddCart&&(isShowCertonaAddToCart=!0)):(markup+="         </a>",null!=isShowAddCart&&"true"==isShowAddCart&&"mobile"==ACC.devices.name&&$("body").hasClass("page-cartPage")&&(isShowCertonaAddToCart=!0)),isShowCertonaAddToCart&&(markup+="<div class='certona-add-cart'>           <button class='d-button d-button--add-cart-new d-button--full-dimension js-quick-add-to-cart' data-offer-code='"+product.ItemID+"'>               <div class='d-icon'><i class='polish-version-icon-cart'></i></div>           </button>       </div>"),markup+="\t</section>",markup+="</div>"}divContent+=markup}divContent=$(divContent),$("#"+divId).html(divContent),$("#"+divId).closest(".rcm-block").show();var parent=divContent.closest(".product-detail__recom"),slides=4;if(-1!==schemeItem.scheme.indexOf("home")&&(parent=divContent.closest(".home__recom")),"home2_rr"!=schemeItem.scheme&&"home3_rr"!=schemeItem.scheme||(slides=3),size<=slides?certonaHelper.reInitSwiperOwl(parent,slides,size,divId):(certonaHelper.reveserElement(size,slides,divId,divContent),certonaHelper.reInitSwiperOwl(parent,slides,size,divId)),certonaHelper.initLazyLoadForImg("#"+divId+" .rcm-lazy"),"mobile"==ACC.devices.name&&$("body").hasClass("page-cartPage")){$(".certona-add-cart").each(function(){$(this).css({display:"block",position:"absolute",bottom:"0",width:"95%"}),$(".d-same-products-list--m1").find(".d-same-products-list__slide").find(".d-product-box").css({position:"unset"})});var maxHeight=0;$("#"+divId+" .items").each(function(){$(this).height()>maxHeight&&(maxHeight=$(this).height()+20)}),$("#"+divId+" .items").height(maxHeight)}}}})})},reveserElement:function(size,slides,divId,divContent){if(slides=-1!=divId.toLowerCase().indexOf("cart")?5:-1!=divId.toLowerCase().indexOf("category")?4:-1!=divId.toLowerCase().indexOf("brand")?4:-1!=divId.toLowerCase().indexOf("merchant")?4:-1!=divId.toLowerCase().indexOf("product")?5:-1!=divId.toLowerCase().indexOf("search")?4:(divId.toLowerCase().indexOf("home"),5),size<2*slides){divContent.clone().each(function(){$(this).each(function(){$("#"+divId).append(this)})})}},updateCertonaData:function(objJson,callback){var offerList=new Array;objJson.resonance.schemes.forEach(function(sheme){sheme.items&&sheme.items.length>0&&sheme.items.forEach(function(item){offerList.push(item.ItemID)})}),$.postJSONCallback(ACC.config.certonaUpdateUrl,JSON.stringify(offerList),function(dataMap){if(dataMap){var solrSchemes=new Array;objJson.resonance.schemes.forEach(function(sheme){if(sheme.items&&sheme.items.length>0){var solrItems=new Array;sheme.items.forEach(function(item){if(dataMap[item.ItemID]){var solrItem=item;solrItem.Price=dataMap[item.ItemID].price,solrItem.SalePrice=dataMap[item.ItemID].salePrice,solrItem.StopperBottom=dataMap[item.ItemID].stopperBottom,solrItem.StopperLeft=dataMap[item.ItemID].stopperLeft,solrItem.StopperRight=dataMap[item.ItemID].stopperRight,solrItem.AverageRating=dataMap[item.ItemID].averageRating,solrItem.RewardRatePLPMessage=dataMap[item.ItemID].rewardRatePLPMessage,solrItem.BestCouponStopper=dataMap[item.ItemID].bestCouponStopper,solrItem.BestFreeGiftStopper=dataMap[item.ItemID].bestFreeGiftStopper,solrItem.CouponStopperText=dataMap[item.ItemID].couponStopperText,solrItems.push(solrItem)}}),sheme.items=solrItems,solrSchemes.push(sheme)}}),objJson.resonance.schemes=solrSchemes}callback()},function(error){callback()})},reInitSwiper:function(selector,slides,itemSize){if(selector){void 0!=slides&&null!=slides||(slides=4);var isLoop=!0;itemSize<=4&&(isLoop=!1);var buttonnext=selector.parent().find(".swiper-button-next-vc"),buttonprev=selector.parent().find(".swiper-button-prev-vc");menuDetail=new Swiper(selector,{slidesPerView:slides,spaceBetween:8,preventClicks:!1,mode:"horizontal",nextButton:buttonnext,prevButton:buttonprev,loop:isLoop,breakpoints:{1024:{slidesPerView:4},640:{slidesPerView:3.5},480:{slidesPerView:2.5}},onInit:function(e){isLoop||($(buttonnext).addClass("hide"),$(buttonprev).addClass("hide"))}}),menuDetail.on("slideChangeEnd",function(){$(selector).find("img.rcm-lazy").lazyload()})}},reInitSwiperOwl:function(selector,slides,itemSize,pageName){if(selector){void 0!=slides&&null!=slides||(slides=4);var marginOwl=0;-1!=pageName.toLowerCase().indexOf("cart")?slides=5:-1!=pageName.toLowerCase().indexOf("category")||-1!=pageName.toLowerCase().indexOf("brand")||-1!=pageName.toLowerCase().indexOf("merchant")?slides=4:-1!=pageName.toLowerCase().indexOf("product")?slides=4:-1!=pageName.toLowerCase().indexOf("search")?slides=4:-1!=pageName.toLowerCase().indexOf("home")?(slides=5,marginOwl="mobile"==ACC.devices.name?4:0):slides=5;var isLoop=!0,isNav=!0;itemSize<=slides&&(isLoop=!1,isNav=!1,$("#"+pageName).find("div.owl-nav").addClass("hide"));var buttonnext=selector.parent().find(".am-next"),buttonprev=selector.parent().find(".am-prev");$(selector).trigger("destroy.owl.carousel"),$(selector).owlCarousel({loop:isLoop,margin:marginOwl,responsiveClass:!0,navText:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick">\n                        <div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i>\n                        </div>\n                      </div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick">\n                        <div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i>\n                        </div>\n                      </div>'],navClass:[buttonnext,buttonprev],dots:!0,center:!1,scrollPerPage:!0,responsive:{480:{items:3,nav:isNav},767:{items:4,nav:isNav},1240:{items:slides,nav:isNav,slideBy:slides}}}),$(selector).on("change.owl.carousel",function(event){setTimeout(function(){$(selector).find("img.rcm-lazy").lazyload(),ACC.global.imgLazyLoadStopper()},1e3)}),itemSize<=slides&&$("#"+pageName).find("div.owl-nav").addClass("hide");var maxHeight=0;$("#"+pageName+" .d-product-box").each(function(){$(this).height()>maxHeight&&(maxHeight=$(this).height())}),$("#"+pageName+" .d-product-box").height(maxHeight)}},stringBeautifier:function(inputStr){return inputStr.replace("<![CDATA[","").replace("]]>","")},formatPrice:function(number){return parseFloat(number).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1.").replace(/\.0+$/,"")}},certona={};if("object"==typeof _certona){if(certona.pagetype=certonaHelper[_certona._pageID],certona.devicetype=certonaHelper.getDeviceType(),_certona._userLocationIds){var certonaUserLocationIds=certonaHelper.getUserLocationId(_certona._userLocationIds);certona.province=certonaUserLocationIds[0],certona.district=certonaUserLocationIds[1],certona.ward=certonaUserLocationIds[2]}else certona.province="",certona.district="",certona.ward="";for(var k in _certona)_certona.hasOwnProperty(k)&&"_userLocationIds"!=k&&"_pageID"!=k&&("string"==typeof certona[k]?certona[k]=certonaHelper.processString(_certona[k]):certona[k]=_certona[k])}ACC.requests={_autoload:["requestRefreshAfterTimeout",["requestGoogleApis",$(".g-plusone").length>0],["requestYoutubeIframeApi",$("#brandReputationPlayer").length>0],"setCarouselForProductTogetherViewed","backToTop","socialShare"],timeout:250,keyRvproducts:"rvproduct",keyVinFooter:"vinfooter",fullAddressRequest:$.Deferred(),googleApisRequest:$.Deferred(),vinidRequest:$.Deferred(),usermetaRequest:$.Deferred(),youtubeRequest:$.Deferred(),recentViewedProducts:$.Deferred(),getCurrentAddress:function(){return $.get("/deliveryzone/getcurrentaddress")},manualDelivery:{elements:{address:"#deliveryRecentAddress a",city:"#shipping--zone-city",street:"#shipping--zone-street",district:"#shipping--zone-district",ward:"#shipping--zone-ward",submit:"#btnSubmit"},request:function(url,dataString){return $.ajax({url:url,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:dataString,success:function(response){"success"===response&&(ACC.delivery.pageType,ACC.helpers.deleteCookie("adayroi_notify_delivery_zone_cookie"))}})},setDeliveryByCustom:function(urlParam){var dataString,url;return dataString="urlParam="+urlParam,url="/deliveryzone/setDeliveryByCustom",ACC.requests.deliveryZone.request(url,dataString)},getCookie:function(name){var dc=document.cookie,prefix=name+"=",begin=dc.indexOf("; "+prefix);if(-1==begin){if(0!=(begin=dc.indexOf(prefix)))return null;var oneCookie=dc.indexOf(";",begin);if(-1==oneCookie)var end=dc.length;else var end=oneCookie;return dc.substring(begin,end).replace(prefix,"")}begin+=2;var end=document.cookie.indexOf(";",begin);return-1==end&&(end=dc.length),dc.substring(begin,end).replace(prefix,"")},getUrlParameter:function(sParam){var sParameterName,i,sPageURL=decodeURIComponent(window.location.search.substring(1)),sURLVariables=sPageURL.split("&");for(i=0;i<sURLVariables.length;i++)if(sParameterName=sURLVariables[i].split("="),sParameterName[0]===sParam)return void 0===sParameterName[1]||sParameterName[1]}},getFullAddress:function(){var res;if(res=$.Deferred(),ACC.config.loadFullAddress){$.get("/deliveryzone/getFullAddress").done(function(locationData){var all=[],pr=[],di=[],wa=[];_.each(locationData,function(p){var city={i:p.id,n:p.name,t:"p"};pr.push(city),all.push(city),_.each(p.children,function(d){var district={i:d.id,n:d.name,t:"d",p:p.id};di.push(district),all.push(district),_.each(d.children,function(w){var ward={i:w.id,n:w.name,t:"w",p:p.id,d:d.id};wa.push(ward),all.push(ward)})})}),res.resolve(all),ACC.requests.fullAddressRequest.resolve(all)})}else _.isUndefined(locationDataMin)||(res.resolve(locationDataMin),ACC.requests.fullAddressRequest.resolve(locationDataMin));return res},getLocalCache:function(name,value){if(void 0!==window.localStorage){var storage,result;return storage=window.localStorage,result=storage.getItem(name),!result&&void 0!==value&&value&&ACC.requests.setLocalCache(name,JSON.stringify(value)),result}},setLocalCache:function(name,value){if(void 0!==window.localStorage){var storage;return storage=window.localStorage,storage.setItem(name,JSON.stringify(value)),storage.getItem(name)}},location:{province:function(provinceEl,focus){ACC.requests.fullAddressRequest.done(function(addresses){var provinceLList=_.where(addresses,{t:"p"}),returnedData=$.grep(provinceLList,function(element,index){return element.i.toString()==ACC.delivery.selectedProvince});null!=returnedData&&returnedData.length>0&&""!=returnedData[0].n&&(ACC.delivery.selectedProvinceName=returnedData[0].n),ACC.selectize.renderListFull(provinceEl,provinceLList,focus)})},district:function(districtEl,provinceCode,focus){ACC.requests.fullAddressRequest.done(function(addresses){var districtList=_.where(addresses,{t:"d",p:provinceCode}),returnedData=$.grep(districtList,function(element,index){return element.i.toString()==ACC.delivery.selectedDistrict});null!=returnedData&&returnedData.length>0&&""!=returnedData[0].n&&(ACC.delivery.selectedDistrictName=returnedData[0].n),ACC.selectize.renderListFull(districtEl,districtList,focus)})},ward:function(wardEl,provinceCode,districtCode,focus){_.isEmpty(provinceCode)||_.isEmpty(districtCode)||ACC.requests.fullAddressRequest.done(function(addresses){var wardList=_.where(addresses,{t:"w",p:provinceCode,d:districtCode}),returnedData=$.grep(wardList,function(element,index){return element.i.toString()==ACC.delivery.selectedWard});null!=returnedData&&returnedData.length>0&&""!=returnedData[0].n&&(ACC.delivery.selectedWardName=returnedData[0].n),ACC.selectize.renderListFull(wardEl,wardList,focus)})},baseProvince:function(provinceEl,districtEl,wardEl){ACC.requests.fullAddressRequest.done(function(addresses){var provinceCode=ACC.selectize.get(provinceEl),districtList=_.where(addresses,{t:"d",p:provinceCode}),wardList=_.where(addresses,{t:"w",p:provinceCode,d:districtList[0].i});ACC.selectize.renderListFull(districtEl,districtList,0),ACC.selectize.set(districtEl,districtList[0].i,"silent"),ACC.selectize.unblock(districtEl),ACC.selectize.renderListFull(wardEl,wardList,0),ACC.selectize.set(wardEl,wardList[0].i,"silent"),ACC.selectize.unblock(wardEl)})},set:function(provinceEl,districtEl,wardEl,locationData){_.isEmpty(locationData)&&(locationData={},_.defaults(locationData,{province:"",district:"",ward:""}));var provinceSelect,districtSelect,wardSelect;provinceSelect=$(provinceEl).selectize(),districtSelect=$(districtEl).selectize(),wardSelect=$(wardEl).selectize(),provinceSelect[0].selectize.on("option_add",function(value){_.isEmpty(locationData.province)||parseInt(value)===parseInt(locationData.province)&&(ACC.selectize.set(provinceEl,locationData.province,"silent"),ACC.requests.location.district(districtEl,locationData.province))}),districtSelect[0].selectize.on("option_add",function(value){_.isEmpty(locationData.district)||parseInt(value)===parseInt(locationData.district)&&(ACC.selectize.set(districtEl,locationData.district,"silent"),ACC.requests.location.ward(wardEl,locationData.province,locationData.district))}),wardSelect[0].selectize.on("option_add",function(value){_.isEmpty(locationData.ward)||parseInt(value)===parseInt(locationData.ward)&&ACC.selectize.set(wardEl,locationData.ward,"silent")})}},triggerComboLocation:function(provinceEl,districtEl,wardEl,streetEl,locationData,loadFirstValue){_.isEmpty(locationData)&&(locationData={},_.defaults(locationData,{province:"",district:"",ward:"",street:""})),$(provinceEl).length>0&&$(districtEl).length>0&&$(wardEl).length>0&&(ACC.selectize.block(districtEl),ACC.selectize.block(wardEl),ACC.requests.location.set(provinceEl,districtEl,wardEl,locationData),ACC.requests.location.province(provinceEl),_.isEmpty(locationData.province)||(ACC.requests.location.district(districtEl,locationData.province),ACC.selectize.unblock(districtEl)),_.isEmpty(locationData.province)||_.isEmpty(locationData.district)||(ACC.requests.location.ward(wardEl,locationData.province,locationData.district),ACC.selectize.unblock(wardEl)),$(document).on("change",provinceEl,function(){if(ACC.selectize.block(districtEl),ACC.selectize.block(wardEl),ACC.selectize.off(districtEl,"option_add"),ACC.selectize.off(wardEl,"option_add"),_.isEmpty(ACC.selectize.get(provinceEl)))return ACC.selectize.unset(districtEl),void ACC.selectize.unset(wardEl);ACC.selectize.clear(districtEl),ACC.selectize.clear(wardEl),ACC.selectize.unblock(districtEl),ACC.requests.location.district(districtEl,ACC.selectize.get(provinceEl),1),void 0!==loadFirstValue&&Boolean(Number(loadFirstValue))&&ACC.requests.location.baseProvince(provinceEl,districtEl,wardEl)}),$(document).on("change",districtEl,function(){if(ACC.selectize.block(wardEl),_.isEmpty(ACC.selectize.get(districtEl)))return void ACC.selectize.unset(wardEl);ACC.selectize.clear(wardEl),ACC.selectize.unblock(wardEl),ACC.requests.location.ward(wardEl,ACC.selectize.get(provinceEl),ACC.selectize.get(districtEl),1),void 0!==loadFirstValue&&Boolean(Number(loadFirstValue))&&ACC.requests.fullAddressRequest.done(function(addresses){var wardList=_.where(addresses,{t:"w",p:ACC.selectize.get(provinceEl),d:ACC.selectize.get(districtEl)});_.isEmpty(wardList)||(ACC.selectize.renderListFull(wardEl,wardList,1),ACC.selectize.set(wardEl,wardList[0].i,"silent"),ACC.selectize.unblock(wardEl))})}))},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}},deliveryZone:{request:function(url,dataString){return $.ajax({url:url,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:dataString,success:function(response){"success"===response&&ACC.delivery.pageType}})},byStreet:function(streetString){var dataString,url;return dataString="street="+streetString,url="/deliveryzone/setdeliveryzonebystreet",ACC.requests.deliveryZone.request(url,dataString)},byDefault:function(province,district,ward){var dataString,url;return dataString="province="+province+"&district="+district+"&ward="+ward,url="/deliveryzone/setdeliveryzone",ACC.requests.deliveryZone.request(url,dataString)}},searchPattern:function(keyword){if(void 0!==keyword)return keyword=$.trim(keyword),keyword=keyword.replace(/\s\s+/g," "),keyword.length<1?"":keyword=$.trim(keyword.replace(/[\/\\#;$~%"?<>{}]/gi," ").replace(/\s+/g," "))},getUrlParameter:function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},getParameterFromScheme:function(name,scheme){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")
;var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(scheme);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},removeUrlParam:function(key,sourceURL){var rtn=sourceURL.split("?")[0],params_arr=[],queryString=-1!==sourceURL.indexOf("?")?sourceURL.split("?")[1]:"";if(""!==queryString){params_arr=queryString.split("&");for(var i=params_arr.length-1;i>=0;i-=1)params_arr[i].split("=")[0]===key&&params_arr.splice(i,1);rtn=rtn+"?"+params_arr.join("&")}return rtn},requestLocationText:function(province,district,ward){var res=$.Deferred();return ACC.requests.fullAddressRequest.done(function(addresses){var locationString="",provinceObj=_.find(addresses,function(l){return l.i===province&&"p"===l.t}),districtOb=_.find(addresses,function(l){return l.i===district&&"d"===l.t}),wardObj=_.find(addresses,function(l){return l.i===ward&&"w"===l.t});locationString+=_.isEmpty(wardObj)?"":wardObj.n+", ",locationString+=_.isEmpty(districtOb)?"":districtOb.n+", ",locationString+=_.isEmpty(provinceObj)?"":provinceObj.n+". ",res.resolve(locationString)}),res},requestLocationPlainText:function(province,district,ward){var res=$.Deferred(),locationString="";return locationString+=_.isEmpty(ward)?"":ward+", ",locationString+=_.isEmpty(district)?"":district+", ",locationString+=_.isEmpty(province)?"":province+". ",res.resolve(locationString),res},requestVinidInfo:function(){var res;return res=$.Deferred(),"resolved"!==ACC.requests.vinidRequest.state()?(res=$.ajax({method:"get",url:"/vinid/info",dataType:"json",timeout:40*ACC.requests.timeout}),res.fail(function(data){ACC.requests.vinidRequest.resolve(data),ACC.template.userInfo.points.desktop(data),ACC.template.userInfo.points.mobile(data),_.isEmpty(data.email)||ACC.login.updateUserEmail(data.email)}),res.done(function(data){ACC.requests.vinidRequest.resolve(data),ACC.template.userInfo.points.desktop(data),ACC.template.userInfo.points.mobile(data),_.isEmpty(data.email)||ACC.login.updateUserEmail(data.email)})):ACC.requests.vinidRequest.done(function(data){res.resolve(data)}),res},requestUserMeta:function(){var res;return res=$.Deferred(),"resolved"!==ACC.requests.usermetaRequest.state()?(res=$.ajax({method:"get",url:"/login/usermeta",dataType:"json",timeout:20*ACC.requests.timeout}),res.fail(function(data){ACC.requests.usermetaRequest.resolve(data)}),res.done(function(data){ACC.requests.usermetaRequest.resolve(data),ACC.template.userInfo.giftcode(data)})):ACC.requests.usermetaRequest.done(function(data){res.resolve(data)}),res},requestGoogleApis:function(){if("resolved"!==ACC.requests.googleApisRequest.state()){var renderPlusOne;renderPlusOne=_.debounce(function(){$.getScript("//apis.google.com/js/platform.js",function(){ACC.requests.googleApisRequest.resolve(!0),ACC.requests.googleApisRequest.done(function(){$(".product-detail__share").length>0&&gapi.plusone.render("widget-div"),$(window).off("scroll",renderPlusOne)})})},ACC.requests.timeout),$(window).scroll(renderPlusOne)}},requestCategoryTree:function(url,currentCode){var loadCats=function(url,currentCode){var $container,catid,tLi,tUl,reqData,reqcats;$container=$("#js-categoryFacetLayer"),url=_.isUndefined(url)?$container.attr("data-categoryFacetResultUrl"):url,currentCode=_.isUndefined(currentCode)?$container.attr("data-current-code"):currentCode,catid=_.uniqueId("categoryMenu_"),tLi=_.template('<li class="category-item category-item_lv<%= catlv %>  <%= catclass %>" data-pc="<%= catpc %>" data-code="<%= catcode %>"><a href="<%= caturl %>"><%= catlbl %></a></li>'),tUl=_.template("<ul id='<%= catid %>' class='<%= catclass %>' <%= uldata %>><%= catchildren %></ul>"),$container.append(tUl({catid:catid,catclass:"category-menu",catchildren:"",uldata:'data-cat-root="true"'})),reqData={url:url,method:"get",dataType:"json",beforeSend:function(){$container.block()}},reqcats=$.ajax(reqData),reqcats.fail(function(){$container.addClass("hidden")}).always(function(){$container.unblock()}).done(function(cats){if(!_.isEmpty(cats)){var sortCats=_.sortBy(_.groupBy(cats,function(c){return parseInt(c.lv)}),function(n){return parseInt(n.lv)});_.each(sortCats,function(groups,gi){var lvMarkup="";_.each(groups,function(cat,ci){var catData={catlv:cat.lv,catclass:"",catcode:cat.code,catpc:cat.pc,caturl:cat.url,catlbl:cat.lbl};if(1===cat.lv)$("#"+catid).append(tLi(catData));else{var gg=sortCats[gi];2===cat.lv&&(catData.catclass=" category-tree "),lvMarkup+=tLi(catData),gg.length-1===ci&&$('li[data-code="'+cat.pc+'"]').append(tUl({catid:"childCategoryLv"+cat.lv,catclass:"category-menu",uldata:_.template('data-cat-parent="<%= parentcode %>"')({parentcode:cat.pc}),catchildren:lvMarkup}))}})});var $currCat=$("#"+catid).find('li[data-code="'+currentCode+'"]');$currCat.addClass("selected active"),$currCat.parents(".category-item_lv2").addClass("has-arrow"),$container.removeClass("hidden")}})};$(document).ready(_.debounce(function(){loadCats(url,currentCode)},ACC.requests.timeout/5))},requestProductGroup:function(currentPageNumber,componentId,statusForMainComponent,quickButtonEnable,quickViewEnable,selectionSort){$.blockUI();var req,res;if(res=!1,void 0!==componentId){var productGroup=ACC.productGroup[componentId];if(_.isUndefined(productGroup)||_.isEmpty(productGroup.data)||_.isUndefined(currentPageNumber))return res;productGroup.data.currentPage=currentPageNumber;var pgform={currentPage:productGroup.data.currentPage,maxSize:productGroup.data.maxSize,componentId:productGroup.data.componentId,groupId:productGroup.data.groupId,merchantCode:productGroup.data.merchantCode,brandCode:productGroup.data.brandCode,statusForMainComponent:productGroup.data.statusForMainComponent,timeFrameStartTime:productGroup.data.timeFrameStartTime,showingCouponCode:productGroup.data.showingCouponCode,showProductStopper:productGroup.data.showingProductStopper,selectionSort:selectionSort};return req=$.ajax({url:ACC.config.encodedContextPath+productGroup.target.url+"/results",type:"POST",data:JSON.stringify(pgform),dataType:"json",cache:!0,contentType:"application/json; charset=utf-8"}),req.done(function(data){$.unblockUI();var $productGroupContainer=$("#productGroupContainer"+componentId),defaultImage={imgLoaderSrc:data.defaultImage.url,imgSrc:data.defaultImage.url,imgAlt:data.defaultImage.altText,imgTitle:data.defaultImage.description,imgBigSrc:""},pItemHtml="";pItemHtml+=ACC.template.productGroup.item(data.products,defaultImage,data.superSaleImage,data.giftImage,productGroup.data.houseblock,statusForMainComponent,quickButtonEnable,quickViewEnable),$productGroupContainer.html(pItemHtml),ACC.requests.fillProductOnvisibleToDataLayer(data.gtmProducts),$productGroupContainer.find("img.plp-lazy").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"})}),req}},requestYoutubeIframeApi:function(){if("undefined"!=typeof homeVideosList&&!_.isEmpty(homeVideosList)){var parsingVideo=function(url){var regExp=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,match=url.match(regExp);return!(!match||11!=match[7].length)&&match[7]},videoList=[];_.each(homeVideosList,function(url){var videoId=parsingVideo(url);videoList.push(videoId)});var playerContainer,player=window.player;playerContainer="brandReputationPlayer",window.curVideoIndex=0,window.nextVideoIndex=1,window.onYouTubeIframeAPIReady=function(){player=new YT.Player(playerContainer,{height:"390",width:"640",videoId:videoList[curVideoIndex],events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})},window.onPlayerReady=function(event){player.cueVideoById(videoList[curVideoIndex],0,"large"),$(window).scroll(function(){var hT=$("#"+playerContainer).offset().top,hH=$("#"+playerContainer).outerHeight(),wH=$(window).height(),wS=$(this).scrollTop();wS>hT+hH-wH&&hT>wS&&wS+wH>hT+hH||player.pauseVideo()})},window.done=!1,window.onPlayerStateChange=function(event){nextVideoIndex===videoList.length&&(done=!0),event.data!=YT.PlayerState.ENDED||done||(player.loadVideoById(videoList[nextVideoIndex],0,"large"),curVideoIndex++,nextVideoIndex++)},window.stopVideo=function(){player.stopVideo()},$.getScript("https://www.youtube.com/iframe_api")}},requestRecentViewedProducts:function(dom){if(console.log(ACC.requests.recentViewedProducts.state()),"resolved"!==ACC.requests.recentViewedProducts.state()){var req=$.get("/rvproducts");dom=void 0===dom?".recent-viewed-products":dom,req.done(function(res){_.isElement($(dom)[0])&&($(dom).append(res),ACC.carousel.bindCarousel(),$("#recentlyreviewedproducts img.lazy").lazyload()),ACC.requests.recentViewedProducts.resolve(res)})}},loadRecentlyViewedProducts:function(){if(void 0!==typeof Storage){$(".pageType-ProductPage").length>0&&void 0!==typeof Storage&&sessionStorage.removeItem(ACC.requests.keyRvproducts);var cacheRv=sessionStorage.getItem(ACC.requests.keyRvproducts);if(null===cacheRv||""===cacheRv||"undefined"===cacheRv){var req=$.get("/rvproducts");req.done(function(res){$("#recentlyreviewedproducts").html(res),sessionStorage.setItem(ACC.requests.keyRvproducts,res),ACC.carousel.bindCarousel(),$("#recentlyreviewedproducts img.lazy").lazyload()})}else $("#recentlyreviewedproducts").html(cacheRv),ACC.carousel.bindCarousel(),$("#recentlyreviewedproducts img.lazy").lazyload()}else{var req=$.get("/rvproducts");req.done(function(res){$("#recentlyreviewedproducts").html(res),ACC.carousel.bindCarousel(),$("#recentlyreviewedproducts img.lazy").lazyload()})}},loadVinFooter:function(){var $window=$(window),windowHeight=$window.height(),windowScrollTop=0,footerLoaded=!1,deferTimerInitFooter=null,footerMainFunc=function(){if(footerLoaded)return!1;if(((windowScrollTop=$window.scrollTop())+windowHeight)/$("#vinfooter").offset().top*100<60)return!0;if(ACC.common.loadingBox.init($("#vinfooter")),void 0!==typeof Storage){var cacheFooter=sessionStorage.getItem(ACC.requests.keyVinFooter);if(null===cacheFooter||""===cacheFooter||"undefined"===cacheFooter){var req=$.get("/footer");req.done(function(res){$("#vinfooter").html(res),ACC.global.initActionFooterClickMobile(),ACC.register.bindSignUpButton($("#vinfooter").find(".js-sign-up__popup_button")),ACC.login.bindSigninButton($("#vinfooter").find(".js-sign-in__popup")),sessionStorage.setItem(ACC.requests.keyVinFooter,res),ACC.common.loadingBox.stop($("#vinfooter"))})}else $("#vinfooter").html(cacheFooter),ACC.global.initActionFooterClickMobile(),ACC.register.bindSignUpButton($("#vinfooter").find(".js-sign-up__popup_button")),ACC.login.bindSigninButton($("#vinfooter").find(".js-sign-in__popup")),ACC.common.loadingBox.stop($("#vinfooter"))}else{var req=$.get("/footer");req.done(function(res){$("#vinfooter").html(res),ACC.global.initActionFooterClickMobile(),ACC.register.bindSignUpButton($("#vinfooter").find(".js-sign-up__popup_button")),ACC.login.bindSigninButton($("#vinfooter").find(".js-sign-in__popup")),ACC.common.loadingBox.stop($("#vinfooter"))})}footerLoaded=!0};footerMainFunc(),$window.on("scroll",function(){deferTimerInitFooter&&clearTimeout(deferTimerInitFooter),deferTimerInitFooter=setTimeout(function(){footerMainFunc()},100)}),$window.on("resize",function(){deferTimerInitFooter&&clearTimeout(deferTimerInitFooter),deferTimerInitFooter=setTimeout(function(){windowHeight=$window.height(),footerMainFunc()},300)})},requestRefreshAfterTimeout:function(){$(window).load(function(){window.IDLE_TIMEOUT=300,window._idleSecondsCounter=0,document.onclick=function(){_idleSecondsCounter=0},document.onmousemove=function(){_idleSecondsCounter=0},document.onkeypress=function(){_idleSecondsCounter=0},window.CheckIdleTime=function(){++_idleSecondsCounter>=IDLE_TIMEOUT&&window.location.reload()},window.setInterval(window.CheckIdleTime,6e4)})},topup:{getOffers:function(reqObj){var reqObj=reqObj||{};_.defaults(reqObj,{url:"/napthe/variants/",method:"get",dataType:"json",data:{}});var res=$.Deferred();return $.ajax(reqObj).done(function(data){res.resolve(data)}),res}},loadContentSlot:function(pk,container,data){var url="/loadslot/"+pk+"?"+data,$container=$("#"+container);ACC.requests.isLoadingCmsComponent=!0;var req=$.get(url);req.done(function(res){$container.html(res),$container.attr("loaded",!0)}),req.always(function(){ACC.requests.isLoadingCmsComponent=!1})},loadCmsComponent:function(pk,container,data){var url="/loadcmscomponent/"+pk+"?"+data,$container=$("#"+container);ACC.requests.isLoadingCmsComponent=!0;var req=$.get(url);req.done(function(res){$container.html(res),$container.attr("loaded",!0)}),req.always(function(){ACC.requests.isLoadingCmsComponent=!1,$(".js-content-comp-ajax:not([loaded]) img.ajax-loading-lazy").each(function(){ACC.requests.RenderAjaxContentOnEvent($(this).data("itemtype"),$(this).data("uid"),$(this).data("data"))})})},RenderAjaxContentOnEvent:function(itemtype,uid,data){$("#"+uid).attr("loaded")||ACC.requests.isLoadingCmsComponent||ACC.requests.RenderAjaxContent(itemtype,uid,data)},RenderAjaxContent:function(itemtype,uid,data){var container=$("#"+uid),wt=$(window).scrollTop(),wb=wt+$(window).height()+200,ot=container.offset().top,ob=ot+container.height();"true"!=container.attr("loaded")&&wt<=ob&&wb>=ot&&("contentslot"===itemtype?ACC.requests.loadContentSlot(uid,uid,data):ACC.requests.loadCmsComponent(uid,uid,data))},loadProductGroup:function(url,container,cacheExpired,cacheable){var $container=$("#ajax-content-holder-"+container);$container.html('<div class="product-group-loader"></div>');var selectedProvince=ACC.delivery.selectedProvince||"",selectedDistrict=ACC.delivery.selectedDistrict||"",selectedWard=ACC.delivery.selectedWard||"",key=[url,selectedProvince,selectedDistrict,selectedWard].join("_");if(void 0!==typeof Storage&&cacheable){var cachedPG=sessionStorage.getItem(key);if(null===cachedPG||""===cachedPG||"undefined"===cachedPG||"true"===cacheExpired){var req=$.get(url);req.done(function(res){$container.html(res),sessionStorage.setItem(key,res)})}else $container.html(cachedPG)}else{var req=$.get(url);req.done(function(res){$container.html(res)})}ACC.carousel.bindCarousel()},loadUserInfo:function(){$.get(ACC.config.loginUserInfoURL,function(data){"ANONYMOUS"!==data&&$(".js-user--info").html(data)})},setCarouselForProductTogetherViewed:function(){void 0!==$("#product-detail__together-viewed")&&$("#product-detail__together-viewed").length>0&&ACC.carousel.bindCarousel()},fillProductOnvisibleToDataLayer:function(lstProduct){try{if(null!=lstProduct&&void 0!==lstProduct&&lstProduct.length>0){for(var lstProductDatalayer=[],i=0;i<=lstProduct.length-1;i++){var productData=lstProduct[i],productDatalayer={id:productData.id,sku:productData.sku,name:productData.name,variant:productData.variant,quantity:productData.quantity,price:{original:productData.price,discounted:productData.discounted,discount:productData.discount},category:{id:productData.categoryId,name:productData.category,path:productData.categoryPath},brand:{id:productData.brandId,name:productData.brand},list:{name:"Landing",position:productData.position}};lstProductDatalayer.push(productDatalayer)}dataLayer.push({event:"productImpressions",productArray:lstProductDatalayer})}}catch(ex){}},backToTop:function(){var backtotop=$(".btn-goto-top");$(window).scroll(function(){var scrollHeight=600;$(window).width()<768&&(scrollHeight=400),$(window).scrollTop()>scrollHeight?backtotop.addClass("show-btt"):backtotop.removeClass("show-btt")}),backtotop.on("click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},"300")})},socialShare:function(){var open_social_share_list=$(".js-open-social-share-list"),modal=$(".js-modal");$(".js-function-modal-button").on("click",function(){$(this).parent().parent().addClass("hide"),$("html").css({overflow:"unset"})}),$(".js-modal").on("click",function(event){var _this=$(this);-1!==event.target.className.indexOf("js-modal")&&(_this.addClass("hide"),_this.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")),$("html").css({overflow:"unset"})}),isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),open_social_share_list.on("click",function(){var _this=$(this);_this.siblings(".js-modal").removeClass("hide"),$("html").css({overflow:"hidden"}),setTimeout(function(){_this.siblings().find(".d-modal__content").addClass("d-modal__content--active-pop-up")},100)}),$(document).on("click",".js-share-fb",function(e){window.open("https://facebook.com/sharer/sharer.php?u="+encodeURIComponent(window.location.href),"_blank"),modal.addClass("hide"),modal.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")}),$(document).on("click",".js-copy-url",function(e){var textArea=document.createElement("input");textArea.value=window.location.href,document.body.appendChild(textArea),ACC.requests.copyToClipboard(textArea),document.body.removeChild(textArea),modal.addClass("hide"),modal.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")})},copyToClipboard:function(el){if(el="string"==typeof el?document.querySelector(el):el,navigator.userAgent.match(/ipad|ipod|iphone/i)){var editable=el.contentEditable,readOnly=el.readOnly;el.contentEditable=!0,el.readOnly=!0;var range=document.createRange();range.selectNodeContents(el);var selection=window.getSelection();selection.removeAllRanges(),selection.addRange(range),el.setSelectionRange(0,999999),el.contentEditable=editable,el.readOnly=readOnly}else el.select();document.execCommand("copy")}},ACC.template={userInfo:{points:{desktop:function(res){$("#userVinPoints .highlight-color").html(_.template("<%=points%>")({points:res.totalPoint||0,currency:ACC.config.currency}))},mobile:function(res){var vinIdTpMobile=_.template('<li class="auto liUserSign"><a class="userSign" href="'+ACC.config.profileUrl+'"><i class="adr-icon icon-account"></i><div class="clear"></div><%= userName %><div class="user-point"><%= pointText %> <span class="text-point"><%= points %><%= currency %></span><span class="adr-icon chevron-right"></span></div></a><a href="<%= logoutUrl %>" type="button" class="js-close-mobile btn"><%= logoutText %></a></li>');$(".js-sticky-user-group").html(vinIdTpMobile({userIcon:ACC.config.themeResourcePath+"/images/user-left-menu.png",userName:ACC.userInfo?ACC.userInfo.name:"Anonymous",pointText:ACC.message.sumVinPointTextMobile,points:_.isNull(res.totalPoint)?0:res.totalPoint,currency:ACC.config.currency,logoutUrl:ACC.config.logoutUrl,logoutText:ACC.message.logoutText}))}},giftcode:function(res){if(!_.isUndefined(res)){$("#userGiftCode .highlight-color").html(res.totalGiftCode);$('.list-group-item [href="/my-account/gift-codes"]').append(_.template('<span style="<%= styleMobile %>"><%= totalGiftCode %></span>')({totalGiftCode:res.totalGiftCode,styleMobile:"border-radius: 100%;background: red;color: #fff;min-width: 20px;min-height: 20px;display: inline-block; margin-left: 5px; line-height: 20px; text-align: center;"}))}}},productGroup:{item:function(productsList,defaultImage,superSaleImage,giftImage,houseblock,statusForMainComponent,quickButtonEnable,quickViewEnable){var pTp,variantInfoHtml,mainImageHtml,extraImageHtml,rewardHtml,priceHtml,pItemHtml,saleImageUrl,extraVinhomeHtml,variantTypeHtml,promotionStopperHtml,couponStopperHtml,freeGiftStopperHtml,rewardMessageHtml,quickButtonHtml,quickButtonFunction,flashSaleProgressHtml;return saleImageUrl=ACC.config.themeResourcePath+"/images/icons/sale-tag.png",variantInfoHtml=_.template('<% if(product.multidimensional && !_.isNull(product.firstCategoryNameList)){ %> <div class="<%= variantsClass %>"> <div class="<%= variantsClass %>-container"> <% _.each(product.firstCategoryNameList, function(cat,loop){ %> <% if(loop.index <= variantNumber){ %> <% var variableClass = "product-item__variable-text" %> <% var totalVariants = _.size(product.firstCategoryNameList) - variantNumber - 1; %> <% if(cat.showImage){ %> <% variableClass = "product-item__variable-image"; %> <% } %> <a href="<%= product.url %><%= cat.variantCode %>?offer=<%= product.code %>" class="<%= variableClass %>"> <% if(cat.showImage){ %> <img class="img-responsive" alt="<%= cat.categoryName %>" src="<%= cat.image %>" /> <% } else { %> <%= cat.categoryName %> <% } %> <% if(loop.index === variantNumber && totalVariants > 0){ %> <div class="variant__mask"> <div class="vertical-alignment-helper"> <div class="vertical-align-center"> + <%= totalVariants %> </div> </div> </div> <% } %> </a> <% } %> <% }); %> </div> </div> <% } %> '),mainImageHtml=_.template('<% var imgBigSrc = imgBigSrc || imgSrc;%><img class="img-item-product-group plp-lazy" alt="<%= imgAlt %>" title="<% imgTitle %>" data-default-image="<%= imgSrc %>" data-original="<%= imgBigSrc %>" data-src="<%= imgBigSrc %>" style="display: inline;">'),extraImageHtml=_.template('<% if (!_.isNull(product.productStopperLeft) && typeof product.productStopperLeft.url !== "undefined") { %><img class="product-item__overlay product-item__overlay-sale-hot stopper-left stopper-top-lazy" alt="" data-original="<%= product.productStopperLeft.url %>"><% } %><% if (!_.isNull(product.productStopperRight) && typeof product.productStopperRight.url !== "undefined") { %><img class="product-item__overlay product-item__overlay-sale-hot stopper-right stopper-top-lazy" alt="" data-original="<%= product.productStopperRight.url %>"><%} else { %><% if (product.supperPromotion) { %><img class="product-item__overlay product-item__overlay-sale-hot supper-sale stopper-top-lazy" data-original="<%= saleImgUrl %>" alt="" title=""><% } %><% } %><% if (!_.isNull(product.productStopperBottom) && typeof product.productStopperBottom.url !== "undefined") { %><img class="product-item__overlay product-item__overlay-sale-hot stopper-bottom stopper-bottom-lazy" alt="" data-original="<%= product.productStopperBottom.url %>"><% } %><% if (!_.isEmpty(product.potentialPromotions)) { %><% if (!_.isNull(giftImage)) { %><img class="product-item__overlay product-item__overlay-cart-rule" alt="<%= giftImage.altText %>" src="<%= giftImage.url %>"><% } else { %><div class="product-item__overlay product-item__overlay-cart-rule"></div><% }} %>'),rewardHtml=_.template('<div class="vinid-coupon__wrapper"><%= rewardMessageHtml %><%= promotionStopperHtml %></div>'),rewardMessageHtml=_.template('<div class="vin-id-reward-wrapper generation-tmp"><div class="vin-id-reward-content"><div class="d-icon"><i class="polish-version-icon-VinID-Logo"></i></div><span class="product-item__info-vinid"><%= rewardRateMessage %></span></div></div>'),variantTypeHtml=_.template('<div class="variant-type-text"> <%= variantType %></div>'),promotionStopperHtml=_.template('<div class="product-item__info-coupon"><%= couponStopperHtml %><%= freeGiftHtml %></div>'),couponStopperHtml=_.template('<div class="product-item__info-coupon"><div class="product-item__info-coupon pl__coupon--list"><div class="d-icon text-icon-tab__left-icon"><i class="polish-version-icon-giftcode-16px"></i></div><div class="pl__coupon--code"><%= couponText %></div></div></div>'),freeGiftStopperHtml=_.template('<div class="d-icon text-icon-tab__right-icon"><i class="polish-version-icon-gift-16px"></i><span class="best-coupon-title"><%= bestFreeGiftStopper %></span></div>'),quickButtonFunction=_.template('<div class="product-item__couple-btn js-quick-button-group"><%= addCartHtml %><%= quickViewHtml %></div>'),
null!=statusForMainComponent&&void 0!=statusForMainComponent&&""!=statusForMainComponent?"COMINGSOON"==statusForMainComponent?priceHtml=_.template('<div class="product-item__info-price"><div class="image-flash-sale-tag"> <svg width="88px" height="20px" viewBox="0 0 88 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> \x3c!-- Generator: Sketch 51.2 (57519) - http://www.bohemiancoding.com/sketch --\x3e <title>FlashSale-Tag</title> <desc>Created with Sketch.</desc> <defs> <path d="M4,0 L84,0 C86.209139,-4.05812251e-16 88,1.790861 88,4 L88,16 C88,18.209139 86.209139,20 84,20 L4,20 C1.790861,20 2.705415e-16,18.209139 0,16 L0,4 C-2.705415e-16,1.790861 1.790861,4.05812251e-16 4,0 Z M8,14.1768421 L9.87487318,14.1768421 L9.87487318,10.7872368 L13.2593845,10.7872368 L13.2593845,9.11078947 L9.87487318,9.11078947 L9.87487318,7.36092105 L13.588096,7.36092105 L13.588096,5.64776316 L8,5.64776316 L8,14.1768421 Z M14.8907677,14.1768421 L20.0771052,14.1768421 L20.0771052,12.4636842 L16.7656409,12.4636842 L16.7656409,5.64776316 L14.8907677,5.64776316 L14.8907677,14.1768421 Z M20.5762597,14.1768421 L22.5728779,14.1768421 L23.1450795,12.7451316 L26.6878593,12.7451316 L27.2600609,14.1768421 L29.2566791,14.1768421 L25.7504227,5.64776316 L24.0825161,5.64776316 L20.5762597,14.1768421 Z M23.6807575,11.24 L24.9225566,8.14407895 L26.1521813,11.24 L23.6807575,11.24 Z M30.9002367,11.4847368 L29.5366926,12.4269737 C29.8207657,12.9898712 30.2570143,13.4446693 30.8454515,13.7913816 C31.4338886,14.1380938 32.1582642,14.3114474 33.0185999,14.3114474 C34.0656123,14.3114474 34.8528888,14.0748708 35.3804532,13.6017105 C35.9080175,13.1285503 36.1717957,12.4963197 36.1717957,11.705 C36.1717957,11.0931548 36.0033835,10.5914493 35.6665539,10.1998684 C35.3297244,9.80828752 34.7757901,9.46565936 34.0047345,9.17197368 C33.8992217,9.13118401 33.7855941,9.08835549 33.6638485,9.04348684 C33.5421029,8.9986182 33.4122428,8.95171077 33.2742645,8.90276316 L32.6655394,8.69473684 C32.6087248,8.67026304 32.5478529,8.64375014 32.4829219,8.61519737 C32.4179909,8.58664459 32.3530609,8.55197389 32.2881299,8.51118421 C32.1582679,8.42960486 32.0710181,8.34190836 32.0263781,8.24809211 C31.981738,8.15427585 31.9594183,8.03802701 31.9594183,7.89934211 C31.9594183,7.69539372 32.0527552,7.52815855 32.2394319,7.39763158 C32.4261085,7.26710461 32.6736542,7.20184211 32.9820764,7.20184211 C33.6557355,7.20184211 34.1630013,7.42210306 34.5038891,7.86263158 L35.7578627,6.90815789 C35.1004363,5.97815324 34.158951,5.51315789 32.9333784,5.51315789 C32.1379737,5.51315789 31.4683828,5.73341885 30.9245857,6.17394737 C30.3807886,6.59816002 30.1088941,7.18144366 30.1088941,7.92381579 C30.1088941,8.5682927 30.2854227,9.08019547 30.638485,9.45953947 C30.9915473,9.83888348 31.5008421,10.1509198 32.1663848,10.3956579 C32.2231995,10.4201317 32.2962457,10.448684 32.3855259,10.4813158 C32.474806,10.5139475 32.5640848,10.5445393 32.6533649,10.5730921 C32.742645,10.6016449 32.8278657,10.6301972 32.9090294,10.65875 C32.9901932,10.6873028 33.0551232,10.7138157 33.1038214,10.7382895 C33.2174507,10.7709212 33.3473107,10.8178286 33.4934055,10.8790132 C33.6395002,10.9401977 33.7531278,10.9993418 33.8342915,11.0564474 C33.9722699,11.1461847 34.0838684,11.2461179 34.1690903,11.35625 C34.2543122,11.4663821 34.2969226,11.6030255 34.2969226,11.7661842 C34.2969226,11.9946064 34.1954694,12.1924334 33.99256,12.3596711 C33.7896507,12.5269087 33.4690587,12.6105263 33.0307744,12.6105263 C32.0649258,12.6105263 31.3547537,12.2352669 30.9002367,11.4847368 Z M37.3283734,14.1768421 L39.2032465,14.1768421 L39.2032465,10.5302632 L42.8799459,10.5302632 L42.8799459,14.1768421 L44.7548191,14.1768421 L44.7548191,5.64776316 L42.8799459,5.64776316 L42.8799459,8.81710526 L39.2032465,8.81710526 L39.2032465,5.64776316 L37.3283734,5.64776316 L37.3283734,14.1768421 Z M51.2193486,17.75 C51.3247558,17.75 51.4273892,17.7040539 51.4967359,17.6163393 L58.2441802,9.15394397 C58.3287832,9.04673702 58.3454264,8.90054568 58.2857881,8.77663078 C58.2275369,8.65271623 58.1027125,8.57474747 57.966793,8.57474747 L54.3787892,8.57474747 L56.0417257,2.70342143 C56.0874945,2.5405225 56.0139869,2.36787739 55.8628106,2.28990863 C55.7130216,2.21193987 55.529946,2.25092425 55.423152,2.38319241 L48.6590648,10.8469799 C48.5744618,10.9541869 48.5578186,11.1003786 48.6160697,11.2242931 C48.675708,11.3468155 48.7991453,11.4261764 48.936452,11.4261764 L52.6631494,11.4261764 L50.8809362,17.2905411 C50.8310065,17.45344 50.9031272,17.6288699 51.0543035,17.7096231 C51.1070069,17.737469 51.1638712,17.75 51.2193486,17.75 Z M58.0980724,14.1768421 L60.0946906,14.1768421 L60.6668921,12.7451316 L64.209672,12.7451316 L64.7818735,14.1768421 L66.7784917,14.1768421 L63.2722354,5.64776316 L61.6043287,5.64776316 L58.0980724,14.1768421 Z M61.2025702,11.24 L62.4443693,8.14407895 L63.6739939,11.24 L61.2025702,11.24 Z M67.7889753,14.1768421 L72.9753128,14.1768421 L72.9753128,12.4636842 L69.6638485,12.4636842 L69.6638485,5.64776316 L67.7889753,5.64776316 L67.7889753,14.1768421 Z M74.1197159,14.1768421 L80,14.1768421 L80,12.4636842 L75.9945891,12.4636842 L75.9945891,10.6403947 L79.659114,10.6403947 L79.659114,8.96394737 L75.9945891,8.96394737 L75.9945891,7.36092105 L79.9147785,7.36092105 L79.9147785,5.64776316 L74.1197159,5.64776316 L74.1197159,14.1768421 Z" id="path-1"></path> </defs> <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="flashsale-tag"> <mask id="mask-2" fill="white"> <use xlink:href="#path-1"></use> </mask> <use id="FlashSale-Tag" fill="#E53935" xlink:href="#path-1"></use> </g> </g> </svg> </div><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>'):"ONGOING"==statusForMainComponent?priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale"><%= product.price.formattedValue %></span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>'):"ENDED"==statusForMainComponent&&(priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale">Đã kết thúc</span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>')):priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale"><%= product.price.formattedValue %></span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>'),extraVinhomeHtml=_.template('<% if (!_.isUndefined(houseblock) && !_.isNull(houseblock) && !_.isEmpty(houseblock)) { %> <img class="qr-code" src="/qrcode?q=<%=qrUrl%>"/> <% } %>'),_.defaults(defaultImage,{imgLoaderSrc:ACC.config.themeResourcePath+"/images/product-240x240.png",imgSrc:"",imgAlt:"ADR",imgTitle:"ADR",imgBigSrc:""}),_.defaults(superSaleImage,{url:saleImageUrl}),_.isUndefined(giftImage)&&(giftImage=null),pItemHtml="",_.each(productsList,function(product){flashSaleProgressHtml="";var variantTypeStr="";"TABLE_BOOKING"==product.productType?pTp=_.template('<div class="col-xs-6 col-sm-4 col-md-3 col-lg-2-5 product-item__wrapper product-item__wrapper--hover"> <div class="product-item__placeholder hidden-sm hidden-xs"></div> <div class="product-item <%= hasVariantClass %> <%= hasVinhomeClass %>"> <%= verticalVariantInfoHtml %><div class="product-item__container"> <a class="product-item__thumbnail " href="<%= productUrl %>"> <%= mainImageHtml %> <%= extraImageHtml %> <%= extraVinhomeHtml %></a> <%= horizVariantInfoHtml %><div class="product-item__info"> <a class="product-item__info-title" href="<%= productUrl %>"> <%= productName %> </a> <a class="btn-mobile-buynow" href="<%= productUrl %>">Mua Ngay <i class="polish-version-icon-arrow-right"></i> </a><%= productPriceHtml %><%= flashSaleProgressHtml %></div> </div> </div> </div>'):(pTp=_.template('<div class="col-xs-6 col-sm-4 col-md-3 col-lg-2-5 product-item__wrapper product-item__wrapper--hover product-item__wrapper-improvement"> <div class="product-item__placeholder hidden-sm hidden-xs"></div> <div class="product-item <%= hasVariantClass %> <%= hasVinhomeClass %>"> <%= verticalVariantInfoHtml %><div class="product-item__container"> <a class="product-item__thumbnail " href="<%= productUrl %>"> <%= mainImageHtml %> <%= extraImageHtml %> <%= extraVinhomeHtml %></a> <%= horizVariantInfoHtml %><div class="product-item__info"> <a class="product-item__info-title" href="<%= productUrl %>"> <%= productName %> </a><a class="btn-mobile-buynow" href="<%= productUrl %>">Mua Ngay <i class="polish-version-icon-arrow-right"></i> </a> <%= productPriceHtml %> <%= variantTypeHtml %><%= rewardHtml %><%= flashSaleProgressHtml %><%= quickButtonHtml %></div> </div> </div> </div>'),product.multidimensional&&!_.isNull(product.firstCategoryNameList)&&(variantTypeStr=product.firstCategoryNameList[0].variantQty+" "+product.firstCategoryNameList[0].spCategoryName),!product.multidimensional||_.isNull(product.firstCategoryNameList)||_.isNull(product.secondCategoryNameList)||(variantTypeStr+=" , "),product.multidimensional&&!_.isNull(product.secondCategoryNameList)&&(variantTypeStr+=product.secondCategoryNameList[0].variantQty+" "+product.secondCategoryNameList[0].spCategoryName)),"TABLE_BOOKING"==product.productType?null!=statusForMainComponent&&void 0!=statusForMainComponent&&""!=statusForMainComponent?"COMINGSOON"==statusForMainComponent?priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale"><div class="image-flash-sale-tag"> <svg width="88px" height="20px" viewBox="0 0 88 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> \x3c!-- Generator: Sketch 51.2 (57519) - http://www.bohemiancoding.com/sketch --\x3e <title>FlashSale-Tag</title> <desc>Created with Sketch.</desc> <defs> <path d="M4,0 L84,0 C86.209139,-4.05812251e-16 88,1.790861 88,4 L88,16 C88,18.209139 86.209139,20 84,20 L4,20 C1.790861,20 2.705415e-16,18.209139 0,16 L0,4 C-2.705415e-16,1.790861 1.790861,4.05812251e-16 4,0 Z M8,14.1768421 L9.87487318,14.1768421 L9.87487318,10.7872368 L13.2593845,10.7872368 L13.2593845,9.11078947 L9.87487318,9.11078947 L9.87487318,7.36092105 L13.588096,7.36092105 L13.588096,5.64776316 L8,5.64776316 L8,14.1768421 Z M14.8907677,14.1768421 L20.0771052,14.1768421 L20.0771052,12.4636842 L16.7656409,12.4636842 L16.7656409,5.64776316 L14.8907677,5.64776316 L14.8907677,14.1768421 Z M20.5762597,14.1768421 L22.5728779,14.1768421 L23.1450795,12.7451316 L26.6878593,12.7451316 L27.2600609,14.1768421 L29.2566791,14.1768421 L25.7504227,5.64776316 L24.0825161,5.64776316 L20.5762597,14.1768421 Z M23.6807575,11.24 L24.9225566,8.14407895 L26.1521813,11.24 L23.6807575,11.24 Z M30.9002367,11.4847368 L29.5366926,12.4269737 C29.8207657,12.9898712 30.2570143,13.4446693 30.8454515,13.7913816 C31.4338886,14.1380938 32.1582642,14.3114474 33.0185999,14.3114474 C34.0656123,14.3114474 34.8528888,14.0748708 35.3804532,13.6017105 C35.9080175,13.1285503 36.1717957,12.4963197 36.1717957,11.705 C36.1717957,11.0931548 36.0033835,10.5914493 35.6665539,10.1998684 C35.3297244,9.80828752 34.7757901,9.46565936 34.0047345,9.17197368 C33.8992217,9.13118401 33.7855941,9.08835549 33.6638485,9.04348684 C33.5421029,8.9986182 33.4122428,8.95171077 33.2742645,8.90276316 L32.6655394,8.69473684 C32.6087248,8.67026304 32.5478529,8.64375014 32.4829219,8.61519737 C32.4179909,8.58664459 32.3530609,8.55197389 32.2881299,8.51118421 C32.1582679,8.42960486 32.0710181,8.34190836 32.0263781,8.24809211 C31.981738,8.15427585 31.9594183,8.03802701 31.9594183,7.89934211 C31.9594183,7.69539372 32.0527552,7.52815855 32.2394319,7.39763158 C32.4261085,7.26710461 32.6736542,7.20184211 32.9820764,7.20184211 C33.6557355,7.20184211 34.1630013,7.42210306 34.5038891,7.86263158 L35.7578627,6.90815789 C35.1004363,5.97815324 34.158951,5.51315789 32.9333784,5.51315789 C32.1379737,5.51315789 31.4683828,5.73341885 30.9245857,6.17394737 C30.3807886,6.59816002 30.1088941,7.18144366 30.1088941,7.92381579 C30.1088941,8.5682927 30.2854227,9.08019547 30.638485,9.45953947 C30.9915473,9.83888348 31.5008421,10.1509198 32.1663848,10.3956579 C32.2231995,10.4201317 32.2962457,10.448684 32.3855259,10.4813158 C32.474806,10.5139475 32.5640848,10.5445393 32.6533649,10.5730921 C32.742645,10.6016449 32.8278657,10.6301972 32.9090294,10.65875 C32.9901932,10.6873028 33.0551232,10.7138157 33.1038214,10.7382895 C33.2174507,10.7709212 33.3473107,10.8178286 33.4934055,10.8790132 C33.6395002,10.9401977 33.7531278,10.9993418 33.8342915,11.0564474 C33.9722699,11.1461847 34.0838684,11.2461179 34.1690903,11.35625 C34.2543122,11.4663821 34.2969226,11.6030255 34.2969226,11.7661842 C34.2969226,11.9946064 34.1954694,12.1924334 33.99256,12.3596711 C33.7896507,12.5269087 33.4690587,12.6105263 33.0307744,12.6105263 C32.0649258,12.6105263 31.3547537,12.2352669 30.9002367,11.4847368 Z M37.3283734,14.1768421 L39.2032465,14.1768421 L39.2032465,10.5302632 L42.8799459,10.5302632 L42.8799459,14.1768421 L44.7548191,14.1768421 L44.7548191,5.64776316 L42.8799459,5.64776316 L42.8799459,8.81710526 L39.2032465,8.81710526 L39.2032465,5.64776316 L37.3283734,5.64776316 L37.3283734,14.1768421 Z M51.2193486,17.75 C51.3247558,17.75 51.4273892,17.7040539 51.4967359,17.6163393 L58.2441802,9.15394397 C58.3287832,9.04673702 58.3454264,8.90054568 58.2857881,8.77663078 C58.2275369,8.65271623 58.1027125,8.57474747 57.966793,8.57474747 L54.3787892,8.57474747 L56.0417257,2.70342143 C56.0874945,2.5405225 56.0139869,2.36787739 55.8628106,2.28990863 C55.7130216,2.21193987 55.529946,2.25092425 55.423152,2.38319241 L48.6590648,10.8469799 C48.5744618,10.9541869 48.5578186,11.1003786 48.6160697,11.2242931 C48.675708,11.3468155 48.7991453,11.4261764 48.936452,11.4261764 L52.6631494,11.4261764 L50.8809362,17.2905411 C50.8310065,17.45344 50.9031272,17.6288699 51.0543035,17.7096231 C51.1070069,17.737469 51.1638712,17.75 51.2193486,17.75 Z M58.0980724,14.1768421 L60.0946906,14.1768421 L60.6668921,12.7451316 L64.209672,12.7451316 L64.7818735,14.1768421 L66.7784917,14.1768421 L63.2722354,5.64776316 L61.6043287,5.64776316 L58.0980724,14.1768421 Z M61.2025702,11.24 L62.4443693,8.14407895 L63.6739939,11.24 L61.2025702,11.24 Z M67.7889753,14.1768421 L72.9753128,14.1768421 L72.9753128,12.4636842 L69.6638485,12.4636842 L69.6638485,5.64776316 L67.7889753,5.64776316 L67.7889753,14.1768421 Z M74.1197159,14.1768421 L80,14.1768421 L80,12.4636842 L75.9945891,12.4636842 L75.9945891,10.6403947 L79.659114,10.6403947 L79.659114,8.96394737 L75.9945891,8.96394737 L75.9945891,7.36092105 L79.9147785,7.36092105 L79.9147785,5.64776316 L74.1197159,5.64776316 L74.1197159,14.1768421 Z" id="path-1"></path> </defs> <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="flashsale-tag"> <mask id="mask-2" fill="white"> <use xlink:href="#path-1"></use> </mask> <use id="FlashSale-Tag" fill="#E53935" xlink:href="#path-1"></use> </g> </g> </svg> </div></span></div>'):"ONGOING"==statusForMainComponent?priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale">'+product.currentOffer.discountTag+"</span></div>"):"ENDED"==statusForMainComponent&&(priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale">Đã kết thúc</span></div>')):priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale">'+product.currentOffer.discountTag+"</span></div>"):null!=statusForMainComponent&&void 0!=statusForMainComponent&&""!=statusForMainComponent?"COMINGSOON"==statusForMainComponent?priceHtml=null!=product.isShowFuturePrice&&1==product.isShowFuturePrice?_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale"><%= product.futurePrice.formattedValue %></span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %></div>'):_.template('<div class="product-item__info-price"><div class="image-flash-sale-tag"> <svg width="88px" height="20px" viewBox="0 0 88 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> \x3c!-- Generator: Sketch 51.2 (57519) - http://www.bohemiancoding.com/sketch --\x3e <title>FlashSale-Tag</title> <desc>Created with Sketch.</desc> <defs> <path d="M4,0 L84,0 C86.209139,-4.05812251e-16 88,1.790861 88,4 L88,16 C88,18.209139 86.209139,20 84,20 L4,20 C1.790861,20 2.705415e-16,18.209139 0,16 L0,4 C-2.705415e-16,1.790861 1.790861,4.05812251e-16 4,0 Z M8,14.1768421 L9.87487318,14.1768421 L9.87487318,10.7872368 L13.2593845,10.7872368 L13.2593845,9.11078947 L9.87487318,9.11078947 L9.87487318,7.36092105 L13.588096,7.36092105 L13.588096,5.64776316 L8,5.64776316 L8,14.1768421 Z M14.8907677,14.1768421 L20.0771052,14.1768421 L20.0771052,12.4636842 L16.7656409,12.4636842 L16.7656409,5.64776316 L14.8907677,5.64776316 L14.8907677,14.1768421 Z M20.5762597,14.1768421 L22.5728779,14.1768421 L23.1450795,12.7451316 L26.6878593,12.7451316 L27.2600609,14.1768421 L29.2566791,14.1768421 L25.7504227,5.64776316 L24.0825161,5.64776316 L20.5762597,14.1768421 Z M23.6807575,11.24 L24.9225566,8.14407895 L26.1521813,11.24 L23.6807575,11.24 Z M30.9002367,11.4847368 L29.5366926,12.4269737 C29.8207657,12.9898712 30.2570143,13.4446693 30.8454515,13.7913816 C31.4338886,14.1380938 32.1582642,14.3114474 33.0185999,14.3114474 C34.0656123,14.3114474 34.8528888,14.0748708 35.3804532,13.6017105 C35.9080175,13.1285503 36.1717957,12.4963197 36.1717957,11.705 C36.1717957,11.0931548 36.0033835,10.5914493 35.6665539,10.1998684 C35.3297244,9.80828752 34.7757901,9.46565936 34.0047345,9.17197368 C33.8992217,9.13118401 33.7855941,9.08835549 33.6638485,9.04348684 C33.5421029,8.9986182 33.4122428,8.95171077 33.2742645,8.90276316 L32.6655394,8.69473684 C32.6087248,8.67026304 32.5478529,8.64375014 32.4829219,8.61519737 C32.4179909,8.58664459 32.3530609,8.55197389 32.2881299,8.51118421 C32.1582679,8.42960486 32.0710181,8.34190836 32.0263781,8.24809211 C31.981738,8.15427585 31.9594183,8.03802701 31.9594183,7.89934211 C31.9594183,7.69539372 32.0527552,7.52815855 32.2394319,7.39763158 C32.4261085,7.26710461 32.6736542,7.20184211 32.9820764,7.20184211 C33.6557355,7.20184211 34.1630013,7.42210306 34.5038891,7.86263158 L35.7578627,6.90815789 C35.1004363,5.97815324 34.158951,5.51315789 32.9333784,5.51315789 C32.1379737,5.51315789 31.4683828,5.73341885 30.9245857,6.17394737 C30.3807886,6.59816002 30.1088941,7.18144366 30.1088941,7.92381579 C30.1088941,8.5682927 30.2854227,9.08019547 30.638485,9.45953947 C30.9915473,9.83888348 31.5008421,10.1509198 32.1663848,10.3956579 C32.2231995,10.4201317 32.2962457,10.448684 32.3855259,10.4813158 C32.474806,10.5139475 32.5640848,10.5445393 32.6533649,10.5730921 C32.742645,10.6016449 32.8278657,10.6301972 32.9090294,10.65875 C32.9901932,10.6873028 33.0551232,10.7138157 33.1038214,10.7382895 C33.2174507,10.7709212 33.3473107,10.8178286 33.4934055,10.8790132 C33.6395002,10.9401977 33.7531278,10.9993418 33.8342915,11.0564474 C33.9722699,11.1461847 34.0838684,11.2461179 34.1690903,11.35625 C34.2543122,11.4663821 34.2969226,11.6030255 34.2969226,11.7661842 C34.2969226,11.9946064 34.1954694,12.1924334 33.99256,12.3596711 C33.7896507,12.5269087 33.4690587,12.6105263 33.0307744,12.6105263 C32.0649258,12.6105263 31.3547537,12.2352669 30.9002367,11.4847368 Z M37.3283734,14.1768421 L39.2032465,14.1768421 L39.2032465,10.5302632 L42.8799459,10.5302632 L42.8799459,14.1768421 L44.7548191,14.1768421 L44.7548191,5.64776316 L42.8799459,5.64776316 L42.8799459,8.81710526 L39.2032465,8.81710526 L39.2032465,5.64776316 L37.3283734,5.64776316 L37.3283734,14.1768421 Z M51.2193486,17.75 C51.3247558,17.75 51.4273892,17.7040539 51.4967359,17.6163393 L58.2441802,9.15394397 C58.3287832,9.04673702 58.3454264,8.90054568 58.2857881,8.77663078 C58.2275369,8.65271623 58.1027125,8.57474747 57.966793,8.57474747 L54.3787892,8.57474747 L56.0417257,2.70342143 C56.0874945,2.5405225 56.0139869,2.36787739 55.8628106,2.28990863 C55.7130216,2.21193987 55.529946,2.25092425 55.423152,2.38319241 L48.6590648,10.8469799 C48.5744618,10.9541869 48.5578186,11.1003786 48.6160697,11.2242931 C48.675708,11.3468155 48.7991453,11.4261764 48.936452,11.4261764 L52.6631494,11.4261764 L50.8809362,17.2905411 C50.8310065,17.45344 50.9031272,17.6288699 51.0543035,17.7096231 C51.1070069,17.737469 51.1638712,17.75 51.2193486,17.75 Z M58.0980724,14.1768421 L60.0946906,14.1768421 L60.6668921,12.7451316 L64.209672,12.7451316 L64.7818735,14.1768421 L66.7784917,14.1768421 L63.2722354,5.64776316 L61.6043287,5.64776316 L58.0980724,14.1768421 Z M61.2025702,11.24 L62.4443693,8.14407895 L63.6739939,11.24 L61.2025702,11.24 Z M67.7889753,14.1768421 L72.9753128,14.1768421 L72.9753128,12.4636842 L69.6638485,12.4636842 L69.6638485,5.64776316 L67.7889753,5.64776316 L67.7889753,14.1768421 Z M74.1197159,14.1768421 L80,14.1768421 L80,12.4636842 L75.9945891,12.4636842 L75.9945891,10.6403947 L79.659114,10.6403947 L79.659114,8.96394737 L75.9945891,8.96394737 L75.9945891,7.36092105 L79.9147785,7.36092105 L79.9147785,5.64776316 L74.1197159,5.64776316 L74.1197159,14.1768421 Z" id="path-1"></path> </defs> <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="flashsale-tag"> <mask id="mask-2" fill="white"> <use xlink:href="#path-1"></use> </mask> <use id="FlashSale-Tag" fill="#E53935" xlink:href="#path-1"></use> </g> </g> </svg> </div><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>'):"ONGOING"==statusForMainComponent?priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale"><%= product.price.formattedValue %></span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>'):"ENDED"==statusForMainComponent&&(priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale">Đã kết thúc</span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>')):priceHtml=_.template('<div class="product-item__info-price"><span class="product-item__info-price-sale"><%= product.price.formattedValue %></span><% if(!product.supperPromotion  && product.offerDiscount > 0){if(isVoucher && (product.price.value < product.offerPrice.value)){ %><span class="product-item__info-price-original"><%= product.offerPrice.formattedValue %></span><%\t} %><span class="product-item__info-price-original"><%= product.rrp.formattedValue %></span><%  } %><% if(!product.supperPromotion && product.offerDiscount > 0){ %><span class="product-item__info-discount"><%= product.offerDiscount %>&#37;</span><% } %></div>');var hasVariantClass=product.multidimensional&&!_.isNull(product.firstCategoryNameList)?"pgi-have__variant":"",hasVinhomeClass=_.isUndefined(houseblock)||_.isNull(houseblock)||_.isEmpty(houseblock)?"":"vinhome-info",mainImgObj={};if(!_.isNull(product.images)&&product.images.length>0?(mainImgObj.imgLoaderSrc=ACC.config.themeResourcePath+"/images/logo-adayroi.svg",mainImgObj.imgSrc=product.images[0].url,mainImgObj.imgBigSrc=product.images[0].url):mainImgObj=defaultImage,mainImgObj.imgAlt=product.name,mainImgObj.imgTitle=product.name,null!=statusForMainComponent&&void 0!=statusForMainComponent&&"ONGOING"==statusForMainComponent&&!_.isNull(product.flashSaleData)){var flashSaleData=product.flashSaleData;if(flashSaleData.isHot)flashSaleProgressHtml='<div class="ch-product__progress"><div class="ch-progress sh"><div class="ch-progress__text white">Sắp hết</div><div class="ch-progress__changed" style="width: '+flashSaleData.actualSoldPercentage+'%;"></div></div></div>';else if(flashSaleData.isOutOfStock)flashSaleProgressHtml='<div class="ch-product__progress"><div class="ch-progress gray"><div class="ch-progress__text">Cháy hàng</div><div class="ch-progress__changed" style="width: 0;"></div></div></div>';else if(_.isNumber(flashSaleData.actualSold)&&_.isNumber(flashSaleData.totalQuantity)&&_.isNumber(flashSaleData.actualSoldPercentage)&&_.isNumber(flashSaleData.fakeQuantity)){var messsage="";messsage=flashSaleData.actualSold+flashSaleData.fakeQuantity>=flashSaleData.totalQuantity||_.isNumber(flashSaleData.remainingQuantity)&&flashSaleData.remainingQuantity>0?"CHỈ CÒN "+(flashSaleData.totalQuantity-flashSaleData.actualSold):"ĐÃ BÁN "+(flashSaleData.actualSold+flashSaleData.fakeQuantity),flashSaleProgressHtml='<div class="ch-product__progress"><div class="ch-progress"><div class="ch-progress__text white">'+messsage+'</div><div class="ch-progress__changed" style="width: '+flashSaleData.actualSoldPercentage+'%;"></div></div></div>'}}if("TABLE_BOOKING"!=product.productType&&"INSURANCE"!=product.productType&&"TOPUP_VOUCHER"!=product.productType&&_.isEqual(ACC.devices.name,"desktop")&&_.isEqual(quickButtonEnable,"true")){var addCartHtml="",quickViewHtml="";product.multidimensional||(addCartHtml='<a><button class="d-button d-button--add-cart-new d-button--full-dimension js-quick-add-to-cart" data-offer-code="'+product.code+'"><div class="d-icon"><i class="polish-version-icon-cart"></i></div></button></a>'),_.isEqual(quickViewEnable,"true")&&(quickViewHtml='<a><button class="d-button d-button--watch-fast d-button--full-dimension js-quick-view-product" data-offer-code="'+product.code+'"><span>Xem nhanh</span></button></a>'),quickButtonHtml=quickButtonFunction({addCartHtml:addCartHtml,quickViewHtml:quickViewHtml})}else quickButtonHtml="";var couponTextHtml="";_.isEmpty(product.couponText)||_.each(product.couponText,function(coupon){couponTextHtml+='<div class="coupon--title">'+coupon+"</div>"}),pItemHtml+=pTp({productUrl:product.url+"?offer="+product.code,hasVariantClass:hasVariantClass,verticalVariantInfoHtml:variantInfoHtml({variantsClass:"product-item__variables-vertical hidden",product:product,variantNumber:3}),horizVariantInfoHtml:variantInfoHtml({variantsClass:"product-item__variables-horizontal",product:product,variantNumber:3}),mainImageHtml:mainImageHtml(mainImgObj),extraImageHtml:extraImageHtml({product:product,saleImgUrl:_.isEmpty(superSaleImage.url)||_.isUndefined(superSaleImage.url)?saleImageUrl:superSaleImage.url,giftImage:giftImage}),extraVinhomeHtml:extraVinhomeHtml({houseblock:houseblock,qrUrl:_.isEmpty(product.urlFull)||_.isUndefined(product.urlFull)?"":product.urlFull+"?offer="+product.code+"&vha="+houseblock}),hasVinhomeClass:hasVinhomeClass,productName:product.name,productPriceHtml:priceHtml({product:product,isVoucher:!1}),variantTypeHtml:_.isEmpty(variantTypeStr)?"":variantTypeHtml({variantType:variantTypeStr}),rewardHtml:rewardHtml({rewardMessageHtml:null==product.currentOffer?"":_.isEmpty(product.currentOffer.rewardRatePLPMessage)?"":rewardMessageHtml({rewardRateMessage:product.currentOffer.rewardRatePLPMessage}),promotionStopperHtml:_.isEqual(ACC.devices.name,"desktop")?promotionStopperHtml({couponStopperHtml:_.isEmpty(couponTextHtml)?"":couponStopperHtml({couponText:couponTextHtml}),freeGiftHtml:_.isEmpty(product.bestFreeGiftStopper)?"":freeGiftStopperHtml({bestFreeGiftStopper:product.bestFreeGiftStopper})}):""}),quickButtonHtml:quickButtonHtml,flashSaleProgressHtml:flashSaleProgressHtml})}),pItemHtml}},pagination:function(pageObj,componentId,dom){var paginationHtml;if(void 0!==componentId)return _.isObject(pageObj)||(pageObj={},_.defaults(pageObj,{currentPage:0,numberOfPages:0,numberPagesShown:0,componentId:componentId})),
paginationHtml=_.template('<% var isEnd, isBegin, hasPreviousPage, hasNextPage, limit, previousIndex, nextIndex; stepMobile=4; cssHiddenXS=""%><% var firstPageLabel = firstPageLabel || "&nbsp;Trang đầu";%><% var lastPageLabel =  lastPageLabel || "Trang cuối&nbsp;";%><% isBegin = currentPage <= 0; %><% isEnd = currentPage + 1 >= numberOfPages; %><% hasPreviousPage = currentPage > 0; %><% hasNextPage = currentPage + 1 < numberOfPages; %><% currentPage = parseInt(currentPage); %><% numberOfPages = parseInt(numberOfPages); %><% endPageIndex = parseInt(numberOfPages) - 1; %><% previousIndex = currentPage - 1; %><% nextIndex = currentPage + 1; %><% previousIndex = previousIndex >= 0 ? previousIndex : -69; %><% nextIndex = nextIndex < numberOfPages ? nextIndex : -69;  %><% limit = parseInt(numberPagesShown); %><% if(ACC.devices.name=="mobile"){if(limit > stepMobile){limit = stepMobile}; cssHiddenXS="hidden-xs";}%><% halfLimit = Math.floor(limit/2); %><% if(numberOfPages > 1){ %><section class="section__pagination text-center"><nav class="Page navigation"><ul class="pagination js-ajax-pagination"><% var searchPageFirstClass = "", prevClass = ""; %><% if(previousIndex === -69){ prevClass += " disabled"; } %><% if(isBegin){ searchPageFirstClass += " disabled"; } %><li class="first-page <%= searchPageFirstClass %>"><a href="javascript:void(0);" data-current-page-number="0"  data-component-id="<%= componentId %>"><i class="adr-icon icon-arrow-left-sm"></i><%= firstPageLabel %></a></li><li class="prev-page <%= prevClass %> <%= cssHiddenXS %>"><a href="javascript:void(0);" data-current-page-number="<%= previousIndex %>"  data-component-id="<%= componentId %>"><i class="adr-icon icon-arrow-left-sm"></i></a></li><% var beginPage = 1; %><% var endPage = numberOfPages; %><% if(limit < numberOfPages){endPage = limit;if((currentPage + 1) % limit === 0){beginPage = currentPage + 1;endPage = currentPage + limit;}else{if((currentPage + 1) > limit){beginPage = (currentPage + 1) - ((currentPage + 1 ) % limit);endPage = beginPage - 1 + limit;}}if((currentPage + 1 === numberOfPages) || endPage > numberOfPages){beginPage = numberOfPages + 1 - limit;endPage = numberOfPages;}}%><% for(var i = beginPage; i <= endPage; i++){ %><% var activeClass = ""; %><% var pageRequest = i - 1; %><% if(pageRequest === currentPage){ %><% activeClass = "active"; %><% } %><li class="<%= activeClass %>"><a href="javascript:void(0);" data-current-page-number="<%= pageRequest %>" data-component-id="<%= componentId %>"><%= i %></a></li><% } %><% var searchPageEndClass = "", nextClass = ""; %><% if(nextIndex === -69){ nextClass += " disabled"; } %><% if(isEnd){ searchPageEndClass += " disabled"; } %><li class="next-page <%= nextClass %> <%= cssHiddenXS %>"><a href="javascript:void(0);" data-current-page-number="<%= nextIndex %>"  data-component-id="<%= componentId %>"><i class="adr-icon icon-arrow-right-sm"></i></a></li><li class="end-page <%= searchPageEndClass %>"><a href="javascript:void(0);" data-current-page-number="<%= endPageIndex %>"  data-component-id="<%= componentId %>"><%= lastPageLabel %><i class="adr-icon icon-arrow-right-sm"></i></a></li></ul><div class="clearfix visible-xs"></div></nav></section><% } %>'),_.isElement($(dom)[0])&&$(dom).html(paginationHtml(pageObj)),paginationHtml(pageObj)},topup:{offer:function(offer){return _.defaults(offer,{type:"BUYCARD",min:"",max:"",available:"",offer:"",code:"",label:"",provider:"",price:"",quantity:1,active:"",onsite:!0}),_.template('<div class="col-xs-4 col-sm-4 col-md-2-5 col-lg-2-5 item-offer"><a href="javascript:void(0);" data-type="<%= type %>" data-offer="<%= offer %>" data-provider="<%= provider %>" data-code="<%= code %>" data-min="<%= min %>" data-max="<%= max %>" data-available="<%= available %>" data-price="<%= price %>" data-quantity="<%= quantity %>" data-onsite="<%= onsite %>" class="mobile-charge__price-item <%= active %>"><%= label %></a></div>')(offer)},offerQuantity:function(offerQuantity){return _.defaults(offerQuantity,{minOrderQty:1,maxOrderQty:999,availableToSell:9999}),_.template('<% var qtyMinus = 1; %><% var maxDisplayItems = 10; %><% var minOrderQty = parseInt(minOrderQty) || 1; %><% var maxOrderQty = parseInt(maxOrderQty) || 999; %><% var maxQty = parseInt(maxQty) || 999999; %><% var displayItems = maxDisplayItems - 1; %><% var haveExtraInput = true; %><%if((maxOrderQty - minOrderQty + 1) <= maxDisplayItems ){displayItems = maxOrderQty - minOrderQty;haveExtraInput = false;}%><% var availableToSell = availableToSell || 9999; %><% var aval = availableToSell; %><%if(aval > (minOrderQty + displayItems)){aval = minOrderQty + displayItems;}%><%if(availableToSell > aval && haveExtraInput){haveExtraInput = true;}else{haveExtraInput = false;}%><% var extraInputNumber = minOrderQty + displayItems;%><% var currentQuantity = currentQuantity || 1; %><div class="product-order__quanity js-qty-selector js-product-order__quanity quantityshow"><div class="product-order__form-control pdpAddtoCartSelectSection adr-dropdown" id="pdpAddtoCartSelectSection"><select name="pdpAddtoCartSelect" id="pdpAddtoCartSelect" class="product-order__quanity-select form-control"><% for(var i = minOrderQty; i<=aval;i++)    { %><% var selected =\' \'; %><% if(currentQuantity == i){selected = \' selected \';} %><option value="<%= i %>" <%= selected %> ><%= i %></option><% } %><% if (haveExtraInput){ %><option value="pdpAddtoCartInput"><%= extraInputNumber %>+</option><% } %></select></div><% if(haveExtraInput){ %><div class="product-order__form-control pdpAddtoCartInputSection" id="pdpAddtoCartInputSection" style="display: none;"><div class="qty-selector input-group js-qty-selector"><input type="number" step="1" maxlength="6" class="form-control js-qty-selector-input product-order__quanity-input" size="1"value="<%= extraInputNumber %>" data-default-value="<%= extraInputNumber %>"data-max="1000" data-min="1" name="pdpAddtoCartInput" id="pdpAddtoCartInput" min="1"/></div></div><% } %></div>')(offerQuantity)},publisher:function(publisher){_.defaults(publisher,{offerCode:"",serviceProvider:"",currentCode:"",label:"",active:"",onsite:"",imgSrc:"",alt:""});var offsite="";return"disabled"==publisher.onsite&&(offsite='<span class="text-expired">Hết hàng</span>'),_.template('<div class="col-xs-4 col-sm-4 col-md-2-5 col-lg-2-5"><a href="javascript:void(0);" data-offer-code="<%= offerCode %>" data-topup-service-provider="<%= serviceProvider %>" data-current-code="<%= currentCode %>" data-prefix-phone="" class="mobile-charge__provider-item <%= active %> <%= onsite %>"><div class="mobile-charge__provider-img"><img src="<%= imgSrc %>" class="img-responsive" alt="<%= alt %>">'+offsite+'</div><div class="mobile-charge__provider-name hidden-xs hidden-sm"> <%= label %></div></a></div>')(publisher)}},generateQuantitySortingBar:function(total,selectedSort,componentId,device){var sortOptions={ORDER:"Nổi bật",SELLING_PRICE_ASC:"Giá tăng dần",SELLING_PRICE_DESC:"Giá giảm dần",NEWEST:"Hàng mới",BEST_SELLING:"Bán chạy"},selectedSort=void 0==sortOptions[selectedSort]?"ORDER":selectedSort,sortTmp=_.template('<li class="<%= selected %>"><a href="#"  data-value="<%= key %>" data-component-id="'+componentId+'"><%= text %></a><i class="polish-version-icon-check"></i></li>'),sortEl="",htmlEl=_.template('<div class="product-quantity"><span class="hidden-xs">Tìm thấy</span> <%= total %> sản phẩm</div>')({total:total});return _.map(sortOptions,function(text,key){sortEl+=sortTmp({key:key,text:text,selected:key==selectedSort?"selected":""})}),"mobile"==device?htmlEl+=_.template('<div class="sorting-bar-container"><span class="sort-title">Sắp xếp theo:</span><div class="dropdown adr-sorting-dropdown"><button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#sortOptionModal"><%= selectonSort%><span class="caret"></span></button><div class="modal fade sorting-option-content" id="sortOptionModal" role="dialog"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-body"><div class="dialog-icon"><i class="d-button--scroll-actionsheet-icon"></i></div><ul class="js-sorting-action"><%= sortOptions%></ul></div></div></div></div></div></div>')({selectonSort:sortOptions[selectedSort],sortOptions:sortEl}):htmlEl=_.template('<div class="product-quantity"><span class="hidden-xs">Tìm thấy</span> '+total+' sản phẩm</div><div class="sorting-bar-container"><span class="sort-title">Sắp xếp theo:</span><div class="dropdown adr-sorting-dropdown"><button class="btn dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" >'+sortOptions[selectedSort]+'<span class="caret"></span></button><ul class="dropdown-menu js-sorting-action">'+sortEl+"</ul></div></div>"),htmlEl}},ACC.selectize={_autoload:[["initSelectize",$(".js-selectize").length>0]],check:function(el){var stt=!1;return void 0!==el&&$(el).length>0&&void 0!==$(el)[0].selectize&&(stt=!0),stt},init:function(el){if(void 0!==el&&$(el).length>0){if(void 0!==$(el)[0].selectize)return;var placeholder=$(this).attr("placeholder");$(el).selectize({placeholder:placeholder,onInitialize:function(){this.$input.hasClass("disabled")&&this.$control.addClass("is-lock")}})}},block:function(el){if(ACC.selectize.check(el)){$(el)[0].selectize.disable()}},unblock:function(el){if(ACC.selectize.check(el)){$(el)[0].selectize.enable()}},unlock:function(el){if(ACC.selectize.check(el)){$(el)[0].selectize.$control.removeClass("is-lock")}},clear:function(el){if(ACC.selectize.check(el)){$(el)[0].selectize.clearOptions()}},destroy:function(el){if(ACC.selectize.check(el)){$(el)[0].selectize.destroy()}},render:function(el,value,text,triggerDropdown,current){return void 0!==current&&value===current?'<option selected value="'+value+'">'+text+"</option>":'<option value="'+value+'">'+text+"</option>"},renderList:function(el,data,triggerDropdown,current){var length,markup;if(markup="",length=data.length,!(void 0===el||$(el).length<1||null===data||length<1)){ACC.selectize.clear(el);for(var i=0;i<length;i++)markup+=ACC.selectize.render(el,data[i].code,data[i].name,triggerDropdown,current);$(el).html(markup),ACC.selectize.reinit(el,triggerDropdown);$(el).append('<option class="hidden" value="" selected disabled></option>')}},renderListFull:function(el,data,focus){for(var selectize=$(el)[0].selectize,i=0;i<data.length;i++)selectize.addOption({value:data[i].i,text:data[i].n});focus=_.isUndefined(focus)?0:focus,selectize.refreshOptions(focus)},renderStreetsList:function(el,data,triggerDropdown,current){var length,markup;if(markup="",length=data.length,!(void 0===el||null===data||data.length<1)){ACC.selectize.clear(el);for(var i=0;i<length;i++){var d=data[i].split(";");markup+=ACC.selectize.render(el,d[0],d[1],triggerDropdown,current)}$(el).html(markup),ACC.selectize.reinit(el,triggerDropdown);$(el).append('<option class="hidden" value="" selected disabled></option>')}},reinit:function(el,triggerDropdown){if(ACC.selectize.check(el)){var s=$(el)[0].selectize;$(el).find("option").each(function(){s.addOption({value:$(this).val(),text:$(this).text()})}),void 0===triggerDropdown&&(triggerDropdown=0),s.refreshOptions(triggerDropdown)}},get:function(el){if(ACC.selectize.check(el)){return $(el)[0].selectize.getValue()}},set:function(el,val,silent){if(ACC.selectize.check(el)){var s=$(el)[0].selectize;$(el).val(val),void 0!==val&&""!==val&&(void 0!==silent?s.setValue(val,silent):s.setValue(val))}},unset:function(el,silent){if(ACC.selectize.check(el)){var s=$(el)[0].selectize;void 0===silent&&(silent="silent"),s.clear(silent)}},off:function(el,event){if(ACC.selectize.check(el)){var s=$(el)[0].selectize;_.isUndefined(event)||s.off(event)}},focus:function(el){if(ACC.selectize.check(el)){$(el)[0].selectize.focus()}},setTextbox:function(el,text,val,silent){if(ACC.selectize.check(el)){var s=$(el)[0].selectize;$(el).val(val),void 0!==$(el)[0].selectize&&(s.setTextbox(text),s.setValue(val,silent))}},delaySet:function(el,val,silent){setTimeout(function(){ACC.selectize.set(el,val,silent)},ACC.requests.timeout)},initSelectize:function(){ACC.selectize.init(".js-selectize")},initElement:function(el){if(void 0!==el&&el.length>0){if(void 0!==el[0].selectize)return;var placeholder=$(this).attr("placeholder");el.selectize({placeholder:placeholder,onInitialize:function(){this.$input.hasClass("disabled")&&this.$control.addClass("is-lock")}})}}},ACC.address={_autoload:["bindToChangeAddressButton","bindCreateUpdateAddressForm","bindSuggestedDeliveryAddresses","bindCountrySpecificAddressForms","showAddressFormButtonPanel","bindViewAddressBook","bindToColorboxClose","showRemoveAddressFromBookConfirmation","showChangeAddressConfirmation","backToListAddresses","init"],spinner:$("<img src='"+ACC.config.commonResourcePath+"/images/ajax-loader_ADR.gif' />"),addressID:"",init:function(){$(document).on("click","#acc_address_add",function(e){e.preventDefault(),ACC.address.addAddress()}),$(document).on("click","#acc_address_add_form_show",function(e){e.preventDefault(),$("#acc_address_add_form").toggle(),$(".address-editing-form-container").remove()}),$(document).on("click",".btn-remove-address-book",function(e){var addressID;addressID=$(this).attr("data-address-id"),ACC.address.openRemoveAddressModal(addressID)}),$(document).on("click",".btn-remove-address",function(e){var addressID=$(this).attr("data-address-id");ACC.address.deleteAddress(addressID)}),$(document).on("click",".close-profile-update-form",function(e){$(this).parent(this).slideUp()}),$(document).on("click",".btn-update-address-book",function(e){e.preventDefault(),$(".address-editing-form-container").slideDown()}),$(document).on("change",".js-1click-change-status",function(e){var flag="";"none"==$(".js-1click-change-status-off").css("display")?flag=!0:"none"==$(".js-1click-change-status-on").css("display")&&(flag=!1),ACC.address.update1ClickCheckout(flag)}),$(document).on("blur","#vatCompanyTaxCode",function(e){$(this).val($(this).val().trim())}),$(document).on("blur","#vatCompanyName",function(e){$(this).val($(this).val().trim())}),$(document).on("blur","#vatAddress",function(e){$(this).val($(this).val().trim())}),"undefined"!=typeof updatedAddressFlag&&updatedAddressFlag&&$("#modal-cpp-success-update-info").modal("show"),void 0!==$("#isAddressAdded")&&"true"==$("#isAddressAdded").val()&&$("#modal-cpp-success-add-info").modal("show")},handleChangeAddressButtonClick:function(){return ACC.address.addressID=$(this).data("address")?$(this).data("address"):"",$("#summaryDeliveryAddressFormContainer").show(),$("#summaryOverlayViewAddressBook").show(),$("#summaryDeliveryAddressBook").hide(),$.getJSON(getDeliveryAddressesUrl,ACC.address.handleAddressDataLoad),!1},handleAddressDataLoad:function(data){ACC.address.setupDeliveryAddressPopupForm(data),$.colorbox.open({inline:!0,href:"#summaryDeliveryAddressOverlay",overlayClose:!1,onOpen:function(){var $domDefaultAddress=$("#defaultAddress");ACC.address.emptyAddressForm(),$(document).on("change","#saveAddress",function(){var saveAddressChecked=$(this).prop("checked");$domDefaultAddress.prop("disabled",!saveAddressChecked),saveAddressChecked||$domDefaultAddress.prop("checked",!1)})}})},setupDeliveryAddressPopupForm:function(data){var $domSumDeliveryAddressBook=$("#summaryDeliveryAddressBook");$domSumDeliveryAddressBook.html($("#deliveryAddressesTemplate").tmpl({addresses:data})),$domSumDeliveryAddressBook.find("button.use_address").click(ACC.address.handleSelectExistingAddressClick),$domSumDeliveryAddressBook.find("button.edit").click(ACC.address.handleEditAddressClick),$domSumDeliveryAddressBook.find("button.default").click(ACC.address.handleDefaultAddressClick)},emptyAddressForm:function(){var options={url:getDeliveryAddressFormUrl,data:{addressId:ACC.address.addressID,createUpdateStatus:""},type:"GET",success:function(data){$("#summaryDeliveryAddressFormContainer").html(data),ACC.address.bindCreateUpdateAddressForm()}};$.ajax(options)},handleSelectExistingAddressClick:function(){var addressId=$(this).attr("data-address");return $.postJSON(setDeliveryAddressUrl,{addressId:addressId},ACC.address.handleSelectExitingAddressSuccess),!1},handleEditAddressClick:function(){$("#summaryDeliveryAddressFormContainer").show(),$("#summaryOverlayViewAddressBook").show(),$("#summaryDeliveryAddressBook").hide();var addressId=$(this).attr("data-address"),options={url:getDeliveryAddressFormUrl,data:{addressId:addressId,createUpdateStatus:""},target:"#summaryDeliveryAddressFormContainer",type:"GET",success:function(data){ACC.address.bindCreateUpdateAddressForm(),ACC.colorbox.resize()},error:function(xht,textStatus,ex){alert("Failed to update cart. Error details ["+xht+", "+textStatus+", "+ex+"]")}};return $(this).ajaxSubmit(options),!1},handleDefaultAddressClick:function(){var addressId=$(this).attr("data-address"),options={url:setDefaultAddressUrl,data:{addressId:addressId},type:"GET",success:function(data){ACC.address.setupDeliveryAddressPopupForm(data)},error:function(xht,textStatus,ex){alert("Failed to update address book. Error details ["+xht+", "+textStatus+", "+ex+"]")}};return $(this).ajaxSubmit(options),!1},handleSelectExitingAddressSuccess:function(data){null!=data?(ACC.refresh.refreshPage(data),ACC.colorbox.close()):alert("Failed to set delivery address")},bindCreateUpdateAddressForm:function(){$(".create_update_address_form").each(function(){var options={type:"POST",beforeSubmit:function(){$("#checkout_delivery_address").block({message:ACC.address.spinner})},success:function(data){$("#summaryDeliveryAddressFormContainer").html(data);var status=$(".create_update_address_id").attr("status");null!=status&&"success"===status.toLowerCase()?(ACC.refresh.getCheckoutCartDataAndRefreshPage(),ACC.colorbox.close()):(ACC.address.bindCreateUpdateAddressForm(),ACC.colorbox.resize())},error:function(xht,textStatus,ex){alert("Failed to update cart. Error details ["+xht+", "+textStatus+", "+ex+"]")},complete:function(){$("#checkout_delivery_address").unblock()}};$(this).ajaxForm(options)})},refreshDeliveryAddressSection:function(data){$(".summaryDeliveryAddress").replaceWith($("#deliveryAddressSummaryTemplate").tmpl(data))},bindSuggestedDeliveryAddresses:function(){var status=$(".add_edit_delivery_address_id").attr("status");null!=status&&"hasSuggestedAddresses"==status&&ACC.address.showSuggestedAddressesPopup()},showSuggestedAddressesPopup:function(){ACC.colorbox.open("",{href:"#popup_suggested_delivery_addresses",inline:!0,overlayClose:!1,width:525})},bindDistrictByProvince:function(addressId){var tagId="#address-province_"+addressId,targetTag="#address-district_"+addressId;ACC.address.bindDistrictsByProvince($(tagId+" option:selected"),$(targetTag))},bindWardByDistrict:function(addressId){var tagId="#address-district_"+addressId,targetTag="#address-ward_"+addressId;ACC.address.bindDistrictsByProvince($(tagId+" option:selected"),$(targetTag))},bindStreetByWard:function(addressId){var tagId="#address-ward_"+addressId,targetTag="#address-street_"+addressId;ACC.address.bindDistrictsByProvince($(tagId+" option:selected"),$(targetTag))},openRemoveAddressModal:function(addressID,target){void 0===addressID&&(addressID=$(this).attr("data-address-id")),void 0===target&&(target="#modal-cpp-remove-address"),$(target).modal("show"),$(target).on("shown.bs.modal",function(){$(target).find(".btn-remove-address").attr("data-address-id",addressID)})},deleteAddress:function(addressId){var tagItem="#acc_address_item_"+addressId;$.ajax({url:ACC.config.encodedContextPath+"/my-account/delete-address/"+addressId,async:!0,type:"POST",dataType:"JSON"}).done(function(response){$(tagItem).remove(),"success"==response&&$("#modal-cpp-remove-address").modal("hide")})},addAddress:function(){e.preventDefault();var element=this;$.ajax({url:"/Home/SaveDetailedInfo",type:"POST",data:JSON.stringify({Options:someData}),dataType:"json",traditional:!0,contentType:"application/json; charset=utf-8",success:function(response){"success"==response?$(element).closest("form").submit():alert("Error occurs on the Database level!")},error:function(){alert("An error has occured!!!")}})},bindCountrySpecificAddressForms:function(){ACC.address.bindCountrySpecificAddressFormsFor("vinAddressForm"),ACC.address.bindCountrySpecificAddressFormsFor("vinAddressEditingForm"),$(document).on("click",".acc_address_edit_show",function(e){var options=$(this).data("options");$("#acc_address_edit_form_"+options.addressId).length>0||ACC.address.displayAddressEditingForm(options,null)})},bindCountrySpecificAddressFormsFor:function(parent){$(document).on("change","#"+parent+' select[name="provinceIso"]',function(){ACC.address.bindDistrictsByProvince($(this),$("#"+parent+' select[name="districtIso"]'))}),$(document).on("change","#"+parent+' select[name="districtIso"]',function(){ACC.address.bindWardsByDistrict($(this),$("#"+parent+' select[name="wardIso"]'))}),$(document).on("change","#"+parent+' select[name="wardIso"]',function(){ACC.address.bindStreetsByWard($(this),$("#"+parent+' select[name="streetIso"]'))})},bindDistrictsByProvince:function(source,target){ACC.address.queryAddressDataFromServer("my-account/districts-by-province",{p:$(source).val()},target)},bindWardsByDistrict:function(source,target){ACC.address.queryAddressDataFromServer("my-account/wards-by-district",{d:$(source).val()},target)},bindStreetsByWard:function(source,target){ACC.address.queryAddressDataFromServer("my-account/streets-by-ward",{w:$(source).val()},target)},displayAddressEditingForm:function(options,callback){var parent=$("#acc_address_item_"+options.addressId);$.ajax({url:ACC.config.encodedContextPath+"/my-account/address-book/edit/form",async:!0,data:options,dataType:"html",beforeSend:function(){}}).done(function(data){$(".address-editing-form-container").remove(),$("#acc_address_add_form").hide(),$(parent).append(data),"function"==typeof callback&&callback.call()})},queryAddressDataFromServer:function(requestUrl,params,target){$.ajax({url:ACC.config.encodedContextPath+"/"+requestUrl,async:!0,data:params,dataType:"JSON"}).done(function(data){ACC.address.bindAddressDataToControl(data,target)})},bindAddressDataToControl:function(data,target){if(data){$(target).find("option").remove();var items=$.parseJSON(data);$.each(items,function(idx,item){$(target).append("<option value="+item.code+">"+item.name+"</option>")}),$(target).change()}},showAddressFormButtonPanel:function(){""!==$("#countrySelector :input").val()&&$("#addressform_button_panel").show()},bindToColorboxClose:function(){$(document).on("click",".closeColorBox",function(){ACC.colorbox.close()})},displayCountrySpecificAddressForm:function(options,callback){$.ajax({url:ACC.config.encodedContextPath+"/my-account/addressform",async:!0,data:options,dataType:"html",beforeSend:function(){$("#i18nAddressForm").html(ACC.address.spinner)}}).done(function(data){$("#i18nAddressForm").html($(data).html()),"function"==typeof callback&&callback.call()})},bindToChangeAddressButton:function(){$(document).on("click",".summaryDeliveryAddress .editButton",ACC.address.handleChangeAddressButtonClick)},bindViewAddressBook:function(){$(document).on("click",".js-address-book",function(e){e.preventDefault(),ACC.colorbox.open("Saved Addresses",{href:"#addressbook",inline:!0,width:"380px"})}),$(document).on("click","#summaryOverlayViewAddressBook",function(){$("#summaryDeliveryAddressFormContainer").hide(),$("#summaryOverlayViewAddressBook").hide(),$("#summaryDeliveryAddressBook").show(),ACC.colorbox.resize()})},showRemoveAddressFromBookConfirmation:function(){$(document).on("click",".removeAddressFromBookButton",function(){var addressId=$(this).data("addressId"),popupTitle=$(this).data("popupTitle");ACC.colorbox.open(popupTitle,{inline:!0,height:!1,href:"#popup_confirm_address_removal_"+addressId,onComplete:function(){$(this).colorbox.resize()}})})},showChangeAddressConfirmation:function(){$(".oneClickConfirmLink").click(function(e){e.preventDefault(),$("#changeAddressDialog").modal("show")}),$("#agree").click(function(e){e.preventDefault(),window.location="address-book"})},backToListAddresses:function(){$(".addressBackBtn").on("click",function(){var sUrl=$(this).data("backToAddresses");window.location=sUrl})},bindShiipingZone:function(){$(document).on("click",".js-mini-cart-link",function(e){e.preventDefault();var url=$(this).data("miniCartUrl"),cartName=0!=$(this).find(".js-mini-cart-count").html()?$(this).data("miniCartName"):$(this).data("miniCartEmptyName");ACC.colorbox.open(cartName,{href:url,maxWidth:"100%",width:"380px",initialWidth:"380px"})}),$(document).on("click",".js-mini-cart-close-button",function(e){e.preventDefault(),ACC.colorbox.close()})},update1ClickCheckout:function(flag){$.ajax({url:ACC.config.encodedContextPath+"/my-account/1click-checkout/update/"+flag,async:!0,type:"POST",dataType:"JSON"}).done(function(response){})}},ACC.autocomplete={_autoload:["bindSearchAutocomplete","bindTriggerUrlAutocomplete","bindTriggerHistoryKeyword"],keywordHistoryKey:"keyword-histories",getKeywordHistory:function(){var keyworHistories=vinStorage.getItem(ACC.autocomplete.keywordHistoryKey);return null!=keyworHistories?JSON.parse(keyworHistories):null},bindTriggerHistoryKeyword:function(){$(".js-search-form").submit(function(e){var keyword=$("#js-site-search-input").val();if(null!==keyword&&0!==keyword.length&&" "!==keyword&&!_.isEmpty(keyword.trim())){var keyworHistories=ACC.autocomplete.getKeywordHistory();null!=keyworHistories?_.contains(keyworHistories,keyword)||(keyworHistories.push(keyword),vinStorage.setItem(ACC.autocomplete.keywordHistoryKey,JSON.stringify(keyworHistories))):vinStorage.setItem(ACC.autocomplete.keywordHistoryKey,JSON.stringify([keyword]))}}),$(document).on("click","#js-site-search-input",function(e){e.preventDefault();var keyword=$("#js-site-search-input").val();_.isEmpty(keyword)&&ACC.autocomplete.bindDropdownData()}),$(document).on("input","#js-site-search-input",function(e){var keyword=$("#js-site-search-input").val();if(_.isEmpty(keyword))ACC.autocomplete.loadingAutocomplete(),ACC.autocomplete.bindDropdownData(),$(".ui-autocomplete:not(#search-history)").hide();else{var option=JSON.parse($(this).attr("data-options")),minchar="object"!=typeof option||_.isEmpty(option.minCharactersBeforeRequest)?0:option.minCharactersBeforeRequest;minchar>0&&$(this).val().length>minchar&&ACC.autocomplete.loadingAutocomplete(1),$("#search-history").addClass("hide")}}),$("body").click(function(event){var IS_CLICK_OUTSIDE_SEARCH_OUTPUT=!$(event.target).closest(".js-search-form").length,IS_CLICK_OUTSIDE_SEARCH_INPUT=!$(event.target).closest("#search-history").length;IS_CLICK_OUTSIDE_SEARCH_OUTPUT&&IS_CLICK_OUTSIDE_SEARCH_INPUT&&$("#search-history").addClass("hide")})},bindDropdownData:function(){var html="",keyworHistories=ACC.autocomplete.getKeywordHistory();if(null!=keyworHistories){var topData=keyworHistories.reverse().slice(0,4),searchPrefix=ACC.config.encodedContextPath+"/search?text=";html+='<li class="c-brand-product c-search-output__output-item ui-menu-item" id="keyword-history">',html+='<div class="c-brand-product__title"><span>Lịch sử tìm kiếm</span><a class="c-clear-history" href="javascript:;">Xóa tất cả</a></div>',$.each(topData,function(i,obj){html+="<a href="+searchPrefix+encodeURIComponent(obj)+"><div class='c-auto-suggest__item c-brand-product__item'>",html+='<span class="c-brand-product__product">'+obj+"</span>",html+="</div></a>"}),html+="</li>"}var searchPopulator="";$("#keyword-poppular").length>0&&(searchPopulator=$("#keyword-poppular").get(0).outerHTML),_.isEmpty(searchPopulator)&&_.isEmpty(html)||($("#search-history").html(html+searchPopulator).removeClass("hide"),$(".ui-autocomplete:not(#search-history)").hide(),ACC.autocomplete.loadingAutocomplete()),$(".c-clear-history").on("click",function(e){null!=keyworHistories&&(localStorage.removeItem("keyword-histories"),$("#keyword-history").hide())})},bindSearchAutocomplete:function(){$.widget("custom.yautocomplete",$.ui.autocomplete,{_create:function(){var option=this.element.data("options");this._setOptions({minLength:option.minCharactersBeforeRequest,displayProductImages:option.displayProductImages,delay:option.waitTimeBeforeRequest,autocompleteUrl:option.autocompleteUrl,source:this.source}),$.ui.autocomplete.prototype._create.call(this)},options:{cache:{},focus:function(){return!1},select:function(event,ui){return!1}},_renderItem:function(ul,item){var self=this;if("autoSuggestion"==item.type&&!_.isEmpty(item.data)){var ulHtml="";return $.each(item.data,function(i,obj){for(var result=obj.term,reg=new RegExp(self.term,"gi");null!==(chars=reg.exec(obj.term));){var newreg=new RegExp(chars[0],"gi");result=obj.term.replace(newreg,"<strong>"+chars[0]+"</strong>")}ulHtml+="<a href="+item.url+encodeURIComponent(obj.term)+"><div class='c-auto-suggest__item c-brand-product__item'>",ulHtml+='<span class="c-brand-product__product">'+result+"</span>",ulHtml+="</div></a>"}),$("<li class='c-brand-product c-search-output__output-item'>").data("item.autocomplete",item).append(ulHtml).appendTo(ul)}if("brandResult"==item.type&&!_.isEmpty(item.name)){var ulHtml="";return ulHtml+='<a class="c-brand-item" href="'+item.url+'">',_.isEmpty(item.image)||(ulHtml+='<img class="c-head-brand__image" src="'+item.image+'" alt="">'),ulHtml+='<h4 class="c-head-brand__brand"> <strong>'+item.name+"</strong></h4>",ulHtml+='<div class="c-head-brand__icon"><div class="c-icon--small"><i class="polish-version-icon-arrow-right text-primary"></i></div></div>',ulHtml+="</a>",$("<li class='c-head-brand'>").data("item.autocomplete",item).append(ulHtml).appendTo(ul)}if("categoryPathResult"==item.type&&!_.isEmpty(item.data)){var ulHtml="",keyword=item.term,categoryFacetField=item.categoryFacetField;return $.each(item.data,function(i,obj){var cateUrl=ACC.config.encodedContextPath+"/tim-kiem?q="+keyword.replace(/\s/g,"+")+"%3A%3Arelevance%3A"+categoryFacetField+"%3A"+obj.code+"&text="+keyword;ulHtml+='<a href="'+cateUrl+'">',ulHtml+="<div class='c-product-cate__item'>",ulHtml+="<div class='c-product-cate__name'>",$.each(obj.path,function(j,objItem){ulHtml+='<div class="c-product-sub-item">'+objItem.name,j!=obj.path.length-1&&(ulHtml+='<span class="c-product-cate__arrow"> <i class="polish-version-icon-arrow-right text-primary"></i> </span>'),ulHtml+="</div>"}),ulHtml+="</div>",null!=obj.productNumbers&&obj.productNumbers,ulHtml+="</div>",ulHtml+="</a>"}),$("<li class='c-product-amount c-search-output__output-item'>").data("item.autocomplete",item).append(ulHtml).appendTo(ul)}if("productResult"==item.type&&!_.isEmpty(item.data)){var ulHtml="";return $.each(item.data,function(i,obj){var productUrl=ACC.config.encodedContextPath+obj.url+"?"+obj.code;ulHtml+="<a href='"+productUrl+"'><div class='c-short-product-info'>";var classNoImage="no-padding";!_.isEmpty(obj.images)&&obj.images.length>0&&self.options.displayProductImages&&(classNoImage="",ulHtml+='<div class="c-short-product-info__image"> <img src=\''+obj.images[0].url+"' alt=''></div>"),ulHtml+='<div class="c-short-product-info__content '+classNoImage+'">',ulHtml+='<div class="c-short-product-info__title"> <span> '+obj.name+"</span> </div>",ulHtml+='<div class="c-short-product-info__price">',"TABLE_BOOKING"==obj.productType?_.isEmpty(obj.discountTag)||(ulHtml+='<div class="c-short-product-info__new-price"> <span> '+obj.discountTag+"</span> </div>"):(ulHtml+='<div class="c-short-product-info__new-price"> <span> '+obj.price.formattedValue+"</span> </div>",void 0!==obj.offerDiscount&&null!=obj.offerDiscount&&obj.offerDiscount>0&&obj.offerDiscount<=50&&(!_.isEmpty(obj.rrp)&&obj.rrp.value>0?ulHtml+='<div class="c-short-product-info__old-price"> <span>'+obj.rrp.formattedValue+"</span> </div>":!_.isEmpty(obj.offerPrice)&&obj.offerPrice.value>0&&(ulHtml+='<div class="c-short-product-info__old-price"> <span>'+obj.offerPrice.formattedValue+"</span> </div>"),ulHtml+='<div class="c-short-product-info__sale-off">  <div class="c-ticket"> <span> -'+obj.offerDiscount+"% </span>  </div>  </div>")),
ulHtml+="</div>",ulHtml+="</div>",ulHtml+="</div></a>"}),null!=item.productNumber&&item.productNumber>0&&(ulHtml+='<a  href="'+item.url+'" class="c-button--view-all text-center"> <span class="c-button__text-wrap"> <span class="c-button__text-style--gray-500">Xem '+item.productNumber+" sản phẩm</span> </span></a>"),$("<li class='c-search-output__output-item--short-info-product'>").data("item.autocomplete",item).append(ulHtml).appendTo(ul)}},source:function(request,response){var self=this,term=request.term.toLowerCase();if((term=ACC.requests.searchPattern(term))in self.options.cache)return ACC.autocomplete.loadingAutocomplete(),response(self.options.cache[term]);ACC.autocomplete.loadingAutocomplete(1);var autoSearchData=[];Promise.all([ACC.autocomplete.getData(self.options.autocompleteUrl+"?type=keyword",term),ACC.autocomplete.getData(self.options.autocompleteUrl+"?type=product",term)]).then(function(datas){return $.each(datas,function(i,data){autoSearchData=autoSearchData.concat(ACC.autocomplete.readData(data,term))}),ACC.autocomplete.loadingAutocomplete(),self.options.cache[term]=autoSearchData,response(autoSearchData)})}}),$search=$(".js-site-search-input"),$search.length>0&&$search.yautocomplete()},getData:function(url,term){return new Promise(function(resolve,reject){resolve($.getJSON(url,{term:term}))})},readData:function(data,term){var autoSearchData=[],termSearch=term.trim(),searchPrefix=ACC.config.encodedContextPath+"/search",searchTextPrefix=searchPrefix+"?text=",triggerPrefix=searchPrefix+"/relatedkeyword?term=";return _.isEmpty(data.suggestions)||autoSearchData.push({url:searchTextPrefix,triggerurl:triggerPrefix,type:"autoSuggestion",data:data.suggestions}),_.isEmpty(data.brandName)||autoSearchData.push({image:data.brandImage,code:data.brandCode,name:data.brandName,url:data.brandUrl,type:"brandResult"}),_.isEmpty(data.categoryDatas)||autoSearchData.push({term:term,type:"categoryPathResult",data:data.categoryDatas,categoryFacetField:data.categoryFacetField}),_.isEmpty(data.productDatas)||autoSearchData.push({type:"productResult",data:data.productDatas,productNumber:data.productNumber,url:searchTextPrefix+termSearch}),autoSearchData},bindTriggerUrlAutocomplete:function(urlDataUpdate){if(void 0!==urlDataUpdate)return $.ajax({url:urlDataUpdate,method:"get",dataType:"json",success:function(result){console.log("my message"+urlDataUpdate)}})},loadingAutocomplete:function(show){var loading_spinner=$(".searbox__loading");show?($(loading_spinner).length||(loading_spinner=$("<div/>",{class:"searbox__loading"}).append($('<i class="loading__icon polish-version-icon-adayroi"></i>')),$(".navigation--middle .site-search-container").append(loading_spinner)),$(loading_spinner).show(),$("#search-history").addClass("hide"),$(".navigation--middle .ui-autocomplete:not(#search-history)").hide()):$(loading_spinner).hide()}},ACC.carousel={_autoload:[["bindCarousel",$(".js-swiper-carousel").length>0],["bindOwlCarousel",$(".js-pg-bn-owl-carousel").length>0],["bindCarouselForTopSearchComponent",$("#top-search-slide").length>0],["bindMegaMenuOwlCarousel",$(".js-mega-menu-carousel").length>0],"bindTimeFrameClick","bindTimeFrameSCClick",["initFSSC",$(".flashe_shortcut_container").length>0]],bindTimeFrameClick:function(){$(".nav-tabs a").on("show.bs.tab",function(event){var css=($(event.target).text(),$(event.relatedTarget).text(),$(this).attr("class"));null!=css&&-1!=css.indexOf("clicked")&&event.preventDefault()}),$(document).on("click",".timeFrameTab",function(){var css=$(this).attr("class");if(console.log(css),null==css||-1==css.indexOf("clicked")){$(".timeFrameTab").addClass("clicked"),$(".nav-tabs li").addClass("clicked");var mb=$(this).attr("data-mainbanner-id"),fh=$(this).attr("data-flashheader-id"),mc=$(this).attr("data-maincontent-id"),ds=$(this).attr("data-statusForMainComponent"),tfst=$(this).attr("data-timeFrameStartTime"),ld=$(this).attr("data-loading-id");$("#"+ld).show(),ACC.requests.loadCmsComponent(mb,"flashSaleMB","");var url1="/loadcmscomponent/"+fh+"?statusForMainComponent="+ds+"&timeFrameStartTime="+tfst,$container1=$("#flashSaleFH");$.get(url1).done(function(res){$("#flashSaleFH").removeClass("hide"),$container1.html(res),ACC.flashsalecomponent.bindCountDownClock()});var url="/loadcmscomponent/"+mc+"?statusForMainComponent="+ds+"&timeFrameStartTime="+tfst,$container=$("#flashSaleMC");$.get(url).done(function(res){$(".timeFrameTab").removeClass("clicked"),$(".nav-tabs li").removeClass("clicked"),$("#"+ld).hide(),$container.html(res)}),ACC.carousel.bindCarousel()}}),$(document).on("click",".js-rounded-btn",function(){if(-1==$(this).attr("class").indexOf("clicked")){$(".js-rounded-btn").attr("disabled","disabled");var mb=$(this).attr("product-component"),ds=$(this).attr("data-statusForMainComponent"),tfst=$(this).attr("data-timeFrameStartTime"),url="/loadcmscomponent/"+mb+"?statusForMainComponent="+ds+"&timeFrameStartTime="+tfst,$container=$("#flashsalePGC");$.get(url).done(function(res){$(".js-rounded-btn").removeAttr("disabled"),$container.html(res)}),ACC.carousel.bindCarousel()}})},initFSSC:function(){$(".flashe_shortcut_container").each(function(){var activeTab=$(this).find(".nav-tabs-shortcut").find("li").eq(0).find("a");activeTab&&activeTab.parent().addClass("active"),ACC.carousel.bindingLoadCMSComponentFlashsaleSC(activeTab)})},bindTimeFrameSCClick:function(){$(document).on("click",".timeFrameTabSC",function(){ACC.carousel.bindingLoadCMSComponentFlashsaleSC($(this))})},bindingLoadCMSComponentFlashsaleSC:function(element){var fh=(element.attr("data-mainbanner-id"),element.attr("data-flashheader-id")),ds=(element.attr("data-maincontent-id"),element.attr("data-statusForMainComponent")),tfst=element.attr("data-timeFrameStartTime"),ld=element.attr("data-loading-id"),isSC=element.attr("data-mode"),shortcutId=element.attr("data-shorcutId"),component=element.attr("data-component"),maxItem=element.attr("data-maxItem"),urlDetail=element.attr("data-url");$("#"+ld).show();var param="";"isSC"==isSC&&(param="mode="+isSC+"&maxItem="+maxItem);var url1="/loadcmscomponent/"+fh+"?statusForMainComponent="+ds+"&timeFrameStartTime="+tfst+"&"+param,$container1=$("#flashSaleFH_"+shortcutId);$.get(url1).done(function(res){$("#flashSaleFH").removeClass("hide"),$container1.html(res),ACC.flashsalecomponent.bindCountDownClock()});var url="/loadcmscomponent/"+component+"?statusForMainComponent="+ds+"&timeFrameStartTime="+tfst+"&"+param,$container=$("#flashSaleMC_"+shortcutId);$.get(url).done(function(res){$(".timeFrameTab").removeClass("clicked"),$(".nav-tabs-shortcut li").removeClass("clicked"),$("#"+ld).hide(),$container.html(res),$container.find("a").each(function(){$(this).attr("href",urlDetail),$(this).attr("target","_blank")})}),ACC.carousel.bindCarousel()},carouselConfig:{"category-products-carousel":{slidesPerView:10,spaceBetween:8,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",pagination:".swiper-pagination",preventClicks:!1,paginationClickable:!0,onSlideChangeEnd:function(e){$(e.wrapper.context).find(".swiper-pagination").html(e.bullets)},onInit:function(e){var $parent=$(e.wrapper.context).parent();e.snapGrid.length<2?($parent.addClass("no-loop"),$parent.find(".swiper-button-prev").hide(),$parent.find(".swiper-button-next").hide()):($parent.removeClass("no-loop"),$parent.find(".swiper-button-prev").show(),$parent.find(".swiper-button-next").show())},breakpoints:{1024:{slidesPerView:6},640:{slidesPerView:4},480:{slidesPerView:2.2,pagination:".swiper-pagination",paginationClickable:!0}}},"home-stores":{slidesPerView:2,spaceBetween:0,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",breakpoints:{1234:{slidesPerView:2},1023:{slidesPerView:2.5,pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:16},768:{slidesPerView:2.5,pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:16},640:{slidesPerView:1.2,pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:8},480:{spaceBetween:8,slidesPerView:1.2,pagination:".swiper-pagination",paginationClickable:!0}}},"good-products-carousel":{slidesPerView:6,spaceBetween:8,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",breakpoints:{1234:{slidesPerView:6},768:{slidesPerView:4,pagination:".swiper-pagination",paginationClickable:!0},640:{slidesPerView:4,pagination:".swiper-pagination",paginationClickable:!0},480:{slidesPerView:2.2,pagination:".swiper-pagination",paginationClickable:!0}},onSliderMove:function(){$(window).trigger("scroll")}},"gift-code":{slidesPerView:6,spaceBetween:8,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",pagination:".swiper-pagination",paginationClickable:!0,breakpoints:{1234:{slidesPerView:6},768:{slidesPerView:4},640:{slidesPerView:4},480:{slidesPerView:2.2}},onSliderMove:function(){$(window).trigger("scroll")}},"collection-banner":{slidesPerView:3,preventClicks:!1,loop:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",pagination:".swiper-pagination",paginationClickable:!0,autoplay:5e3,breakpoints:{1234:{slidesPerView:3},768:{slidesPerView:3},640:{slidesPerView:3},480:{slidesPerView:2.2}},onSliderMove:function(){$(window).trigger("scroll")}},"product-suggestion":{slidesPerView:2.5,spaceBetween:12,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",breakpoints:{1024:{slidesPerView:3.2},640:{slidesPerView:3.5},480:{slidesPerView:3.5}}},"product-detail__merchant":{slidesPerView:6,spaceBetween:8,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",pagination:".swiper-pagination",paginationClickable:!0,onSlideChangeEnd:function(e){$(e.wrapper.context).find(".swiper-pagination").html(e.bullets)},breakpoints:{1024:{slidesPerView:4},640:{slidesPerView:3.5},480:{slidesPerView:2.5}}},"product-detail__related":{slidesPerView:4,spaceBetween:8,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",breakpoints:{1024:{slidesPerView:4},640:{slidesPerView:3.5},480:{slidesPerView:2.5,pagination:".swiper-pagination",paginationClickable:!0}},onInit:function(e){var $parent=$(e.wrapper.context).parent();e.snapGrid.length<5&&($parent.find(".swiper-button-prev").hide(),$parent.find(".swiper-button-next").hide())}},"product-detail__related-deal":{slidesPerView:4,spaceBetween:15,preventClicks:!1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",breakpoints:{1400:{slidesPerView:4},1024:{slidesPerView:3.5},640:{slidesPerView:2.25},480:{slidesPerView:1.25}},loop:!0,onInit:function(e){var $parent=$(e.wrapper.context).parent();if(e.snapGrid.length<10){$parent.find(".swiper-button-prev").hide(),$parent.find(".swiper-button-next").hide();$(".js-swiper-product-detail__related-deal")[0].swiper.destroy(!1,!0)}}},"lp-banner-slider":{slidesPerView:1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",loop:!0,pagination:".swiper-pagination",autoplay:5e3,preventClicks:!1,onInit:function(e){$(".product-list__container img.lazy").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"})}},"lp-banner-slider-map":{slidesPerView:1,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",loop:!0,pagination:".swiper-pagination",autoplay:!1,preventClicks:!1},"lp-product-slider":{slidesPerView:6,slidesPerGroup:6,spaceBetween:8,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",pagination:!1,preventClicks:!1,breakpoints:{1234:{slidesPerView:5,slidesPerGroup:5},1024:{slidesPerView:4.5,slidesPerGroup:4,pagination:".swiper-pagination",paginationClickable:!0},768:{slidesPerView:4,slidesPerGroup:4,pagination:".swiper-pagination",paginationClickable:!0},640:{slidesPerView:3.5,slidesPerGroup:3,pagination:".swiper-pagination",paginationClickable:!0},480:{slidesPerView:2.2,slidesPerGroup:2,pagination:".swiper-pagination",paginationClickable:!0}}},"flash-sale-shortcut":{slidesPerView:5,slidesPerGroup:5,spaceBetween:0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev",pagination:!1,onInit:function(s){s.container.find("img.stopper-bottom-lazy:not(.lazy-initialized)").each(function(){if(void 0!=ACC.config.bottomstopperccp){var imgUrl=$(this).attr("data-original");void 0!=imgUrl&&(imgUrl=imgUrl.replace("/sys_master/",ACC.config.bottomstopperccp),$(this).attr("data-original",imgUrl))}}),s.container.find("img.stopper-top-lazy:not(.lazy-initialized)").each(function(){if(void 0!=ACC.config.topstopperccp){var imgUrl=$(this).attr("data-original");void 0!=imgUrl&&(imgUrl=imgUrl.replace("/sys_master/",ACC.config.topstopperccp),$(this).attr("data-original",imgUrl))}});for(var i=0;i<s.originalParams.slidesPerView;i++){$(s.slides[i]).find("img.stopper-top-lazy:not(.lazy-initialized),img.stopper-bottom-lazy:not(.lazy-initialized)").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}).addClass("lazy-initialized")}},onSlideChangeEnd:function(s){for(var i=s.activeIndex;i<s.activeIndex+s.originalParams.slidesPerView;i++)$(s.slides[i]).find("img.stopper-top-lazy:not(.lazy-initialized),img.stopper-bottom-lazy:not(.lazy-initialized)").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}).addClass("lazy-initialized")},breakpoints:{1234:{slidesPerView:5,slidesPerGroup:5},1024:{slidesPerView:4,slidesPerGroup:4,pagination:".swiper-pagination",paginationClickable:!0},768:{slidesPerView:4,slidesPerGroup:4,pagination:".swiper-pagination",paginationClickable:!0},640:{slidesPerView:3.5,slidesPerGroup:3,pagination:".swiper-pagination",paginationClickable:!0},480:{slidesPerView:2.2,slidesPerGroup:2,spaceBetween:8,pagination:".swiper-pagination",paginationClickable:!0}}}},bindCarousel:function(){$(".js-owl-carousel").each(function(){var $c=$(this);$.each(ACC.carousel.carouselConfig,function(key,config){if($c.hasClass("js-owl-"+key)){$(".js-owl-"+key).owlCarousel(config)}})}),$.each(ACC.carousel.carouselConfig,function(key,config){config.preloadImages=!1,config.lazyLoading=!0,$(".js-swiper-"+key).each(function(){var $this=$(this);if($this.hasClass("js-swiper-carousel")&&!$this.hasClass("initialized")){$this.swiper(config),$this.addClass("initialized");var $parent=$this.parents(".adr-swiper-wrapper");$parent.length>0&&$this.find(".swiper-button-next, .swiper-button-prev").appendTo($parent)}})});var $swiperCarousel=$(".js-swiper-carousel");if(void 0!==$swiperCarousel&&_.isElement($swiperCarousel[0])&&void 0!==$swiperCarousel[0].swiper){$swiperCarousel[0].swiper.on("slideChangeEnd",function(){$("img.lazy:not(.lazy-initialized)").lazyload().addClass("lazy-initialized")})}$(".product__list-slider-setion").each(function(e){$(".product-group-carousel .swiper-slide").length>6&&$(".product-group-carousel .swiper-button-next").removeClass("swiper-button-disabled")})},bindOwlCarousel:function(){$(".js-pg-bn-owl-carousel").each(function(){var total=$(this).find(".js-p-g-total-item").val(),navText=parseInt(total)<=4?[]:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"> <div class="d-icon f-row a-j-center"> <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i> </div></div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"> <div class="d-icon f-row a-j-center"> <i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i> </div></div>'],loop=!(parseInt(total)<=4);$(this).find(".owl-carousel").owlCarousel({loop:loop,responsiveClass:!0,navText:navText,navClass:["am-prev","am-next"],dotsEach:!0,dots:!1,lazyLoad:!0,margin:16,responsive:{480:{items:3,slideBy:3,nav:!0},767:{items:3,slideBy:3,nav:!0},1240:{items:4,slideBy:4,nav:!0}}})})},bindCarouselForTopSearchComponent:function(){$("#top-search-slide").owlCarousel({loop:!0,margin:0,responsiveClass:!0,lazyLoad:!0,navText:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"> <div class="d-icon f-row a-j-center"> <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i> </div></div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"> <div class="d-icon f-row a-j-center"> <i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i> </div></div>'],navClass:["am-prev","am-next"],dots:!0,responsive:{10:{items:2,slideBy:2,nav:!0},767:{items:3,slideBy:3,nav:!0},1240:{items:4,slideBy:4,nav:!0}}})},bindMegaMenuOwlCarousel:function(){var mgCarousel=$(".js-mega-menu-carousel"),timeOut=mgCarousel.data("autoplay"),total=mgCarousel.data("total"),navText=1==total?[]:['<div class="d-slide__button d-slide__button--back d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"> <div class="d-icon f-row a-j-center"> <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i> </div></div>','<div class="d-slide__button d-slide__button--next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"> <div class="d-icon f-row a-j-center"> <i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i> </div></div>'],showDot=1!=total;mgCarousel.owlCarousel({loop:!0,responsiveClass:!0,navText:navText,navClass:["am-prev","am-next"],dotsEach:!0,dots:showDot,items:1,slideBy:1,autoplay:!0,autoplayTimeout:timeOut,autoplayHoverPause:!0,animateOut:"fadeOut",onChanged:function(property){var current=property.item.index,bgcolor=$(property.target).find(".owl-item").eq(current).find("div").eq(0).data("bgcolor");$(".bg-color-affect").css("background-color",bgcolor)}})}},ACC.cart={_config:{element:{removeItemBtn:".js-remove-entry-button",quantityInput:".js-update-entry-quantity-input"}},_autoload:["initElements","bindCartPage","bindMultiDEntryRemoval","bindMultidCartProduct",["bindApplyVoucher",0!=$("#js-voucher-apply-btn").length],["bindToReleaseVoucher",0!=$("#js-applied-vouchers").length],"bindRemoveItem","bindQuantityChange","bindQuantityFocus","bindQuantityPaste","bindQtySelector","initCart","bindCheckout","bindQuantityBoxChange","showErrorMessageToCartItem"],prevEntryQuantity:0,initCart:function(){$(document).on("click",".js-cart-total-toggle",function(event){var $detail,$this=$(this);event.preventDefault(),$detail=$this.parents(".cart-total__promotion").find(".cart-total__promotion-detail"),$detail.is(":visible")?($detail.stop().slideUp(300,function(){ACC.colorbox.resize()}),$this.find(".adr-icon").attr("class","adr-icon icon-expand")):($detail.stop().slideDown(300,function(){ACC.colorbox.resize()}),$this.find(".adr-icon").attr("class","adr-icon icon-collapse"))}),$(document).on("click","#stopEmulate, .asm-modify-order-footer .js-button-cancel-modification, .asm-modify-order-footer .js-preview-order-popup, .asm-modify-order-footer .confirm-btn, .profile-content profile-order-detail .js-order-modification, .ASM-btn-start-session, .js-payment-checkout  ",function(event){vinStorage.removeItem("miniCart"),vinStorage.removeItem("miniCartTotal")})},initElements:function(){ACC.common.loadModuleElements(ACC.cart),ACC.minicart.isMiniCart=!1,$(document).on("submit",".js-shopping-cart .js-qty-form,.js-mini-cart .js-qty-form",function(event){event.preventDefault();var form=$(this),select=form.find(".cart-qty-select"),entryClass="."+select.data("entryId");form.find(entryClass+" .cart-qty-input").blur()}),$(document).on("click",".js-cart-reload",function(e){e.preventDefault(),window.location.reload(!0)})},bindQuantityFocus:function(){$(document).on("focus",".js-shopping-cart .cart-qty-input,.js-mini-cart .cart-qty-input",function(event){ACC.cart.prevEntryQuantity=$(this).val()}),$(document).on("keypress",".qty-cart-product-box .input-qty",function(e){var code=e.keyCode?e.keyCode:e.which;(code<48||code>57)&&8!=code&&46!=code&&e.preventDefault()})},bindQuantityPaste:function(){$(document).on("paste",".js-shopping-cart .cart-qty-input,.js-mini-cart .cart-qty-input",function(event){event.preventDefault()}),$(document).on("paste",".qty-cart-product-box .input-qty",function(event){event.preventDefault()})},bindQuantityChange:function(){$(document).on("change",".js-shopping-cart .cart-qty-input,.js-mini-cart .cart-qty-input",function(event){event.preventDefault();var self=$(this),form=self.closest("form"),select=(form.find("input[name=productCode]").val(),form.find(".cart-qty-select")),entryClass="."+select.data("entryId");$(entryClass+" .cart-qty-input").val(self.val());var entryNumber=form.find("input[name=entryNumber]").val(),quantity=self.val(),isASM=form.find("input[name=isASM]").val(),maxDisplayItems=self.data("maxDisplayItems"),ats=self.data("ats"),currentEntryItemsClass=".entry-item-"+entryNumber,currentWarningMessageElm=$(currentEntryItemsClass).find(".js-item-invalid");void 0!==currentWarningMessageElm&&currentWarningMessageElm.remove();var currentValue=$(this).attr("data-original-value");if(self.parents().hasClass("js-shopping-cart")&&parseInt(currentValue)>parseInt(quantity))self.val(currentValue),quantity=currentValue;else{var isMiniCart=1===$(this).closest(".js-mini-cart").length;isMiniCart?$(".js-mini-cart").block():$.blockUI(),ACC.cart._showSessionTimeoutMessage(!1),ACC.cartitem.updateQuantities(entryNumber,quantity,isASM).then(function(response){if(0==ACC.cart.isJSONString(response)){isMiniCart?$(".js-mini-cart").unblock():$.unblockUI();var inputs=$(entryClass+" .cart-qty-input"),selects=$(entryClass+" .cart-qty-select");quantity<maxDisplayItems?(inputs.val(quantity),selects.val(quantity),$(entryClass+" .cart-qty-input-section").hide(),$(entryClass+" .cart-qty-select-section").show()):quantity<ats?(inputs.val(quantity),selects.val(quantity)):(inputs.val(ats),selects.val(ats)),ACC.cart.updateCartInfo(response),ACC.selectize.initSelectize(),ACC.cart._showSessionTimeoutMessage(!1)}else{isMiniCart?$(".js-mini-cart").unblock():$.unblockUI();var errorObj=JSON.parse(response);ACC.cart.addErrorMessageToCartItem($(currentEntryItemsClass),errorObj.message);var checkoutBtn=$(".js-cart-checkout-button");ACC.cart.disableButton(checkoutBtn);var expressBtn=$(".js-cart-express-buy-button");ACC.cart.disableButton(expressBtn)}},function(error){if(403===error.status)return void ACC.cart._showSessionTimeoutMessage(!0)})}})},bindQuantityBoxChange:function(){function handleChangeQty(target){0==$(target).val().length&&$(target).val(1);var self=$(target),form=self.closest("form"),box=(form.find("input[name=productCode]").val(),form.find(".qty-cart-product-box")),entryClass=(form.find(".js-cart-product-qty-input"),"."+box.data("entryId")),entryNumber=form.find("input[name=entryNumber]").val(),quantity=box.find("input[name=quantity-value]").val(),isASM=form.find("input[name=isASM]").val();self.data("maxDisplayItems"),self.data("ats");self.hasClass("qty-cat-product-increase")&&quantity++,self.hasClass("qty-cat-product-decrease")&&quantity--;var currentEntryItemsClass=".entry-item-"+entryNumber,currentWarningMessageElm=$(currentEntryItemsClass).find(".js-item-invalid");void 0!==currentWarningMessageElm&&currentWarningMessageElm.remove();var isMiniCart=($(this).attr("data-original-value"),1===$(this).closest(".js-mini-cart").length);isMiniCart?$(".js-mini-cart").block():$.blockUI(),ACC.cart._showSessionTimeoutMessage(!1),ACC.cartitem.updateQuantities(entryNumber,quantity,isASM).then(function(response){if(0==ACC.cart.isJSONString(response)){isMiniCart?$(".js-mini-cart").unblock():$.unblockUI();$(entryClass+" .js-cart-product-decrease"),$(entryClass+" .js-cart-product-increase");ACC.cart.updateCartInfo(response),ACC.selectize.initSelectize(),ACC.cart._showSessionTimeoutMessage(!1)}else{isMiniCart?$(".js-mini-cart").unblock():$.unblockUI();var errorObj=JSON.parse(response);ACC.cart.showErrorMessageToCartItem($(currentEntryItemsClass),errorObj);var checkoutBtn=$(".js-cart-checkout-button");ACC.cart.disableButton(checkoutBtn);var expressBtn=$(".js-cart-express-buy-button");ACC.cart.disableButton(expressBtn)}},function(error){if(403===error.status)return void ACC.cart._showSessionTimeoutMessage(!0)})}$(document).on("click",".js-shopping-cart .js-cart-product-decrease",function(event){event.preventDefault(),$(this).hasClass("disabled")||handleChangeQty(this)}),$(document).on("click",".js-shopping-cart .js-cart-product-increase",function(event){event.preventDefault(),$(this).hasClass("disabled")||handleChangeQty(this)}),$(document).on("change",".js-shopping-cart .js-cart-product-qty-input",function(event){event.preventDefault(),$(this).hasClass("disabled")||handleChangeQty(this)})},bindQtySelector:function(){function handleChangeQty(target,parent){var entryClass="."+$(target).data("entryId"),input=$(parent+" "+entryClass+" .cart-qty-input"),qty=$(target).val();"overDisplayValue"===qty?($(entryClass+" .cart-qty-input-section").show(),$(entryClass+" .cart-qty-select-section").hide(),$(entryClass+" .cart-qty-input").val(10),$(entryClass+" .cart-qty-input").focus()):($(entryClass+" .cart-qty-select").val(qty),input.val(qty),input.change())}$(document).on("change",".js-shopping-cart .cart-qty-select",function(){handleChangeQty(this,".js-shopping-cart")}),$(document).on("click",".js-shopping-cart .cart-qty-select",function(){var value=$(this).parent().parent().find(".cart-qty-input").attr("data-original-value");$(this).find("option").attr("disabled",!1);for(var i=1;i<value;i++)$(this).find("option[value="+i+"]").attr("disabled",!0)}),$(document).on("change",".js-mini-cart .cart-qty-select",function(){handleChangeQty(this,".js-mini-cart")})},bindRemoveItem:function(){$(document).on("click",".js-shopping-cart .js-remove-entry-button",function(event){event.preventDefault();var entry=$(this).attr("id").split("_"),form=$("#updateCartForm"+entry[1]),code=form.find("input[name=productCode]").val(),entryNumber=form.find("input[name=entryNumber]").val();form.find("input[name=quantity]").val(),$(this);ACC.cart.gtmRemoveFromCart(form,"Cartpage"),$.blockUI(),ACC.cart._showSessionTimeoutMessage(!1),ACC.cartitem.deleteQuantities(entryNumber).then(function(response){$.unblockUI(),ACC.cart.updateCartInfo(response),ACC.track.trackEmaticRemoveFromCart(code),ACC.selectize.initSelectize(),ACC.cart._showSessionTimeoutMessage(!1)},function(error){if($.unblockUI(),403===error.status)return void ACC.cart._showSessionTimeoutMessage(!0)}),ACC.minicart.updateMiniCartDisplay()}),$(document).on("click",".js-mini-cart .js-remove-entry-button",function(event){event.preventDefault();var entry=$(this).attr("id").split("_"),form=$("#updateCartForm"+entry[1]),code=form.find("input[name=productCode]").val(),entryNumber=form.find("input[name=entryNumber]").val();form.find("input[name=quantity]").val(),$(this);ACC.cart.gtmRemoveFromCart(form,"Minicart"),ACC.cart._showSessionTimeoutMessage(!1);var listPrd=$(".js-mini-cart .mini-shopping-cart__list-product");listPrd&&listPrd.find("li").length>1?$(".entry-item-"+entryNumber).fadeTo(300,.01,function(){$(this).slideUp(150,function(){$(this).remove()})}):$(".mini-shopping-cart__content").fadeTo(300,.01,function(){$(this).remove()}),ACC.cartitem.deleteQuantities(entryNumber).then(function(response){ACC.cart.updateCartInfo(response),$(".js-mini-shopping-cart").animate({opacity:0},150,function(){$(".js-mini-shopping-cart").empty(),ACC.minicart.binDisplayMiniCart(),$(this).animate({opacity:1},150,function(){$(this).removeAttr("style")})}),ACC.track.trackEmaticRemoveFromCart(code),ACC.cart._showSessionTimeoutMessage(!1)},function(error){if($.unblockUI(),403===error.status)return void ACC.cart._showSessionTimeoutMessage(!0)})})},_showSessionTimeoutMessage:function(isShow){if(isShow){var html='<div class="alert alert-danger"><i class="adr-icon icon-danger"></i>'+SESSION_TIMEOUT_WARNING_MESSAGE+"</div>";$(".js-cart-session-timeout").html(html)}else $(".js-cart-session-timeout").html("")},checkEntryQtyOver:function(){},updateCartInfo:function(cartUpdateHtml){var cartUpdate=$($(cartUpdateHtml)[0]),miniCartContent="";if("true"===cartUpdate.find("#isCartEmpty").html()){var divRCM=$(".h-rcm-cart").clone();$(".js-cart--container .cart").html(cartUpdate.find("#cartEmpty").html()),$(".js-cart--container .cart").after('<div class="container">'+$(divRCM).html()+"</div>"),miniCartContent=cartUpdate.find("#miniCartEmpty").html();var idArr=$(".rcm-block").find(".d-slide").children().map(function(){return this.id});idArr&&idArr.length&&idArr.map(function(index,id){ACC.cart.reinitRCMSlideWhenEmtpyCart(id)})}else $(".js-cart-total-unit").text(cartUpdate.find("#totalUnits").text()),$(".js-cart-items--container").html(cartUpdate.find("#cartItems").html()),$(".js-cart-total--container").html(cartUpdate.find("#cartTotals").html()),miniCartContent=cartUpdate.find("#miniCartDisplay").html();vinStorage.setItem("miniCart",miniCartContent),vinStorage.setItem("miniCartTotal",cartUpdate.find("#totalUnits").text()),vinStorage.setItem("code",cartUpdate.find("#code").text()),ACC.minicart.updateMiniCartDisplay(),$(".mini-cart .cart-coupon").remove()},reinitRCMSlideWhenEmtpyCart:function(element){var $owl=$("#"+element);$owl.trigger("destroy.owl.carousel");var buttonnext=$("#"+element).parent().find(".am-next"),buttonprev=$("#"+element).parent().find(".am-prev");$owl.owlCarousel({loop:!0,margin:16,responsiveClass:!0,navText:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick">\n                        <div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i>\n                        </div>\n                      </div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick">\n                        <div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i>\n                        </div>\n                      </div>'],navClass:[buttonnext,buttonprev],dots:!0,center:!1,scrollPerPage:!0,responsive:{480:{items:3,nav:!0},767:{items:4,nav:!0},1240:{items:5,nav:!0,slideBy:5}}}),$owl.on("change.owl.carousel",function(event){setTimeout(function(){$("#"+element).find("img.rcm-lazy").lazyload()},2e3)}),certonaHelper.initLazyLoadForImg("#"+element+" .rcm-lazy"),"mobile"==ACC.devices.name&&2==$("#"+element).find(".owl-dots").length&&$("#"+element).find(".owl-dots").eq(0).addClass("hide")},bindCartPage:function(){$(document).on("click",".js-show-editable-grid",function(event){ACC.cart.populateAndShowEditableGrid(this,event)})},bindMultiDEntryRemoval:function(){$(document).on("click",".js-submit-remove-product-multi-d",function(){var itemIndex=$(this).data("index"),$form=$("#updateCartForm"+itemIndex),initialCartQuantity=$form.find("input[name=initialQuantity]"),cartQuantity=$form.find("input[name=quantity]"),productCode=($form.find("input[name=entryNumber]").val(),$form.find("input[name=productCode]").val());cartQuantity.val(0),initialCartQuantity.val(0),ACC.track.trackRemoveFromCart(productCode,initialCartQuantity,cartQuantity.val());var method=$form.attr("method")?$form.attr("method").toUpperCase():"GET";$.ajax({url:$form.attr("action"),data:$form.serialize(),type:method,success:function(data){location.reload()},error:function(){alert("Failed to remove quantity. Error details ["+xht+", "+textStatus+", "+ex+"]")}})})},populateAndShowEditableGrid:function(element,event){var readOnly=$(element).data("readOnlyMultidGrid"),itemIndex=$(element).data("index");grid=$("#ajaxGrid"+itemIndex);var gridEntries=$("#grid"+itemIndex),strSubEntries=gridEntries.data("sub-entries"),arrSubEntries=strSubEntries.split(","),firstVariantCode=arrSubEntries[0].split(":")[0];$(element).toggleClass("open");for(var targetUrl=gridEntries.data("target-url"),mapCodeQuantity=new Object,i=0;i<arrSubEntries.length;i++){var arrValue=arrSubEntries[i].split(":");mapCodeQuantity[arrValue[0]]=arrValue[1]}if(grid.children("#cartOrderGridForm").length>0)grid.slideToggle("slow");else{$.ajax({url:targetUrl,data:{
productCode:firstVariantCode,readOnly:readOnly},type:"GET",success:function(data){grid.html(data),$("#ajaxGrid").removeAttr("id");for(var $gridContainer=grid.find(".product-grid-container"),numGrids=$gridContainer.length,i=0;i<numGrids;i++)ACC.cart.getProductQuantity($gridContainer.eq(i),mapCodeQuantity,i);grid.slideDown("slow"),ACC.cart.coreCartGridTableActions(element,mapCodeQuantity),ACC.productorderform.coreTableScrollActions(grid.children("#cartOrderGridForm"))},error:function(xht,textStatus,ex){alert("Failed to get variant matrix. Error details ["+xht+", "+textStatus+", "+ex+"]")}})}},coreCartGridTableActions:function(element,mapCodeQuantity){ACC.productorderform.bindUpdateFutureStockButton(".update_future_stock_button"),ACC.productorderform.bindVariantSelect($(".variant-select-btn"),"cartOrderGridForm");var itemIndex=$(element).data("index"),quantityBefore=0,grid=$("#ajaxGrid"+itemIndex+" .product-grid-container");grid.on("focusin",".sku-quantity",function(event){quantityBefore=jQuery.trim(this.value),$(this).parents("tr").next(".variant-summary").remove(),$(this).parents("table").data(ACC.productorderform.selectedVariantData)?ACC.productorderform.selectedVariants=$(this).parents("table").data(ACC.productorderform.selectedVariantData):ACC.productorderform.selectedVariants=[],""==quantityBefore&&(quantityBefore=0,this.value=0)}),grid.on("focusout",".sku-quantity",function(event){var quantityAfter=0,gridLevelTotalPrice="",currentIndex=parseInt($(this).attr("id").match("[0-9]+"));this.value=ACC.productorderform.filterSkuEntry(this.value),quantityAfter=jQuery.trim(this.value);var variantCode=$("input[id='cartEntries["+currentIndex+"].sku']").val();isNaN(jQuery.trim(this.value))&&(this.value=0),""==quantityAfter&&(quantityAfter=0,this.value=0);var $gridTotalValue=grid.find("[data-grid-total-id=total_value_"+currentIndex+"]"),currentPrice=$("input[id='productPrice["+currentIndex+"]']").val();quantityAfter>0&&(gridLevelTotalPrice=ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice)*parseInt(quantityAfter))),$gridTotalValue.html(gridLevelTotalPrice);var _this=this,priceSibling=$(this).siblings(".price"),propSibling=$(this).siblings(".variant-prop"),currentSkuId=$(this).next(".td_stock").data("sku-id"),currentBaseTotal=$(this).siblings(".data-grid-total");if(this.value!=quantityBefore){var newVariant=!0;ACC.productorderform.selectedVariants.forEach(function(item,index){item.id===currentSkuId&&(newVariant=!1,"0"===_this.value||0===_this.value?ACC.productorderform.selectedVariants.splice(index,1):(ACC.productorderform.selectedVariants[index].quantity=_this.value,ACC.productorderform.selectedVariants[index].total=ACC.productorderform.updateVariantTotal(priceSibling,_this.value,currentBaseTotal)))}),newVariant&&this.value>0&&ACC.productorderform.selectedVariants.push({id:currentSkuId,size:propSibling.data("variant-prop"),quantity:_this.value,total:ACC.productorderform.updateVariantTotal(priceSibling,_this.value,currentBaseTotal)})}if(ACC.productorderform.showSelectedVariant($(this).parents("table")),this.value>0&&this.value!=quantityBefore?$(this).parents("table").addClass("selected"):0===ACC.productorderform.selectedVariants.length&&$(this).parents("table").removeClass("selected").find(".variant-summary").remove(),quantityBefore!=quantityAfter){$.ajax({url:ACC.config.encodedContextPath+"/cart/updateMultiD",data:{productCode:variantCode,quantity:quantityAfter,entryNumber:-1},type:"POST",success:function(data,textStatus,xhr){ACC.cart.refreshCartData(data,-1,quantityAfter,itemIndex),mapCodeQuantity[variantCode]=quantityAfter},error:function(xhr,textStatus,error){var redirectUrl=xhr.getResponseHeader("redirectUrl"),connection=xhr.getResponseHeader("Connection");null!==redirectUrl?window.location=redirectUrl:"close"===connection&&window.location.reload()}})}})},refreshCartData:function(cartData,entryNum,quantity,itemIndex){if(0==cartData.entries.length)location.reload();else{var form;if(-1==entryNum){form=$(".js-qty-form"+itemIndex);for(var productCode=form.find("input[name=productCode]").val(),quantity=0,entryPrice=0,i=0;i<cartData.entries.length;i++){var entry=cartData.entries[i];if(entry.product.code==productCode){quantity=entry.quantity,entryPrice=entry.totalPrice;break}}0==quantity?location.reload():(form.find(".qtyValue").html(quantity),form.parent().parent().find(".js-item-total").html(entryPrice.formattedValue))}ACC.cart.refreshCartPageWithJSONResponse(cartData)}},refreshCartPageWithJSONResponse:function(cartData){ACC.minicart.updateMiniCartDisplay(),$(".js-cart-top-totals").html($("#cartTopTotalSectionTemplate").tmpl(cartData)),$("div .cartpotproline").remove(),$("div .cartproline").remove(),$(".js-cart-totals").remove(),$("#ajaxCartPotentialPromotionSection").html($("#cartPotentialPromotionSectionTemplate").tmpl(cartData)),$("#ajaxCartPromotionSection").html($("#cartPromotionSectionTemplate").tmpl(cartData)),$("#ajaxCart").html($("#cartTotalsTemplate").tmpl(cartData))},getProductQuantity:function(gridContainer,mapData,i){var tables=gridContainer.find("table");$.each(tables,function(index,currentTable){var skus=jQuery.map($(currentTable).find("input[type='hidden'].sku"),function(o){return o.value}),quantities=jQuery.map($(currentTable).find("input[type='textbox'].sku-quantity"),function(o){return o}),selectedVariants=[];$.each(skus,function(index,skuId){var quantity=mapData[skuId];if(void 0!=quantity){quantities[index].value=quantity;var currentIndex=parseInt(quantities[index].id.match("[0-9]+")),gridTotalValue=gridContainer.find("[data-grid-total-id=total_value_"+currentIndex+"]"),gridLevelTotalPrice="",currentPrice=$("input[id='productPrice["+currentIndex+"]']").val();quantity>0&&(gridLevelTotalPrice=ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice)*parseInt(quantity))),gridTotalValue.html(gridLevelTotalPrice),selectedVariants.push({id:skuId,size:$(quantities[index]).siblings(".variant-prop").data("variant-prop"),quantity:quantity,total:gridLevelTotalPrice})}}),0!=selectedVariants.length&&($.tmpl(ACC.productorderform.$variantSummaryTemplate,{variants:selectedVariants}).appendTo($(currentTable).addClass("selected")),$(currentTable).find(".variant-summary .variant-property").html($(currentTable).find(".variant-detail").data("variant-property")),$(currentTable).data(ACC.productorderform.selectedVariantData,selectedVariants))})},bindMultidCartProduct:function(){$(document).on("click",".showQuantityProduct",function(event){ACC.multidgrid.populateAndShowGrid(this,event,!0)}),$(document).on("click",".showQuantityProductOverlay",function(event){ACC.multidgrid.populateAndShowGridOverlay(this,event)})},bindApplyVoucher:function(){$(document).on("click","#js-voucher-apply-btn",function(e){ACC.cart.handleApplyVoucher(e)}),$(document).on("keypress","#js-voucher-code-text",function(e){13==(e.keyCode?e.keyCode:e.which)&&ACC.cart.handleApplyVoucher(e)})},handleApplyVoucher:function(e){var voucherCode=$.trim($("#js-voucher-code-text").val());""!=voucherCode&&voucherCode.length>0&&$("#applyVoucherForm").submit()},bindToReleaseVoucher:function(){$(document).on("click",".js-release-voucher-remove-btn",function(event){$(this).closest("form").submit()})},addErrorMessageToCartItem:function(cartItem,errorMsg){if(cartItem){var warningEl=cartItem.find(".js-item-warnings");warningEl.prepend("<div class='js-item-invalid alert alert-warning'><i class='adr-icon icon-warning'></i> "+errorMsg+"</div>"),warningEl.show()}},showErrorMessageToCartItem:function(cartItem,error){if(cartItem)if("VIN_CORE_088"===error.code)$(".cart-page-product__alert .cart-page-product__warning ").removeClass("display-none"),$(".cart-page-product__alert .cart-page-product__warning .alert-not-max-quantity-entry").removeClass("display-none");else if("VIN_CORE_023"===error.code)$(".cart-page-product__alert .cart-page-product__warning ").removeClass("display-none"),$(".cart-page-product__alert .cart-page-product__warning .alert-out-of-1000").removeClass("display-none");else{var warningEl=cartItem.find(".js-item-warnings");cartItem.addClass("cart-page-product__list-item-warning"),warningEl.text(error.message)}},disableButton:function(button){button&&button.addClass("disabled")},enableButton:function(button){button&&button.removeClass("disabled")},updateCartPage:function(){$.ajax({url:ACC.config.cartInfoUrl,cache:!1,type:"GET",success:function(htmlData){$(".js-shopping-cart > .container > .cart").html(htmlData)}})},gtmRemoveFromCart:function(form,module){try{if(void 0!==form&&void 0!==ACC.track.gtmRemoveFromCart&&"function"==typeof ACC.track.gtmRemoveFromCart){var offer={};offer.id=form.find("input[name=productCode]").val(),offer.quantity=form.find("input[name=initialQuantity]").val();var data=form.data("cart");offer.name=data.productName,offer.price=null;var price=data.productPostPrice;if(void 0!==price){var dotPosition=price.indexOf(".",0);dotPosition>-1&&(offer.price=price.substr(0,dotPosition))}offer.brand=data.brand,offer.variant=data.variant,offer.category=data.breadcrumb,offer.module=module,ACC.track.gtmRemoveFromCart(offer)}}catch(err){}},bindCheckout:function(){$(document).on("click",".js-cart-checkout-button",function(event){void 0!==ACC.track.gtmClickCheckoutInCart&&"function"==typeof ACC.track.gtmClickCheckoutInCart&&(ACC.track.gtmClickCheckoutInCart("productBuy"),$(this).click(function(){return!1}))}),$(document).on("click",".js-cart-express-buy-button",function(event){void 0!==ACC.track.gtmClickCheckoutInCart&&"function"==typeof ACC.track.gtmClickCheckoutInCart&&(ACC.track.gtmClickCheckoutInCart("productBuyFast"),$(this).click(function(){return!1}))})},isJSONString:function(str){try{return JSON.parse(str),!0}catch(e){return!1}}},ACC.cartitem={_autoload:[],submitTriggered:!1,updateQuantities:function(entryNumber,quantity,isASM){var formData={quantity:quantity,entryNumber:entryNumber,isASM:isASM};return $.ajax({url:ACC.config.cartUpdateUrl,type:"post",data:JSON.stringify(formData),dataType:"html",contentType:"application/json; charset=utf-8"})},deleteEntries:function(entries){return $.ajax({url:"/checkout/multi/delivery-address/deleteentries?entries="+entries,type:"post",dataType:"html",contentType:"application/json; charset=utf-8"})},deleteQuantities:function(entryNumber){return $.ajax({url:ACC.config.cartDeleteUrl+"?entryNumber="+entryNumber,type:"post",dataType:"html",contentType:"application/json; charset=utf-8"})},deleteQuantitiesWithSourcing:function(entryNumber){return $.ajax({url:ACC.config.cartDeleteUrl+"?entryNumber="+entryNumber+"&sourcing=true",type:"post",dataType:"html",contentType:"application/json; charset=utf-8"})},bindCartItem:function(){$(".js-remove-entry-button").on("click",function(){var entryNumber=$(this).attr("id").split("_"),form=$("#updateCartForm"+entryNumber[1]),productCode=form.find("input[name=productCode]").val(),initialCartQuantity=form.find("input[name=initialQuantity]"),cartQuantity=form.find("input[name=quantity]");ACC.track.trackRemoveFromCart(productCode,initialCartQuantity.val()),cartQuantity.val(0),initialCartQuantity.val(0),form.submit(),ACC.minicart.updateMiniCartDisplay()}),$(".js-update-entry-quantity-input").on("blur",function(e){ACC.cartitem.handleUpdateQuantity(this,e)}).on("keyup",function(e){return ACC.cartitem.handleKeyEvent(this,e)}).on("keydown",function(e){return ACC.cartitem.handleKeyEvent(this,e)})},handleKeyEvent:function(elementRef,event){return 13!=event.which||ACC.cartitem.submitTriggered?!ACC.cartitem.submitTriggered:(ACC.cartitem.submitTriggered=ACC.cartitem.handleUpdateQuantity(elementRef,event),ACC.cartitem.submitTriggered)},handleUpdateQuantity:function(elementRef,event){var form=$(elementRef).closest("form"),productCode=form.find("input[name=productCode]").val(),initialCartQuantity=form.find("input[name=initialQuantity]").val(),newCartQuantity=form.find("input[name=quantity]").val();return initialCartQuantity!=newCartQuantity&&(ACC.track.trackUpdateCart(productCode,initialCartQuantity,newCartQuantity),form.submit(),!0)}},$(".wishliscon-cartpage").on("click",function(e){var productCode=$(this).attr("data-product"),cobj=$(this);if("anonymous"===ACC.userInfo.uid)return void ACC.login.show();if(!cobj.data("requestRunning")){cobj.data("requestRunning",!0);var res=$.ajax({url:"/addwish?pcode="+productCode,method:"GET",success:function(response){if("0"===response){var exCount=eval($("#wishCount-"+productCode).attr("data-count"));$("#wishicon-"+productCode).removeClass("polish-version-icon-heart-shape ").addClass("polish-version-icon-heart-16px")}else if("1"===response){var exCount=eval($("#wishCount-"+productCode).attr("data-count"));$("#wishicon-"+productCode).css({color:"#464850"})}},complete:function(){cobj.data("requestRunning",!1),ACC.common.bindWishPopup(productCode)}})}}),ACC.deliverydata=ACC.deliverydata||{},ACC.delivery={_autoload:["initLocationModule"],pageType:_.isEmpty(ACC.deliverydata.pageType)?"":ACC.deliverydata.pageType,selectedProvince:_.isEmpty(ACC.deliverydata.selectedProvince)?"":ACC.deliverydata.selectedProvince,selectedDistrict:_.isEmpty(ACC.deliverydata.selectedDistrict)?"":ACC.deliverydata.selectedDistrict,selectedWard:_.isEmpty(ACC.deliverydata.selectedWard)?"":ACC.deliverydata.selectedWard,selectedProvinceName:_.isEmpty(ACC.deliverydata.selectedProvinceName)?"":ACC.deliverydata.selectedProvinceName,selectedDistrictName:_.isEmpty(ACC.deliverydata.selectedDistrictName)?"":ACC.deliverydata.selectedDistrictName,selectedWardName:_.isEmpty(ACC.deliverydata.selectedWardName)?"":ACC.deliverydata.selectedWardName,selectedStreet:"",missingMessage:_.isEmpty(ACC.deliverydata.missingMessage)?"":ACC.deliverydata.missingMessage,successMessage:_.isEmpty(ACC.deliverydata.successMessage)?"":ACC.deliverydata.successMessage,showTextValue:"",firstTimeUser:_.isEmpty(ACC.deliverydata.firstTimeUser)?"":ACC.deliverydata.firstTimeUser,suggestionFrom:_.isEmpty(ACC.deliverydata.suggestionFrom)?"":ACC.deliverydata.suggestionFrom,scrollFrom:_.isEmpty(ACC.deliverydata.scrollFrom)?"":ACC.deliverydata.scrollFrom,adayroiDeliveryZoneCookie:"adayroi_delivery_zone_cookie",AID:"AID",popup:function(state,elem){void 0===state&&(state="hide"),void 0===elem&&(elem="#shipping--zone"),$(elem).modal(state)},initLocationModule:function(){var myCookie=ACC.requests.manualDelivery.getCookie(ACC.delivery.adayroiDeliveryZoneCookie),isValid=!1;if(null!=ACC.requests.manualDelivery.getUrlParameter(ACC.delivery.AID)&&""!=ACC.requests.manualDelivery.getUrlParameter(ACC.delivery.AID)&&-1!=ACC.requests.manualDelivery.getUrlParameter(ACC.delivery.AID).indexOf("_")&&3==ACC.requests.manualDelivery.getUrlParameter(ACC.delivery.AID).split("_").length)for(var arrayAID=ACC.requests.manualDelivery.getUrlParameter(ACC.delivery.AID).split("_"),i=0;i<arrayAID.length;i++){if((null==arrayAID[i]||""==arrayAID[i])&&isNaN(parseInt(arrayAID[i]))){isValid=!1;break}isValid=!0}if(null==myCookie&&isValid){var res,urlParam=ACC.requests.manualDelivery.getUrlParameter("AID");res=ACC.requests.manualDelivery.setDeliveryByCustom(urlParam),res.always(function(){ACC.delivery.popup("hide")}).done(function(response){if(null!=response&&-1!=response.indexOf("_")){if(0===ACC.requests.getUrlParameter("page").length){var arrAID=response.split("_");if(null!=arrAID&&3==arrAID.length){ACC.delivery.selectedProvince=arrAID[2],ACC.delivery.selectedDistrict=arrAID[1],ACC.delivery.selectedWard=arrAID[0];var els;els=ACC.delivery.deliveryZone.elements,ACC.delivery.deliveryZone.checkState(),ACC.delivery.deliveryZone.binding();var elsPDP;if(elsPDP=ACC.delivery.productDelivery.elements,ACC.delivery.productDelivery.binding(),ACC.requests.triggerComboLocation(els.city,els.district,els.ward,els.street,{province:ACC.delivery.selectedProvince,district:ACC.delivery.selectedDistrict,ward:ACC.delivery.selectedWard},1),ACC.requests.triggerComboLocation(elsPDP.city,elsPDP.district,elsPDP.ward,elsPDP.district_only,{province:ACC.delivery.selectedProvince,district:ACC.delivery.selectedDistrict,ward:ACC.delivery.selectedWard}),void 0!=ACC.delivery.selectedProvinceName&&""!=ACC.delivery.selectedProvinceName&&void 0!=ACC.delivery.selectedDistrictName&&""!=ACC.delivery.selectedDistrictName&&void 0!=ACC.delivery.selectedWardName&&""!=ACC.delivery.selectedWardName){var showDeliveryText=ACC.delivery.selectedWardName+", "+ACC.delivery.selectedDistrictName+", "+ACC.delivery.selectedProvinceName;$(".pop-hover-title .text-location-home").html(showDeliveryText),$(".js-change-location span strong").html(showDeliveryText)}}}else window.location.href=ACC.requests.removeUrlParam("page",window.location.href)}else null!=response&&"fail"==response&&($("#shipping--zone-city").length>0&&ACC.delivery.deliveryZone.initSelectize(),$("#product--detail-city").length>0&&ACC.delivery.productDelivery.initSelectize())})}else $("#shipping--zone-city").length>0&&ACC.delivery.deliveryZone.initSelectize(),$("#product--detail-city").length>0&&ACC.delivery.productDelivery.initSelectize()},deliveryZone:{elements:{address:"#deliveryRecentAddress a",city:"#shipping--zone-city",street:"#shipping--zone-street",district:"#shipping--zone-district",ward:"#shipping--zone-ward",submit:"#btnSubmit"},initSelectize:function(){ACC.delivery.deliveryZone.elements,ACC.delivery.deliveryZone.checkState(),ACC.delivery.deliveryZone.binding()},checkState:function(){"true"!==ACC.requests.getUrlParameter("nopopup")&&"true"===ACC.deliverydata.firstTimeUser&&"true"===ACC.config.autoShowPopup&&$(window).load(_.debounce(function(){ACC.delivery.popup("show")},10*ACC.requests.timeout))},binding:function(){var els;els=ACC.delivery.deliveryZone.elements;var deliverySubmit=function(city,district,ward){var res;res=ACC.requests.deliveryZone.byDefault(city,district,ward),res.always(function(){ACC.delivery.popup("hide")}).done(function(response){if("success"===response){0===ACC.requests.getUrlParameter("page").length?window.location.reload():window.location.href=ACC.requests.removeUrlParam("page",window.location.href)}})};$(document).on("click",".js-change_delivery, .js-change_delivery_pdp, .js-change_delivery_nonTextChange, .js-shippingArea",function(e){e.preventDefault(),$(".modal").modal("hide"),ACC.delivery.popup("show"),$("#shipping--zone").on("shown.bs.modal",function(){_.isEmpty(ACC.delivery.selectedProvince)&&ACC.selectize.focus(els.city)})}),$(document).on("change",els.ward,function(e){_.isEmpty(ACC.selectize.get(els.ward))||($(els.submit).removeClass("btn-disabled"),$(".js-confirm-delivery-updated").html(""))}),$(document).on("click",els.address,function(e){var city,district,ward,$this=$(this);city=$this.data("city"),district=$this.data("district"),ward=$this.data("ward"),ACC.track.trackChangeAddressInCartPage("productChangeAddress"),deliverySubmit(city,district,ward)}),$(document).on("click",els.submit,function(e){if(e.preventDefault(),_.isEmpty($(els.street).val())&&(_.isEmpty($(els.district).val())||_.isEmpty($(els.ward).val())))return void $(".js-confirm-delivery-updated").html(ACC.delivery.missingMessage);var city,district,ward;city=$(els.city).val(),district=$(els.district).val(),ward=$(els.ward).val(),ACC.track.trackChangeAddressInCartPage("productChangeAddress"),deliverySubmit(city,district,ward)})}},productDelivery:{elements:{form:"#product-shipping-section",title:".product-detail__sidebar__title",city:"#product--detail-city",district:"#product--detail-district",ward:"#product--detail-ward",status:"#product-shipping-status",locationInfo:"#locationInfo"},initSelectize:function(){var els;els=ACC.delivery.productDelivery.elements,ACC.delivery.productDelivery.binding(),ACC.requests.triggerComboLocation(els.city,els.district,els.ward,els.district_only,{province:ACC.delivery.selectedProvince,district:ACC.delivery.selectedDistrict,ward:ACC.delivery.selectedWard})},binding:function(){var els;els=ACC.delivery.productDelivery.elements,$(document).on("change",els.ward,function(e){e.preventDefault();var ward=ACC.selectize.get(els.ward);if(!_.isEmpty(ward)){ACC.requests.deliveryZone.byDefault($(els.city).val(),$(els.district).val(),$(els.ward).val()).done(function(response){"success"===response&&(ACC.helpers.deleteCookie("adayroi_notify_delivery_zone_cookie"),window.location.reload())})}}),_.isElement($(els.ward)[0])&&!_.isUndefined($(els.ward)[0].selectize)&&$(els.ward)[0].selectize.on("blur",function(){var ward=ACC.selectize.get(els.ward);if(!_.isEmpty(ward)){ACC.requests.deliveryZone.byDefault($(els.city).val(),$(els.district).val(),$(els.ward).val()).done(function(response){"success"===response&&(ACC.helpers.deleteCookie("adayroi_notify_delivery_zone_cookie"),window.location.reload())})}}),$(document).on("click",".js-change-location .change-location",function(e){e.preventDefault(),$(els.status).addClass("hidden"),$(els.locationInfo).addClass("hidden"),$(els.form).removeClass("hidden")}),$(document).on("click","#aCloseLocation",function(e){e.preventDefault(),$(els.status).removeClass("hidden"),$(els.locationInfo).removeClass("hidden"),$(els.form).addClass("hidden")})}}},ACC.checkout={_autoload:["bindCheckO","bindForms","bindSavedPayments","initBlock","initPopover","initCalendar","bindCalenderCell",["initCheckoutAddress",$("#provinceIso").length>0],"initVatInfo","bindExpressShippingForm",["initPaymentOptions",$("#vinPaymentDetailsForm").length>0],["initInstallmentPeriod",$('[name="installmentPaymentMode"]').length>0],"handleAsmOrderDeliveryTime",["checkShowSidebarProductNotify",$("#right-sidebar-product__list .sidebar-product__notify-content-box").length>0],"checkPaymentTerm",["initInstallmentInstantCart",$("#installmentInstantCartPayment").length>0],"bindingSelectLeadTime"],bindForms:function(){$(document).on("click",".sidebar-product__item .js-remove-entry-button",function(event){event.preventDefault();var entryNumber=$(this).attr("remove-entry"),sourcing=$(this).attr("sourcing");$.blockUI(),void 0!=sourcing&&"true"==sourcing?ACC.cartitem.deleteQuantitiesWithSourcing(entryNumber).then(function(response){location.reload(),$.unblockUI()},function(error){location.reload(),$.unblockUI()}):ACC.cartitem.deleteQuantities(entryNumber).then(function(response){ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify).done(function(){$(".checkout-sidebar .sidebar-product__list").length<1&&location.reload()}),$.unblockUI()},function(error){$.unblockUI(),location.reload()})}),$(document).on("click","#checkoutAddressSubmit",function(e){var entryNumber=$(".sidebar-product__item .js-remove-entry-button").attr("remove-entry"),disEntryNumber=$(".disable-entry-block").attr("disable-entry");void 0==entryNumber&&void 0==disEntryNumber&&(e.preventDefault(),$("#vinCheckoutAddressForm").submit(),$(".checkout-submit .btn-primary").prop("disabled",!0))}),$(document).on("click","#to-checkout-method",function(e){var entryNumber=$(".sidebar-product__item .js-remove-entry-button").attr("remove-entry"),disEntryNumber=$(".disable-entry-block").attr("disable-entry");void 0==entryNumber&&void 0==disEntryNumber&&(e.preventDefault(),$("#vinCheckoutAddressForm").submit())}),$(document).on("click","#previewOrder",function(e){var entryNumber=$(".sidebar-product__item .js-remove-entry-button").attr("remove-entry"),disEntryNumber=$(".disable-entry-block").attr("disable-entry");void 0==entryNumber&&void 0==disEntryNumber&&(e.preventDefault(),$("#vinCheckoutAddressForm").submit())}),$(document).on("click","#deliveryMethodSubmit",function(e){e.preventDefault(),$("#selectDeliveryMethodForm").submit()}),$(document).on("click",".js-link-change-cart",function(e){e.preventDefault(),IS_TOPUP_CHECKOUT?$("#checkoutHeaderData").attr("data-checkout-header-homeurl",ACC.config.encodedContextPath+"/napthe"):typeof IS_INSTALLMENT_CHECKOUT==typeof!0&&IS_INSTALLMENT_CHECKOUT?$("#checkoutHeaderData").attr("data-checkout-header-homeurl",ACC.config.encodedContextPath+"/p/"+INSTALLMENT_OFFER_CODE):$("#checkoutHeaderData").attr("data-checkout-header-homeurl",ACC.config.encodedContextPath+"/cart")}),$(document).on("click","#js-checkout-header-logo",function(e){e.preventDefault(),$("#checkoutHeaderData").attr("data-checkout-header-homeurl","/")}),$(document).on("click",".js-payment-method",function(e){var $this=$(this),$input=$this.find(".adr-radio-input"),$parent=$this.parents(".checkout-payment-methods"),$detail=$this.siblings(".checkout-payment-method-detail");$this.hasClass("is-active")||(!$this.hasClass("has-error")&&$input.is(":checked")?(void 0!==ACC.track.gtmOnCheckoutOption&&"function"==typeof ACC.track.gtmOnCheckoutOption&&ACC.track.gtmOnCheckoutOption("2",$input.val()),"undefined"!=typeof gtmOnCheckout&&"function"==typeof gtmOnCheckout&&gtmOnCheckout("2",$input.val()),$(".js-payment-method").removeClass("is-active"),$this.addClass("is-active"),$detail.slideDown(),$parent.find(".checkout-payment-method-detail").not($detail).slideUp(),$parent.find(".checkout-block-warning").addClass("hidden"),$this.parent().find(".checkout-block-warning.alert-danger").removeClass("hidden")):$this.parent().find(".checkout-block-warning.alert-danger").removeClass("hidden"))});if($(document).on("change",".js-payment-method .adr-radio-input",function(e){if($(this).is(":checked")){var paymentType=$(this).data("paytype"),_this=$(this),$parentLi=$(this).parent().parent(),data=$(ACC.otpCheckout._config.element.paymentForm).serialize();$.blockUI(),$.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/payment-method/validatepayment",method:"post",data:data,complete:function(){setTimeout(function(){$.unblockUI()},2e3)},success:function(response){if(void 0!=response.cartDataView&&null!=response.cartDataView&&""!==response.cartDataView){var cartView=$("<div></div>").html(response.cartDataView).text();$(ACC.giftcoderedeem._config.element.cartDetail).html(cartView)}if(void 0!=response.giftcodeView&&null!=response.giftcodeView&&""!==response.giftcodeView){var giftView=$("<div></div>").html(response.giftcodeView).text();$(ACC.giftcoderedeem._config.element.giftcodeDiv).html(giftView)}if(null!=response.newInstallmentPeriod&&"undefined"!==response.newInstallmentPeriod&&response.newInstallmentPeriod.length>0){var newInstallmentPeriodView=$("<div></div>").html(response.newInstallmentPeriod).text();ACC.checkout.initInstallmentPeriod(JSON.parse(newInstallmentPeriodView))}response.shouldRefreshPaymentOptions&&window.mediator.publish("refreshPaymentOptionsInPaymentMethod");var vinIdCheckbox=$("#vinIDCheckBox"),originalRedeemable=vinIdCheckbox.data("redeemable"),shouldDisableVinId=!(originalRedeemable&&!response.shouldDisableVinID);if("PAYMENT_DISCOUNT"==paymentType){if(!response.appliedPromotion&&null!=response.paymentModeWarningView){var warningView=$("<div></div>").html(response.paymentModeWarningView).text();$parentLi.find(".js-discountpayment-error").html(warningView)}response.shouldDisableOption?(_this.attr("disabled",!0),_this.attr("checked",!1),$parentLi.find(".checkout-payment-method-detail").hide()):$parentLi.find(".checkout-payment-method-detail").slideDown()}$("#vinIDCheckBox").attr("disabled",shouldDisableVinId)}})}}),$(document).on("click",".js-payment-method .adr-radio-icon.has-warning",function(e){var $this=$(this),$parent=$this.parents(".checkout-payment-methods"),$detail=$this.parents(".js-payment-method").siblings(".checkout-block-warning");$detail.removeClass("hidden"),$parent.find(".checkout-block-warning").not($detail).addClass("hidden")}),$(document).on("change",".checkout-payment-method-detail .adr-radio-input",function(e){var $this=$(this),$parent=$this.parents(".checkout-payment-method-detail"),$detail=$parent.find(".js-payment-checkbox");!$this.is(":checked")||void 0!=$this.val()&&""!=$this.val()?$detail.slideUp():$detail.slideDown()}),$(document).on("click",".js-payment-checkout",function(e){"undefined"!=typeof gtmCheckoutSubmitFinal&&"function"==typeof gtmCheckoutSubmitFinal&&gtmCheckoutSubmitFinal($("#vinPaymentDetailsForm").serializeArray(),"Regular")}),!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$("#sidebar-cart-total").length){new StickySidebar("#sidebar-cart-total",{topSpacing:75,bottomSpacing:0,containerSelector:".row",innerWrapperSelector:".sidebar__inner",resizeSensor:!0,stickyClass:"is-affixed",minWidth:0})}$(document).on("click",".js-cart-total--container .cart-submit",function(e){e.stopPropagation()}),$(document).on("click",".js-cart-total--container",function(e){$(this).closest(".js-cart-total--container").toggleClass("expand")}),$(document).on("click",".subtotals.sidebar-product__order .cart-total-toggle",function(e){e.stopPropagation()}),$(document).on("click",".subtotals.sidebar-product__order",function(e){$(this).toggleClass("expand")})},initPaymentOptions:function(){$(".js-payment-method .adr-radio-input").each(function(index){var $parent=$(this).parents(".checkout-payment-methods"),$detail=$(this).parents(".js-payment-method").siblings(".checkout-payment-method-detail");$(this).is(":checked")&&($detail.slideDown(),$parent.find(".checkout-payment-method-detail").not($detail).slideUp())})},afterSetShippingAddress:function(){},sendShippingAddress:function(data){var isASM=$("input[name='isASM']").val(),$isDisableDeliveryCalendar=$("#delivery-calendar"),$isDisableAdressSubmit=$("#checkoutAddressSubmit");if(void 0!=data&&isASM&&1==data.isFocus)return void ACC.order.getHouseBlock(data);if(void 0!==data&&!isASM){return $.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/delivery-address/update",method:"post",contentType:"application/json; charset=UTF-8",data:JSON.stringify(data),beforeSend:function(){$(".checkout-main .iconLoad").show(),$isDisableDeliveryCalendar.attr("disabled","true"),$isDisableAdressSubmit.attr("disabled","true"),$("#checkoutAddressWrapper *").attr("disabled",!0)},complete:function(){$(".checkout-main .iconLoad").hide(),$isDisableDeliveryCalendar.removeAttr("disabled"),$isDisableAdressSubmit.removeAttr("disabled"),$("#checkoutAddressWrapper *").removeAttr("disabled")},success:function(response){if(response.success){var encoded=$("<div></div>").html(response.cartData.deliveryInformation).text();if($("#deliveryInformation").html(encoded),ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify),void 0!==response.invalidAddress&&response.invalidAddress){var $selected=$(".js-checkout-receiver-address .adr-radio-input:checked");if($selected){$selected.parents("li").find(".checkout-receiver-address__form").stop().slideDown()}}data.vinhomesAddress&&void 0!==response.houseblocks&&null!=response.houseblocks&&ACC.checkout.bindingCheckoutVinhomesAddress("#vinhomesAddressShipping\\.vhHouseBlock",response.houseblocks,data)}else data.vinhomesAddress&&ACC.checkout.bindingCheckoutVinhomesAddress("#vinhomesAddressShipping\\.vhHouseBlock",[],data),response.refresh&&(window.location=ACC.config.encodedContextPath+"/checkout/multi/delivery-address/add")},error:function(xhr,ajaxOptions,thrownError){data.vinhomesAddress&&ACC.checkout.bindingCheckoutVinhomesAddress("#vinhomesAddressShipping\\.vhHouseBlock",[],data)}})}},updateCheckoutSummary:function(checkoutStep,isAsmModify){var beforeUpdate=$("#checkoutData").data("checkoutShowPopup");return $.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/deliveryaddress/updateCheckoutSummary",method:"post",dataType:"json",data:{checkoutStep:checkoutStep,isAsmModify:isAsmModify||!1},success:function(response){null!=response&&void 0!==response.totalCartEntries&&null!=response.totalCartEntries&&response.totalCartEntries<=0&&location.reload();var encoded=$("<div></div>").html(response.checkoutSummaryInformation).text();$("#checkoutSummaryInformation1").html(encoded);var issueupdateinfo=$("<div></div>").html(response.disableEntriesPopup).text();$("#checkout-step-confirm").html(issueupdateinfo);var afterUpdate=$("#checkoutData").data("checkoutShowPopup");(afterUpdate&&!beforeUpdate||1==afterUpdate&&1==beforeUpdate)&&($("#checkout-step-confirm").modal("show"),ACC.checkout.initCheckoutSummaryPopup())}})},bindSavedPayments:function(){$(document).on("click",".js-saved-payments",function(e){e.preventDefault();var title=$("#savedpaymentstitle").html()
;$.colorbox({href:"#savedpaymentsbody",inline:!0,maxWidth:"100%",opacity:.7,title:title,close:'<span class="glyphicon glyphicon-remove"></span>',onComplete:function(){}})})},bindCheckO:function(){var cartEntriesError=!1;$(".doFlowSelectedChange").change(function(){"multistep-pci"==$("#selectAltCheckoutFlow").attr("value")?$("#selectPciOption").css("display",""):$("#selectPciOption").css("display","none")}),$(".js-continue-shopping-button").click(function(){var checkoutUrl=$(this).data("continueShoppingUrl");window.location=checkoutUrl}),$(".expressCheckoutButton").click(function(){document.getElementById("expressCheckoutCheckbox").checked=!0}),$(document).on("input",".confirmGuestEmail,.guestEmail",function(){$(".guestEmail").val()===$(".confirmGuestEmail").val()?$(".guestCheckoutBtn").removeAttr("disabled"):$(".guestCheckoutBtn").attr("disabled","disabled")}),$(".js-continue-checkout-button").click(function(){var checkoutUrl=$(this).data("checkoutUrl");if(!(cartEntriesError=ACC.pickupinstore.validatePickupinStoreCartEntires())){var expressCheckoutObject=$(".express-checkout-checkbox");if(expressCheckoutObject.is(":checked"))window.location=expressCheckoutObject.data("expressCheckoutUrl");else{var flow=$("#selectAltCheckoutFlow").attr("value");if(void 0==flow||""==flow)window.location=checkoutUrl;else{"multistep-pci"==flow&&(flow="multistep");var pci=$("#selectPciOption").attr("value"),redirectUrl=checkoutUrl+"/select-flow?flow="+flow+"&pci="+pci;window.location=redirectUrl}}}return!1})},initVatInfo:function(){var showForm=function(){var $detail=$(".checkout-vat-info");$(".checkout-export-vat-form").stop().slideDown(),$detail.stop().slideUp(),$("#vat-adr-icon").attr("class","adr-icon icon-minimize-circle")},hideForm=function(){var $detail=$(".checkout-vat-info");$(".checkout-export-vat-form").stop().slideUp(),$detail.stop().slideDown(),$("#vat-adr-icon").attr("class","adr-icon icon-edit-circle")};$("#vat-adr-checkbox-input").is(":checked")&&($("#vat_checkout-block__body").stop().slideDown(),$(".js-checkout-vat-btn").fadeIn(),"1"===$("#vatInfoMode").val()?showForm():hideForm(),$(".checkout-export-vat-form .error-message").length>0?showForm():hideForm()),$(".js-export-vat-checkbox .adr-checkbox-input").on("change",function(){$(this).is(":checked")?($(".js-checkout-vat-btn").fadeIn(),showForm()):$(".js-checkout-vat-btn").fadeOut()}),$(".js-checkout-vat-btn").on("click",function(event){event.preventDefault();var $this=$(this),$detail=$(".checkout-vat-info"),$form=$(".checkout-export-vat-form");$form.is(":visible")?($form.stop().slideUp(),$detail.stop().slideDown(),$this.find(".adr-icon").attr("class","adr-icon icon-edit-circle")):($form.stop().slideDown(),$detail.stop().slideUp(),$this.find(".adr-icon").attr("class","adr-icon icon-minimize-circle"))}),$(".js-checkout-block input").on("change",function(){var checked=$(this).is(":checked"),$block=$(this).closest(".checkout-block").find(".checkout-block__body");checked?$block.stop().slideDown():$block.stop().slideUp()})},initShippingForm:function(){var $selected=$(".js-checkout-receiver-address .adr-radio-input.js-adr-shipping-noaddress");if($selected.is(":checked")){var $li=$selected.parents("li");$li.addClass("active").siblings(".active").each(function(){$(this).removeClass("active").find(".checkout-receiver-address__form").stop().slideUp()}),$li.find(".checkout-receiver-address__form").stop().slideDown()}},initInValidShippingForm:function(){var $selected=$(".js-checkout-receiver-address .adr-radio-input[data-invalid='true']:checked");if($selected){var $li=$selected.parents("li");$li.addClass("active").siblings(".active").each(function(){$(this).removeClass("active").find(".checkout-receiver-address__form").stop().slideUp()}),$li.find(".checkout-receiver-address__form").stop().slideDown()}},initVinhomesShippingForm:function(){var $selected=$(".js-checkout-receiver-address .adr-radio-input.js-adr-shipping-vinhome-address");if($selected.is(":checked")){var $li=$selected.parents("li");$li.addClass("active").siblings(".active").each(function(){$(this).removeClass("active").find(".checkout-receiver-address__form").stop().slideUp()}),$li.find(".checkout-receiver-address__form").stop().slideDown()}},initCheckoutHeader:function(){var checkoutHeader={agree:"#checkout-header-agree",cancel:"#checkout-header-cancel"};$(document).on("click",checkoutHeader.agree,function(){$(this).prop("disabled",!0),window.location=$("#checkoutHeaderData").data("checkoutHeaderHomeurl")}),$(document).on("click",checkoutHeader.cancel,function(){$("#checkout-header-confirm").modal("hide")}),$("#checkoutData").data("checkoutShowPopup")&&$("#checkout-step-confirm").modal("show")},initCheckoutLogInLogOut:function(){var checkoutHeader={login:"#checkout-header-login",logout:"#checkout-header-logout"};$(document).on("click",checkoutHeader.login,function(){$(this).prop("disabled",!0),$.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/delivery-address/clearSourcing",method:"post",success:function(res){window.location=$("#checkoutHeaderLoginData").data("checkoutHeaderLoginurl")}})}),$(document).on("click",checkoutHeader.logout,function(){$(this).prop("disabled",!0),$.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/delivery-address/clearSourcing",method:"post",success:function(res){var logouUrl=$("#checkoutHeaderLogoutData").data("checkoutHeaderLogouturl");IS_TOPUP_CHECKOUT?logouUrl+="?topupLogout=true":IS_INSURANCE_CHECKOUT?logouUrl+="?insuranceLogout=true":typeof IS_INSTALLMENT_CHECKOUT==typeof!0&&IS_INSTALLMENT_CHECKOUT?logouUrl+="?installmentLogout=true&offerCode="+INSTALLMENT_OFFER_CODE:IS_TABLE_BOOKING_CHECKOUT&&(logouUrl+="?tableBookingLogout=true"),window.location=logouUrl}})})},initCheckoutSummaryPopup:function(){$("#checkout-step-change-shippingAddress").length>0?$("#checkout-step-change-shippingAddress").on("click",function(){$("#checkout-step-confirm").modal("hide")}):$("#checkout-step-update-qty").length>0?$("#checkout-step-update-qty").on("click",function(){var formData=($("input[name='isASM']").val(),{entryNumberList:$("#entryNumberList").val(),availableToSellList:$("#availableToSellList").val()});return $.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/delivery-address/updateCartQuantities",method:"post",data:formData,beforeSend:function(){$(".checkout-main .iconLoad").show()},complete:function(){$(".checkout-main .iconLoad").hide(),$("#checkout-step-confirm").modal("hide")},success:function(response){if(response.success){var encoded=$("<div></div>").html(response.cartData.deliveryInformation).text();$("#deliveryInformation").html(encoded),ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify)}}})}):$("#checkout-step-cancel").on("click",function(){$("#checkout-step-confirm").modal("hide")}),$("#checkout-step-agree").on("click",function(){var removeItems=$(".sidebar-product__item .js-remove-entry-button"),entries=(removeItems.length,"");removeItems.each(function(i,el){var entryNumber=$(this).attr("remove-entry");entries=entries+entryNumber+",";var product="remove-product_"+$(this).attr("remove-entry");$("#"+product).remove()}),$.blockUI(),ACC.cartitem.deleteEntries(entries).then(function(response){$("#checkout-step-confirm").modal("hide"),location.reload()},function(error){location.reload()})})},standardLocationData:function(){var location={};try{location.availability="No",location.name="","undefined"!=typeof moreInfo&&moreInfo.hasOwnProperty("gtmDataLayer")&&moreInfo.gtmDataLayer.hasOwnProperty("userCity")&&"UNKNOWN"!=moreInfo.gtmDataLayer.userCity&&(location.availability="Yes",location.name=moreInfo.gtmDataLayer.userCity+"/"+moreInfo.gtmDataLayer.userDistrict+"/"+moreInfo.gtmDataLayer.userWard)}catch(err){}return location},gtmRemoveFromCheckout:function(entryNumber){try{if("undefined"!=typeof moreInfo&&void 0!==moreInfo.gtmDataLayer&&void 0!==moreInfo.gtmDataLayer.isUsingGtmOld&&moreInfo.hasOwnProperty("entries")&&!moreInfo.gtmDataLayer.isUsingGtmOld){var offerId=moreInfo.entries[entryNumber];moreInfo.hasOwnProperty(offerId)&&dataLayer.push({event:"productRemove",module:"Checkout",product:{id:moreInfo[offerId].id,sku:moreInfo[offerId].sku,name:moreInfo[offerId].name,variant:moreInfo[offerId].variant,quantity:moreInfo[offerId].quantity,price:{original:moreInfo[offerId].originalPrice,discounted:moreInfo[offerId].discountedPrice,discount:moreInfo[offerId].discountPrice},category:{id:moreInfo[offerId].categoryId,name:moreInfo[offerId].categoryName,path:moreInfo[offerId].categoryPath},brand:{id:moreInfo[offerId].brandId,name:moreInfo[offerId].brandName},merchant:{id:moreInfo[offerId].merchantId,name:moreInfo[offerId].merchantName},location:{availability:this.standardLocationData().availability,name:this.standardLocationData().name}}})}}catch(err){}},initBlock:function(){this.initShippingForm(),this.initInValidShippingForm(),this.initVinhomesShippingForm(),this.initCheckoutHeader(),this.initCheckoutSummaryPopup(),this.initCheckoutLogInLogOut(),$(".js-vinid-txt").on("keyup",function(){$("#modal-checkout-vinid-point").modal()}),$(".js-checkout-receiver-address-btn").on("click",function(event){event.preventDefault();var $this=$(this),$detail=$(".checkout-receiver-address-info"),$form=$(".checkout-receiver-address__form");$form.is(":visible")?($form.stop().slideUp(),$detail.stop().slideDown(),$this.find(".adr-icon").attr("class","adr-icon icon-edit-circle")):($form.stop().slideDown(),$detail.stop().slideUp(),$this.find(".adr-icon").attr("class","adr-icon icon-minimize-circle"))}),$(".js-checkout-payment-method-btn").on("click",function(event){event.preventDefault();var $this=$(this),$detail=$(".checkout-payment-method-info"),$form=$(".checkout-payment-method-form");$form.is(":visible")?($form.stop().slideUp(),$detail.stop().slideDown(),$this.find(".adr-icon").attr("class","adr-icon icon-edit-circle")):($form.stop().slideDown(),$detail.stop().slideUp(),$this.find(".adr-icon").attr("class","adr-icon icon-minimize-circle"))}),$(".js-checkout-receiver-address .adr-radio-input").on("change",function(){var $li=$(this).parents("li");$li.addClass("active").siblings(".active").each(function(){$(this).removeClass("active").find(".checkout-receiver-address__form").stop().slideUp()}),$li.find(".checkout-receiver-address__form:not(.checkout-address-invalid)").stop().slideDown()}),$(".js-payment-method .adr-radio-input").on("change",function(){var $this=$(this),$parent=$this.parents(".checkout-payment-methods"),$detail=$this.parents(".js-payment-method").siblings(".checkout-payment-method-detail");$this.is(":checked")&&($detail.slideDown(),$parent.find(".checkout-payment-method-detail").not($detail).slideUp(),"cod"===$this.val()&&$("#modal-checkout-otp").modal())}),$(document).on("click",".dropdown-menu-mobile-wap",function(event){event.preventDefault();var target,$this=$(this);target=$this.attr("data-target");var $target=$(target);$target.length>0&&($target.is(":visible")?($target.slideUp(),$this.find(".adr-icon").attr("class","adr-icon icon-view-menu-down")):($target.slideDown(),$this.find(".adr-icon").attr("class","adr-icon icon-view-menu-up")))});!function(){var $elem=$(".js-checkout-buyer-information-header .adr-checkbox-input"),$parent=$(".js-checkout-buyer-information-content"),hasnoBuyerAddress=$parent.data("hasno-buyeraddress"),error=$parent.data("error"),$form=$parent.find(".checkout-buyer-information-form"),$detail=$parent.find(".checkout-buyer-detail"),$button=$(".js-checkout-buyer-information-btn");error?($parent.stop().slideDown(),$button.fadeOut(),$form.show(),$detail.hide()):hasnoBuyerAddress?($parent.stop().slideDown(),$detail.hide(),$form.show(),$button.fadeOut()):($parent.stop().slideDown(),$detail.show(),$form.hide(),$button.fadeIn()),$(".js-checkout-buyer-information-header .adr-checkbox-input").on("change",function(){$elem.is(":checked")?($parent.stop().slideUp(),$button.fadeOut()):($parent.stop().slideDown(),error||hasnoBuyerAddress||$button.fadeIn())}),$(".js-checkout-buyer-information-header .adr-checkbox-input").trigger("change")}(),$(".js-checkout-buyer-information-btn").on("click",function(event){event.preventDefault(),ACC.checkout.buyerAddressSlideUpAndDown($(this))})},buyerAddressSlideUpAndDown:function(self){var $this=self,$parent=$(".js-checkout-buyer-information-content"),$form=$parent.find(".checkout-buyer-information-form"),$detail=$parent.find(".checkout-buyer-detail");$form.is(":visible")?($form.stop().slideUp(),$detail.stop().slideDown(),$this.find(".adr-icon").attr("class","adr-icon icon-edit-circle")):($form.stop().slideDown(),$detail.stop().slideUp(),$this.find(".adr-icon").attr("class","adr-icon icon-minimize-circle"))},initPopover:function(){$('.section__checkout [data-toggle="popover"], .cart-products [data-toggle="popover"]').popover({trigger:"manual",container:"body",animation:!0,viewport:{selector:".section__checkout > .container",padding:20},html:!0,content:function(){var target,$this=$(this);return target=$this.attr("data-target"),target?$(target).html():$this.attr("data-content")}}).on("click",function(e){e.preventDefault()}).on("mouseenter",function(){var _this=this;$(this).popover("show"),$(".popover").on("mouseleave",function(){$(_this).popover("hide")})}).on("mouseleave",function(){var _this=this;$(".popover:hover").length||$(_this).popover("hide")})},initCalendar:function(){$(document).on("click",".js-delivery-calendar",function(e){e.preventDefault(),$(this).closest(".checkout-delivery__item").find(".checkout-delivery__item-calendar").stop().slideToggle()}),$(document).on("click",".js-delivery-day",function(e){e.preventDefault();var day=$(this).attr("data-delivery-day");$("[data-delivery-day]").removeClass("active"),$('[data-delivery-day="'+day+'"]').addClass("active")})},initCheckoutAddress:function(){var els,bels;els={city:"#provinceIso",district_only:"#districtOnly",district:"#districtIso",ward:"#wardIso",street:"#streetIso"},bels={city:"#buyerAddress\\.provinceIso",district_only:"#buyerAddress\\.districtOnly",district:"#buyerAddress\\.districtIso",ward:"#buyerAddress\\.wardIso",street:"#buyerAddress\\.streetIso"};var locationData,bLocationData,delayCheckLoginAddress=$.Deferred(),currentAddress=($.Deferred(),ACC.requests.getCurrentAddress());locationData={province:$(els.city).attr("data-current-code"),district:$(els.district).attr("data-current-code"),ward:$(els.ward).attr("data-current-code"),street:$(els.street).val()},bLocationData={province:$(bels.city).attr("data-current-code"),district:$(bels.district).attr("data-current-code"),ward:$(bels.ward).attr("data-current-code"),street:$(bels.street).val()},_.isEmpty(locationData.province)||_.isEmpty(locationData.district)||_.isEmpty(locationData.ward)?currentAddress.done(function(addresses){_.isEmpty(addresses.province)||(locationData.province=addresses.province.code),_.isEmpty(addresses.district)||(locationData.district=addresses.district.code),_.isEmpty(addresses.ward)||(locationData.ward=addresses.ward.code),_.isEmpty(addresses.street)||(locationData.street=addresses.street.code),delayCheckLoginAddress.resolve(locationData)}):delayCheckLoginAddress.resolve(locationData),ACC.checkout.bindingCheckoutAddressAction(),delayCheckLoginAddress.done(function(locationData){ACC.requests.triggerComboLocation(els.city,els.district,els.ward,els.district_only,locationData)}),ACC.requests.triggerComboLocation(bels.city,bels.district,bels.ward,bels.district_only,bLocationData);var listAddressData=[],exitstAddress=$(".js-checkout-receiver-address .adr-radio-input.exists-address");if(void 0!==exitstAddress&&null!=exitstAddress){var index=0;exitstAddress.each(function(){var elsExists={city:"#vinAddressFormInValid"+index+"\\.provinceIso",district_only:"#vinAddressFormInValid"+index+"\\.districtOnly",district:"#vinAddressFormInValid"+index+"\\.districtIso",ward:"#vinAddressFormInValid"+index+"\\.wardIso",street:"#vinAddressFormInValid"+index+"\\.streetIso",addressId:"#vinAddressFormInValid"+index+"\\.addressId"},edLocationData={province:$(elsExists.city).attr("data-current-code"),district:$(elsExists.district).attr("data-current-code"),ward:$(elsExists.ward).attr("data-current-code"),street:$(elsExists.street).val()};ACC.requests.triggerComboLocation(elsExists.city,elsExists.district,elsExists.ward,elsExists.district_only,edLocationData),index++,listAddressData.push(elsExists)})}ACC.checkout.bindingCheckoutAddressExistsAction(listAddressData)},bindingCheckoutAddressAction:function(){var els,evh;evh={vhVinhomesInfo:"#vinhomesAddressShipping\\.vhVinhomesInfo",vhHouseBlock:"#vinhomesAddressShipping\\.vhHouseBlock"},els={city:"#provinceIso",district_only:"#districtOnly",district:"#districtIso",ward:"#wardIso",street:"#streetIso"},$(document).on("change",els.ward,_.debounce(function(){if(!_.isEmpty(ACC.selectize.get(els.ward))){var data={provinceIso:ACC.selectize.get(els.city),districtIso:ACC.selectize.get(els.district),wardIso:ACC.selectize.get(els.ward),streetIso:""};ACC.checkout.sendShippingAddress(data)}},3*ACC.requests.timeout));$(document).on("change","input[name='shippingAddressCode']",function(){var data={},isVinHomeAddress=$(this).hasClass("js-adr-shipping-vinhome-address");if(data.shippingAddressCode=$(this).val(),data.vinhomesAddress=!1,isVinHomeAddress){if(data.vinhomesAddress=!0,data.vhHouseBlock=$(evh.vhHouseBlock).val(),data.vhVinhomesInfo=$(evh.vhVinhomesInfo).val(),_.isEmpty(data.vhVinhomesInfo))return}else void 0!==data.shippingAddressCode&&data.shippingAddressCode.length<1&&void 0!==$(els.ward).val()&&""!==$(els.ward).val()&&(data={provinceIso:$(els.city).val(),districtIso:$(els.district).val(),wardIso:$(els.ward).val(),streetIso:""});$(".checkout__delivery__time").find("input").removeClass("selected"),$(".checkout__delivery__time").find("label").removeAttr("style"),data.radioChooseTime=0,ACC.checkout.sendShippingAddress(data)}),$(document).on("change",evh.vhVinhomesInfo,_.debounce(function(){if(!_.isEmpty(ACC.selectize.get(evh.vhVinhomesInfo))){var data={vinhomesAddress:!0,vhHouseBlock:$(evh.vhHouseBlock).val(),vhVinhomesInfo:$(evh.vhVinhomesInfo).val(),isFocus:1};ACC.checkout.sendShippingAddress(data)}},3*ACC.requests.timeout))},bindingCheckoutVinhomesAddress:function(houseBlockEl,houseBlockList,data){void 0===data.isFocus&&(data.isFocus=0),ACC.selectize.block(houseBlockEl),ACC.selectize.clear(houseBlockEl),ACC.selectize.unblock(houseBlockEl),_.isEmpty(houseBlockList)||(ACC.checkout.renderListFullAjax(houseBlockEl,houseBlockList,data.isFocus),1==data.isFocus?ACC.selectize.set(houseBlockEl,houseBlockList[0].code,"silent"):0!=data.isFocus||_.isEmpty(data.vhHouseBlock)||ACC.selectize.set(houseBlockEl,data.vhHouseBlock,"silent"),ACC.selectize.unblock(houseBlockEl))},renderListFullAjax:function(el,data,focus){for(var selectize=$(el)[0].selectize,i=0;i<data.length;i++)selectize.addOption({value:data[i].code,text:data[i].name});focus=_.isUndefined(focus)?0:focus,selectize.refreshOptions(focus)},bindingCheckoutAddressExistsAction:function(addressForm){if(console.log(addressForm),void 0!==addressForm&&null!=addressForm)for(index in addressForm)$(document).on("change",addressForm[index].ward,_.debounce(function(){if(!_.isEmpty(ACC.selectize.get(addressForm[index].ward))){var data={provinceIso:ACC.selectize.get(addressForm[index].city),districtIso:ACC.selectize.get(addressForm[index].district),wardIso:ACC.selectize.get(addressForm[index].ward),streetIso:"",updateAddress:!0,shippingAddressCode:$(addressForm[index].addressId).val()};ACC.checkout.sendShippingAddress(data)}},3*ACC.requests.timeout))},debounceSendShippingAddress:function(elsCity,elsDistrict,elsWard){ACC.requests.debounce(function(){var data={provinceIso:$(elsCity).val(),districtIso:$(elsDistrict).val(),wardIso:$(elsWard).val(),streetIso:""};null!=data.provinceIso&&null!=data.districtIso&&null!=data.wardIso&&ACC.checkout.sendShippingAddress(data)},ACC.requests.timeout)()},bindCalenderCell:function(){var deliveryTimeDom,$isDisableAdressSubmit=$("#checkoutAddressSubmit");deliveryTimeDom=".checkout-delivery__item-calendar__table-cell",deliveryTimeItemBody=".js-delivery-time",$(document).on("click",deliveryTimeItemBody,function(){var deliveryDay,ajaxUrl,id,shipmentId,deliveryFromHour,deliveryToHour,rushHour,preSelected=!1;id="#"+$(this).attr("id"),shipmentId=$(this).attr("data-shipment-id"),deliveryDay=$(this).attr("data-delivery-day"),deliveryFromHour=$(this).attr("data-delivery-from-hour"),deliveryToHour=$(this).attr("data-delivery-to-hour"),rushHour=$(this).attr("data-delivery-rush-hour"),ajaxUrl=ACC.config.encodedContextPath+"/checkout/multi/delivery-address/selectDeliveryTime",$(id).hasClass("selected")&&($(id).removeClass("selected"),$(id).find(".hot-time").addClass("hide"),preSelected=!0);var res=$.ajax({url:ajaxUrl,method:"post",beforeSend:function(){$.blockUI(),$isDisableAdressSubmit.attr("disabled","true"),$("#checkoutAddressWrapper *").attr("disabled",!0)},complete:function(){$.unblockUI(),$isDisableAdressSubmit.removeAttr("disabled"),$("#checkoutAddressWrapper *").removeAttr("disabled")},data:{shipmentId:shipmentId,deliveryDate:deliveryDay,fromTime:deliveryFromHour,toTime:deliveryToHour,rushHour:rushHour}});res.fail(function(response){console.log("Select Delivery Time Failed")}),res.done(function(response){if(response.success){var shipmentId="#"+response.shipmentData.shipmentId+" ";if($(shipmentId).find(".checkout-delivery__item-time").html(response.shipmentData.shipmentTimeMsg),ACC.checkout.bindAsmOrderDeliveryCalendarInput(shipmentId,deliveryDay,deliveryFromHour,deliveryToHour),$(shipmentId+".delivery-time-error").remove(),$(shipmentId+".required-field-error").remove(),response.shipmentData.selectedTime){if($(shipmentId).find(deliveryTimeDom).not(id).removeClass("selected"),$(shipmentId).find(".hot-time").addClass("hide"),!preSelected){$(id).addClass("selected");var reason=$(shipmentId+"#rescheduleReasonOpt option:selected").val();ACC.config.isAsmModify&&""==reason&&$(shipmentId+".js-delivery__time-asm").append("<div class='col-md-12 required-field-error has-error'><span class='help-block'>Lý do không được để trống</span></div>")}$(id).find(".hot-time").removeClass("hide"),$(shipmentId).find("#"+response.shipmentData.deliveryDay).addClass("selected"),ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify)}else $(shipmentId).find(".hot-time").addClass("hide"),ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify)}else console.log("Select Delivery Time Unsuccess")})})},bindExpressShippingForm:function(){$(document).on("click",".js-express-shipping",function(e){ACC.checkout.submitExpressShippingForm($(this))})},submitExpressShippingForm:function(self){var checked=self.is(":checked"),poCode=self.attr("data-po-code"),$isDisableAdressSubmit=$("#checkoutAddressSubmit");$.ajax({type:"POST",url:ACC.config.encodedContextPath+"/checkout/multi/delivery-address/selectExpressShipping",dataType:"json",data:{CSRFToken:ACC.config.CSRFToken,poCode:poCode,expressShipping:checked},beforeSend:function(){$.blockUI(),$isDisableAdressSubmit.attr("disabled","true"),$("#checkoutAddressWrapper *").attr("disabled",!0)},complete:function(){$.unblockUI(),$isDisableAdressSubmit.removeAttr("disabled"),$("#checkoutAddressWrapper *").removeAttr("disabled")},success:function(response){if(response.success){console.log(response,"Changed Shippng Mode Successful");var encoded=$("<div></div>").html(response.cartData.deliveryInformation).text();$("#deliveryInformation").html(encoded),ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify)}else{var encoded=$("<div></div>").html(response.cartData.deliveryInformation).text();$("#deliveryInformation").html(encoded);var htmlPopup=$("<div></div>").html(response.message).text();$.colorbox({html:htmlPopup,width:"870px",onComplete:function(){$loader.css({display:"none"})}}),console.log(response,"Changed Shippng Mode Unsuccessful")}}})},bindFocusVAT:function(){$(document).on("click",".js-focus-vat",function(e){$("html, body").animate({scrollTop:$("#vat_checkout-block__body").offset().top-190},500),$("#reviewComment").focus()})},initInstallmentPeriod:function(installmentGroupJsonParam){if(void 0!==installmentGroupJsonParam&&(installmentGroupJson=installmentGroupJsonParam),"undefined"!=typeof installmentGroupJson&&!_.isNull(installmentGroupJson.banks)){var checkInstallmentOptions=function(bankCode,selectedPeriod){var $domInstallmentOptions=$('select[name="installmentOption"]'),bankPeriods=installmentGroupJson.banks[bankCode].period,optsMarkup="";console.log(bankPeriods),void 0===selectedPeriod&&(selectedPeriod=!1);for(var i in bankPeriods){var selected="";bankPeriods[i].code==selectedPeriod&&(selected=" selected"),optsMarkup+=_.template('<option data-target="#<%= bankCode %>" <%= selected %> value="<%= code %>"><%= value %></option>')({code:bankPeriods[i].code,value:bankPeriods[i].value,selected:selected,bankCode:bankCode})}$domInstallmentOptions.html(optsMarkup),$(".js-adayroi-term-msg").html(installmentGroupJson.banks[bankCode].termConditionMsg)};checkInstallmentOptions(installmentGroupJson.selectedBank,installmentGroupJson.selectedPeriod),$(document).on("change",'select[name="installmentOption"]',function(){$('select[name="installmentOption"] option:selected').attr("data-target");$('input[name="installmentPaymentMode"]').attr("data-prev",$(this).val())}),$(document).on("change",'input[name="installmentPaymentMode"]',function(){var selectedBank=$('input[name="installmentPaymentMode"]:checked').val(),selectedPeriod=$(this).attr("data-prev");checkInstallmentOptions(selectedBank,selectedPeriod)})}},handleAsmOrderDeliveryTime:function(){Number.prototype.between=function(a,b){var min=Math.min(a,b),max=Math.max(a,b);return this>min&&this<max};var keyUpHandler=function(e){var evt=e||window.event,target=evt.target||evt.srcElement,key=e.keyCode||e.which,number=($(this).val(),e.which),condition1=number.between(47,58,!0),condition2=number.between(95,106,!0);!1===condition1&&!1===condition2&&8!==e.which&&(e.preventDefault(),$(this).val("")),insertTimingColor(target,key),$("#"+target.getAttribute("data-shipment-id")+" .checkout-delivery__item-calendar .checkout-delivery__item-calendar__table-cell").removeClass("selected"),$("#"+target.getAttribute("data-shipment-id")+" .checkout-delivery__item-calendar .checkout-delivery__item-calendar__table-cell").find(".hot-time").addClass("hide")},insertTimingColor=function(element,key){element.value;if(2==element.value.trim().length&&8!==key&&(element.value>23&&(element.value=23),element.value=element.value+":"),5==element.value.trim().length&&8!==key){var m=element.value.slice(-2),hr=element.value.substring(0,element.value.length-3);m>59&&(m=59),element.value=hr+":"+m}},onChangeHandler=function(id){$(id+".delivery-time-error").remove(),$(id+".required-field-error").remove();var oderCode=$(id+".js-delivery__time-asm").attr("data-order-code"),shipmentIdSelected=$(id+".js-delivery__time-asm").attr("data-shipment-id"),dateSelected=$(id+"#asmOrderDeliveryTime").val(),timeFromSelected=$(id+".js-asm-order-delivery-from").val(),timeToSelected=$(id+".js-asm-order-delivery-to").val(),reason=$(id+"#rescheduleReasonOpt option:selected").val(),isComplain=$(id+"#isComplaintChk").prop("checked"),htmlDeliveryErrorString="<div class='col-md-12 delivery-time-error has-error'><span class='help-block'>Giờ giao hàng không hợp lệ</span></div>",htmlRequiredErrorString="<div class='col-md-12 required-field-error has-error'><span class='help-block'>##ERROR_MESSAGE##</span></div>",regex=/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])(:[0-5][0-9])?$/;if(""==dateSelected)return console.log("check required field for the delivery date"),void $(id+".js-delivery__time-asm").append(htmlRequiredErrorString.replace("##ERROR_MESSAGE##","Ngày giao hàng không được để trống"));if(""==timeToSelected)return console.log("check required field for the time to"),void $(id+".js-delivery__time-asm").append(htmlRequiredErrorString.replace("##ERROR_MESSAGE##","Giờ giao hàng không được để trống"));if(""!=timeToSelected&&!timeToSelected.match(regex))return console.log("check value for the time from if user entered value"),void $(id+".js-delivery__time-asm").append(htmlDeliveryErrorString);if(""!=timeFromSelected&&!timeFromSelected.match(regex))return console.log("check valid the selected time from"),void $(id+".js-delivery__time-asm").append(htmlDeliveryErrorString);if(""==reason)return console.log("check required field for reason"),void $(id+".js-delivery__time-asm").append(htmlRequiredErrorString.replace("##ERROR_MESSAGE##","Lý do không được để trống"));var dateSelectedFormatted=null;dateSelectedFormatted=null!=$(id+"#asmOrderDeliveryTime").datepicker("getDate")?$.datepicker.formatDate("yy-mm-dd",$(id+"#asmOrderDeliveryTime").datepicker("getDate")):$(id+"#asmOrderDeliveryTime").attr("data-date-iso");var dateTimeToSelected=new Date(dateSelectedFormatted+" "+timeToSelected).getTime(),dateTimeFromSelected=""!=timeFromSelected?new Date(dateSelectedFormatted+" "+timeFromSelected).getTime():null,unavailableSlots=$(id+"div.disabled[id*="+dateSelected.replace(/\//g,"")+"]");if(dateTimeFromSelected&&dateTimeFromSelected>dateTimeToSelected)return console.log("delivery time from is greater than delivery time to"),void $(id+".js-delivery__time-asm").append(htmlDeliveryErrorString);var $firstSlot=$(id+"div[id*="+dateSelected.replace(/\//g,"")+"]").not(".disabled").first();if(new Date(dateSelectedFormatted+" "+$firstSlot.attr("data-delivery-from-hour")).getTime()>=dateTimeToSelected)return console.log("the selected time totally outside the first available slot"),$(id+".js-delivery__time-asm").append(htmlDeliveryErrorString),!1;var $lastSlot=$(id+"div[id*="+dateSelected.replace(/\//g,"")+"]").not(".disabled").last(),timeToLastSlot=new Date(dateSelectedFormatted+" "+$lastSlot.attr("data-delivery-to-hour")).getTime();if(dateTimeFromSelected&&dateTimeFromSelected>timeToLastSlot)return console.log("the selected time range totally outside the defined time range"),$(id+".js-delivery__time-asm").append(htmlDeliveryErrorString),!1;if(dateTimeToSelected>timeToLastSlot)return console.log("the selected time to totally outside the defined time range"),$(id+".js-delivery__time-asm").append(htmlDeliveryErrorString),!1;$(id+".checkout-delivery__item-calendar").find(unavailableSlots).each(function(index){var unavailableTimeFromSlot=new Date(dateSelectedFormatted+" "+$(this).attr("data-delivery-from-hour")).getTime(),unavailableTimeToSlot=new Date(dateSelectedFormatted+" "+$(this).attr("data-delivery-to-hour")).getTime();if(dateTimeFromSelected){if(dateTimeFromSelected>=unavailableTimeFromSlot&&dateTimeFromSelected<=unavailableTimeToSlot&&dateTimeToSelected>=unavailableTimeFromSlot&&dateTimeToSelected<=unavailableTimeToSlot)return console.log("the selected date time range inside the unavailable time range"),$(id+".js-delivery__time-asm").append(htmlDeliveryErrorString),!1;if(unavailableTimeFromSlot>dateTimeFromSelected&&unavailableTimeFromSlot<dateTimeToSelected||unavailableTimeToSlot>dateTimeFromSelected&&unavailableTimeToSlot<dateTimeToSelected)return console.log("the unavailable date time range inside the selected date time range"),$(id+".js-delivery__time-asm").append(htmlDeliveryErrorString),!1}else if(dateTimeToSelected>unavailableTimeToSlot||dateTimeToSelected>unavailableTimeFromSlot)return console.log("the selected time to is greater than the last unavailable time slot"),$(id+".js-delivery__time-asm").append(htmlDeliveryErrorString),!1});var res=$.ajax({url:ACC.config.encodedContextPath+"/my-account/edit/"+oderCode+"/updateDeliveryTimeWithReason",method:"post",data:{shipmentId:shipmentIdSelected,deliveryDate:dateSelected,fromTime:timeFromSelected,toTime:timeToSelected,reason:reason,isComplain:isComplain}});res.fail(function(response){console.log("Update delivery time failed")}),res.done(function(response){if(response.success){var shipmentId="#"+response.shipmentData.shipmentId+" ";$(shipmentId).find(".checkout-delivery__item-time").html(response.shipmentData.shipmentTimeMsg)
}else console.log("Update delivery time unsuccess")})};$(document).on("keyup",".js-asm-order-delivery-time input",keyUpHandler),$(document).on("change",".js-asm-order-delivery-time input",function(){var id="#"+$(this).attr("data-shipment-id")+" ";onChangeHandler(id)}),$(document).on("change","#asmOrderDeliveryTime",function(){var id="#"+$(this).attr("data-shipment-id")+" ";$(id+".checkout-delivery__item-calendar .checkout-delivery__item-calendar__table-cell").removeClass("selected"),onChangeHandler(id)}),$(document).on("change","#rescheduleReasonOpt",function(){var id="#"+$(this).attr("data-shipment-id")+" ";onChangeHandler(id)}),$(document).on("change","#isComplaintChk",function(){var id="#"+$(this).attr("data-shipment-id")+" ";onChangeHandler(id)})},bindAsmOrderDeliveryCalendarInput:function(id,date,from,to){var $jsDeliveryTimeAsm=$(id+" .js-delivery__time-asm");$jsDeliveryTimeAsm.find("#asmOrderDeliveryTime").val(date),$jsDeliveryTimeAsm.find("#asmOrderDeliveryTime").datepicker("update"),$jsDeliveryTimeAsm.find(".js-asm-order-delivery-to").val(to),$jsDeliveryTimeAsm.find(".js-asm-order-delivery-from").val(from)},checkShowSidebarProductNotify:function(){$(".js-toggle-panel").trigger("click")},checkPaymentTerm:function(){var checkoutCondition=$("#vin-payment-term-component");if(checkoutCondition.length<=0)return!1;var modalDialog=$("#checkout-condition__modal-order"),checkPaymentTerm=$("#checkPaymentTerm"),paymentTermConfirm=$("#paymentTermConfirm"),paymentTerm=$("#paymentTerm"),windowH=$(window).height();modalDialog.find(".title").html(checkoutCondition.find(".paymentTitle").html()),modalDialog.find("#checkout-condition__modal-contentscroll").html(checkoutCondition.find(".paymentFullContent").html()),$(document).on("click",".checkout-condition__modal--btn",function(){modalDialog.modal()});var cartProductBody=$(".checkout-condition__modal-boxscrol");if(cartProductBody.length>0){var niceScrollOptions={cursorwidth:"5px",cursorborderradius:"0",cursorborder:"1px solid transparent",cursorcolor:"#a3a7af",autohidemode:!1,background:"#d8d8d8",horizrailenabled:!1,railpadding:{top:1,right:1,left:1,bottom:1}};windowH<=510?cartProductBody.css("max-height","200px"):cartProductBody.css("max-height","460px"),cartProductBody.css("margin","5px 0"),cartProductBody.css("padding","0 15px 0 5px");var niceScrollDiv=null;$(window).on("shown.bs.modal",function(){null==niceScrollDiv?niceScrollDiv=cartProductBody.niceScroll(niceScrollOptions):(niceScrollDiv.resize(),$(".nicescroll-rails").css("display","block"))})}if(paymentTermConfirm.length<=0)return!1;checkPaymentTerm.length>0&&null!=checkPaymentTerm.val()&&checkPaymentTerm.val().length>0&&this.initCurrentStatePaymentTermCheckbox(checkPaymentTerm.val()),paymentTermConfirm.is(":checked")?paymentTerm.val(!0):paymentTerm.val(!1),$(document).on("click","#paymentTermConfirm",function(){var result=$(this).is(":checked");paymentTerm.val(result),ACC.checkout.initCurrentStatePaymentTermCheckbox(result)})},initCurrentStatePaymentTermCheckbox:function(status){var paymentTermConfirms=$("input[name='paymentTermConfirm']");void 0!==paymentTermConfirms&&null!=paymentTermConfirms&&paymentTermConfirms.each(function(){var isTrueSet="true"===status.toString();$(this).prop("checked",isTrueSet)})},initInstallmentInstantCart:function(){$(document).on("click",".installment-instant-payment-mode",function(){var paymentCode=this.id;$(this).addClass("d-list__item-wrapper--active"),$(this).siblings().removeClass("d-list__item-wrapper--active"),$("#select-installment-instant-warning").addClass("hide"),$("#installment-instant-period-title").removeClass("hide"),$("#installment-instant-period-please").removeClass("hide"),$("#paymentMode").val(this.id),$("#installmentPaymentMode").val(this.id),$("#installmentOption").val(""),$("#agreement").val(!0);var res=$.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/payment-method/getInstallmentPeriods/"+paymentCode,method:"get",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()}});res.fail(function(response){console.log("Fail to get installment payment periods")}),res.done(function(response){var paymentOptions=$.parseHTML(response);$("#installment-instant-period-list").replaceWith(paymentOptions[0]),$("#installment-instant-term-condition, #installment-instant-term-condition-mobile").replaceWith(paymentOptions[2]),$(document).on("click",".installment-instant-payment-period",function(){$("#installment-instant-period-please").addClass("hide"),$(this).addClass("d-list__item-wrapper--active"),$(this).siblings().removeClass("d-list__item-wrapper--active"),$("#installmentOption").val(this.id)})})}),$(document).on("click","#adr-checkox-agreement",function(){var paymentTerm=$("#paymentTerm"),result=$(this).is(":checked");paymentTerm.val(result);var paymentTermConfirms=$("input[name='paymentTermConfirm']");void 0!==paymentTermConfirms&&null!=paymentTermConfirms&&paymentTermConfirms.each(function(){var isTrueSet="true"===status.toString();$(this).prop("checked",isTrueSet)})}),$(document).on("click","#installmentTermConfirm",function(){var result=$(this).is(":checked"),paymentTermConfirms=$("#agreement");result?($(this).prop("checked",!1),paymentTermConfirms.val(!1)):($(this).prop("checked",!0),paymentTermConfirms.val(!0))})},bindingSelectLeadTime:function(){$(document).on("click","input[name='chooseTime']",function(){var radioChooseTimes=$("input[name='chooseTime']:checked").val();$(this).hasClass("selected")?(radioChooseTimes=0,$(".checkout__delivery__time").find("label").removeAttr("style")):void 0!=radioChooseTimes&&1==radioChooseTimes?($(".checkout__delivery__time .inworktime").attr("style","border-color: #dd1d1b;"),$(".checkout__delivery__time .outworktime").removeAttr("style")):void 0!=radioChooseTimes&&2==radioChooseTimes&&($(".checkout__delivery__time .outworktime").attr("style","border-color: #dd1d1b;"),$(".checkout__delivery__time .inworktime").removeAttr("style"));var deliveryTimeDom,formData={radioChooseTime:radioChooseTimes};if(deliveryTimeDom=".checkout-delivery__item-calendar__table-cell",".js-delivery-time",$.ajax({type:"POST",url:ACC.config.encodedContextPath+"/checkout/multi/delivery-address/updateShipmentTime",dataType:"json",data:formData,success:function(response){if(response.success){if(1==response.cartTimeout)return void(window.location=ACC.config.encodedContextPath+"/checkout/multi/delivery-address/add");for(var index in response.shipmentDatas){var shipment=response.shipmentDatas[index],shipmentId="#"+shipment.shipmentId+" ",timeSlotId=$("#"+shipment.highlightDivTimeSlotId),deliveryDay=$(timeSlotId).attr("data-delivery-day"),deliveryFromHour=$(timeSlotId).attr("data-delivery-from-hour"),deliveryToHour=$(timeSlotId).attr("data-delivery-to-hour"),preSelected=($(timeSlotId).attr("data-delivery-rush-hour"),!1);if(shipment.selectedTime||($(".checkout-delivery__item-calendar__table-cell").removeClass("selected"),$(".checkout-delivery__item-calendar__table-cell").find(".hot-time").addClass("hide"),preSelected=!0),$(timeSlotId).hasClass("selected")&&!shipment.selectedTime&&($(timeSlotId).removeClass("selected"),$(timeSlotId).find(".hot-time").addClass("hide"),preSelected=!0),$(shipmentId).find(".checkout-delivery__item-time .title-shipment-time").html(shipment.shipmentTimeMsg),ACC.checkout.bindAsmOrderDeliveryCalendarInput(shipmentId,deliveryDay,deliveryFromHour,deliveryToHour),$(shipmentId+".delivery-time-error").remove(),$(shipmentId+".required-field-error").remove(),shipment.selectedTime){if($(shipmentId).find(deliveryTimeDom).not(timeSlotId).removeClass("selected"),$(shipmentId).find(".hot-time").addClass("hide"),!preSelected){$(timeSlotId).addClass("selected");var reason=$(shipmentId+"#rescheduleReasonOpt option:selected").val();ACC.config.isAsmModify&&""==reason&&$(shipmentId+".js-delivery__time-asm").append("<div class='col-md-12 required-field-error has-error'><span class='help-block'>Lý do không được để trống</span></div>")}$(timeSlotId).find(".hot-time").removeClass("hide"),$(shipmentId).find("#"+shipment.deliveryDay).addClass("selected")}else $(shipmentId).find(".hot-time").addClass("hide")}ACC.checkout.updateCheckoutSummary(null,ACC.config.isAsmModify)}}}),$(this).hasClass("selected"))return $(this).removeClass("selected"),void $(this).prop("checked",!1);$(this).parent().find("input").removeClass("selected"),$(this).addClass("selected")})}},ACC.checkoutaddress={spinner:$("<img src='"+ACC.config.commonResourcePath+"/images/ajax-loader_ADR.gif' />"),addressID:"",showAddressBook:function(){$(document).on("click","#viewAddressBook",function(){var data=$("#savedAddressListHolder").html();$.colorbox({height:!1,html:data,onComplete:function(){$(this).colorbox.resize()}})})},showRemoveAddressConfirmation:function(){$(document).on("click",".removeAddressButton",function(){var addressId=$(this).data("addressId");$.colorbox({inline:!0,height:!1,href:"#popup_confirm_address_removal_"+addressId,onComplete:function(){$(this).colorbox.resize()}})})}},$(document).ready(function(){with(ACC.checkoutaddress)showAddressBook(),showRemoveAddressConfirmation()}),ACC.checkoutsteps={_autoload:["permeateLinks"],permeateLinks:function(){$(document).on("click",".js-checkout-step",function(e){e.preventDefault(),window.location=$(this).closest("a").attr("href")})}},ACC.cms={_autoload:["bindOnClickPagiantion",["bindAjaxComponent",$(".js-ajax-component-data").length>0],["initProductGroupAjaxComponent",$(".js-product-group-loader").length>0]],loadComponent:function(id,type,target,onSuccess,onError){var self=this;id&&$.ajax({url:ACC.config.encodedContextPath+"/cms/component?componentUid="+id,cache:!1,type:"GET",success:function(result){reprocess=result.indexOf("js-responsive-image")>-1,self.insertHtml(result,target,reprocess),onSuccess&&onSuccess(result,id,type,target)},error:function(result){onError&&onError(result,id,type,target)}})},bindAjaxComponent:function(){elements=$(".js-ajax-component-data"),elements.each(function(){void 0!==$(this).data("componentuid")&&(componentuid=$(this).data("componentuid")),controllerName="VinAjaxComponentController",url=ACC.config.encodedContextPath+"/view/"+controllerName+"/component?componentUid="+componentuid,void 0!==$(this).data("component-controller")&&""!=$(this).data("component-controller")?(controllerName=$(this).data("component-controller"),url=ACC.config.encodedContextPath+"/view/"+controllerName+"?componentUid="+componentuid):void 0!==$(this).data("component-url")&&""!=$(this).data("component-url")&&(url=$(this).data("component-url")),ACC.cms.loadAjaxComponent(componentuid,"GET","js-ajax-component-"+componentuid,url,controllerName,!0,!0)})},loadAjaxComponent:function(id,type,target,url,controllerName,onSuccess,onError){var self=this;id&&$.ajax({url:url,cache:!0,type:type,success:function(result){onSuccess&&$("#"+target).replaceWith(result),reprocess=result.indexOf("js-responsive-image")>-1,self.reprocessResponsiveImages(result,target,reprocess),self.reprocessCarouselImages(result,target,$(".js-swiper-carousel").length>-1)},error:function(result){onError&&onError(result,id,type,target)}})},bindOnClickPagiantion:function(){$(document).on("click",".js-ajax-pagination a",function(e){var pageOps={};$(".js-product-group-loader"),e.preventDefault();var currentPageNo,componentId,$pagingContainer,componentSelected,statusForMainComponent,quickButtonEnable,quickViewEnable,$sortingContainer,selectionSort;if(componentId=$(this).attr("data-component-id"),componentSelected=$("#"+componentId),!$(this).parent().hasClass("disabled")){if($pagingContainer=$("#productGroupPagination"+componentId),null==pageOps[componentId]){var productGroup=ACC.productGroup[componentId];parseInt(productGroup.data.numberOfPages)>1&&(pageOps[componentId]={currentPage:0,numberOfPages:productGroup.data.numberOfPages,numberPagesShown:productGroup.data.numberPagesShown,componentId:componentId})}pageOps[componentId].currentPage=$(this).data("current-page-number"),$pagingContainer.html(ACC.template.pagination(pageOps[componentId],componentId)),statusForMainComponent=componentSelected.attr("data-status"),quickButtonEnable=componentSelected.attr("quick-button"),quickViewEnable=componentSelected.attr("quick-view"),currentPageNo=$(this).data("current-page-number"),$sortingContainer=$("#productGroupSorting"+componentId),selectionSort=$sortingContainer.attr("data-selection-sort"),ACC.requests.requestProductGroup(currentPageNo,componentId,statusForMainComponent,quickButtonEnable,quickViewEnable,selectionSort)}}),$(document).on("click",".js-sorting-action li a",function(event){event.preventDefault();var componentId,componentSelected,statusForMainComponent,quickButtonEnable,quickViewEnable,$selectedEl,sortingValue,$selectedSorting,$btn,pageOps={};$selectedEl=$(this),sortingValue=$selectedEl.attr("data-value"),$btn=$selectedEl.parents(".sorting-bar-container").find(".btn"),$btn.html($(this).text()+'<span class="caret"></span>'),"modal"==$btn.data("toggle")&&$("#sortOptionModal").modal("hide"),$selectedEl.parents(".sorting-bar-container").find(".selected").attr("class",""),$selectedEl.parents("li").attr("class","selected"),componentId=$(this).attr("data-component-id"),$selectedSorting=$("#productGroupSorting"+componentId),$selectedSorting.attr("data-selection-sort",sortingValue),componentSelected=$("#"+componentId),statusForMainComponent=componentSelected.attr("data-status"),quickButtonEnable=componentSelected.attr("quick-button"),quickViewEnable=componentSelected.attr("quick-view");var productGroup=ACC.productGroup[componentId];if(parseInt(productGroup.data.numberOfPages)>1){pageOps[componentId]={currentPage:0,numberOfPages:productGroup.data.numberOfPages,numberPagesShown:productGroup.data.numberPagesShown,componentId:componentId};$("#productGroupPagination"+componentId).html(ACC.template.pagination(pageOps[componentId],componentId))}ACC.requests.requestProductGroup("0",componentId,statusForMainComponent,quickButtonEnable,quickViewEnable,sortingValue)})},reprocessResponsiveImages:function(html,target,reprocess){target&&reprocess&&ACC.global.reprocessImages()},reprocessCarouselImages:function(html,target,reprocess){target&&reprocess&&ACC.carousel.bindCarousel()},initProductGroupAjaxComponent:function(){var $container,pageOps={};$container=$(".js-product-group-loader"),$container.each(function(){var $componentContainer,productGroup,componentId,prodEl,pagingEl,quantitySortEl;if(componentId=$(this).attr("id"),$componentContainer=$("#"+componentId),"true"!==$componentContainer.attr("pgloaded")){prodEl="productGroupContainer"+componentId,pagingEl="productGroupPagination"+componentId,quantitySortEl="productGroupSorting"+componentId,productGroup=ACC.productGroup[componentId],$componentContainer.prepend(_.template('<div class="container"><div class="product-list__container"><div id="<%= id %>" class="row"></div></div></div>')({id:prodEl})),$componentContainer.append(_.template('<div id="<%= id %>"></div>')({id:pagingEl})),$componentContainer.prepend(_.template('<div id="<%= id %>" class="product-group-sorting-container display-none"  data-selection-sort="<%= selectionSort %>"></div>')({id:quantitySortEl,selectionSort:productGroup.data.selectionSort}));var defaultImage={imgLoaderSrc:productGroup.data.defaultImage.url,imgSrc:productGroup.data.defaultImage.url,imgAlt:productGroup.data.defaultImage.altText,imgTitle:productGroup.data.defaultImage.description,imgBigSrc:""},productHtml="";productHtml+=ACC.template.productGroup.item(productGroup.data.products,defaultImage,productGroup.data.superSaleImage,productGroup.data.giftImage,productGroup.data.houseblock,productGroup.data.statusForMainComponent,productGroup.data.quickButtonEnable,productGroup.data.quickViewEnable);var $prodEl=$("#"+prodEl);$prodEl.addClass("lp-bottom-border"),$prodEl.html(productHtml),$prodEl.find("img.plp-lazy").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}),ACC.global.imgLazyLoadStopper(),parseInt(productGroup.data.numberOfPages)>1&&(pageOps[componentId]={currentPage:0,numberOfPages:productGroup.data.numberOfPages,numberPagesShown:productGroup.data.numberPagesShown,componentId:componentId},$("#"+pagingEl).append(ACC.template.pagination(pageOps[componentId],componentId))),$("#"+quantitySortEl).append(ACC.template.generateQuantitySortingBar(productGroup.data.totalProduct,productGroup.data.selectionSort,componentId,productGroup.data.device)),$componentContainer.attr("pgloaded","true")}})}};var cboxOptions={width:"95%",height:"95%",maxWidth:"960px",maxHeight:"960px"};$(".cbox-link").colorbox(cboxOptions),$(window).resize(function(){$("#colorbox").hasClass("variantSelectMobile")||$.colorbox.resize({width:window.innerWidth>parseInt(cboxOptions.maxWidth)?cboxOptions.maxWidth:cboxOptions.width,height:window.innerHeight>parseInt(cboxOptions.maxHeight)?cboxOptions.maxHeight:cboxOptions.height})}),ACC.colorbox={config:{opacity:.7,width:"auto",transition:"none",close:'<span class="color-box-close"></span>',title:'<div class="headline"><span class="headline-text">{title}</span></div>',overlayClose:!0,onComplete:function(){$.colorbox.resize(),ACC.common.refreshScreenReaderBuffer()},onClosed:function(){ACC.common.refreshScreenReaderBuffer()}},open:function(title,config){var config=$.extend({},ACC.colorbox.config,config);config.title=config.title.replace(/{title}/g,title),$.colorbox(config),ACC.selectize.initSelectize(),ACC.colorbox.resize()},resize:function(){$.colorbox.resize()},close:function(){$.colorbox.close()}},ACC.common={_autoload:["initVinStorage","bindLogoutClick",["bindVinTabClick",0!=$(".nav-tabs li .call-witch-tab").length]],currentCurrency:$("main").data("currencyIsoCode")||"USD",processingMessage:$("<img src='"+ACC.config.commonResourcePath+"/images/ajax-loader_ADR.gif'/>"),loadDynamicFile:function(element,type,fileurl){var jsElm=document.createElement(element);jsElm.type=type,jsElm.src=fileurl,document.body.appendChild(jsElm)},blockFormAndShowProcessingMessage:function(submitButton){submitButton.parents("form:first").block({message:ACC.common.processingMessage})},refreshScreenReaderBuffer:function(){$("#accesibility_refreshScreenReaderBufferField").attr("value",(new Date).getTime())},checkAuthenticationStatusBeforeAction:function(actionCallback){$.ajax({url:ACC.config.authenticationStatusUrl,statusCode:{401:function(){location.href=ACC.config.loginUrl}},success:function(data){"authenticated"==data&&actionCallback()}})},stepEventModal:function(sel,step){$(sel).trigger("next.m."+step)},attachCaptchaParameter:function(parentId,url){if(parent&&url){var recaptchaVal=$(parentId+" .g-recaptcha-response").val();return recaptchaVal?url+"?g-recaptcha-response="+recaptchaVal:url}},attachCaptchaParameterLandingADR:function(parentId,url){if(parent&&url){var recaptchaVal=$(parentId+" .g-recaptcha-response").val();return recaptchaVal||""}},resetForm:function($form){$form&&($form.find("input:text, input:password, input:file, select, textarea").not(":hidden").val(""),$form.find("input:radio, input:checkbox").removeAttr("checked").removeAttr("selected"),$form.find(".error-message").html(""))},hidePhoneNumber:function(phone){var result=phone;phone&&phone.length>4&&(result=phone.slice(phone.length-4));for(var i=0;i<4;i++)result="x"+result;return result},formatVinIdNumber:function(vindId){var result;return result=vindId.substring(0,4)+" ",result=result+vindId.substring(4,8)+" ",result=result+vindId.substring(8,12)+" ",result+=vindId.substring(12,16)},loadModuleElements:function(obj){obj&&obj._config&&obj._config.element&&$.each(obj._config.element,function(key,value){obj[key]=$(value)})},formatThousands:function(nStr){nStr+="",x=nStr.split(","),x1=x[0],x2=x.length>1?","+x[1]:"";for(var rgx=/(\d+)(\d{3})/;rgx.test(x1);)x1=x1.replace(rgx,"$1.$2");return x1+x2},getUrlForAjaxWithAllLocationSearchParams:function(originUrl){var url=originUrl;if(void 0!==url&&url.indexOf("adrIC")<0){var searchParamsQuery=window.location.search;if(""!=searchParamsQuery&&void 0!==searchParamsQuery&&searchParamsQuery.indexOf("?")>=0){var splitSearchQuery=searchParamsQuery.split("?");if(2==splitSearchQuery.length){var searchParams=splitSearchQuery[1],params=ACC.common._parseParams(searchParams),cartCode=params.adrIC;void 0!==cartCode&&(url=url.indexOf("?")<0?url+"?adrIC="+cartCode:url+"&adrIC="+cartCode)}}}return url},_parseParams:function(searchParams){for(var params={},splitParams=searchParams.split("&"),i=0;i<splitParams.length;i++){var p=splitParams[i].split("=");null!=p&&void 0!=typeof p&&2==p.length&&(params[p[0]]=p[1])}return params},loadingBox:{speed:40,arrayColorsTemp:["rgba(99, 99, 99, 0)","rgba(99, 99, 99, 0.05)","rgba(99, 99, 99, 0.08)","rgba(99, 99, 99, 0.2)","rgba(99, 99, 99, 0.3)","rgba(99, 99, 99, 0.5)","rgba(99, 99, 99, 0.6)","rgba(99, 99, 99, 1)"],arrayColors:[],statusAnimation:"stop",stop:function(element){element.find(".adr-loader-blocks").remove(),ACC.common.loadingBox.statusAnimation="stop"},init:function(element){element.append('<div class="adr-loader-blocks td-loader-infinite td-loader-blocks-load-more adr-loader-animation-start"></div>'),ACC.common.loadingBox.arrayColors=ACC.common.loadingBox.arrayColorsTemp.slice(0),"stop"===ACC.common.loadingBox.statusAnimation&&(ACC.common.loadingBox.statusAnimation="display",this.render()),setTimeout(function(){element.find(".adr-loader-blocks").removeClass("adr-loader-animation-start").addClass("adr-loader-animation-mid")},50)},render:function(color){ACC.common.loadingBox.animationDisplay('<div class="adr-lb-box adr-lb-box-1" style="background-color:'+ACC.common.loadingBox.arrayColors[0]+'"></div><div class="adr-lb-box adr-lb-box-2" style="background-color:'+ACC.common.loadingBox.arrayColors[1]+'"></div><div class="adr-lb-box adr-lb-box-3" style="background-color:'+ACC.common.loadingBox.arrayColors[2]+'"></div><div class="adr-lb-box adr-lb-box-4" style="background-color:'+ACC.common.loadingBox.arrayColors[3]+'"></div><div class="adr-lb-box adr-lb-box-5" style="background-color:'+ACC.common.loadingBox.arrayColors[4]+'"></div><div class="adr-lb-box adr-lb-box-6" style="background-color:'+ACC.common.loadingBox.arrayColors[5]+'"></div><div class="adr-lb-box adr-lb-box-7" style="background-color:'+ACC.common.loadingBox.arrayColors[6]+'"></div><div class="adr-lb-box adr-lb-box-8" style="background-color:'+ACC.common.loadingBox.arrayColors[7]+'"></div>');var tempColorArray=[ACC.common.loadingBox.arrayColors[0],ACC.common.loadingBox.arrayColors[1],ACC.common.loadingBox.arrayColors[2],ACC.common.loadingBox.arrayColors[3],ACC.common.loadingBox.arrayColors[4],ACC.common.loadingBox.arrayColors[5],ACC.common.loadingBox.arrayColors[6],ACC.common.loadingBox.arrayColors[7]];ACC.common.loadingBox.arrayColors[0]=tempColorArray[7],ACC.common.loadingBox.arrayColors[1]=tempColorArray[0],ACC.common.loadingBox.arrayColors[2]=tempColorArray[1],ACC.common.loadingBox.arrayColors[3]=tempColorArray[2],ACC.common.loadingBox.arrayColors[4]=tempColorArray[3],ACC.common.loadingBox.arrayColors[5]=tempColorArray[4],ACC.common.loadingBox.arrayColors[6]=tempColorArray[5],ACC.common.loadingBox.arrayColors[7]=tempColorArray[6],"display"===ACC.common.loadingBox.statusAnimation?setTimeout(ACC.common.loadingBox.render,ACC.common.loadingBox.speed):ACC.common.loadingBox.animationDisplay("")},animationDisplay:function(animation_str){jQuery(".adr-loader-blocks").html(animation_str)}},vinGlobalStorageFactory:function(){var api=new Object;return api.getItem=function(key){return vinMemoryStorage?vinMemoryStorage[key]||null:null},api.setItem=function(key,value){vinMemoryStorage||(vinMemoryStorage=new Object),vinMemoryStorage[key]=value},api.removeItem=function(key){vinMemoryStorage&&delete vinMemoryStorage[key]},api.clear=function(){vinMemoryStorage=new Object},api},initVinStorage:function(){return"localStorage"in window&&window.localStorage?void(vinStorage=localStorage):"sessionStorage"in window&&window.sessionStorage?void(vinStorage=sessionStorage):void(vinStorage=ACC.common.vinGlobalStorageFactory())},bindVinTabClick:function(){$(".nav-tabs li .call-witch-tab").click(function(e){e.preventDefault(),e.stopImmediatePropagation(),$(this).tab("show");var hash=$(e.target).attr("href");hash||(hash=$(this).data("target"));var tabid=hash.replace("#",""),cid=$(this).data("component-id");$("#vintabcontent-"+cid).prepend(ACC.common.processingMessage),ACC.requests.loadCmsComponent(tabid,"vintabcontent-"+cid,"")})},bindWishPopup:function(offerCode){$("#modal-quick-view").attr("data-offer-code",offerCode),$.ajax({url:"/wishsuspop?offerCode="+offerCode,type:"get",beforeSend:function(){$.blockUI()},complete:function(response){$.unblockUI()},data:{quickView:!0},success:function(response){$(".wishlist__critemodal").length>0&&$(".wishlist__critemodal").remove(),$("body").append(response),$(".wishlist__critemodal").modal("show")}})},bindLogoutClick:function(){$("#adrlogouthref").click(function(e){e.preventDefault(),ACC.minicart.clearCartPreview(),location.href=$(this).attr("href")})}},jQuery.extend({postJSON:function(url,data,callback){return jQuery.post(ACC.common.getUrlForAjaxWithAllLocationSearchParams(url),data,callback,"json")},postJSONCallback:function(url,data,success,error){return jQuery.ajax({type:"post",url:ACC.common.getUrlForAjaxWithAllLocationSearchParams(url),data:data,dataType:"json",contentType:"application/json; charset=utf-8",headers:{CSRFToken:ACC.config.CSRFToken},success:success,error:error})},postJSONCallbackWithLoading:function(url,data,successHander,errorHandler,blockContainer){var beforeSendHandler=function(){blockContainer&&blockContainer.find(".ui-ajax-block").block()},completeHandler=function(){blockContainer&&blockContainer.find(".ui-ajax-block").unblock()};return jQuery.ajax({type:"post",url:ACC.common.getUrlForAjaxWithAllLocationSearchParams(url),data:data,dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:beforeSendHandler,complete:completeHandler,success:successHander,error:errorHandler})}}),$.ajaxPrefilter(function(options,originalOptions,jqXHR){if("post"===options.type||"POST"===options.type){if(void 0===options.data)options.data="CSRFToken="+ACC.config.CSRFToken;else{/application\/json/i.test(options.contentType)?jqXHR.setRequestHeader("CSRFToken",ACC.config.CSRFToken):-1===options.data.indexOf("CSRFToken")?options.data=options.data+"&CSRFToken="+ACC.config.CSRFToken:void 0!==window.FormData&&options.data instanceof window.FormData&&options.data.append("CSRFToken",ACC.config.CSRFToken)}}options.url=ACC.common.getUrlForAjaxWithAllLocationSearchParams(options.url)}),$(document).ready(function(){try{ACC.requests.getFullAddress()}catch(e){console.log("load address fail!")}if($(document).on("keydown","input[number-only]",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190,189,173,109])||65==e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}),$(window).scroll(function(){$(this).scrollTop()>50?$("#back-to-top").fadeIn():$("#back-to-top").fadeOut()}),$("#back-to-top").click(function(){return $("#back-to-top").tooltip("hide"),$("body,html").animate({scrollTop:0},800),!1}),$("#back-to-top").tooltip("show"),$(window).load(function(){setTimeout(function(){$(".loader").hide()},500)}),$(".tooltip .icon-hint").on("click",function(event){$(".tooltiptext").toggle()}),$(".js-button-cancel-modification,.js-button-revert").on("click",function(event){$("this").attr("disabled",!0)}),$(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub .js_nav__link--drill__down",function(e){$(".navigation__overflow").scrollTop(0)}),$("img[usemap]").length>0&&$("img[usemap]").rwdImageMaps(),this.utils={isIOS:function(version){return/iPad|iPhone|iPod/.test(navigator.userAgent)},isIOS11:function(){return/OS 11_/.test(navigator.userAgent)}},this.utils.isIOS()&&this.utils.isIOS11()&&$("body").addClass("ios ios-11"),$(document).on("click",".js-ajax-pagination li a",function(e){var $target,componentId,compTop,scrollTop=0;componentId=$(this).attr("data-component-id"),_.isEmpty(componentId)||($target=$(_.template("#<%= id %>")({id:componentId})),compTop=$target.closest(".js-content-comp-ajax").length>0?$target.closest(".js-content-comp-ajax").find(".vinTab_header").length>0?$target.closest(".js-content-comp-ajax").find(".vinTab_header").find(".nav-tabs").offset().top-5:$target.closest(".js-content-comp-ajax").offset().top-65:$target.offset().top-65,_.isElement($target[0])&&(scrollTop=compTop-$("header").height())),$("body,html").scrollTop(scrollTop),setTimeout(function(){ACC.global.imgLazyLoadStopper()},300)}),$(".product__list-slider-setion").each(function(e){$(".product-group-carousel .swiper-slide").length>6&&$(".product-group-carousel .swiper-button-next").removeClass("swiper-button-disabled")}),$(".mobile-charge").length>0){$("#number-phone").val()>9&&$("#js-card-submit").removeAttr("disabled")}$(".product-detail__section").length>0&&$(window).width()<1024&&$(".product-detail__sidebar").appendTo(".product-detail__right--mobile")}),$(window).load(function(){var productCode=$("#addtowishLink").attr("data-product"),count=$("#wishCount-"+productCode).attr("data-count"),trimcount=$.trim(count);jQuery.isEmptyObject(trimcount)?$("#wishCounts-"+productCode).html():$("#wishCounts-"+productCode).html("("+trimcount+")")}),$(window).load(function(){$("html,body").trigger("scroll"),$(".mobile-charge").length>0&&window.performance&&2===window.performance.navigation.type&&window.location.reload()}),$(document).ready(function(){var uri=window.location.toString();if(uri.indexOf("?")>0){var clean_uri=uri.substring(0,uri.indexOf("?removeoffer"));window.history.replaceState({},document.title,clean_uri)}}),ACC.forgottenpassword={_config:{element:{popupRequest:"#forgot-password-request",popupChange:"#forgot-password-change",popupRequestBlock:"#forgot-password-request .modal-content",popupChangeBlock:"#forgot-password-change .modal-content"},variables:{username:""}},_autoload:["bindLink"],initElements:function(){ACC.common.loadModuleElements(ACC.forgottenpassword),this.popupRequest.on("hidden.bs.modal",function(){ACC.captcha.reset("js-forgot-password-request-captcha")})},bindSubmit:function(){$("#js-forgot-password-form").submit(function(event){event.preventDefault(),ACC.forgottenpassword._sendOtp()}),$("#js-otp-forgot-password-confirm").submit(function(event){event.preventDefault();ACC.config.forgotPasswordChangeUrl,ACC.captcha.getResponse("js-forgot-password-captcha");ACC.forgottenpassword.popupChangeBlock.block();var success=function(result){ACC.forgottenpassword.popupChangeBlock.unblock(),result.success?(ACC.forgottenpassword._closeChangePopup(),ACC.login.show()):(ACC.forgottenpassword._resetChangePopup(result),ACC.captcha.reset("js-forgot-password-captcha"))},error=function(jqXHR){ACC.forgottenpassword.popupChangeBlock.unblock(),$(".js-fp-otp-error").html(jqXHR.responseJSON.message),ACC.captcha.reset("js-forgot-password-captcha")},data={otpCode:$(".js-forgot-password-otp").val(),newPassword:$(".js-forgot-password-new-otp").val(),newPasswordConfirm:$(".js-forgot-password-new-confirm-otp").val(),username:ACC.forgottenpassword._config.variables.username};ACC.secureOTP.verifyOTP(data.otpCode,data,ACC.secureOTP.ACTIONS.FORGOT_PASSWORD,success,error,"js-forgot-password-captcha")})},bindLink:function(){$(document).on("click",".js-forgot-password-link",function(e){e.preventDefault();var currentPopup=$(this).closest(".modal");currentPopup?currentPopup.modal("hide"):$.colorbox.close(),ACC.forgottenpassword._openRequestPopup()}),$(document).on("click",".js-fp-resend-otp",function(e){e.preventDefault();var success=function(result){ACC.forgottenpassword.popupChangeBlock.unblock(),$(".js-fp-otp-error").html(""),$(".js-fp-otp-resend-msg").html(result)},error=function(jqXHR){ACC.forgottenpassword.popupChangeBlock.unblock(),$(".js-fp-otp-error").html(jqXHR.responseJSON.message),$(".js-fp-otp-resend-msg").html("")},data={otpHash:ACC.secureOTP.otpHash,action:ACC.secureOTP.ACTIONS.FORGOT_PASSWORD}
;ACC.secureOTP.sendOTP(data,success,error),ACC.forgottenpassword.popupChangeBlock.block()})},_closeRequestPopup:function(){this.popupRequest&&(this.popupRequest.modal("hide"),ACC.captcha.reset("js-forgot-password-request-captcha"))},_loadModal:function(callback){var _this=this;_this.popupRequest&&_this.popupChange?"function"==typeof callback&&callback():(ACC.helpers.showLoader(),$.ajax({url:"/popup-forgot-password",type:"GET",success:function(data){$("body").append(data),_this.initElements(),_this.bindSubmit(),ACC.helpers.hideLoader(),"function"==typeof callback&&callback()},error:function(data){ACC.helpers.hideLoader()}}))},_openRequestPopup:function(){var _this=this;_this._loadModal(function(){ACC.captcha.renderWidget("js-forgot-password-request-captcha"),$(".js-forgot-password-username").val(""),$(".js-fp-request-username-error").html(""),$(".js-fp-request-captcha-error").html(""),_this.popupRequest.modal("show")})},_closeChangePopup:function(){this.popupChange&&(this.popupChange.modal("hide"),ACC.captcha.reset("js-forgot-password-captcha"))},_openChangePopup:function(isEmail){var _this=this;_this._loadModal(function(){$(".js-forgot-password-otp").val(""),_this._resetChangePopup(),isEmail?($(".js-fp-change-sms").addClass("hide"),$(".js-fp-change-email").removeClass("hide")):($(".js-fp-change-sms").removeClass("hide"),$(".js-fp-change-email").addClass("hide")),_this.popupChange.modal("show"),ACC.captcha.renderWidget("js-forgot-password-captcha")})},_resetChangePopup:function(result){$(".js-forgot-password-new-otp").val(""),$(".js-forgot-password-new-confirm-otp").val(""),$(".js-fp-otp-resend-msg").html(""),result?($(".js-fp-otp-error").html(result.otpMsg),$(".js-fp-new-pwd-error").html(result.newPasswordMsg),$(".js-fp-new-pwd-confirm-error").html(result.newPasswordConfirmMsg),$(".js-fp-captcha-error").html(result.captchaMsg)):($(".js-fp-otp-error").html(""),$(".js-fp-new-pwd-error").html(""),$(".js-fp-new-pwd-confirm-error").html(""),$(".js-fp-captcha-error").html(""))},_sendOtp:function(){var requestUrl=ACC.config.forgotPasswordUrl+"?otpfunc="+ACC.otp.func.resetPass;requestUrl+="&g-recaptcha-response="+ACC.captcha.getResponse("js-forgot-password-request-captcha");var requestData={type:ACC.config.otpRequestType.FORGOTTEN_PASSWORD,username:$(".js-forgot-password-username").val()};ACC.forgottenpassword.popupRequestBlock.block(),$.ajax({url:requestUrl,type:"POST",data:JSON.stringify(requestData),dataType:"json",contentType:"application/json; charset=utf-8",success:function(result,textStatus,request){ACC.forgottenpassword.popupRequestBlock.unblock();var otpHash=request.getResponseHeader("otpHash");result.success&&otpHash&&null!=otpHash?(ACC.forgottenpassword._config.variables.username=result.username,ACC.forgottenpassword._closeRequestPopup(),ACC.forgottenpassword._openChangePopup(result.email),ACC.secureOTP.otpHash=otpHash):($(".js-fp-request-username-error").html(result.usernameMsg),$(".js-fp-request-captcha-error").html(result.captchaMsg),ACC.captcha.reset("js-forgot-password-request-captcha"))},error:function(jqXHR){ACC.forgottenpassword.popupRequestBlock.unblock(),$(".js-fp-request-username-error").html(jqXHR.responseJSON.message),ACC.captcha.reset("js-forgot-password-request-captcha")}})}},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(search,pos){return this.substr(!pos||pos<0?0:+pos,search.length)===search}}),String.prototype.endsWith||(String.prototype.endsWith=function(search,this_len){return(void 0===this_len||this_len>this.length)&&(this_len=this.length),this.substring(this_len-search.length,this_len)===search}),ACC.global={_autoload:["formatNumber","formatInput",["passwordStrength",$(".password-strength").length>0],"bindToggleOffcanvas","bindToggleXsSearch","initImager","backToHome",["categoryMenu",$(".category-menu").length>0],"selectboxRedirect",["selectFormSubmit",$(".js-form-submit").length>0],"initActionFooterClickMobile","bindAccordion",["initColorboxVideo",$(".js-youtube").length>0],["preventScriptInjection",$(".js-script-check").length>0],["imgLazyLoad",$(".pageType-CategoryPage, .pageType-MerchantPage, .pageType-BrandPage, .pageType-CouponPage, .page-search, .js-swiper-lp-product-slider, .home__banner").length>0],["imgLazyLoadTopSearch",$("#top-search-list").length>0],["imgLazyLoadPlP",$(".pageType-CategoryPage, .pageType-MerchantPage, .pageType-BrandPage, .pageType-CouponPage, .page-search, .js-swiper-lp-product-slider, .home__banner, .pageType-ProductGroupPage, .page-wishlistpage").length>0],["imgLazyLoadAppendClass",$(".js-lazy-img-class").length>0],["handleSearchSubmit",$(".js-search-form").length>0],"lazyLoadVingroupLogo","seachBackPage","clearInputSearch","checkIsLogin","closeModelDefault","initEvent","bindClickUserMobile","imgLazyLoadStopper","notFoundPageAction"],checkIsLogin:function(){"true"==ACC.config.isLogin?$(".footer-link-register").remove():$(".footer-link-logined").remove()},formatNumber:function(){$(".js-parse-float").each(function(){var val=$(this).text();void 0!==val&&$(this).html(parseFloat(val))})},formatInput:function(){$('.js-input-range[type="number"]').each(function(){$(this).on("blur",function(){var current,max;current=parseInt($(this).val()),parseInt($(this).attr("min")),max=parseInt($(this).attr("max")),current>max&&$(this).val(max)})})},closeModal:function(){$(".modal").on("click",function(e){($(e.target).hasClass("modal-dialog")||$(e.target).hasClass("modal")||$(e.target).hasClass("step-1"))&&$(".modal").modal("hide")})},passwordStrength:function(){$(".password-strength").pstrength({verdicts:[ACC.pwdStrengthTooShortPwd,ACC.pwdStrengthVeryWeak,ACC.pwdStrengthWeak,ACC.pwdStrengthMedium,ACC.pwdStrengthStrong,ACC.pwdStrengthVeryStrong],minCharText:ACC.pwdStrengthMinCharText})},bindAccordion:function(){$(".js-accordion .accordion-item .accordion-title").on("click",function(){$(this).parents().siblings().removeClass("open"),$(this).parents().addClass("open")})},bindToggleOffcanvas:function(){$(document).on("click",".js-toggle-sm-navigation",function(){ACC.global.toggleClassDisableOverflow("open-menu"),ACC.global.toggleClassState($(".js-enquire-offcanvas-navigation"),"hide"),ACC.global.resetXsSearch(),$("body").toggleClass("show--mobile")}),$(document).on("click",".js-close-mobile",function(){ACC.global.toggleClassDisableOverflow("open-menu"),ACC.global.resetXsSearch(),$(".bg-overlay").hide(),$("body").toggleClass("show--mobile")}),$(document).on("click",".js__change-delivery--mobile",function(e){e.preventDefault(),ACC.global.resetXsSearch(),$(".bg-overlay").hide(),$("body").toggleClass("show--mobile"),ACC.delivery.popup("show")}),$(document).on("click",".js-login-btn",function(e){e.preventDefault(),$(".bg-overlay").hide()})},bindToggleXsSearch:function(){$(document).on("click",".js-toggle-xs-search, .js-search-wap-container:not(.fixed-search-wap) .js-mobile-search",function(e){e.preventDefault(),ACC.global.toggleClassState($(".site-search"),"active"),ACC.global.toggleClassState($(".js-mainHeader .navigation--middle"),"search-open"),ACC.global.toggleClassState($("body"),"popup-search-open"),$(".site-search").addClass("c-modal-box-mobile js-modal-mobile fixed-search-wap"),ACC.global.toggleClassDisableOverflow("popup-open");var keyword=$("#js-site-search-input").focus().val();_.isEmpty(keyword)&&ACC.autocomplete.bindDropdownData()}),$(document).on("keypress",".js-search-wap-container:not(.fixed-search-wap)",function(e){e.preventDefault(),ACC.global.toggleClassState($(".site-search"),"active"),ACC.global.toggleClassState($(".js-mainHeader .navigation--middle"),"search-open"),$(".site-search").addClass("c-modal-box-mobile js-modal-mobile fixed-search-wap"),ACC.global.toggleClassDisableOverflow("popup-open");var keyword=$("#js-site-search-input").val();_.isEmpty(keyword)&&ACC.autocomplete.bindDropdownData()})},bindClickUserMobile:function(){$(document).on("click",".js-mobile-user",function(e){e.preventDefault();var parentPopup=$("#js-popup-header-user");parentPopup.addClass("c-modal-box-mobile c-modal-box-mobile-fixed-header popup-showing").removeClass("hide"),parentPopup.find(".c-modal-box-mobile__head").removeClass("hide"),parentPopup.find(".c-log-inout-content").addClass("c-modal-box-mobile__body"),ACC.global.toggleClassDisableOverflow("popup-open")})},resetXsSearch:function(){$(".site-search").removeClass("active"),$(".js-mainHeader .navigation--middle").removeClass("search-open"),$("body").removeClass("popup-search-open")},toggleClassState:function($e,c){return $e.hasClass(c)?$e.removeClass(c):$e.addClass(c),$e.hasClass(c)},seachBackPage:function(){$(document).on("click",".js-back-search",function(e){ACC.global.toggleClassState($(".site-search"),"active"),ACC.global.toggleClassState($(".js-mainHeader .navigation--middle"),"search-open"),$("body").removeClass("popup-search-open"),$(".site-search").removeClass("c-modal-box-mobile js-modal-mobile fixed-search-wap"),ACC.global.toggleClassDisableOverflow("popup-open"),$("#search-history").addClass("hide")})},toggleClassDisableOverflow:function(className){ACC.global.toggleClassState($("main"),className),ACC.global.toggleClassState($("html"),className),ACC.global.toggleClassState($("body"),className)},clearInputSearch:function(){$(document).on("click",".js-clear-search",function(e){e.preventDefault(),$("#js-site-search-input").val("")})},initImager:function(elems){elems=elems||".js-responsive-image",this.imgr=new Imager(elems)},reprocessImages:function(elems){elems=elems||".js-responsive-image",void 0==this.imgr?this.initImager(elems):this.imgr.checkImagesNeedReplacing($(elems))},addGoogleMapsApi:function(callback){void 0!=callback&&0==$(".js-googleMapsApi").length?$("head").append('<script class="js-googleMapsApi" type="text/javascript" src="//maps.googleapis.com/maps/api/js?key='+ACC.config.googleApiKey+"&sensor=false&callback="+callback+'"><\/script>'):void 0!=callback&&eval(callback+"()")},backToHome:function(){$(".backToHome").on("click",function(){var sUrl=ACC.config.contextPath;window.location=sUrl})},categoryMenu:function(){$(".category-menu li").each(function(){var $self;$self=$(this),$self.hasClass("active")&&($self.addClass("category-tree"),$self.parents("li.category-item").addClass("category-tree"),$self.hasClass("category-item_lv2")?$self.addClass("has-arrow"):$self.parents("li.category-item_lv2").addClass("has-arrow")),$self.hasClass("parent-arrow")&&$self.addClass("has-arrow")}),ACC.global.categoryMenuShowMore(25)},categoryMenuShowMore:function(maxRow){var totalRow,extraRow=[];if((totalRow=$(".category-item:visible").length)>maxRow){for(var i=0;i<totalRow;i++)i>maxRow-1&&extraRow.push($(".category-item:visible")[i]);if($(".section__category").append('<span class="category-showmore category-showmore-new--version">Xem thêm</span><span class="category-showless  category-showless-new--version hidden">Thu gọn</span>'),extraRow.length>0)for(var r=0;r<extraRow.length;r++)$(extraRow[r]).addClass("category-extra hidden");$("body").on("click",".category-showmore",function(){$self=$(this).addClass("hidden"),$(".category-showless").removeClass("hidden"),$(".category-item").removeClass("hidden")}),$("body").on("click",".category-showless",function(){$self=$(this).addClass("hidden"),$(".category-showmore").removeClass("hidden"),$(".category-item.category-extra").addClass("hidden")})}},selectboxRedirect:function(){$("body").on("change",".js-select-redirect",function(){var redirectPath,redirectUrl;redirectPath=$(this).find("option:selected").attr("data-url"),redirectUrl=window.location.origin+redirectPath,window.location.href=redirectUrl})},parseQueryString:function(query){-1!=query.indexOf("?")&&(query=query.replace("?","&"));for(var strTracking="itm_,utm_,traffic_",vars=query.split("&"),query_string="",i=1;i<vars.length;i++)for(var pair=vars[i].split("="),key=decodeURIComponent(pair[0]),value=decodeURIComponent(pair[1]),arrTracking=strTracking.split(","),t=0;t<arrTracking.length;t++)if(-1!=key.indexOf(arrTracking[t]))if(void 0===query_string[key])query_string+="&"+key+"="+decodeURIComponent(value);else if("string"==typeof query_string[key]){var arr=[query_string[key],decodeURIComponent(value)];query_string+="&"+key+"="+arr}else query_string+="&"+key+"="+decodeURIComponent(value);return query_string},selectFormSubmit:function(){$("body").on("click",".js-form-submit",function(){var dataForm,dataFor,dataValue;if(dataForm=$(this).attr("data-form"),dataFor=$(this).attr("data-for"),dataValue=$(this).attr("data-value"),$(dataFor).val(dataValue),"#sortForm1"==dataForm||"#sortForm2"==dataForm){var keySort=$(dataFor).attr("name"),keyQ=$(dataForm).find(".hdKeyQ").attr("name"),paramQ=$(dataForm).find(".hdKeyQ").val(),queryString="",urlPathName="";if(-1!=window.location.pathname.indexOf("/")&&window.location.pathname.split("/").length>2){var arrUrl=window.location.pathname.split("/");urlPathName="/"+arrUrl[1]}if(-1!=window.location.pathname.indexOf("/")&&window.location.pathname.split("/").length>=3){var arrUrl=window.location.pathname.split("/");"ma-giam-gia"==arrUrl[1]&&(urlPathName="/"+arrUrl[1]+"/"+arrUrl[2])}if(queryString=void 0!==keyQ&&void 0!==paramQ&&""!=keyQ&&""!=paramQ?(""!=urlPathName?urlPathName:window.location.href.split("?")[0])+paramQ:window.location.pathname,""!=keySort&&""!=dataValue){if(-1!=queryString.indexOf("sort")){var res=queryString.match("sort=[a-zA-Z-]+&?");null!=res&&res[0].endsWith("&")&&(res[0]=res[0].replace("&","")),null!=res&&""!=res&&(queryString=queryString.replace(res[0],"").replace("?&","?").replace("&&","&"))}for(var arrSort="relevance,price-asc,price-desc,bestselling-desc".split(","),preSort="",i=0;i<arrSort.length;i++)-1!=queryString.indexOf(arrSort[i])&&(preSort=arrSort[i]);""!=preSort&&(queryString=queryString.replace(preSort,dataValue)),queryString.endsWith("&&")&&(queryString=queryString.replace("&&","")),queryString.endsWith("?")&&(queryString=queryString.substr(0,queryString.length-1)),-1!=window.location.search.indexOf("orderType=tbk")&&-1==queryString.indexOf("orderType=tbk")&&(queryString+=(-1!=queryString.indexOf("?")?"&":"?")+"orderType=tbk"),queryString+=(-1!=queryString.indexOf("?")?"&":"?")+keySort+"="+dataValue}var paramTracking=ACC.global.parseQueryString(window.location.href);null!=paramTracking&&(paramTracking.startsWith("&")&&-1!=queryString.indexOf("?")?(paramTracking=paramTracking.substring(1),queryString+="&"+paramTracking):paramTracking.startsWith("&")&&-1!=!queryString.indexOf("?")?(paramTracking=paramTracking.substring(1),queryString+="?"+paramTracking):queryString+=paramTracking),window.location.href=queryString}else $(dataForm).submit()})},initActionFooterClickMobile:function(){$(".footer__nav-container .footer__nav-list .title, .footer__credit--title ").prepend('<span class="nav-click"><i class="nav-arrow"></i></span>'),$(window).width()<=1023&&($(document).on("click",".footer__nav-container .footer__nav-list .title",function(e){e.preventDefault();var self=$(this);self.siblings(".footer__nav-links").slideToggle(),self.find(".nav-click").children(".nav-arrow").toggleClass("nav-rotate")}),$(document).on("click",".footer__credit .footer__credit--title",function(e){e.preventDefault();var self=$(this);self.siblings(".footer__credit--content").slideToggle(),self.find(".nav-click").children(".nav-arrow").toggleClass("nav-rotate")}),$(document).on("click",".footer-condition .title",function(e){e.preventDefault();var self=$(this);self.siblings(".footer-condition-content").slideToggle(),self.find(".nav-click").children(".nav-arrow").toggleClass("nav-rotate")}))},initColorboxVideo:function(){$(".js-youtube").colorbox({iframe:!0,innerWidth:640,innerHeight:390})},preventScriptInjection:function(){var $input=$(".js-script-check");$input.on("blur",function(){var v=$(this).val();v=v.replace(/(<([^>]+)>)/gi,""),v=v.replace(/[!@#~_=+;<>,.?$%^&*]/g,""),v=v.replace(/[\])}[{(]/g,""),_.isString(v)&&!_.isFunction(v)&&$(this).val(v)}),$input.on("paste",function(e){e.preventDefault()})},imgLazyLoad:function(){$("img.lazy:not(.lazy-initialized)").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}).addClass("lazy-initialized")},imgLazyLoadTopSearch:function(){$("#top-search-list img.owl-lazy").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"})},imgLazyLoadPlP:function(){$("img.plp-lazy:not(.lazy-initialized)").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}).addClass("lazy-initialized")},imgLazyLoadStopper:function(){$("img.stopper-bottom-lazy:not(.lazy-initialized)").each(function(){if(void 0!=ACC.config.bottomstopperccp){var imgUrl=$(this).attr("data-original");void 0!=imgUrl&&(imgUrl=imgUrl.replace("/sys_master/",ACC.config.bottomstopperccp),$(this).attr("data-original",imgUrl))}}),$("img.stopper-top-lazy:not(.lazy-initialized)").each(function(){if(void 0!=ACC.config.topstopperccp){var imgUrl=$(this).attr("data-original");void 0!=imgUrl&&(imgUrl=imgUrl.replace("/sys_master/",ACC.config.topstopperccp),$(this).attr("data-original",imgUrl))}}),$("img.stopper-top-lazy:not(.lazy-initialized),img.stopper-bottom-lazy:not(.lazy-initialized)").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"}).addClass("lazy-initialized")},imgLazyLoadAjax:function(){$("img.ajax-loading-lazy").lazyload({threshold:200,skip_invisible:!1,effect:"fadeIn"})},ajaxLoadTrigger:function(){$("img.ajax-loading-lazy").load(function(){ACC.requests.RenderAjaxContentOnEvent($(this).data("itemtype"),$(this).data("uid"),$(this).data("data"))})},imgLazyLoadAppendClass:function(){$("img.js-lazy-img-class").each(function(){var uniqueEvent=_.uniqueId("lazyImg_");$(this).lazyload({event:uniqueEvent,threshold:50,skip_invisible:!1}),$(this).trigger(uniqueEvent),$(this).load(function(){var appendClass=$(this).attr("data-append");void 0!=appendClass&&$(this).addClass(appendClass)})})},handleSearchSubmit:function(){var searchEls={form:".js-search-form",input:".js-site-search-input"};$(document).on("submit",searchEls.form,function(e){var v=$(searchEls.input).val();v=ACC.requests.searchPattern(v),$(searchEls.input).val(v),v?$(this).unbind("submit").submit():(e.preventDefault(),setTimeout(function(){$(searchEls.form).find('[type="submit"]').trigger("click")},ACC.requests.timeout))})},lazyLoadVingroupLogo:function(){var niceScrollDivVinLogo=null,hoverButton=$(".popup-vingroup-logo");hoverButton.hover(function(e){var niceScrollOptions={cursorcolor:"#d6d8e0",cursorwidth:"6px",cursorborder:"1px solid #d6d8e0",cursorborderradius:0,cursorfixedheight:208,cursoropacitymax:1,boxzoom:!1,autohidemode:!0,touchbehavior:!0,horizrailenabled:!1};null==niceScrollDivVinLogo?niceScrollDivVinLogo=hoverButton.find(".header-vingroup-container").niceScroll(niceScrollOptions):(niceScrollDivVinLogo.resize(),hoverButton.find(".popup-vingroup-logo .nicescroll-rails").css("display","block"));var headerVingroupLogo=hoverButton.find(".header-vingroup-logo");ACC.global.bindingVingroupLogoHtml(headerVingroupLogo)})},lazyLoadVingroupLogoMobile:function(selector){ACC.global.bindingVingroupLogoHtml($(selector).find(".header-vingroup-logo")),ACC.global.openPopup(selector)},bindingVingroupLogoHtml:function(selector){if(!($.trim(selector.html()).length>0)){var html="",htmlVingroupLogo="";!_.isEmpty(ACC.topVingroupLogos)&&ACC.topVingroupLogos.length>0&&$.each(ACC.topVingroupLogos,function(j,objItem){void 0!==objItem.primary&&objItem.primary?htmlVingroupLogo='<div class="col-xs-4 col-xs-offset-4"><a href="'+objItem.url+'"><img src="'+objItem.image+'" alt="'+objItem.alt+'"></a></div>':html+='<div class="col-xs-4"><a href="'+objItem.url+'"><img src="'+objItem.image+'" alt="'+objItem.alt+'"></a></div>'});var finalHtml="<div class='row row-4'>"+htmlVingroupLogo+"</div><div class='row row-4'>"+html+"</div>";selector.html(finalHtml)}},closeModelDefault:function(){$(".js-back-modal-icon-mobile").on("click",function(){var parent=$(this).parents(".c-modal-box-mobile");parent.addClass("hide"),parent.removeClass("popup-showing"),ACC.global.toggleClassDisableOverflow("popup-open")})},openPopup:function(selector){ACC.global.toggleClassDisableOverflow("popup-open"),$(selector).removeClass("hide"),$(selector).addClass("popup-showing")},closePopup:function(selector){ACC.global.toggleClassDisableOverflow("popup-open"),$(selector).addClass("hide"),$(selector).removeClass("popup-showing")},initEvent:function(){for(var events=["click","focus","change"],i=0;i<events.length;i++){var eventName=events[i];!function(eventName){$(document).on(eventName,"[js-"+eventName+"]",function(event){event.preventDefault();var func=$(this).attr("js-"+eventName);eval(func)})}(eventName)}},notFoundPageAction:function(){$(".section__404 .notfoundPageLink").on("click",function(e){e.preventDefault();var keyword=$("#js-site-search-input").val();$("#js-site-search-input").focus(),"mobile"==ACC.devices.name&&(ACC.global.toggleClassState($(".site-search"),"active"),ACC.global.toggleClassState($(".js-mainHeader .navigation--middle"),"search-open"),$(".site-search").addClass("c-modal-box-mobile js-modal-mobile fixed-search-wap"),ACC.global.toggleClassDisableOverflow("popup-open")),ACC.autocomplete.bindDropdownData(),setTimeout(function(){_.isEmpty(keyword)&&""!=$("#search-history").html()?$("#search-history").removeClass("hide"):""!=$(".ui-autocomplete:not(#search-history)").html()&&$(".ui-autocomplete:not(#search-history)").show()},100)})}},ACC.hopdebug={bindAll:function(){this.bindShowDebugMode()},bindShowDebugMode:function(){$("#hopDebugMode").data("hopDebugMode")||$("#showDebugPage").attr("value")||$("#hostedOrderPagePostForm").submit()}},$(document).ready(function(){ACC.hopdebug.bindAll()}),ACC.imagegallery={_autoload:["bindImageGallery"],bindImageGallery:function(){$(".js-gallery").each(function(){function startZoom(e){$(e).zoom({url:$(e).find("img.lazyOwl").data("zoomImage"),touch:!0,on:"grab",touchduration:300,onZoomIn:function(){},onZoomOut:function(){$image.data("owlCarousel").dragging(!0),$image.data("zoomEnable",!0)},zoomEnableCallBack:function(){var bool=$image.data("zoomEnable"),owl=$image.data("owlCarousel");return 0==bool?owl.dragging(!0):owl.dragging(!1),bool}})}var $image=$(this).find(".js-gallery-image"),$carousel=$(this).find(".js-gallery-carousel");$image.owlCarousel({singleItem:!0,pagination:!0,navigation:!0,lazyLoad:!0,navigationText:["<span class='glyphicon glyphicon-chevron-left'></span>","<span class='glyphicon glyphicon-chevron-right'></span>"],afterAction:function(){ACC.imagegallery.syncPosition($image,$carousel,this.currentItem),$image.data("zoomEnable",!0)},startDragging:function(){$image.data("zoomEnable",!1)},afterLazyLoad:function(e){var b=$image.data("owlCarousel")||{};b.currentItem||(b.currentItem=0),startZoom($($image.find("img.lazyOwl")[b.currentItem]).parent())}}),$carousel.owlCarousel({navigation:!0,navigationText:["<span class='glyphicon glyphicon-chevron-left'></span>","<span class='glyphicon glyphicon-chevron-right'></span>"],pagination:!1,items:2,itemsDesktop:[5e3,7],itemsDesktopSmall:[1200,5],itemsTablet:[768,4],itemsMobile:[480,3],lazyLoad:!0,afterAction:function(){}}),$carousel.on("click","a.item",function(e){e.preventDefault(),$image.trigger("owl.goTo",$(this).parent(".owl-item").data("owlItem"))})})},syncPosition:function($image,$carousel,currentItem){$carousel.trigger("owl.goTo",currentItem)}},ACC.langcurrency={_autoload:["bindLangCurrencySelector"],bindLangCurrencySelector:function(){$("#lang-selector").change(function(){$("#lang-form").submit()}),$("#currency-selector").change(function(){$("#currency-form").submit()})}},ACC.minicart={_autoload:[["bindMiniCart",$(".js-mini-cart-link").length>0]],miniColorbox:"",bindMiniCart:function(){$(document).on("mouseenter",".js-mini-cart-link",function(e){e.preventDefault();$(".isOrder").val();if($(".js-nav-cart").hasClass("is-hover")&&$(window).width()>768){var url=$(this).data("miniCartUrl");ACC.minicart.bindMiniCartData(url)}}),$(document).on("click",".js-mini-cart-link",function(e){$.blockUI()}),$(document).on("mouseover",".js-mini-cart-link",function(e){e.preventDefault()}),$(document).on("mouseenter","js-nav-cart",function(e){e.preventDefault(),$(".js-nav-cart").hasClass("isMouseenter")||$(".js-nav-cart").addClass("isMouseenter")}),$(document).on("click",".js-mini-cart-close-button, .js-mini-cart-off",function(e){var $body=$("body");e.preventDefault(),ACC.colorbox.close(),$body.removeClass("modal-open")}),$(document).on("click",".js-cart-continue-shopping-button",function(e){ACC.isMiniCart&&(ACC.isMiniCart=!1,e.preventDefault(),ACC.colorbox.close())}),$(document).on("click","#js-cart-continue-shopping-button",function(e){ACC.isMiniCart&&(ACC.isMiniCart=!1,e.preventDefault(),ACC.colorbox.close())}),$(document).on("click",".js-remove-entry-button",function(e){e.preventDefault(),$.colorbox.resize()})},showMiniCart:function(url){},bindScrollMinicart:function(){var self=$("#cboxContent").height(),heightpromotion=$(".cart-total__promotion-detail").height(),niceScrollOptions={cursorwidth:"5px",cursorborderradius:"0",cursorborder:"1px solid transparent",cursorcolor:"#cc2023",autohidemode:!1,background:"#d8d8d8",horizrailenabled:!1,railpadding:{top:1,right:1,left:1,bottom:1}};if(self>380){var $cartProductBody=$("#cboxContent .cart-products__body");$cartProductBody.css("max-height","280px"),$cartProductBody.css("margin","15px 0"),$cartProductBody.css("padding","0 15px 0 5px"),$(".miniCartPopup .cart-products__body").niceScroll(niceScrollOptions)}if(heightpromotion>60){var $cartTotalPromotion=$(".cart-total__promotion");$cartTotalPromotion.css("max-height","60px"),$cartTotalPromotion.css("padding","0 15px 0 0px"),$(".miniCartPopup .cart-total__promotion").niceScroll(niceScrollOptions)}},updateMiniCartDisplay:function(){var miniCartRefreshUrl=($(".js-mini-cart-link").data("miniCartItemsText"),$(".js-mini-cart-link").data("miniCartRefreshUrl"));$(".miniCartPopup").height();miniCartRefreshUrl&&$.ajax({url:miniCartRefreshUrl,cache:!1,type:"GET",success:function(jsonData){var miniCartCount=jsonData.miniCartCount;$(".mini-cart-icon .js-cart-total-unit"),$("body"),$(window).width();ACC.minicart.updateMiniCartCount(miniCartCount)}})},updateMiniCart:function(){var cartItems=$(".js-mini-cart-link").data("miniCartItemsText"),miniCartRefreshUrl=$(".js-mini-cart-link").data("miniCartRefreshUrl");miniCartRefreshUrl&&$.ajax({url:miniCartRefreshUrl,cache:!1,type:"GET",success:function(jsonData){(void 0!==vinStorage.getItem("cartCode")&&vinStorage.getItem("cartCode")!=jsonData.code||void 0!==vinStorage.getItem("cartCode")&&vinStorage.getItem("miniCartTotal")!=jsonData.miniCartCount||0==jsonData.hasSessionCart)&&ACC.minicart.clearCartPreview(),void 0!=jsonData.code&&-1!=jsonData.code.indexOf("-temp")&&($(".navigation--middle .js-nav-cart").removeClass("is-hover"),$(".navigation--middle .js-mini-cart-link").addClass("disabled"),$(".js-mini-shopping-cart").empty(),ACC.minicart.clearCartPreview()),$(".js-mini-cart-link .js-mini-cart-count").html('<span class="nav-items-total">'+jsonData.miniCartCount+'<span class="items-desktop hidden-xs hidden-sm"> '+cartItems+"</span></span>");var miniCartCount=jsonData.miniCartCount;ACC.minicart.updateMiniCartCount(miniCartCount)}})},updateMiniCartCount:function(miniCartCount){var $cartTotalUnits=$(".mini-cart-icon .js-cart-total-unit");miniCartCount>0?($(".mini-cart-icon .adr-icon").addClass("icon-cart-full"),$(".mini-cart-icon .adr-icon").removeClass(" icon-cart-2")):($(".mini-cart-icon .adr-icon").removeClass("icon-cart-full"),$(".mini-cart-icon .adr-icon").addClass(" icon-cart-2")),miniCartCount>99&&(miniCartCount="99+"),$cartTotalUnits.length?$cartTotalUnits.html(miniCartCount):$(".mini-cart-icon").append('<span class="mini-cart-price js-cart-total-unit">'+miniCartCount+"</span>")},preventScrollOutside:function(){$(".miniCartPopup .cart-products").on("mousewheel DOMMouseScroll",function(e){var scrollTo=null;"mousewheel"===e.type?scrollTo=-1*e.originalEvent.wheelDelta:"DOMMouseScroll"===e.type&&(scrollTo=40*e.originalEvent.detail),scrollTo&&(e.preventDefault(),$(this).scrollTop(scrollTo+$(this).scrollTop()))})},bindMiniCartData:function(url){vinStorage.getItem("miniCart")&&" "!=vinStorage.getItem("miniCart")?ACC.minicart.binDisplayMiniCart():($(".js-mini-cart-link").css("pointer-events","none"),url+="?recalculation=false",$.ajax({url:url}).done(function(rs){$(".js-mini-cart-link").css("pointer-events",""),vinStorage.setItem("miniCart",rs),ACC.minicart.binDisplayMiniCart()}))},binDisplayMiniCart:function(){vinStorage.getItem("miniCart")&&"undefined"!==vinStorage.getItem("miniCart")&&vinStorage.getItem("miniCart").length>0&&($(".js-mini-shopping-cart").empty(),$(".js-mini-shopping-cart").html(vinStorage.getItem("miniCart")),$(".mini-shopping-cart__content-list").niceScroll({cursorcolor:"#d6d8e0",cursorwidth:"6px",cursorborder:"1px solid #d6d8e0",cursorborderradius:0,cursorfixedheight:208,cursoropacitymax:1,boxzoom:!1,autohidemode:!0,touchbehavior:!0})),vinStorage.getItem("miniCartTotal")&&vinStorage.getItem("miniCartTotal").length>0&&ACC.minicart.updateMiniCartCount(vinStorage.getItem("miniCartTotal"))},dropdownMiniCart:function(url,prdCode){$(window).width()<1023?$.ajax({url:url}).done(function(rs){var minicartUpdate=$(rs);$(".js-mini-shopping-cart").html(rs),$(".js-mini-shopping-cart").empty(),vinStorage.removeItem("miniCart"),$(".js-cart-total-unit").text(vinStorage.getItem("miniCartTotal")>99?"99+":vinStorage.getItem("miniCartTotal")),$(".mini-cart-icon .adr-icon").addClass("icon-cart-full"),$(".mini-cart-icon .adr-icon").removeClass(" icon-cart-2");$("body").find(".m-shopping-cart-preview").remove(),$("body").append('  <div class="m-shopping-cart-preview">\n        <span class="m-shopping-cart__text-success">\n            Sản phẩm đã cho vào giỏ hàng\n        </span>\t\t <ul class="mini-shopping-cart__list-product">\t\t\t<li class="mini-shopping-cart__item-product js-m-mini-cart mini-shopping-cart__item-add-new"></li>\t\t </ul></div>'),minicartUpdate.find("."+prdCode).find(".js-remove-entry-button").text(""),$(".js-m-mini-cart").append(minicartUpdate.find("."+prdCode).html()),$("body").find(".m-shopping-cart-preview").fadeIn(),$(document).on("click",function(e){0===$(e.target).closest(".m-shopping-cart-preview").length&&$(".m-shopping-cart-preview").fadeOut()}),setTimeout(function(){$(".m-shopping-cart-preview").fadeOut()},2e3)}):(url+="&addedProductCode="+prdCode,$.ajax({url:url}).done(function(rs){function miniCartFadeIn(){setTimeout(function(){clearInterval(setNewPrd),$(".js-nav-cart").addClass("active")},48)}function miniCartFadeout(){setTimeout(function(){$(".js-nav-cart").removeClass("active")},2500),setTimeout(function(){$(".js-nav-cart ."+prdCode).removeClass("mini-shopping-cart__item-add-new"),$(".text-add-success-product").remove()},2800)}vinStorage.setItem("miniCart",rs),ACC.minicart.binDisplayMiniCart();var setNewPrd=setInterval(function(){var newPrd=$(".js-nav-cart ."+prdCode);newPrd.hasClass("mini-shopping-cart__item-add-new")||newPrd.addClass("mini-shopping-cart__item-add-new"),$(".text-add-success-product").length<=0&&$(".mini-shopping-cart__content").prepend(' <span class="text-add-success-product">Sản phẩm đã cho vào giỏ hàng</span>')},16);0==$(window).scrollTop()||0==$(".pageType-ProductPage").length?(miniCartFadeIn(),miniCartFadeout(),$.unblockUI()):$("html, body").animate({scrollTop:0},500,function(){miniCartFadeIn(),miniCartFadeout(),$.unblockUI()})}))},moveNewPrdToTop:function(html,prdCode){return _.each($(html),function(el,i){if(_.isElement(el)&&void 0!=el.className&&-1!=el.className.indexOf("mini-shopping-cart__content")){var miniCart=$(el);if(void 0!=miniCart.find("ul")){var listPrd=$(miniCart.find("ul")[0]),newPrd=miniCart.find("."+prdCode),prd=newPrd.wrapAll("<div></div>").parent().html();listPrd.find("."+prdCode).remove(),listPrd.prepend(prd);var content=$(html);content[i]=$.parseHTML(miniCart.wrapAll("<div></div>").parent().html())[0],html=content.wrapAll("<div></div>").parent().html()}}}),html},clearCartPreview:function(){vinStorage.removeItem("miniCart"),
vinStorage.removeItem("miniCartTotal"),vinStorage.removeItem("cartCode")},showWarningMsg:function(){var isOutOfStock=_.find($(".qty-cart-product-box .isOutOfStock"),function(el){if("true"==el.value)return!0}),isNotSupportDelivery=_.find($(".qty-cart-product-box .isNotSupportDelivery"),function(el){if("true"==el.value)return!0});void 0!==isNotSupportDelivery&&"true"==isNotSupportDelivery.value&&($(".cart-page-product__alert .cart-page-product__warning ").removeClass("display-none"),$(".cart-page-product__alert .cart-page-product__warning .alert-not-support-delivery").removeClass("display-none")),void 0!==isOutOfStock&&"true"==isOutOfStock.value&&($(".cart-page-product__alert .cart-page-product__warning ").removeClass("display-none"),$(".cart-page-product__alert .cart-page-product__warning .alert-out-of-stock").removeClass("display-none"))}};var oDoc=document;ACC.navigation={_autoload:[["offcanvasNavigation",$(".js-mainHeader").length>0],["myAccountNavigation",$(".js-mainHeader").length>0],["headerSticky",$(".pageType-ProductPage").length<1&&$(".template-pages-layout-vinInsuranceLandingPageTemplate").length<1&&$(".template-pages-layout-vinInsurancePageTemplate").length<1],["searchBarCategorySelected",$(".js-mainHeader").length>0],["topNavDisplay",$(".js-mainHeader").length>0],["initMainNavigation",$(".menu__cat-list--parent").length>0]],offcanvasNavigation:function(){enquire.register("screen and (max-width:"+screenSmMax+")",{match:function(){$(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub .js_nav__link--drill__down",function(e){e.preventDefault(),$(".js-userAccount-Links").hide(),$(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").addClass("active"),$(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active"),$(this).parent(".js-enquire-has-sub").addClass("active"),ACC.navigation.changeTitleNavigation($(this).attr("title"))}),$(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-sub-close",function(e){e.preventDefault(),$(".js-userAccount-Links").show(),$(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").removeClass("active"),$(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active")}),$(document).on("click",".header-back-icon",function(e){if($(".sub-navigation-list").is(":visible")){var current=$(".sub-navigation-list:visible");$(current).parent().siblings().show(),$(current).hide(),$(".js_nav__link--go-child .title").show(),$(".js-enquire-sub-close").show();var title=$(current).parents(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").find(".js_nav__link--drill__down").attr("title");ACC.navigation.changeTitleNavigation(title)}else $(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").hasClass("active")?(e.preventDefault(),$(".js-userAccount-Links").show(),$(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").removeClass("active"),$(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active"),ACC.navigation.changeTitleNavigation("Danh mục")):(ACC.global.toggleClassState($("main"),"open-menu"),ACC.global.toggleClassState($("html"),"open-menu"),ACC.global.toggleClassState($("body"),"open-menu"),ACC.global.toggleClassState($(".js-enquire-offcanvas-navigation"),"hide"),ACC.global.resetXsSearch(),$("body").toggleClass("show--mobile"),ACC.navigation.changeTitleNavigation("Danh mục"))}),$(document).on("click",".js_nav__link--go-child .title",function(){$(this).hasClass("view-all")||($(this).parent().siblings().hide(),$(this).parent().find(".sub-navigation-list").show(),$(this).hide(),$(".js-enquire-sub-close").hide(),ACC.navigation.changeTitleNavigation($(this).attr("title")))}),$(document).on("click",".js-enquire-go-child-close",function(){$(this).parent().parent().siblings().show(),$(this).parent().hide(),$(".js_nav__link--go-child .title").show(),$(".js-enquire-sub-close").show()})},unmatch:function(){$(".js-userAccount-Links").show(),$(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").removeClass("active"),$(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active"),$(document).off("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub > a"),$(document).off("click",".js-enquire-offcanvas-navigation .js-enquire-sub-close")}})},changeTitleNavigation:function(text){$(".top-menu-mobile-heder-title span").html(text)},myAccountNavigation:function(){$(".js-mobile-logo").html($(".js-site-logo a").clone()),$(".nav-form").html($('<span class="glyphicon glyphicon-list-alt"></span>'));var aAcctData=[],sSignBtn="",oMyAccountData=$(".accNavComponent");$(".js-secondaryNavAccount > ul"),$(".navigation--bottom > ul.nav__links.nav__links--products");if(oMyAccountData)for(var aLinks=oMyAccountData.find("a"),i=0;i<aLinks.length;i++)aAcctData.push({link:aLinks[i].href,text:aLinks[i].title});$(".liOffcanvas a")&&$(".liOffcanvas a").length>0&&(sSignBtn+='<li class="auto liUserSign" ><a class="userSign" href="'+$(".liOffcanvas a")[0].href+'"><i class="adr-icon icon-account"></i><div class="clearfix"></div><span class="js-sign-in__popup">Đăng nhập</span> / <span class="js-sign-up__popup_button">Đăng ký</span></a></li>');var oUserInfo=$(".nav__right ul li.logged_in");if(oUserInfo&&1===oUserInfo.length){var sUserBtn="";sUserBtn+='<li class="auto ">',sUserBtn+='<div class="userGroup">',sUserBtn+='<span class="glyphicon glyphicon-user myAcctUserIcon"></span>',sUserBtn+='<div class="userName">'+oUserInfo[0].innerHTML+"</div>",aAcctData.length>0&&(sUserBtn+='<a class="collapsed js-nav-collapse" id="signedInUserOptionsToggle" data-toggle="collapse"  data-target=".offcanvasGroup1">',sUserBtn+='<span class="glyphicon glyphicon-chevron-up myAcctExp"></span>',sUserBtn+="</a>"),sUserBtn+="</div>",sUserBtn+="",$(".js-sticky-user-group").html(sUserBtn),$(".js-userAccount-Links").append(sSignBtn),$(".js-userAccount-Links").append($('<li class="auto"><div class="myAccountLinksContainer js-myAccountLinksContainer"></div></li>'));var myAccountHook=$('<a class="myAccountLinksHeader collapsed js-myAccount-toggle" data-toggle="collapse" data-parent=".nav__right" href="#accNavComponentDesktopOne">'+oMyAccountData.data("title")+"</a>");myAccountHook.insertBefore(oMyAccountData);var myAccountHook=[];myAccountHook.push('<div class="sub-nav">'),myAccountHook.push('<a id="signedInUserAccountToggle" class="myAccountLinksHeader collapsed js-myAccount-toggle" data-toggle="collapse" data-target=".offcanvasGroup2">'),myAccountHook.push(oMyAccountData.data("title")),myAccountHook.push('<span class="glyphicon glyphicon-chevron-down myAcctExp"></span>'),myAccountHook.push("</a>"),myAccountHook.push("</div>"),$(".js-myAccountLinksContainer").append(myAccountHook.join("")),$(".js-myAccountLinksContainer").append($('<ul data-trigger="#signedInUserAccountToggle" class="offcanvasGroup2 offcanvasNoBorder collapse js-nav-collapse-body subNavList js-myAccount-root sub-nav"></ul>'));for(var i=aAcctData.length-1;i>=0;i--){var oLink=oDoc.createElement("a");oLink.title=aAcctData[i].text,oLink.href=aAcctData[i].link,oLink.innerHTML=aAcctData[i].text;var oListItem=oDoc.createElement("li");oListItem.appendChild(oLink),oListItem=$(oListItem),oListItem.addClass("auto "),$(".js-myAccount-root").append(oListItem)}}else{var navButtons=sSignBtn.substring(0,sSignBtn.length-5)+"</li>";$(".js-sticky-user-group").html(navButtons)}},headerSticky:function(){if($("header .navigation--middle").length>0){var height=$("header .navigation--middle").height(),count=($(".product-list__header"),$("header .navigation--middle").offset().top,$(".navigation--middle .container > .row").length);window.matchMedia("(max-width: 1023px)").matches&&count>1?$(".navigation--middle .row:first-child").sticky({topSpacing:0}):$(".navigation--middle").sticky({topSpacing:0});try{var prevScrollpos=window.pageYOffset,$header_navigationMiddle=$("header .navigation--middle"),$resetPaddingMobile=$(".reset-padding-moblie"),$vinHeader_filterBarSticky=$(".vinheader-filterbarsticky");window.onscroll=function(){var currentScrollPos=window.pageYOffset;height=$header_navigationMiddle.height(),prevScrollpos>currentScrollPos?$resetPaddingMobile.length>0&&($resetPaddingMobile.offset().top>currentScrollPos?$vinHeader_filterBarSticky.removeClass("show").addClass("hide"):$vinHeader_filterBarSticky.removeClass("hide").addClass("show")):$vinHeader_filterBarSticky.removeClass("show").addClass("hide"),prevScrollpos=currentScrollPos}}catch(err){}}},searchBarCategorySelected:function(){$(document).on("click",".js-select-category .dropdown-menu a",function(){var content=$(this).text(),value=$(this).attr("data-value");$(".js-select-category .category-selected").html(content),$(".js-select-category .input-selected").val(value)}),$(document).on("mouseleave",".dropdown-menu ",function(){$(this).parent(this).removeClass("open")})},topNavDisplay:function(){ACC.navigation.topNavChecking(),$(window).bind("resize",function(){$(".top_nav-item").removeClass("hidden"),ACC.navigation.topNavChecking()})},topNavChecking:function(){var allLevels,maxLevels,allSelectors;if(allLevels=[],allSelectors={},$(".top_nav-item").length<1?$(".section__sale").addClass("hidden"):$(".section__sale").removeClass("hidden"),$(".top_nav-item:visible").each(function(){var key=$(this).attr("data-level");allLevels.push($(this).attr("data-level")),allSelectors[key]={level:$(this).attr("data-level"),order:$(this).attr("data-order"),priority:$(this).attr("data-priority")},maxLevels=Math.max.apply(Math,allLevels)}),$(".js-top-nav").height()>36)return $('.top_nav-item[data-level="'+maxLevels+'"]:visible:last').addClass("hidden"),ACC.navigation.topNavChecking();$(".js-top-nav").removeClass("disabled")},initMainNavigation:function(){var $menuCatParent,menuState={};$menuCatParent=$(".menu__cat-list--parent"),$(".menu__cat-list--parent a.menu__cat-link"),$(".menu__cat-list--child"),menuState={normal:function(){$(".feature__sec.feature__sec-banner").removeClass("hidden"),$(".feature__sec.feature__sec-cat").addClass("hidden")},hover:function(imgCatList,menuid){$(".feature__sec.feature__sec-banner").addClass("hidden"),$(".feature__sec.feature__sec-cat:not(."+menuid+")").addClass("hidden");$(".feature__sec.feature__sec-cat."+menuid).length<=0&&$(".feature__sec-cat.fe-sec-original").clone().addClass(menuid).removeClass("fe-sec-original").appendTo(".feature__sec-container"),$(".feature__sec.feature__sec-cat."+menuid).removeClass("hidden")}},$menuCatParent.menuAim({activate:function(row){var $row=$(row);$row.addClass("is-active");var menuId=$row.attr("id");ACC.helpers.buildHomeItemMegaMenu(menuId)},deactivate:function(row){$(row).removeClass("is-active"),menuState.normal()}}),$(document).mousemove(function(event){$(event.target).closest(".menu__cat,.menu__cat *").length||$(event.target).closest(".feature__sec,.feature__sec *").length||(menuState.normal(),$(".menu__cat-list--parent").find(".is-active").removeClass("is-active"))}),$('[data-toggle="hover"]').each(function(){var divTarget,ootb;divTarget=$(this).attr("data-target"),ootb='[data-toggle="hover"][data-target="'+divTarget+'"], '+divTarget+", "+divTarget+" *",$(divTarget).length>0&&$(this).mouseover(function(){$(divTarget).removeClass("hidden")}),$(document).mousemove(function(event){$(event.target).closest(ootb).length||$(divTarget).addClass("hidden")})})},mainNavHandle:{request:function(){$(document).on("mouseover",".menu__cat-list a.menu__cat-link",function(){var $this,ajaxUrl,cached,res;return $this=$(this),res=$.Deferred(),ajaxUrl=$this.attr("data-url"),cached=ACC.requests.getLocalCache(ajaxUrl),null!==cached&&cached.length>0?res.resolve(JSON.parse(cached)):(res=$.get(ajaxUrl),res.done(function(menus){ACC.requests.setLocalCache(ajaxUrl,menus)})),res.done(function(menus){var $menuCatChild=$(".menu__cat-list.menu__cat-list--child"),html=ACC.navigation.mainNavHandle.render(menus);$menuCatChild.html(html)}),res})},render:function(menus){var menuHtml="";return _.isEmpty(menus)||(menuHtml+='<h3 class="text-uppercase">vinpear giá mới</h3>',menuHtml+="<hr>",_.each(menus,function(menu){menuHtml+='<p><a href="#'+menu.uid+'">'+menu.name+"</a></p>",menu.hasChildren&&(menuHtml+="<ul>",_.each(menu.entries,function(entry){menuHtml+='<li><a href="#'+entry.itemId+'">'+entry.itemName+"</a></li>"}),menuHtml+="</ul>")}),menuHtml+='<a href="#" class="menu__cat-link--all">Tất cả danh mục »</a>'),menuHtml}}},ACC.order={_autoload:["backToOrderHistory","bindMultidProduct","previewOrderModification","orderCancelPopup","confirmCancel","customerOrderCancelPopup","customerConfirmCancel","partialCancelConfirm","confirmOrderModification","confirmNotifyDeliveryTimeChanged","confirmCancelNotifyDeliveryTimeChanged","cancel","initUpdateOrderStatus","bindShowRefundRequestPopup","bindCloseRefundRequestPopup","showRefundRequestPopupAuto","init"],init:function(){var cc=ACC.order.getQueryVariable("cc");"true"==cc&&($("#modal-success-cancel-order").on("hidden.bs.modal",function(){ACC.order.processUrl()}).modal("show"),$("#modal-unsuccess-cancel-order").modal("hide"),$("#modal-notify-cancel-order").modal("hide")),"false"==cc&&($("#modal-success-cancel-order").modal("hide"),$("#modal-unsuccess-cancel-order").on("hidden.bs.modal",function(){ACC.order.processUrl()}).modal("show"),$("#modal-notify-cancel-order").modal("hide")),"not"==cc&&($("#modal-success-cancel-order").modal("hide"),$("#modal-unsuccess-cancel-order").modal("hide"),$("#modal-notify-cancel-order").on("hidden.bs.modal",function(){ACC.order.processUrl()}).modal("show")),$(document).on("click",".showMultiDGridInOrderOverlay",function(event){ACC.multidgrid.populateAndShowGridOverlay(this,event)});var isOrder=$(".isOrder").val(),isASM=$(".isASM").val();"true"==isOrder&&"true"==isASM&&($(".navigation--middle .js-nav-cart").removeClass("is-hover"),$(".navigation--middle .js-mini-cart-link").addClass("disabled"),$(".js-mini-shopping-cart").empty(),delete localStorage.miniCart)},initUpdateOrderStatus:function(){$(".js-order-modification").length>0&&(ACC.order._reloadOrderInterval=window.setInterval(this.updateOrderStatus,1e4))},backToOrderHistory:function(){$(".orderBackBtn > button").on("click",function(){var sUrl=$(this).data("backToOrders");window.location=sUrl})},bindMultidProduct:function(){$(document).on("click",".js-show-multiD-grid-in-order",function(event){return ACC.multidgrid.populateAndShowGrid(this,event,!0),!1}),$(document).on("click",".showMultiDGridInOrderOverlay",function(event){ACC.multidgrid.populateAndShowGridOverlay(this,event)})},previewOrderModificationRequest:function(previewParam){var $loader=($.Deferred(),$(".js #loader")),confirm=0;"false"==$(".js-preview-order-popup").attr("data-from-preview")&&(confirm=1),$.ajax({type:"POST",url:ACC.config.encodedContextPath+"/my-account/edit/preview?confirm="+confirm,data:$("#vinCheckoutAddressForm").serialize()+previewParam,beforeSend:function(){$("#loader").css({display:"block"}).removeClass("hidden")},complete:function(){$("#loader").css({display:"none"}).addClass("hidden")},success:function(response){if($(".js-confirm-section").html(""),$loader.css({display:"none"}),response.hasError){var addAddressCodeBtn=$("input[name='shippingAddressCode']:checked"),form=addAddressCodeBtn.parents("li").find(".checkout-receiver-address__form"),encoded=$("<div></div>").html(response.cartData.deliveryInformation).text();$(form).html(encoded),ACC.checkout.initCheckoutAddress(),response.isShippingAddressVinhomes&&(ACC.selectize.init(".checkout-address-vinhomes"),ACC.selectize.init(".checkout-address-houseblock"))}else{var htmlPopup="";if(response.warningInstallment)htmlPopup=$("<div></div>").html(response.warningInstallmentView).text();else{htmlPopup="<h1>Delivery time changing notification</h1>";response.showPopup?htmlCartShipments=$("<div id='fakeID1'></div>").html(ACC.order.renderPreviewOrderModification(response.cartShipments)).text():htmlCartShipments=$("<div id='fakeID2'></div>").html(ACC.order.renderPreviewOrderModification(response.notification)).text(),htmlPopup=htmlCartShipments;var htmlDeliveryInformation=$("<div></div>").html(response.deliveryInformation).text();$("#deliveryInformation").html(htmlDeliveryInformation);var htmlCheckoutInformation=$("<div></div>").html(response.checkoutSummaryInformation).text();$("#checkoutSummaryInformation1").html(htmlCheckoutInformation)}$.colorbox({html:htmlPopup,width:"870px",onComplete:function(){$loader.css({display:"none"})},onClosed:function(){(0==confirm||void 0!==response.hasCartError&&response.hasCartError)&&location.reload()}})}}})},updateOrderStatus:function(){var orderCode=$("#order-code").text();"true"==$("#order-info").attr("need-to-reload")&&$.ajax({type:"GET",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/my-account/edit/orderdata/"+orderCode,success:function(response){$("#order-info").attr("need-to-reload",response.needToReload),$("#order-status").text(response.originalStatus);var encoded=$("<div></div>").html(response.orderAmount).text();$("#order-amount").html(encoded);for(var key in response.consignmentStatus)if(response.consignmentStatus.hasOwnProperty(key)){var val=response.consignmentStatus[key];$("#"+key).text(val)}}})},previewOrderModification:function(){$(document).on("click",".js-preview-order-popup",function(){$(this).attr("data-order-code");$(".js #loader").css({display:"block",opacity:"0.5"}),$(".required-field-error").length>0||($(".js-preview-order-popup").attr("data-from-preview",!0),ACC.order.previewOrderModificationRequest(""))}),ACC.order.previewOrderModificationConfirmWarningInstallment()},previewOrderModificationConfirmWarningInstallment:function(){$(document).on("click",".js-accept-warning-installment-popup",function(){ACC.order.previewOrderModificationRequest("&acceptWarning=true")})},renderPreviewOrderModification:function(data){var markupArg=data.split("|"),markup="";markup+="<ul>";for(var i in markupArg)markup+="<li>"+markupArg[i]+"</li>";return markup+="</ul>"},orderCancelPopup:function(data){$(document).on("click",".js-cancel-order-popup",function(){var orderCode=$(this).data("order-code");$.ajax({type:"GET",url:ACC.config.encodedContextPath+"/my-account/edit/"+orderCode+"/cancelorder/request",success:function(cancellationHtml){$.colorbox({html:cancellationHtml,title:!1,onComplete:function(){$("#cboxTitle, #cboxCurrent").hide()}})}})})},customerOrderCancelPopup:function(){var _this=this;$(document).on("click",".js-customer-cancel-order-popup",function(){clearTimeout(_this._timeout),_this._timeout=setTimeout(function(){$("#loader").css({display:"block"}).removeClass("hidden")},200);var orderCode=$(this).data("order-code");$.ajax({type:"GET",url:ACC.config.encodedContextPath+"/my-account/edit/"+orderCode+"/customercancelorder/request",success:function(cancellationHtml){clearTimeout(_this._timeout),$("#loader").css({display:"none"}).addClass("hidden");var $modal=$("#modal-order-cancellation");$modal.find(".modal-body").html(cancellationHtml),$modal.find(".js-selectize").on("change",function(){_this.checkValidation()}).selectize(),$modal.find('input[name="confirm"]').on("change",function(){_this.checkValidation()}),$modal.modal()},error:function(){clearTimeout(_this._timeout),$("#loader").css({display:"none"}).addClass("hidden")}})})},checkValidation:function(){var canceltable=$("#cancel-order-table"),cancelReason=canceltable.find('select[name="cancel_reason"]').val(),confirm=canceltable.find('input[name="confirm"]').is(":checked");cancelReason&&confirm?$(".js-customer-confirm-cancel").removeClass("disabled"):$(".js-customer-confirm-cancel").addClass("disabled")},confirmCancel:function(data){$(document).on("click",".js-confirm-cancel",function(){$(this).attr("disabled",!0);var orderCode=$(this).data("order-code"),canceltable=$("#cancel-order-table"),cancelData={entry:{cancelReason:canceltable.find('select[name="cancel_reason"]').val(),comment:canceltable.find('input[name="comment"]').val()}};$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/my-account/edit/"+orderCode+"/cancelorder/confirm?CSRFToken="+ACC.config.CSRFToken,data:JSON.stringify(cancelData),success:function(data){ACC.order.processCancleOrderFlow(data)},done:function(data){$(this).attr("disabled",!1)}})})},customerConfirmCancel:function(data){var _this=this;$(document).on("click",".js-customer-confirm-cancel",function(){var canceltable=$("#cancel-order-table"),orderCode=$(this).data("order-code"),cancelData={entry:{cancelReason:canceltable.find('select[name="cancel_reason"]').val(),comment:canceltable.find('input[name="comment"]').val()}};if(!cancelData.entry.cancelReason)return!1;clearTimeout(_this._timeout),_this._timeout=setTimeout(function(){$("#loader").css({display:"block"}).removeClass("hidden")},200),$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/my-account/edit/"+orderCode+"/customercancelorder/confirm?CSRFToken="+ACC.config.CSRFToken,data:JSON.stringify(cancelData),success:function(data){clearTimeout(_this._timeout),$("#loader").css({display:"none"}).addClass("hidden"),ACC.order.processCustomerCancleOrderFlow(data)},error:function(){clearTimeout(_this._timeout),$("#loader").css({display:"none"}).addClass("hidden")}})})},cancel:function(data){$(document).on("click",".js-cancel",function(){$.colorbox.close()})},partialCancelConfirm:function(data){$(document).on("click",".js-confirm-entry-cancel",function(){var cancelData={},orderCode=$(this).data("order-code");cancelData.entries=[];var isQuantityByZero=!1;$("#cancel-product-collapse-"+$(this).data("consignment-entry")).find("tr.consigment-entry").each(function(entry){var quantity=$(this).find('input[name="quantity"]').val();if(""!=quantity&&0==Number(quantity))return isQuantityByZero=!0,$(this).find('input[name="comment"]').val(""),$(this).find('input[name="quantity"]').val(""),!1;cancelData.entries.push({consignmentEntryPk:$(this).data("pk"),cancelReason:$(this).find('select[name="cancel_reason"]').val(),quantity:Number(quantity),comment:$(this).find('input[name="comment"]').val()})}),isQuantityByZero||$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/my-account/edit/"+orderCode+"/cancelpartialentry/confirm?CSRFToken="+ACC.config.CSRFToken,data:JSON.stringify(cancelData),success:function(cancellationHtml){location.reload()}})})},confirmOrderModification:function(){$(document).on("click",".confirm-btn",function(){$(".required-field-error").length>0||($(".js-preview-order-popup").attr("data-from-preview",!1),$("#loader").css({display:"block"}).removeClass("hidden"),ACC.order.previewOrderModificationRequest(""))}),$(document).on("click",".btn-confirm-change",function(e){$.fn.colorbox.close();var res=$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/my-account/edit/"+$(".confirm-btn").attr("data-order-code")+"/checkIfDeliveryTimeChanged"});res.fail(function(response){console.log("Checking delivery time failed")}),res.done(function(response){if(response.changedDeliveryTime&&ACC.order.validateReasonInformMethod())$("#modalConfirmDeliveryTime").modal("show");else{console.log("Checking delivery time unsuccess");var href=ACC.config.encodedContextPath+"/my-account/edit/"+$(".confirm-btn").attr("data-order-code")+"/confirm?notifyDeliveryTimeChanged=false";window.location.href=href}$("#loader").css({display:"none"}).addClass("hidden")})}),$(document).on("click",".btn-not-change",function(){return $.fn.colorbox.close(),!1})},confirmNotifyDeliveryTimeChanged:function(){$(document).on("click",".js-notify-delivery-time-submit",function(){var href=ACC.config.encodedContextPath+"/my-account/edit/"+$(this).attr("data-order-code")+"/confirm?notifyDeliveryTimeChanged=true";window.location.href=href})},confirmCancelNotifyDeliveryTimeChanged:function(){$(document).on("click",".js-notify-delivery-time-cancel",function(){var href=ACC.config.encodedContextPath+"/my-account/edit/"+$(this).attr("data-order-code")+"/confirm?notifyDeliveryTimeChanged=false";window.location.href=href})},validateReasonInformMethod:function(){var allowShowingPopup=!1;return $("#deliveryInformation #rescheduleReasonOpt option:selected").each(function(index){if("EMAIL"===$(this).attr("data-inform-method")||"SMS"===$(this).attr("data-inform-method")||"BOTH"===$(this).attr("data-inform-method"))return allowShowingPopup=!0,!1}),allowShowingPopup},bindShowRefundRequestPopup:function(){$("#refundRequestContent").length>0&&($("#refundRequest-section").on("show.bs.modal",function(e){clearInterval(ACC.order._reloadOrderInterval)}),$(document).on("click","#btn_refundRequests",function(){clearInterval(ACC.order._reloadOrderInterval)}))},bindCloseRefundRequestPopup:function(){$("#refundRequestContent").length>0&&$("#refundRequest-section").on("hide.bs.modal",function(e){ACC.order.initUpdateOrderStatus()})},showRefundRequestPopupAuto:function(){$("#showRefundPopup").length>0&&$("#refundRequestContent").length>0&&window.setInterval(this.getRefundList,1e4)},getRefundList:function(){var orderCode=$("#order-code").text();"true"==$("#showRefundPopup").attr("need-to-reload")&&$.ajax({type:"GET",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/my-account/edit/"+orderCode+"/getRefundList",success:function(response){if(response.needToBeReload||$("#showRefundPopup").attr("need-to-reload",!1),response.showPopUp){var encoded=$("<div></div>").html(response.refundList).text();$("#refundRequest-section .modal-body").html(encoded),$("#refundRequest-section").modal("show")}}})},processCancleOrderFlow:function(data){var url=window.location.href+"?cancelled=true";if(null!=data&&1==data.refundPossible)console.log("refundPossible: "+data.refundPossible),setTimeout(function(){window.location.href=url},3e3);else if(null!=data&&1==data.dataTelecom){var htmlPopup=$("<div></div>").html(data.dataHtml).text();$.colorbox({html:htmlPopup,title:!1,onComplete:function(){$("#cboxTitle, #cboxCurrent").hide()}})}else window.location.href=url},processCustomerCancleOrderFlow:function(data){var url=window.location.href+"?cc=true";window.location.href=url},processUrl:function(){window.location.href.indexOf("?")>-1&&history.pushState("",document.title,window.location.pathname)},getQueryVariable:function(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(decodeURIComponent(pair[0])==variable)return decodeURIComponent(pair[1])}},getHouseBlock:function(data){$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.houseBlock+"?vhCode="+data.vhVinhomesInfo,success:function(response){null!=response?ACC.checkout.bindingCheckoutVinhomesAddress("#vinhomesAddressShipping\\.vhHouseBlock",response,data):ACC.checkout.bindingCheckoutVinhomesAddress("#vinhomesAddressShipping\\.vhHouseBlock",[],data)},error:function(xhr,ajaxOptions,thrownError){ACC.checkout.bindingCheckoutVinhomesAddress("#vinhomesAddressShipping\\.vhHouseBlock",[],data)}})}},ACC.paginationsort={downUpKeysPressed:!1,bindAll:function(){this.bindPaginationSort(),this.showSelectSortText()},showSelectSortText:function(){var text=$(".js-product-list__order").find(".dropdown-menu .js-form-submit.selected").text();text&&$(".js-product-list__order").find(".dropdown-toggle_text").html(text)},bindPaginationSort:function(){with(ACC.paginationsort)bindSortForm($("#sortForm1")),bindSortForm($("#sortForm2"))},bindSortForm:function(sortForm){sortForm.change(function(){ACC.paginationsort.downUpPressed||this.submit(),ACC.paginationsort.downUpPressed=!1})},sortFormIEFix:function(sortOptions,selectedOption){sortOptions.keydown(function(e){38===e.keyCode||40===e.keyCode?ACC.paginationsort.downUpPressed=!0:13===e.keyCode&&selectedOption!==$(this).val()?$(this).parent().submit():ACC.paginationsort.downUpPressed=!1})}},$(document).ready(function(){ACC.paginationsort.bindAll()}),ACC.payment={activateSavedPaymentButton:function(){$(document).on("click",".js-saved-payments",function(e){e.preventDefault();var title=$("#savedpaymentstitle").html();$.colorbox({href:"#savedpaymentsbody",inline:!0,maxWidth:"100%",opacity:.7,width:"320px",title:title,close:'<span class="glyphicon glyphicon-remove"></span>',onComplete:function(){}})})},bindPaymentCardTypeSelect:function(){ACC.payment.filterCardInformationDisplayed(),$("#card_cardType").change(function(){"024"==$(this).val()?$("#startDate, #issueNum").show():$("#startDate, #issueNum").hide()})},filterCardInformationDisplayed:function(){"024"==$("#card_cardType").val()?$("#startDate, #issueNum").show():$("#startDate, #issueNum").hide()}},$(document).ready(function(){with(ACC.payment)activateSavedPaymentButton(),bindPaymentCardTypeSelect()}),ACC.paymentDetails={_autoload:["showRemovePaymentDetailsConfirmation","updateDefaultPaymentModes","expiredCardPayment"],showRemovePaymentDetailsConfirmation:function(){$(document).on("click",".js-delete-payment-method",function(){var modalId,paymentId;if(modalId=$(this).attr("data-modal-id"),paymentId=$(this).attr("data-payment-id"),$(this).attr("data-popup-title"),_.isEmpty(paymentId))return void console.log("No Payment ID");$('#removePaymentDetails input[name="paymentInfoId"]').val(paymentId),$(modalId).modal("show")})},updateDefaultPaymentModes:function(){$(document).on("click",".js-set-default-payment-method",function(){var defaultPaymentMode,defaultPaymentId,url;if(defaultPaymentMode=$(this).attr("data-default-payment-mode"),defaultPaymentId=$(this).attr("data-default-payment-id"),url="/my-account/set-default-payment-method",_.isEmpty(defaultPaymentMode))return void console.log("No Payment mode");$(this).parents(".profile-payment-methods__default");$("#loader").css({display:"block"}).removeClass("hidden"),$.ajax({url:url,type:"POST",data:{paymentModeCode:defaultPaymentMode,paymentInfoId:defaultPaymentId},success:function(data){$("#loader").css({display:"none"}).addClass("hidden"),data&&window.location.replace("/my-account/payment-details")}})})},expiredCardPayment:function(){$(document).on("click",".js-expired-card",function(){var expiredPaymentMode,expiredPaymentId,url;if(expiredPaymentMode=$(this).attr("data-expired-payment-mode"),expiredPaymentId=$(this).attr("data-expired-id"),url="/my-account/expired-card-payment-method",_.isEmpty(expiredPaymentId))return void console.log("No Payment mode");var that=$(this).parents(".profile-payment-methods__list--item");that.find(".visa-card-text-extend").hide(),$("#loader").css({display:"block"}).removeClass("hidden"),$.ajax({url:url,type:"POST",data:{paymentModeCode:expiredPaymentMode,paymentInfoId:expiredPaymentId},success:function(data){$("#loader").css({display:"none"}).addClass("hidden"),data?window.location.replace("/my-account/payment-details"):that.find(".visa-card-text-note").show()},error:function(){$("#loader").css({display:"none"}).addClass("hidden")}})})}},ACC.product={_autoload:["bindToAddToCartForm","enableStorePickupButton","enableVariantSelectors","bindFacets","bindOneClickButton","bindRemoveViewedProduct","buildProductList",["bindReviewAjax",$(".js-review-submit").length>0],"confirmOrderModificationOnlyPrepaid","bindTogetherViewedProduct","bindRelatedDeal","changeQuantity","toggleDropdown","bindQuickButtonClick"],toggleDropdown:function(){$(".js-dropdown-tag").on("mouseenter",function(){$(this).find(".tooltip-content").removeClass("hide")}),$(".js-dropdown-tag").on("mouseleave",function(){$(this).find(".tooltip-content").addClass("hide")}),$(".tooltip-content").on("mouseenter",function(){$(this).removeClass("hide")}),$(".tooltip-content").on("mouseleave",function(){$(this).removeClass("hide")}),$(".js-dropdown-tag").on("touchstart",function(){$(this).find(".tooltip-content").toggleClass("hide")})},changeQuantity:function(){var _qty_selector_input=$(".js-qty-selector-input"),_cart_product_qty_input=$(".js-cart-product-qty-input-quantity"),max_quantity=_cart_product_qty_input.data("max"),min_quantity=_cart_product_qty_input.data("min")
;$(".js-cart-product-decrease-quantity").addClass("disabled"),$(".js-cart-product-increase-quantity").on("click",function(){var _this=$(this),_quantity_input=_this.siblings(".js-cart-product-qty-input-quantity");handle_change_quantity(_this,_quantity_input,_cart_product_qty_input,min_quantity,max_quantity,!0)}),$(".js-cart-product-decrease-quantity").on("click",function(){var _this=$(this),_quantity_input=_this.siblings(".js-cart-product-qty-input-quantity");handle_change_quantity(_this,_quantity_input,_cart_product_qty_input,min_quantity,max_quantity,!1)}),_cart_product_qty_input.on("input",function(){$(this).val()>=min_quantity&&$(this).val()<=max_quantity&&($(".js-cart-product-increase-quantity").removeClass("disabled"),$(".js-cart-product-decrease-quantity").removeClass("disabled")),_qty_selector_input.val($(this).val()),0===$(this).val().length&&(_qty_selector_input.val(1),$(".js-cart-product-decrease-quantity").addClass("disabled")),_cart_product_qty_input.blur(function(){0===$(this).val().length&&(_cart_product_qty_input.val(1),_qty_selector_input.val(1))}),1===parseInt($(this).val(),10)&&$(".js-cart-product-decrease-quantity").addClass("disabled"),parseInt($(this).val(),10)>=1e3&&(_qty_selector_input.val(1e3),setTimeout(function(){_cart_product_qty_input.val(1e3)},300))});var handle_change_quantity=function(_trigger,_quantity_input,_cart_product_qty_input,min_quantity,max_quantity,is_increase){var current_quantity=_quantity_input.val();is_increase&&current_quantity<max_quantity&&current_quantity++,!is_increase&&current_quantity>min_quantity&&current_quantity--,(current_quantity<=min_quantity||current_quantity>=max_quantity)&&handle_change_button_state(_trigger),current_quantity>min_quantity&&current_quantity<max_quantity&&($(".js-cart-product-increase-quantity").removeClass("disabled"),$(".js-cart-product-decrease-quantity").removeClass("disabled")),_quantity_input.val(current_quantity),_qty_selector_input.val(current_quantity)},handle_change_button_state=function(_trigger_button){_trigger_button.addClass("disabled")}},bindFacets:function(){$(document).on("click",".js-show-facets",function(e){e.preventDefault();var selectRefinementsTitle=$(this).data("selectRefinementsTitle");ACC.colorbox.open(selectRefinementsTitle,{href:".js-product-facet",inline:!0,width:"480px",onComplete:function(){$(document).on("click",".js-product-facet .js-facet-name",function(e){e.preventDefault(),$(".js-product-facet  .js-facet").removeClass("active"),$(this).parents(".js-facet").addClass("active"),$.colorbox.resize()})},onClosed:function(){$(document).off("click",".js-product-facet .js-facet-name")}})})},enableAddToCartButton:function(){$(".js-enable-btn").each(function(){$(this).hasClass("outOfStock")||$(this).hasClass("out-of-stock")||$(this).removeAttr("disabled")})},enableVariantSelectors:function(){$(".variant-select").removeAttr("disabled")},bindToAddToCartForm:function(){var $addToCart=$("#addToCartButton, .btn-add-to-cart");$(document).on("submit",".add_to_cart_form",function(e){e.preventDefault()}),$(document).on("click","#sticky_add_to_cart",function(){$.blockUI(),$("#sticky_add_to_cart").attr("disabled","disabled"),$(".add_to_cart_form").eq(0).ajaxSubmit({success:ACC.product.processAddToCartSuccess}),e.preventDefault()}),$addToCart.on("click",function(e){if($.blockUI(),$("#addToCartButton, .btn-add-to-cart").attr("disabled","disabled"),$("#modal-quick-view").length>0&&$("#modal-quick-view").modal("hide"),void 0!==window.hasOfferOutOfArea&&"true"===window.hasOfferOutOfArea)$.unblockUI(),$("#hasOfferOutOfAreaModel").modal("show"),$(".na__location__modal .na__location__modal--backbtn").click(function(){$("body").removeClass("modal-open")}),$("#addToCartButton, .btn-add-to-cart").removeAttr("disabled");else{$(this).parent().ajaxSubmit({success:ACC.product.processAddToCartSuccess}),e.preventDefault()}})},processAddToCartSuccess:function(cartResult,statusText,xhr,formElement){var showCart=!1,allowRedirect=ACC.cartASM.allowRedirect;(""===allowRedirect||"false"===allowRedirect||cartResult.hasError||cartResult.modifyOrderWithOnlyPrepaid)&&(showCart=!0),showCart?(ACC.product.displayAddToCartPopup(cartResult,statusText,xhr,formElement),$.unblockUI(),$("#addToCartButton, .btn-add-to-cart, #sticky_add_to_cart").removeAttr("disabled")):(delete localStorage.miniCart,delete localStorage.miniCartTotal,window.location.href=ACC.config.contextPath+cartResult);var cartNumber="";if(null!=cartResult&&void 0!=cartResult&&null!=cartResult.cartAnalyticsData&&void 0!=cartResult.cartAnalyticsData&&(cartNumber=cartResult.cartAnalyticsData.cartCode),"undefined"!=typeof gtmAddToCart&&"function"==typeof gtmAddToCart){var quantity=$("#pdpAddtoCartSelect").val();void 0!==quantity&&gtmAddToCart(quantity,cartNumber)}},bindOneClickButton:function(){$(document).on("click","#btn-1click-checkout",function(e){$.blockUI(),void 0!==window.hasOfferOutOfArea&&"true"===window.hasOfferOutOfArea?($.unblockUI(),$("#hasOfferOutOfAreaModel").modal("show"),$(".na__location__modal .na__location__modal--backbtn").click(function(){$("body").removeClass("modal-open")})):($("#btn-1click-checkout").attr("disabled","disabled"),$(".d-button--buy-now").attr("disabled","disabled"),ACC.product.redirectToConfirmationPage(),ACC.track.gtmBuyNowCheckout("productBuyFast"))}),$(document).on("click","#btn-1click-checkout-sticky-header",function(e){$(this).hasClass("has-variants")||($.blockUI(),void 0!==window.hasOfferOutOfArea&&"true"===window.hasOfferOutOfArea?($.unblockUI(),$("#hasOfferOutOfAreaModel").modal("show"),$(".na__location__modal .na__location__modal--backbtn").click(function(){$("body").removeClass("modal-open")})):($("#btn-1click-checkout-sticky-header").attr("disabled","disabled"),ACC.product.redirectToConfirmationPage()))}),$(document).on("click","#addToInstallmentCartButton, #btn-buy-installment-sticky-header",function(e){$(this).hasClass("has-variants")||($.blockUI(),void 0!==window.hasOfferOutOfArea&&"true"===window.hasOfferOutOfArea?($.unblockUI(),$("#hasOfferOutOfAreaModel").modal("show"),$(".na__location__modal .na__location__modal--backbtn").click(function(){$("body").removeClass("modal-open")})):($("#btn-buy-installment-sticky-header").attr("disabled","disabled"),$("#addToInstallmentCartButton").attr("disabled","disabled"),ACC.product.buyInstallment(),ACC.track.gtmBuyNowCheckout("productBuyInstallment")))})},bindToAddToCartStorePickUpForm:function(){$("#colorbox #add_to_cart_storepickup_form").ajaxForm({success:ACC.product.displayAddToCartPopup})},enableStorePickupButton:function(){$(".js-pickup-in-store-button").removeAttr("disabled")},sendCartValidation:function(){if($("#startReferredDateStr").length>0){var code=$("input[name*='productCodePost']").val(),startDate=$("#startReferredDateStr").val(),endDate=$("#endReferredDateStr").val(),dataString={productCode:code,startReferredDateStr:startDate,endReferredDateStr:endDate};$.ajax({url:ACC.config.encodedContextPath+"/cart/validate",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){if("OK"==response.status)$("#addtocartErrorMsg").text(""),$(".addtocartErrorMsg").addClass("hidden"),ACC.product.callConfirmationPageAjax();else{var errors=response.fieldValidations;void 0!=errors&&($(".addtocartErrorMsg").removeClass("hidden"),$("#addtocartErrorMsg").text(errors.startReferredDate))}}})}else ACC.product.callConfirmationPageAjax()},redirectToConfirmationPage:function(){void 0!==$("#addToCartButton")&&ACC.product.sendCartValidation()},buyInstallment:function(){void 0!==$("#addToCartButton")&&ACC.product.callBuyInstallmentAjax()},callConfirmationPageAjax:function(){$.ajax({url:ACC.config.encodedContextPath+"/cart/buynow",type:"post",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},data:$("#addToCartForm").serialize(),success:function(cartResult,statusText,xhr,formElement){var showCart=!1;(cartResult.hasError||cartResult.modifyOrderWithOnlyPrepaid)&&(showCart=!0),showCart?(ACC.product.displayAddToCartPopup(cartResult,statusText,xhr,formElement),$.unblockUI(),$("#btn-1click-checkout, #btn-1click-checkout-sticky-header").removeAttr("disabled")):$(location).attr("href",ACC.config.encodedContextPath+"/checkout")}})},callBuyInstallmentAjax:function(){$.ajax({url:ACC.config.encodedContextPath+"/cart/buyinstallment",type:"post",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},data:$("#addToCartForm").serialize(),success:function(cartResult,statusText,xhr,formElement){var showCart=!1;(cartResult.hasError||cartResult.modifyOrderWithOnlyPrepaid)&&(showCart=!0),showCart?(ACC.product.displayAddToCartPopup(cartResult,statusText,xhr,formElement),$.unblockUI(),$("#btn-buy-installment-sticky-header").removeAttr("disabled"),$("#addToInstallmentCartButton").removeAttr("disabled")):$(location).attr("href",ACC.config.encodedContextPath+"/checkout?adrIC="+cartResult.cartAnalyticsData.cartCode)}})},displayAddToCartPopup:function(cartResult,statusText,xhr,formElement){if(void 0!==cartResult.modifyOrderWithOnlyPrepaid&&1==cartResult.modifyOrderWithOnlyPrepaid){var productCode=$("[name=productCodePost]",formElement).val(),res=$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/cart/add/"+productCode+"/checkIfShowOnlyPrepaidPopUp",data:$("#addToCartForm").serialize()});res.fail(function(response){console.log("Not show popup")}),res.done(function(response){response.showPopUp&&$("#modalConfirmOnlyPrepaid").modal("show")})}else{if(_.isEmpty(cartResult))return;if($("#addToCartLayer").remove(),!0===cartResult.hasError)$.colorbox({html:cartResult.addToCartLayer,maxWidth:"100%",width:"335px",initialWidth:"120px",className:"error-limit-quanity",closeButton:!1});else{var url=ACC.config.cartMiniUrl;$('[name="mini-cart-url"]').length>0&&(url=$('[name="mini-cart-url"]').val()),url+="?recalculation=false",ACC.minicart.dropdownMiniCart(url,$("[name=productCodePost]",formElement).val())}var productCode=$("[name=productCodePost]",formElement).val(),quantityField=$("[name=qty]",formElement).val(),quantity=1;void 0!==quantityField&&(quantity=quantityField);var cartAnalyticsData=cartResult.cartAnalyticsData;_.defaults(cartAnalyticsData,{cartCode:"",productName:"",productPostPrice:""});var cartData={cartCode:_.isUndefined(cartAnalyticsData)||_.isEmpty(cartAnalyticsData.cartCode)?null:cartAnalyticsData.cartCode,productCode:productCode,quantity:quantity,productPrice:cartAnalyticsData.productPostPrice,productName:cartAnalyticsData.productName};ACC.track.trackAddToCart(productCode,quantity,cartData)}},bindRemoveViewedProduct:function(){$(document).on("click",".js-remove-viewed-product",function(e){var productCode=$(this).data("productcode"),options=($(this).parent(),{productCode:$(this).data("productcode")});$.ajax({url:ACC.config.encodedContextPath+"/viewedproduct/remove",type:"GET",dataType:"json",contentType:"application/json",data:options,async:!1,complete:function(response){$("#js-viewed-product-"+productCode).remove()}})})},bindNiceScrollDropdownSearch:function(){var $self=$(".product-list__filter .dropdown-menu li"),$parentself=$(".product-list__filter .dropdown-menu");$self.length>5&&($parentself.css("max-height","152px"),$parentself.niceScroll({cursorwidth:"4px",cursorborder:"none",autohidemode:!1,cursorcolor:"#dddddd",background:"transparent",railpadding:{top:3,right:1,left:1,bottom:3}}))},buildProductList:function(){var that=this;$(".product-list__filter .adr-dropdown").on("show.bs.dropdown",function(e){var target=$(e.currentTarget);if(!target.data("builtProductList")){var html="",link_search_paged="",ul=$(e.currentTarget).find("ul"),link_seach=ul.data("url"),current_page=ul.data("current-page")?parseInt(ul.data("current-page")):1,total_page=ul.data("total-pages")?parseInt(ul.data("total-pages")):0;if(total_page>0&&link_seach){var totalNumberShow=current_page+3;if(totalNumberShow>total_page&&(totalNumberShow=total_page),current_page/3>1&&(link_search_paged=link_seach+(-1!=link_seach.indexOf("?")?"&":"?")+"page=1",html+='<li><a href="'+link_search_paged+'">Trang đầu &nbsp;&nbsp;&nbsp;&nbsp;</a></li><option data-url="'+link_search_paged+'" class="hidden" value="1")>Trang đầu</option>'),current_page<=3&&current_page>0)for(var i=1;i<current_page;i++)link_search_paged=link_seach+(-1!=link_seach.indexOf("?")?"&":"?")+"page="+i,html+='<li><a href="'+link_search_paged+'">Trang '+i+' &nbsp;&nbsp;&nbsp;&nbsp;</a></li><option data-url="'+link_search_paged+'" class="hidden" value="'+i+'" '+(current_page==i?'selected="selected"':"")+">"+i+"/"+total_page+"</option>";if(current_page-3>0)for(var i=current_page-3;i<current_page;i++)link_search_paged=link_seach+(-1!=link_seach.indexOf("?")?"&":"?")+"page="+i,html+='<li><a href="'+link_search_paged+'">Trang '+i+' &nbsp;&nbsp;&nbsp;&nbsp;</a></li><option data-url="'+link_search_paged+'" class="hidden" value="'+i+'" '+(current_page==i?'selected="selected"':"")+">"+i+"/"+total_page+"</option>";for(var i=current_page;i<=totalNumberShow;i++)link_search_paged=link_seach+(-1!=link_seach.indexOf("?")?"&":"?")+"page="+i,html+='<li><a href="'+link_search_paged+'">Trang '+i+' &nbsp;&nbsp;&nbsp;&nbsp;</a></li><option data-url="'+link_search_paged+'" class="hidden" value="'+i+'" '+(current_page==i?'selected="selected"':"")+">"+i+"/"+total_page+"</option>";current_page<total_page&&(link_search_paged=link_seach+(-1!=link_seach.indexOf("?")?"&":"?")+"page="+total_page,html+='<li><a href="'+link_search_paged+'">Trang cuối &nbsp;&nbsp;&nbsp;&nbsp;</a></li><option data-url="'+link_search_paged+'" class="hidden" value="'+total_page+'")>Trang cuối</option>'),ul.append(html),that.bindNiceScrollDropdownSearch()}target.data("builtProductList",!0)}})},countDownDate:function(){var today=new Date,dd=today.getDate()+1,mm=today.getMonth()+1,yyyy=today.getFullYear(),date=mm+"-"+dd+"-"+yyyy+" 00:00:00",countDownDate=new Date(date).getTime();console.log("countDownDate"),$(".time-deal .countdown-one-day").each(function(){var $self=$(this),interval=setInterval(function(){var now=(new Date).getTime(),distance=countDownDate-now,hours=Math.floor(distance%864e5/36e5),minutes=Math.floor(distance%36e5/6e4),seconds=Math.floor(distance%6e4/1e3);$self.html(hours+":"+minutes+":'"+seconds+"''"),distance<0&&clearInterval(interval)},1e3)})},bindReviewAjax:function(){$(document).on("click",".js-review-submit",function(){if(""===$(".js-ratingSetInput").val()||"NaN"===parseInt($(".js-ratingSetInput").val())||parseInt($(".js-ratingSetInput").val())<0)return void $("#commentErrMsg").html("Vui lòng gửi đánh giá của bạn cho sản phẩm.");ACC.product.reviewAjax($(this).attr("data-url"))})},reviewAjax:function(url){$.ajax({url:url,type:"post",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},data:$("#vinReviewForm").serialize(),success:function(data){var json=JSON.parse(data),status=json.status;if("true"==json.anonymous_user&&ACC.captcha.reset("js-product-review__captcha"),"invalidData"==status){var aliasError=json.alias,placeHolder=$("#alias").attr("placeholder");if(""!=aliasError){var aliasFormHasError='<div class="form-group has-error"><label class="control-label invisible-label hidden" for="alias"></label> <input id="alias" name="alias" class="form-control form-control" placeholder= \''+placeHolder+'\' type="text" value=\'\'><div class="help-block"><span id="alias.errors">'+aliasError+"</span></div></div>";$("#alias-comment-process").html(aliasFormHasError)}else{var aliasValue=$("#alias").val(),aliasFormNoError='<div class="form-group"> <label class="control-label invisible-label hidden" for="alias"> </label> <input id="alias" name="alias" class="form-control form-control" placeholder=\''+placeHolder+"' type=\"text\" value='"+aliasValue+"'></div>";$("#alias-comment-process").html(aliasFormNoError)}if("false"==json.recaptchaChallangeAnswered){var captcha_error_msg=json.captcha_error;ACC.captcha.showError("js-product-review__captcha",captcha_error_msg)}var errorRating=json.rating;""!=errorRating&&0==$("#rating-errors").length&&($("div.vertical-align-center > div.form-group").append('<div class="help-block"><span id="rating-errors">'+errorRating+"</span></div></div>"),$("div.vertical-align-center > div.form-group").addClass("has-error"))}else $("div.form-group > div.help-block").remove();if($("#comment-form__message--sucess").html(""),"overCommentLenght"==status){var overMaximumCommentMsg=json.overMaximumCommentMsg,placeHolder=$("#alias").attr("placeholder"),aliasFormNoError='<div class="form-group"> <label class="control-label invisible-label hidden" for="alias"> </label> <input id="alias" name="alias" class="form-control form-control" placeholder=\''+placeHolder+"' type=\"text\" value=''></div>";$("#alias-comment-process").html(aliasFormNoError),$("div.form-group > div.help-block").remove(),$("#comment-form__message--sucess").html('<i class="adr-icon icon-error-comment"></i> '+overMaximumCommentMsg).addClass("comment-form__message-error")}if("success"==status){var success_msg=json.success_msg,placeHolder=$("#alias").attr("placeholder"),aliasFormNoError='<div class="form-group"> <label class="control-label invisible-label hidden" for="alias"> </label> <input id="alias" name="alias" class="form-control form-control" placeholder=\''+placeHolder+"' type=\"text\" value=''></div>";$("#alias-comment-process").html(aliasFormNoError),$("div.form-group > div.help-block").remove(),$("#reviewComment").val(""),$(".comment-form__submit").attr("disabled","disabled"),$("#currentCommentCounter").html("0"),$(".js-writeReviewStars").find("span").removeClass("active"),$(".js-ratingSetInput").val("0"),$("#step2").fadeOut(500,function(){$("#step1").fadeIn(500)});var numberOfReview=json.reviewsTotal;$("#comment-form__message--sucess").html('<i class="adr-icon icon-success"> </i>'+success_msg).addClass("comment-form__message"),$("#alias-comment-process").html(aliasFormNoError);var comment=json.reviewDataGson.comment.replace(/\n/g,"<br>"),reviewDate=json.reviewDate,rating=(json.reviewDataGson.alias,json.rating),uniqId=_.uniqueId("review_"),reviewItem="";if(reviewItem+='<div class="row p-t-8 p-b-8">',reviewItem+='\t\t<div class="col-md-6 col-xs-6">',reviewItem+='\t\t\t<div class="rating">',reviewItem+="\t\t\t\t<div id='"+uniqId+'\' class="rating-stars pull-left js-ratingCalc " data-rating=\'{"rating":'+rating+',"total":5}\' >',reviewItem+='\t\t\t\t\t<div class="greyStars">',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star"></span>',reviewItem+="\t\t\t\t\t</div>",reviewItem+='\t\t\t\t\t<div class="greenStars js-greenStars">',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star active"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star active"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star active"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star active"></span>',reviewItem+='\t\t\t\t\t\t<span class="glyphicon glyphicon-star active"></span>',reviewItem+="\t\t\t\t\t</div>",reviewItem+="\t\t\t\t</div>",reviewItem+="\t\t\t</div>",reviewItem+="\t\t</div>",reviewItem+='\t\t<div class="col-md-6 col-xs-6">',reviewItem+='\t\t\t<div class="comment-item__action clearfix pull-right">',reviewItem+='\t\t\t\t<div class="comment-item__time">',reviewItem+='\t\t\t\t\t<span class="date">'+reviewDate+"</span>",reviewItem+="\t\t\t\t</div>",reviewItem+="\t\t\t</div>",reviewItem+="\t\t</div>",reviewItem+="\t</div>",reviewItem+='\t<div class="row p-b-8">',reviewItem+='\t\t<div class="col-md-12 col-xs-12">',reviewItem+=comment,reviewItem+="\t\t</div>",reviewItem+="\t</div>",reviewItem+='\t<div class="row">',reviewItem+='\t\t<div class="col-md-12 col-xs-12 p-t-16">',reviewItem+='\t\t\t<div id="comment-form__message--sucess" class="comment-form__message">',reviewItem+='\t\t\t\t<i class="adr-icon icon-success"></i><div class="comment-message">Phần đánh giá của Quý khách được gửi thành công. Vui lòng chờ phê duyệt.</div>',reviewItem+="\t\t\t</div>",reviewItem+="\t\t</div>",reviewItem+="\t</div>",$("#yourComment").html(reviewItem),ACC.ratingstars.renderRatingStars(uniqId),$(".product-comment__item").length>15&&$(".review-list.product-comment__item").last().hide(),numberOfReview>15&&0==$(".btn-view-more-review").length){var labelForViewMoreLink=json.labelForViewMoreLink,viewMoreLink='<a href="javascript:;" class="btn btn-white btn-view-more-review">'+labelForViewMoreLink+"</a>";$(".review-list").append(viewMoreLink)}}$.unblockUI()}})},confirmOrderModificationOnlyPrepaid:function(){$(document).on("click",".js-order-modification-onlyprepaid-submit",function(){var offerCode=$(this).data("offercode");$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:ACC.config.encodedContextPath+"/cart/add/"+offerCode+"/confirm?modifyOnlyPrepaid=true",data:$("#addToCartForm").serialize(),complete:function(response){$("#modalConfirmOnlyPrepaid").modal("hide"),$(".js-mini-cart-link").click()}})})},bindTogetherViewedProduct:function(){$(document).on("click","#product-detail__together-viewed a.product-item",function(){gtmOnClickTogetherViewedProduct(this)})},bindRelatedDeal:function(){$(document).on("click",".product-detail__related-deal a.product-item",function(){gtmOnClickSuggestedProduct(this)})},bindQuickButtonClick:function(){$(document).on("click",".js-quick-add-to-cart",function(){var offerCode=$(this).attr("data-offer-code");$.ajax({url:ACC.config.encodedContextPath+"/cart/addQuick",type:"post",beforeSend:function(){$.blockUI()},complete:function(response){$.unblockUI();var errorBox=$.parseHTML(response.responseText);if($(errorBox[0]).hasClass("js-has-error"))$(document).find(".js-mini-shopping-cart").addClass("hide"),$(document).find(".js-warning-quick-add-to-cart").replaceWith(errorBox[0]),setTimeout(function(){$(".js-warning-quick-add-to-cart").fadeOut(),$(document).find(".js-mini-shopping-cart").removeClass("hide")},1800);else{var cartId=$(errorBox[0]).attr("data-cart-id"),quantity=$(errorBox[0]).attr("data-product-quantity"),url=ACC.config.cartMiniUrl;$('[name="mini-cart-url"]').length>0&&(url=$('[name="mini-cart-url"]').val()),url+="?recalculation=false",ACC.minicart.dropdownMiniCart(url,offerCode),ACC.track.gtmProductQuickAdd(offerCode,cartId,quantity),$(".page-cartPage").length>0&&window.location.reload(!0)}},data:{productCodePost:offerCode},success:function(response){}})}),$(document).on("click",".js-quick-view-product",function(){var offerCode=$(this).attr("data-offer-code");ACC.product.bindQuickViewPopup(offerCode),ACC.track.gtmProductQuickView(offerCode)}),$(document).on("click",".product-variant__item",function(e){e.preventDefault();var offerCode=$(this).attr("data-offer-code");void 0!==offerCode&&""!==offerCode?ACC.product.bindQuickViewPopup(offerCode):window.location.href=$(this).attr("href")})},bindQuickViewPopup:function(offerCode){var popupQuickView=$("#modal-quick-view");popupQuickView.attr("data-offer-code",offerCode),$.ajax({url:ACC.config.encodedContextPath+"/p/"+offerCode,type:"get",beforeSend:function(){$("#modal-quick-view").find(".modal-body").html("<div style='width: 900px; height: 420px;'></div>"),$.blockUI()},complete:function(response){$.unblockUI()},data:{quickView:!0},success:function(response){if($("#imgQuickViewDefault").removeClass("hidden"),$(response).find(".voucher-right").length>0){var pdpLeft=$(response).find(".product-detail__left"),pdpRight=$(response).find(".voucher-right"),div=$('<div class="row voucher-quickview"></div>');div.html(pdpLeft[0].outerHTML),div.append(pdpRight[0].outerHTML),popupQuickView.find(".modal-body").html(div[0].outerHTML)}else{var pdpQuickView=$(response).find(".product-detail__left");popupQuickView.find(".modal-body").html(pdpQuickView[0].outerHTML)}popupQuickView.modal("show"),ACC.product.toggleDropdown(),ACC.product.changeQuantity(),ACC.product.bindToAddToCartForm(),ACC.adrProductDetail.bindCountDownClock(),ACC.adrProductDetail.initWishListAction(),setTimeout(function(){ACC.adrProductDetail.initDefaultGallery(),ACC.adrProductDetail.initCopyDiscountTag(),ACC.adrProductDetail.ajaxAddStopper(),ACC.myCoupons.socialShareCoupon(),$("#imgQuickViewDefault").addClass("hidden")},1e3),popupQuickView.on("click",".js-link-product-detail",function(){var offerCode=$("#modal-quick-view").attr("data-offer-code");$(location).attr("href",ACC.config.encodedContextPath+"/p/"+offerCode)})}})},scrollPageAfterFilter:function(){if($("body").hasClass("pageType-CategoryPage")||$("body").hasClass("pageType-MerchantPage")||$("body").hasClass("pageType-BrandPage")){var sort_val=$(".header__filter form[id*=sortForm] select[name=sort]").val(),scrollTo=function(){if($(".product-list__header").length>0){var plus=$("header").hasClass("fixed")?116:200;setTimeout(function(){$("body,html").scrollTop($(".product-list__header").offset().top-plus)},1e3)}};if($(".product-list__header .facet-button-text").length>0)scrollTo();else if(void 0!==sort_val&&""!=sort_val&&"relevance"!=sort_val)scrollTo();else{var sParameterName,i,sPageURL=window.location.search.substring(1),sURLVariables=sPageURL.split("&"),sParam=["sort","page"];for(i=0;i<sURLVariables.length;i++)if(sParameterName=sURLVariables[i].split("="),sParam.indexOf(sParameterName[0])>=0){scrollTo();break}}}}},$(document).ready(function(){ACC.product.enableAddToCartButton()}),$(window).load(function(){ACC.product.scrollPageAfterFilter()}),ACC.productDetail={_autoload:["initPageEvents","bindVariantOptions",["initProductDescriptionLazyLoad",$("#js-product-detail__description").length],"initProductBoxLazyload"],checkQtySelector:function(self,mode){var input=$(self).parents(".js-qty-selector").find(".js-qty-selector-input"),inputVal=parseInt(input.val()),max=input.data("max"),minusBtn=$(self).parents(".js-qty-selector").find(".js-qty-selector-minus"),plusBtn=$(self).parents(".js-qty-selector").find(".js-qty-selector-plus");$(self).parents(".js-qty-selector").find(".btn").removeAttr("disabled"),"minus"==mode?1!=inputVal?(ACC.productDetail.updateQtyValue(self,inputVal-1),inputVal-1==1&&minusBtn.attr("disabled","disabled")):minusBtn.attr("disabled","disabled"):"reset"==mode?ACC.productDetail.updateQtyValue(self,1):"plus"==mode?"FORCE_IN_STOCK"==max?ACC.productDetail.updateQtyValue(self,inputVal+1):inputVal<=max?(ACC.productDetail.updateQtyValue(self,inputVal+1),inputVal+1==max&&plusBtn.attr("disabled","disabled")):plusBtn.attr("disabled","disabled"):"input"==mode?1==inputVal?minusBtn.attr("disabled","disabled"):"FORCE_IN_STOCK"==max&&inputVal>0?ACC.productDetail.updateQtyValue(self,inputVal):inputVal==max?plusBtn.attr("disabled","disabled"):inputVal<1?(ACC.productDetail.updateQtyValue(self,1),minusBtn.attr("disabled","disabled")):inputVal>max&&(ACC.productDetail.updateQtyValue(self,max),plusBtn.attr("disabled","disabled")):"focusout"==mode&&(isNaN(inputVal)?(ACC.productDetail.updateQtyValue(self,1),minusBtn.attr("disabled","disabled")):inputVal>=max&&plusBtn.attr("disabled","disabled"))},updateQtyValue:function(self,value){var input=$(self).parents(".js-qty-selector").find(".js-qty-selector-input"),addtocartQty=$(self).parents(".addtocart-component").find("#addToCartForm").find(".js-qty-selector-input");input.val(value),addtocartQty.val(value)},initPageEvents:function(){function changeOnVariantOptionSelection(optionSelected){window.location.href=optionSelected.attr("value")}$(document).on("click",".js-qty-selector .js-qty-selector-minus",function(){ACC.productDetail.checkQtySelector(this,"minus")}),$(document).on("click",".js-qty-selector .js-qty-selector-plus",function(){ACC.productDetail.checkQtySelector(this,"plus")}),$(document).on("keydown",".js-qty-selector .js-qty-selector-input",function(e){e.shiftKey&&e.preventDefault()," "!=$(this).val()&&(e.which>=48&&e.which<=57||e.which>=96&&e.which<=105)||8==e.which||46==e.which||37==e.which||39==e.which||9==e.which||(38==e.which?ACC.productDetail.checkQtySelector(this,"plus"):40==e.which?ACC.productDetail.checkQtySelector(this,"minus"):e.preventDefault())}),$(document).on("blur",".js-qty-selector .js-qty-selector-input",function(e){var initVal=$(this).val();outputVal=initVal.replace(/[^0-9]/g,""),initVal!=outputVal&&$(this).val(outputVal)}),$(document).on("keyup",".js-qty-selector .js-qty-selector-input",function(e){ACC.productDetail.checkQtySelector(this,"input"),ACC.productDetail.updateQtyValue(this,$(this).val())}),$(document).on("focusout",".js-qty-selector .js-qty-selector-input",function(e){ACC.productDetail.checkQtySelector(this,"focusout"),ACC.productDetail.updateQtyValue(this,$(this).val())}),$(document).on("change","#pdpAddtoCartSelect",function(){var qty=$(this).val();if("pdpAddtoCartInput"===qty){$("#pdpAddtoCartInputSection").toggle(),$("#pdpAddtoCartSelectSection").toggle(),$("#pdpAddtoCartInput").focus();var defaultQty=$("#pdpAddtoCartInput").data("default-value");ACC.productDetail.updateQtyValue(this,defaultQty)}else ACC.productDetail.updateQtyValue(this,qty)}),$("#pdpAddtoCartSelect").change(),$("#Size").change(function(){changeOnVariantOptionSelection($("#Size option:selected"))}),$("#variant").change(function(){changeOnVariantOptionSelection($("#variant option:selected"))}),$(".selectPriority").change(function(){window.location.href=$(this[this.selectedIndex]).val()})},bindVariantOptions:function(){ACC.productDetail.bindCurrentStyle(),ACC.productDetail.bindCurrentSize(),ACC.productDetail.bindCurrentType()},bindCurrentStyle:function(){var currentStyle=$("#currentStyleValue").data("styleValue"),styleSpan=$(".styleName");null!=currentStyle&&styleSpan.text(": "+currentStyle)},bindCurrentSize:function(){var currentSize=$("#currentSizeValue").data("sizeValue"),sizeSpan=$(".sizeName");null!=currentSize&&sizeSpan.text(": "+currentSize)},bindCurrentType:function(){var currentSize=$("#currentTypeValue").data("typeValue"),sizeSpan=$(".typeName");null!=currentSize&&sizeSpan.text(": "+currentSize)},initImageBroken:function(element){"together-viewed-product"==$(element).attr("id")&&($(element).show(),$(element).attr("src",$("#data").data("missingImageProduct")))},initProductDescriptionLazyLoad:function(){var $productionDescription=$("#js-product-detail__description");$productionDescription.find("img").lazyload({data_attribute:"src",threshold:300,appear:function(){$(this).addClass("loaded")}}),initLazyloadIframe=function(){$productionDescription.find("iframe").each(function(){var frame=$(this),vidSource=$(frame).attr("data-src"),distance=$(frame).offset().top-$(window).scrollTop(),distTopBot=window.innerHeight-distance,distBotTop=distance+$(frame).height();distTopBot>=0&&distBotTop>=0&&($(frame).attr("src",vidSource),$(frame).removeAttr("data-src"))})};var timeoutResize,throttled=_.throttle(initLazyloadIframe,100);$(window).scroll(throttled),$(window).on("resize",function(){clearTimeout(timeoutResize),timeoutResize=setTimeout(function(){initLazyloadIframe()},300)})},initProductBoxLazyload:function(){void 0!==$(".product-list__container")&&$(".product-list__container").length>0&&$(".product-list__container img.lazy").lazyload({event:"lazyload",effect:"fadeIn",effectspeed:1e3}).trigger("lazyload")}},ACC.productVehicleFee={_autoload:[["initElements",$(".car__feebox").length>0]],selectedProvinceCode:4,registrationFee:0,insuranceFee:0,licenseFee:0,totalFee:0,price:0,rounding:1e3,_config:{element:{form:".car__feebox",provinceSelector:".car__feebox .selectpicker",dropdownTag:".car__feebox .js-dropdown-tag",popOver:".car__feebox .pop-hover",registrationFeeHolder:".car__feebox .registration-fee",insuranceFeeHolder:".car__feebox .insurance-fee",licenseFeeHolder:".car__feebox .license-fee",totalFeeHolder:".car__feebox .total-fee",closeButton:".car__feebox .close"}},initElements:function(){
if("undefined"!=typeof offerPrice&&offerPrice&&(ACC.productVehicleFee.price=parseFloat(offerPrice),ACC.productVehicleFee.price&&(ACC.productVehicleFee.selectedProvinceCode=parseInt(ACC.delivery.selectedProvince),ACC.productVehicleFee.insuranceFee=globalIsuranceFee,ACC.common.loadModuleElements(ACC.productVehicleFee),ACC.productVehicleFee.form.length))){var options={aSep:".",aDec:",",aPad:!1};ACC.productVehicleFee.registrationFeeHolder.autoNumeric("init",options),ACC.productVehicleFee.insuranceFeeHolder.autoNumeric("init",options),ACC.productVehicleFee.licenseFeeHolder.autoNumeric("init",options),ACC.productVehicleFee.totalFeeHolder.autoNumeric("init",options);var provinceSelect=ACC.productVehicleFee.provinceSelector.selectize(),locationData={province:ACC.delivery.selectedProvince};provinceSelect[0].selectize.on("option_add",function(value){_.isEmpty(locationData.province)||parseInt(value)===parseInt(locationData.province)&&ACC.selectize.set(ACC.productVehicleFee.provinceSelector,locationData.province,"silent")}),ACC.requests.location.province(ACC.productVehicleFee.provinceSelector),ACC.productVehicleFee.dropdownTag.on("click",function(e){e.stopPropagation(),e.preventDefault(),ACC.productVehicleFee.popOver.toggleClass("open")}),ACC.productVehicleFee.closeButton.on("click",function(e){e.stopPropagation(),e.preventDefault(),ACC.productVehicleFee.popOver.removeClass("open")}),ACC.productVehicleFee.popOver.on("click",function(e){e.stopPropagation(),e.preventDefault()}),$("body").click(function(){ACC.productVehicleFee.popOver.removeClass("open")}),ACC.productVehicleFee.updateFees(),ACC.productVehicleFee.provinceSelector.on("change",function(){ACC.productVehicleFee.updateFees()})}},findRegistrationFee:function(code){var rSize=globalRegistrationFees.length;if(rSize)for(var i=0;i<rSize;i++){var configFee=globalRegistrationFees[i],provinces=configFee.provinces;if(provinces&&provinces.length)for(var j=0;j<provinces.length;j++){var p=provinces[j];if(parseInt(code)===parseInt(p))return configFee}}},findLicenseFee:function(code,price){var rSize=globalLicenseFees.length;if(rSize)for(var i=0;i<rSize;i++){var configFee=globalLicenseFees[i],fromPrice=configFee.fromPrice,toPrice=configFee.toPrice,area=configFee.area;if(code==area&&price>=fromPrice&&price<=toPrice)return configFee}},updateFees:function(){ACC.productVehicleFee.selectedProvinceCode=parseInt(ACC.productVehicleFee.provinceSelector.val()),ACC.productVehicleFee.registrationFee=0,ACC.productVehicleFee.licenseFee=0;var selectedProvince=ACC.productVehicleFee.selectedProvinceCode,configRegistrationFee=ACC.productVehicleFee.findRegistrationFee(selectedProvince);if(configRegistrationFee){ACC.productVehicleFee.registrationFee=Math.round(ACC.productVehicleFee.price*configRegistrationFee.fee/100/ACC.productVehicleFee.rounding)*ACC.productVehicleFee.rounding;var configCode=configRegistrationFee.code,configLicenseFee=ACC.productVehicleFee.findLicenseFee(configCode,ACC.productVehicleFee.price);configLicenseFee&&(ACC.productVehicleFee.licenseFee=configLicenseFee.fee)}ACC.productVehicleFee.setNumber(ACC.productVehicleFee.registrationFeeHolder,ACC.productVehicleFee.registrationFee),ACC.productVehicleFee.setNumber(ACC.productVehicleFee.insuranceFeeHolder,ACC.productVehicleFee.insuranceFee),ACC.productVehicleFee.setNumber(ACC.productVehicleFee.licenseFeeHolder,ACC.productVehicleFee.licenseFee),ACC.productVehicleFee.totalFee=ACC.productVehicleFee.registrationFee+ACC.productVehicleFee.insuranceFee+ACC.productVehicleFee.licenseFee,ACC.productVehicleFee.setNumber(ACC.productVehicleFee.totalFeeHolder,ACC.productVehicleFee.totalFee)},setNumber:function(el,num){el.text(num),el.autoNumeric("update")}},ACC.quickview={_autoload:["bindToUiCarouselLink"],initQuickviewLightbox:function(){ACC.product.enableAddToCartButton(),ACC.product.bindToAddToCartForm(),ACC.product.enableStorePickupButton()},refreshScreenReaderBuffer:function(){$("#accesibility_refreshScreenReaderBufferField").attr("value",(new Date).getTime())},bindToUiCarouselLink:function(){var titleHeader=$("#quickViewTitle").html();$(".js-owl-carousel-reference .js-reference-item").colorbox({close:'<span class="glyphicon glyphicon-remove"></span>',title:titleHeader,maxWidth:"100%",onComplete:function(){ACC.quickview.refreshScreenReaderBuffer(),ACC.quickview.initQuickviewLightbox(),ACC.ratingstars.bindRatingStars($(".quick-view-stars"))},onClosed:function(){ACC.quickview.refreshScreenReaderBuffer()}})}},ACC.ratingstars={star:5,_autoload:[["bindRatingStars",$(".js-ratingCalc").length>0],["bindRatingStarsSet",$(".js-ratingCalcSet").length>0]],bindRatingStars:function(){$(".js-ratingCalc").each(function(){var rating=$(this).data("rating");$(this).find(".js-greenStars").width($(this).width()*(parseFloat(rating.rating,ACC.ratingstars.star)/5)),$(this).find(".js-yellowStars").width(parseFloat(100*rating/5)+"%")})},renderRatingStars:function(id){var $dom=$("#"+id),rating=$dom.data("rating");$dom.find(".js-greenStars").width(parseFloat(100*rating.rating/ACC.ratingstars.star)+"%"),$dom.find(".js-yellowStars").width(parseFloat(100*rating/5)+"%")},bindRatingStarsSet:function(){$(".js-ratingSetInput").val(5),$(".js-writeReviewStars").on({mouseleave:function(){clearReviewState();var sV=parseFloat($(".js-ratingSetInput").val(),ACC.ratingstars.star);"number"!=typeof sV||isNaN(sV)?clearReviewState():setReviewState(sV)}});var ratingIcons=$(".js-writeReviewStars .js-ratingIcon"),setReviewState=function(index){ratingIcons.slice(0,parseFloat(index,ACC.ratingstars.star)).addClass("active")},clearReviewState=function(){ratingIcons.removeClass("active")};ratingIcons.on({mouseenter:function(){clearReviewState(),setReviewState($(this).index()+1)},mouseleave:function(){$(this).removeClass("active")},click:function(){$(".js-ratingSetInput").val($(this).index()+1)}})}},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(search,pos){return this.substr(!pos||pos<0?0:+pos,search.length)===search}}),ACC.refinements={_autoload:[["bindMoreLessToggles",0!=$(".js-facet-form").length],["bindMoreStoresToggles",0!=$(".js-facet-form").length],["bindSearch",0!=$(".js-facet-form").length]],coords:{},storeSearchData:{},bindSearch:function(){$(document).on("submit","#user_location_form",function(e){e.preventDefault();var q=$(".js-shop-stores-facet .js-shop-store-search-input").val();q.length>0&&ACC.refinements.getInitStoreData(q)}),$(document).on("click","#findStoresNearMeAjax",function(e){e.preventDefault(),ACC.refinements.getInitStoreData(null,ACC.refinements.coords.latitude,ACC.refinements.coords.longitude)})},getInitStoreData:function(q,latitude,longitude){$(".alert").remove(),data={q:"",page:"0"},null!=q&&(data.q=q),null!=latitude&&(data.latitude=latitude),null!=longitude&&(data.longitude=longitude),ACC.refinements.storeSearchData=data,ACC.refinements.getStoreData()},getStoreData:function(){url=$(".js-facet-form").data("url"),$.ajax({url:url,data:ACC.refinements.storeSearchData,type:"get",success:function(response){window.location.reload()}})},bindMoreLessToggles:function(){$(document).on("click",".js-shop-stores-facet .js-facet-change-link",function(e){e.preventDefault(),$(".js-shop-stores-facet .js-facet-container").hide(),$(".js-shop-stores-facet .js-facet-form").show()}),$(document).on("click",".js-product-facet .js-facet-checkbox",function(){var paramQ=$(this).parents("form").find("input[name='q']").val(),paramText=$(this).parents("form").find("input[name='text']").val();""!==paramText&&(paramText=paramText.replace(/\s/g,"+"));var queryString="",urlPathName="";if(-1!=window.location.pathname.indexOf("/")&&window.location.pathname.split("/").length>2){var arrUrl=window.location.pathname.split("/");urlPathName="/"+arrUrl[1]}if(-1!=window.location.pathname.indexOf("/")&&window.location.pathname.split("/").length>=3){var arrUrl=window.location.pathname.split("/");"ma-giam-gia"==arrUrl[1]&&(urlPathName="/"+arrUrl[1]+"/"+arrUrl[2])}if(queryString=""!=paramQ&&""!=paramText?(""!=urlPathName?urlPathName:window.location.href.split("?")[0])+paramQ+"&text="+paramText:""==paramQ&&""!=paramText?(""!=urlPathName?urlPathName:window.location.href.split("?")[0])+"?text="+paramText:""!=paramQ&&""==paramText?(""!=urlPathName?urlPathName:window.location.href.split("?")[0])+paramQ:window.location.pathname,null!=window.location.pathname&&-1!=window.location.pathname.indexOf("/")&&window.location.pathname.split("/").length>2&&""==queryString){var arrUrl=window.location.pathname.split("/");queryString="/"+arrUrl[1]}var paramTracking=ACC.global.parseQueryString(window.location.href);null!=paramTracking&&(paramTracking.startsWith("&")&&-1!=queryString.indexOf("?")?(paramTracking=paramTracking.substring(1),queryString+="&"+paramTracking):paramTracking.startsWith("&")&&-1!=!queryString.indexOf("?")?(paramTracking=paramTracking.substring(1),queryString+="?"+paramTracking):queryString+=paramTracking),window.location.href=queryString}),$(document).on("click",".js-product-facet .js-more-facet-values-link",function(e){e.preventDefault(),$(this).parents(".js-facet").find(".js-facet-top-values").hide(),$(this).parents(".js-facet").find(".js-facet-list-hidden").show(),$(this).parents(".js-facet").find(".js-more-facet-values").hide(),$(this).parents(".js-facet").find(".js-less-facet-values").show()}),$(document).on("click",".js-product-facet .js-less-facet-values-link",function(e){e.preventDefault(),$(this).parents(".js-facet").find(".js-facet-top-values").show(),$(this).parents(".js-facet").find(".js-facet-list-hidden").hide(),$(this).parents(".js-facet").find(".js-more-facet-values").show(),$(this).parents(".js-facet").find(".js-less-facet-values").hide()})},bindMoreStoresToggles:function(){$(document).on("click",".js-shop-stores-facet .js-more-stores-facet-values",function(e){e.preventDefault(),$(".js-shop-stores-facet ul.js-facet-list li.hidden").slice(0,5).removeClass("hidden").first().find(".js-facet-checkbox").focus(),0==$(".js-shop-stores-facet ul.js-facet-list li.hidden").length&&$(".js-shop-stores-facet .js-more-stores-facet-values").hide()})}},ACC.silentorderpost={spinner:$("<img src='"+ACC.config.commonResourcePath+"/images/ajax-loader_ADR.gif' />"),bindUseDeliveryAddress:function(){if($("#useDeliveryAddress").on("change",function(){if($("#useDeliveryAddress").is(":checked")){var options={countryIsoCode:$("#useDeliveryAddressData").data("countryisocode"),useDeliveryAddress:!0};ACC.silentorderpost.enableAddressForm(),ACC.silentorderpost.displayCreditCardAddressForm(options,ACC.silentorderpost.useDeliveryAddressSelected),ACC.silentorderpost.disableAddressForm()}else ACC.silentorderpost.clearAddressForm(),ACC.silentorderpost.enableAddressForm()}),$("#useDeliveryAddress").is(":checked")){var options={countryIsoCode:$("#useDeliveryAddressData").data("countryisocode"),useDeliveryAddress:!0};ACC.silentorderpost.enableAddressForm(),ACC.silentorderpost.displayCreditCardAddressForm(options,ACC.silentorderpost.useDeliveryAddressSelected),ACC.silentorderpost.disableAddressForm()}},bindSubmitSilentOrderPostForm:function(){$(".submit_silentOrderPostForm").click(function(){ACC.common.blockFormAndShowProcessingMessage($(this)),$(".billingAddressForm").filter(":hidden").remove(),ACC.silentorderpost.enableAddressForm(),$("#silentOrderPostForm").submit()})},bindCycleFocusEvent:function(){$("#lastInTheForm").blur(function(){$('#silentOrderPostForm [tabindex$="10"]').focus()})},isEmpty:function(obj){return void 0===obj||null===obj||""===obj},disableAddressForm:function(){$('input[id^="address\\."]').prop("disabled",!0),$('select[id^="address\\."]').prop("disabled",!0)},enableAddressForm:function(){$('input[id^="address\\."]').prop("disabled",!1),$('select[id^="address\\."]').prop("disabled",!1)},clearAddressForm:function(){$('input[id^="address\\."]').val(""),$('select[id^="address\\."]').val("")},useDeliveryAddressSelected:function(){$("#useDeliveryAddress").is(":checked")?($("#address\\.country").val($("#useDeliveryAddressData").data("countryisocode")),ACC.silentorderpost.disableAddressForm()):(ACC.silentorderpost.clearAddressForm(),ACC.silentorderpost.enableAddressForm())},bindCreditCardAddressForm:function(){$("#billingCountrySelector :input").on("change",function(){var countrySelection=$(this).val(),options={countryIsoCode:countrySelection,useDeliveryAddress:!1};ACC.silentorderpost.displayCreditCardAddressForm(options)})},displayCreditCardAddressForm:function(options,callback){$.ajax({url:ACC.config.encodedContextPath+"/checkout/multi/sop/billingaddressform",async:!0,data:options,dataType:"html",beforeSend:function(){$("#billingAddressForm").html(ACC.silentorderpost.spinner)}}).done(function(data){$("#billingAddressForm").html(data),"function"==typeof callback&&callback.call()})}},$(document).ready(function(){with(ACC.silentorderpost)bindUseDeliveryAddress(),bindSubmitSilentOrderPostForm(),bindCreditCardAddressForm();$("#useDeliveryAddress").click()}),ACC.tabs={_autoload:[["hideReviewBtn",$(".panel-product-comment").length>0],["determineToDisplayReviews",$(".panel-product-comment").length>0],["bindCommentCounter",$(".panel-product-comment").length>0],["scrollToCommentSection",$(".panel-product-comment").length>0],["focusNavActive",$(".adr-flash-sale .adr-flash-sale__tabs--box ul.nav-tabs").length>0]],showReviewsAction:function(s){var stt,$reviews;stt=!1,$reviews=$("#reviews"),_.isUndefined(s)||($reviews.length>0&&!_.isUndefined($reviews.data(s))&&(stt=!0),stt&&$.get($reviews.data(s),function(result){$reviews.html(result),$(".js-ratingCalc").length>0&&(ACC.ratingstars.bindRatingStars(),ACC.tabs.showingAllReviews())}))},hideReviewBtn:function(btnClass){btnClass=void 0===btnClass?".less-reviews-btn":btnClass,$(btnClass).hide()},showReviewBtn:function(btnClass){$(btnClass).show()},showingAllReviews:function(){$("#showingAllReviews").data("showingallreviews")&&ACC.tabs.hideReviewBtn(".all-reviews-btn")},determineToDisplayReviews:function(){"#tabreview"===location.hash&&ACC.tabs.showReviewsAction("reviews")},loadComments:function(){ACC.tabs.showReviewsAction("reviews")},bindCommentCounter:function(){var text,$reviewComment=$("#reviewComment"),$form=$(".js-validation-10-charactor");$(".comment-form__container .help-block").addClass("hidden"),$("#commentErrMsg").html("");var switchHelpBlock=function(text,flag){text.length>500?($("#commentErrMsg").html($form.find(".over-character-block").html()),$form.find(".comment-form__submit").attr("disabled","true")):text.length<10?($("#commentErrMsg").html($form.find(".new-block").html()),$form.find(".comment-form__submit").attr("disabled","true"),0===text.length&&($("#commentErrMsg").html(""),$form.find(".new-block").addClass("hidden"),$form.find(".over-character-block").addClass("hidden"),$form.find(".comment-form__submit").attr("disabled","true"))):($("#commentErrMsg").html(""),$form.find(".new-block").addClass("hidden"),$form.find(".over-character-block").addClass("hidden"),$form.find(".comment-form__submit").removeAttr("disabled"))};void 0!==$reviewComment.val()&&(text=$reviewComment.val().trim(),$("#currentCommentCounter").html(text.length),switchHelpBlock(text)),$reviewComment.keyup(function(){text=$(this).val().trim(),$("#currentCommentCounter").html(text.length),switchHelpBlock(text)})},scrollToCommentSection:function(){$("#commented").length>0&&($("html, body").animate({scrollTop:$("#reviewComment").offset().top-190},500),$("#reviewComment").focus())},focusNavActive:function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$(".adr-flash-sale .adr-flash-sale__tabs--box ul.nav-tabs").each(function(){var nav_active=$(this).find("li.active").offset();$("ul.nav-tabs").animate({scrollLeft:nav_active.left-24},1e3)})}},ACC.termsandconditions={bindTermsAndConditionsLink:function(){$(document).on("click",".termsAndConditionsLink",function(e){e.preventDefault(),$.colorbox({maxWidth:"100%",maxHeight:"80%",width:"870px",scrolling:!0,href:$(this).attr("href"),close:'<span class="glyphicon glyphicon-remove"></span>',title:'<div class="headline"><span class="headline-text">Terms and Conditions</span></div>',onComplete:function(){ACC.common.refreshScreenReaderBuffer()},onClosed:function(){ACC.common.refreshScreenReaderBuffer()}})})}},$(function(){with(ACC.termsandconditions)bindTermsAndConditionsLink()}),ACC.gtmdata=ACC.gtmdata||{},ACC.track={_autoload:["gtmClickBanner","gtmClickCheckoutSteps","gtmOneClickProductOnvisible","gtmIssueCustomerDecision","gtmTrackCartIconAndCartSeeDetail","getProductInfoFromDataLayer","gtmProductQuickAdd","gtmProductQuickView"],trackAddToCart:function(productCode,quantity,cartData){window.mediator.publish("trackAddToCart",{productCode:productCode,quantity:quantity,cartData:cartData})},trackRemoveFromCart:function(productCode,initialCartQuantity){window.mediator.publish("trackRemoveFromCart",{productCode:productCode,initialCartQuantity:initialCartQuantity})},trackUpdateCart:function(productCode,initialCartQuantity,newCartQuantity){window.mediator.publish("trackUpdateCart",{productCode:productCode,initialCartQuantity:initialCartQuantity,newCartQuantity:newCartQuantity})},trackChangeAddressInCartPage:function(event){ACC.track.gtmClickCheckoutInCart(event)},trackEmaticAddToCart:function(data){window.mediator.publish("trackEmaticAddToCart",data)},trackEmaticRemoveFromCart:function(id){window.mediator.publish("trackEmaticRemoveFromCart",id)},trackEmatickUpdateCart:function(id,quantity){window.mediator.publish("trackEmaticUpdateCart",{id:id,quantity:quantity})},trackEmaticBeginCheckout:function(products){window.mediator.publish("trackEmaticBeginCheckout",products)},trackEmaticBeginPayment:function(products){window.mediator.publish("trackEmaticBeginPayment",products)},resetCart:function(products){window.mediator.publish("resetCart",products)},productBrowse:function(product){window.mediator.publish("productBrowse",product)},standardLocationData:function(){var location={};try{location.availability="No",location.name="","undefined"!=typeof moreInfo&&moreInfo.hasOwnProperty("gtmDataLayer")&&moreInfo.gtmDataLayer.hasOwnProperty("userCity")&&"UNKNOWN"!=moreInfo.gtmDataLayer.userCity&&(location.availability="Yes",location.name=moreInfo.gtmDataLayer.userCity+"/"+moreInfo.gtmDataLayer.userDistrict+"/"+moreInfo.gtmDataLayer.userWard)}catch(err){}return location},gtmRemoveFromCart:function(offer){try{if("undefined"!=typeof moreInfo&&void 0!==moreInfo.gtmDataLayer&&void 0!==moreInfo.gtmDataLayer.isUsingGtmOld){var cartCode="",form=$("#updateCartForm0");if(null!=form&&void 0!=form){var data=form.data("cart");null!=data&&void 0!=data&&(cartCode=data.cartCode)}moreInfo.gtmDataLayer.isUsingGtmOld?dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:[{name:offer.name,id:offer.id,price:offer.price,brand:offer.brand,category:offer.category,variant:offer.variant,quantity:offer.quantity}]}}}):moreInfo.hasOwnProperty(offer.id)&&dataLayer.push({event:"productRemove",module:offer.module,cartID:cartCode,product:{id:moreInfo[offer.id].id,sku:moreInfo[offer.id].sku,name:moreInfo[offer.id].name,variant:moreInfo[offer.id].variant,quantity:offer.quantity,price:{original:moreInfo[offer.id].originalPrice,discounted:moreInfo[offer.id].discountedPrice,discount:moreInfo[offer.id].discountPrice},category:{id:moreInfo[offer.id].categoryId,name:moreInfo[offer.id].categoryName,path:moreInfo[offer.id].categoryPath},brand:{id:moreInfo[offer.id].brandId,name:moreInfo[offer.id].brandName},merchant:{id:moreInfo[offer.id].merchantId,name:moreInfo[offer.id].merchantName},location:{availability:moreInfo[offer.id].availability,name:this.standardLocationData().name},issue:moreInfo[offer.id].issue}})}}catch(err){}},gtmClickBanner:function(){$(document).on("click",".js-gtm-track-click-banner",function(e){if($(this).data("istrackable")){var promoObj={};promoObj.id=$(this).data("trackbannerid"),promoObj.name=$(this).data("trackbannername"),promoObj.creative=$(this).data("trackbannercreative"),promoObj.position=$(this).data("trackbannerposition"),promoObj.url=$(this).data("trackbannerurl"),ACC.track.gtmOnPromoClick(promoObj)}})},gtmOnPromoClick:function(promoObj){dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:[{id:promoObj.id,name:promoObj.name,creative:promoObj.creative,position:promoObj.position}]}},eventCallback:function(){document.location=promoObj.url}})},gtmClickCheckoutSteps:function(){void 0!==ACC.gtmdata.step&&void 0!==ACC.gtmdata.option&&"undefined"!=typeof moreInfo&&void 0!==moreInfo.gtmDataLayer&&void 0!==moreInfo.gtmDataLayer.isUsingGtmOld&&moreInfo.gtmDataLayer.isUsingGtmOld&&(ACC.track.gtmOnCheckoutOption(ACC.gtmdata.step,ACC.gtmdata.option),"undefined"!=typeof gtmOnCheckout&&"function"==typeof gtmOnCheckout&&gtmOnCheckout(ACC.gtmdata.step,ACC.gtmdata.option))},gtmOnCheckoutOption:function(step,option){"undefined"!=typeof moreInfo&&void 0!==moreInfo.gtmDataLayer&&void 0!==moreInfo.gtmDataLayer.isUsingGtmOld&&moreInfo.gtmDataLayer.isUsingGtmOld&&dataLayer.push({event:"checkoutOption",ecommerce:{checkout_option:{actionField:{step:step,option:option}}}})},gtmClickCheckoutInCart:function(event){try{if("undefined"!=typeof moreInfo&&void 0!==moreInfo.gtmDataLayer&&void 0!==moreInfo.gtmDataLayer.isUsingGtmOld&&!moreInfo.gtmDataLayer.isUsingGtmOld){for(var products=[],i=0;i<$(".cart-page-product__list-item").length;i++)products[i]={id:moreInfo[moreInfo.entries[i]].id,sku:moreInfo[moreInfo.entries[i]].sku,name:moreInfo[moreInfo.entries[i]].name,variant:moreInfo[moreInfo.entries[i]].variant,quantity:moreInfo[moreInfo.entries[i]].quantity,price:{original:moreInfo[moreInfo.entries[i]].originalPrice,discounted:moreInfo[moreInfo.entries[i]].discountedPrice,discount:moreInfo[moreInfo.entries[i]].discountPrice},category:{id:moreInfo[moreInfo.entries[i]].categoryId,name:moreInfo[moreInfo.entries[i]].categoryName,path:moreInfo[moreInfo.entries[i]].categoryPath},brand:{id:moreInfo[moreInfo.entries[i]].brandId,name:moreInfo[moreInfo.entries[i]].brandName},merchant:{id:moreInfo[moreInfo.entries[i]].merchantId,name:moreInfo[moreInfo.entries[i]].merchantName},location:{availability:this.standardLocationData().availability,name:this.standardLocationData().name},issue:moreInfo[moreInfo.entries[i]].issue};var cartCode="",form=$("#updateCartForm0");if(null!=form&&void 0!=form){var data=form.data("cart");null!=data&&void 0!=data&&(cartCode=data.cartCode)}products.length>0&&dataLayer.push({event:event,cartID:cartCode,page:{id:"CartPage",name:"Trang CartPage"},products:[products]})}}catch(err){}},gtmBuyNowCheckout:function(eventName){try{if("undefined"!=typeof moreInfoForOneClick&&void 0!==moreInfoForOneClick.product&&void 0!==moreInfoForOneClick.gtmDataLayer&&void 0!==moreInfoForOneClick.gtmDataLayer.isUsingGtmOld&&!moreInfoForOneClick.gtmDataLayer.isUsingGtmOld){var moreInfo=moreInfoForOneClick,product=moreInfo.product,categoryPath="";try{categoryPath=moreInfo.gtmDataLayer.page.mainCategory,""!==moreInfo.gtmDataLayer.page.subCategory1&&(categoryPath+="/"+moreInfo.gtmDataLayer.page.subCategory1),""!==moreInfo.gtmDataLayer.page.subCategory2&&(categoryPath+="/"+moreInfo.gtmDataLayer.page.subCategory2),""!==moreInfo.gtmDataLayer.page.subCategory3&&(categoryPath+="/"+moreInfo.gtmDataLayer.page.subCategory3),""!==moreInfo.gtmDataLayer.page.subCategory4&&(categoryPath+="/"+moreInfo.gtmDataLayer.page.subCategory4)}catch(err){}dataLayer.push({event:eventName,product:{id:product.offerCode,sku:product.sapSku,name:product.name,variant:moreInfo.variant,quantity:$("#pdpAddtoCartSelect").val(),price:{original:product.rrpPrice,discounted:product.offerPrice,discount:product.offerDiscount},category:{id:product.displayCategoryCode,name:product.displayCategoryName,path:categoryPath},brand:{id:product.brandCode,name:product.brandName},merchant:{id:product.merchantCode,name:product.merchantName},location:{availability:moreInfo.availabilityLocation,name:moreInfo.nameLocation}}})}}catch(err){}},gtmOneClickProductOnvisible:function(){window.setTimeout(function(){var funOneClickProductOnvisible=function(productId){try{if(null!=productId&&""!=productId&&void 0!=productId){var productClick=ACC.track.getProductInfoFromDataLayer(productId);null!=productClick&&void 0!=productClick&&dataLayer.push({event:"productClick",product:productClick})}}catch(err){}};$(document).on("click",".product-item__container img, .product-item__container .product-item__info",function(e){try{var productId=null,_this=$(this).closest(".product-item");null!=_this&&void 0!=_this&&""!=(productId=_this.attr("href"))&&void 0!=productId&&null!=(productId=productId.split("?offer=")[1])&&-1!=productId.indexOf("&")&&(productId=productId.split("&")[0]),funOneClickProductOnvisible(productId)}catch(err){}}),$(document).on("click",".product-item__container a, .product-item__info a",function(e){try{var _this=$(this).closest(".product-item__wrapper"),linkDetailProduct=null;(null==_this||void 0==_this||null!=_this&&void 0!=_this&&0==_this.length)&&(_this=$(this).closest(".swiper-slide")),linkDetailProduct=_this.find(".product-item__info-title");var productId=null;null!=linkDetailProduct&&""!=(productId=linkDetailProduct.attr("href"))&&void 0!=productId&&null!=(productId=productId.split("?offer=")[1])&&-1!=productId.indexOf("&")&&(productId=productId.split("&")[0]),funOneClickProductOnvisible(productId)}catch(err){}})},400)},gtmProductQuickAdd:function(productId,cartCode,quantity){window.setTimeout(function(){try{if(null!=productId&&""!=productId&&void 0!=productId){var productAdd=ACC.track.getProductInfoFromDataLayer(productId);if(null!=productAdd&&void 0!=productAdd){var eventName=$(".pageType-LandingPage").length>0?"productAddInLanding":"productAddInPLP";void 0==productAdd||_.isEmpty(productAdd)||(productAdd.quantity=quantity),dataLayer.push({event:eventName,cartID:cartCode,product:productAdd})}}}catch(err){}},400)},gtmProductQuickView:function(productId){window.setTimeout(function(){try{if(null!=productId&&""!=productId&&void 0!=productId){var productView=ACC.track.getProductInfoFromDataLayer(productId);if(null!=productView&&void 0!=productView){var eventName=$(".pageType-LandingPage").length>0?"productViewInLanding":"productViewInPLP";dataLayer.push({event:eventName,product:productView})}}}catch(err){}},400)},gtmIssueCustomerDecision:function(){window.setTimeout(function(){var funDataLayerCustomerDecision=function(action){if(null!=window.gtmDataLayerCustomerDecision&&void 0!=window.gtmDataLayerCustomerDecision&&null!=window.gtmDataLayerCustomerDecision.product&&window.gtmDataLayerCustomerDecision.product.length>0){window.gtmDataLayerCustomerDecision.event=action;var newObj=Object.assign({},window.gtmDataLayerCustomerDecision);dataLayer.push(newObj)}};$(document).on("click","#checkout-step-confirm button.close",function(e){funDataLayerCustomerDecision("productClosepopup")}),$(document).on("click","#checkout-step-confirm",function(e){null!=e&&null!=e.target&&null!=e.target.id&&"checkout-step-confirm"==e.target.id&&funDataLayerCustomerDecision("productClosepopup")}),$(document).on("click","#checkout-step-agree",function(e){funDataLayerCustomerDecision("productRemove")}),$(document).on("click","#checkout-step-change-shippingAddress",function(e){funDataLayerCustomerDecision("productChangeAddress")}),$(document).on("click","#checkout-step-update-qty",function(e){funDataLayerCustomerDecision("updateQty")}),$(document).on("click","#checkout-step-cancel",function(e){funDataLayerCustomerDecision("seeDetail")})},400)},gtmTrackCartIconAndCartSeeDetail:function(){window.setTimeout(function(){var funTrackCartIconAndCartSeeDetail=function(action){var cartCode="",pageId="",pageName="",form=$("#updateCartForm0");if(null!=form&&void 0!=form){var data=form.data("cart");null!=data&&void 0!=data&&(cartCode=data.cartCode)}if(dataLayer.length>0)for(var i=dataLayer.length-1;i>=0;i--)if("pageview"===dataLayer[i].event){var page=dataLayer[i].page;null!=page&&void 0!=page&&(pageId=page.id,pageName=page.name)}dataLayer.push({event:action,cartID:cartCode,page:{id:pageId,name:pageName}})};$(document).on("click",".mini-cart-icon",function(e){funTrackCartIconAndCartSeeDetail("cartClick")}),$(document).on("click",".mini-shopping-cart__bottom-view-cart",function(e){funTrackCartIconAndCartSeeDetail("cartDetailClick")})},400)},getProductInfoFromDataLayer:function(productId){var product=null,lstProduct=[];if(null!=productId&&""!=productId&&void 0!=productId){if(dataLayer.length>0)for(var i=dataLayer.length-1;i>=0;i--)if("productImpressions"===dataLayer[i].event){var productList=dataLayer[i].productArray;if(void 0!=productList&&!_.isNull(productList)&&!_.isEmpty(productList))for(var j=0;j<=productList.length-1;j++)lstProduct.push(productList[j])}if(lstProduct.length>0&&void 0!=lstProduct)for(var j=0;j<=lstProduct.length-1;j++)if(lstProduct[j].id===productId){product=lstProduct[j];break}}return product}},ACC.futurelink={_autoload:["bindFutureStockLink"],bindFutureStockLink:function(){$(document).on("click",".futureStockLink",function(e){e.preventDefault();var url=$(this).attr("href"),title=$(this).attr("title");ACC.colorbox.open(title,{href:url,maxWidth:"100%",width:"320px",height:"320px",initialWidth:"320px"})})}},ACC.productorderform={_autoload:["headerActions","coreTableActions","addToCartOrderGridForm"],$addToCartOrderForm:$("#AddToCartOrderForm"),$addToCartBtn:$("#addToCartBtn"),$omsErrorMessageContainer:$("#globalMessages"),$emptySkuQuantityInputs:$(".sku-quantity[value]"),$nonEmptySkuQuantityInputs:$(".sku-quantity[value]"),$totalGridValues:$("[data-grid-total-id]"),$futureTooltipTemplate:$("#future-stock-template"),$futureTooltipErrorTemplate:$("#future-tooltip-error-template"),$omsErrorMessageTemplate:$("#oms-error-message-template"),$variantSummaryTemplate:$("#variant-summary"),selectedVariantData:"selected-variant",selectedVariants:[],quantityTotal:0,scrollTopPos:0,headerActions:function(){ACC.productorderform.bindProductDetailToggle($(".product-details-toggle"))},coreTableActions:function(){ACC.productorderform.coreTableScrollActions(ACC.productorderform.$addToCartOrderForm),ACC.productorderform.bindUpdateFutureStockButton(".update_future_stock_button"),ACC.productorderform.bindHideFutureStockInfo(".hide_future_stock_info"),ACC.productorderform.bindVariantSelect($(".variant-select-btn"),"AddToCartOrderForm"),ACC.productorderform.cancelVariantModal(".closeVariantModal");var quantityBefore=0,quantityAfter=0;ACC.productorderform.$addToCartOrderForm.on("click",".sku-quantity",function(event){$(this).select()}),ACC.productorderform.$addToCartOrderForm.on("focusin",".sku-quantity",function(event){quantityBefore=jQuery.trim(this.value),$(this).parents("tr").next(".variant-summary").remove(),$(this).parents("table").data(ACC.productorderform.selectedVariantData)?ACC.productorderform.selectedVariants=$(this).parents("table").data(ACC.productorderform.selectedVariantData):ACC.productorderform.selectedVariants=[],""==quantityBefore&&(quantityBefore=0,this.value=0)}),$(".sku-quantity").on("blur",function(event){var currentIndex=parseInt($(this).attr("id").match("[0-9]+")),totalPrice=0,_this=this,currentPrice=$("input[id='productPrice["+currentIndex+"]']").val();this.value=ACC.productorderform.filterSkuEntry(this.value);var $currentTotalItems=$(".js-total-items-count"),currentTotalItemsValue=$currentTotalItems.html(),currentTotalPrice=$(".js-total-price-value").val(),$gridGroup=$(this).parents(".orderForm_grid_group");if(isNaN(jQuery.trim(this.value))&&(this.value=0),quantityAfter=jQuery.trim(this.value),""==quantityAfter&&(quantityAfter=0,this.value=0),ACC.orderform)void 0!==sessionStorage.totalItems&&void 0!==sessionStorage.totalPriceVal&&(currentTotalItemsValue=sessionStorage.totalItems,currentTotalPrice=sessionStorage.totalPriceVal),0==quantityBefore?($currentTotalItems.html(parseInt(currentTotalItemsValue)+parseInt(quantityAfter)),
totalPrice=parseFloat(currentTotalPrice)+parseFloat(currentPrice)*parseInt(quantityAfter)):($currentTotalItems.html(parseInt(currentTotalItemsValue)+(parseInt(quantityAfter)-parseInt(quantityBefore))),totalPrice=parseFloat(currentTotalPrice)+parseFloat(currentPrice)*(parseInt(quantityAfter)-parseInt(quantityBefore))),sessionStorage.totalPrice=ACC.productorderform.formatTotalsCurrency(totalPrice),sessionStorage.totalItems=$currentTotalItems.html(),sessionStorage.totalPriceVal=totalPrice,ACC.orderform.addToSkuQtyInput(_this);else if($gridGroup&&$gridGroup.length>0){var $closestQuantityValue=$gridGroup.find("#quantityValue"),$closestAvgPriceValue=$gridGroup.find("#avgPriceValue"),$closestSubtotalValue=$gridGroup.find("#subtotalValue"),currentQuantityValue=$closestQuantityValue.val(),currentSubtotalValue=$closestSubtotalValue.val();0==quantityBefore?($closestQuantityValue.val(parseInt(currentQuantityValue)+parseInt(quantityAfter)),$closestSubtotalValue.val(parseFloat(currentSubtotalValue)+parseFloat(currentPrice)*parseInt(quantityAfter)),$currentTotalItems.html(parseInt(currentTotalItemsValue)+parseInt(quantityAfter)),totalPrice=parseFloat(currentTotalPrice)+parseFloat(currentPrice)*parseInt(quantityAfter)):($closestQuantityValue.val(parseInt(currentQuantityValue)+(parseInt(quantityAfter)-parseInt(quantityBefore))),$closestSubtotalValue.val(parseFloat(currentSubtotalValue)+parseFloat(currentPrice)*(parseInt(quantityAfter)-parseInt(quantityBefore))),$currentTotalItems.html(parseInt(currentTotalItemsValue)+(parseInt(quantityAfter)-parseInt(quantityBefore))),totalPrice=parseFloat(currentTotalPrice)+parseFloat(currentPrice)*(parseInt(quantityAfter)-parseInt(quantityBefore))),ACC.productorderform.enableBeforeUnloadEvent(quantityAfter,$currentTotalItems.text()),0!=$currentTotalItems.length&&0==$currentTotalItems.text()?(ACC.productorderform.$addToCartBtn.attr("disabled","disabled"),$(window).off("beforeunload",ACC.productorderform.beforeUnloadHandler)):ACC.productorderform.$addToCartBtn.removeAttr("disabled"),parseInt($closestQuantityValue.val())>0?$closestAvgPriceValue.val(parseFloat($closestSubtotalValue.val())/parseInt($closestQuantityValue.val())):$closestAvgPriceValue.val(0)}if($gridGroup&&$gridGroup.length>0){var gridLevelTotalPrice="",$gridTotalValue=$gridGroup.find("[data-grid-total-id=total_value_"+currentIndex+"]");quantityAfter>0&&(gridLevelTotalPrice=ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice)*parseInt(quantityAfter))),$gridTotalValue.html(gridLevelTotalPrice),ACC.productorderform.updateSelectedVariantGridTotal(this,quantityBefore,!1,!1)}$(".js-total-price").html(ACC.productorderform.formatTotalsCurrency(totalPrice)),$(".js-total-price-value").val(totalPrice)}),$("body").on("focusin","#cboxContent .sku-quantity",function(){quantityBefore=jQuery.trim(this.value);var currentVariantId=$(this).data("variant-id"),currentBaseInput=$("#AddToCartOrderForm, #cartOrderGridForm").find("[data-variant-id='"+currentVariantId+"']");currentBaseInput.trigger("focusin"),currentBaseInput.parents("table").find(".variant-summary").remove(),currentBaseInput.parents("table").data(ACC.productorderform.selectedVariantData)?ACC.productorderform.selectedVariants=currentBaseInput.parents("table").data(ACC.productorderform.selectedVariantData):ACC.productorderform.selectedVariants=[],""==quantityBefore&&(quantityBefore=0,this.value=0)}),$("body").on("blur","#cboxContent .sku-quantity",function(){var priceSibling=$(this).siblings(".price"),totalSibling=$(this).siblings(".data-grid-total"),currentVariantId=$(this).data("variant-id"),currentBaseInput=$("#AddToCartOrderForm, #cartOrderGridForm").find("[data-variant-id='"+currentVariantId+"']");this.value=ACC.productorderform.filterSkuEntry(this.value),(isNaN(jQuery.trim(this.value))||this.value<0||""==this.value)&&(this.value=0),currentBaseInput.val(this.value),currentBaseInput.trigger("blur"),ACC.productorderform.updateVariantTotal(priceSibling,this.value,totalSibling),this.value>0&&this.value!=quantityBefore?(currentBaseInput.parents("table").addClass("selected"),currentBaseInput.trigger("change")):0===ACC.productorderform.selectedVariants.length&&currentBaseInput.parents("table").removeClass("selected")})},updateSelectedVariantGridTotal:function(_this,quantityBefore,isFillQty,resetSummary){var priceSibling=$(_this).siblings(".price"),propSibling=$(_this).siblings(".variant-prop"),currentSkuId=$(_this).next(".td_stock").data("sku-id"),currentBaseTotal=$(_this).siblings(".data-grid-total");if(isFillQty&&(ACC.productorderform.selectedVariants=[]),_this.value!=quantityBefore){var newVariant=!0;ACC.productorderform.selectedVariants.forEach(function(item,index){item.id===currentSkuId&&(newVariant=!1,"0"===_this.value||0===_this.value?ACC.productorderform.selectedVariants.splice(index,1):(ACC.productorderform.selectedVariants[index].quantity=_this.value,ACC.productorderform.selectedVariants[index].total=ACC.productorderform.updateVariantTotal(priceSibling,_this.value,currentBaseTotal)))}),newVariant&&_this.value>0&&ACC.productorderform.selectedVariants.push({id:currentSkuId,size:propSibling.data("variant-prop"),quantity:_this.value,total:ACC.productorderform.updateVariantTotal(priceSibling,_this.value,currentBaseTotal)})}resetSummary&&$(_this).parents("table").find(".variant-summary").remove(),ACC.productorderform.showSelectedVariant($(_this).parents("table")),_this.value>0&&_this.value!=quantityBefore?$(_this).parents("table").addClass("selected"):0===ACC.productorderform.selectedVariants.length&&$(_this).parents("table").removeClass("selected").find(".variant-summary").remove()},updateVariantTotal:function(priceSibling,quantity,totalElement){var variantTotal=parseFloat(priceSibling.data("variant-price"))*parseInt(quantity);return totalElement.html(ACC.productorderform.formatTotalsCurrency(variantTotal)),ACC.productorderform.formatTotalsCurrency(variantTotal)},bindUpdateFutureStockButton:function(updateFutureStockButton){$("body").on("click",updateFutureStockButton,function(event){event.preventDefault();var $gridContainer=$(this).parents(".orderForm_grid_group").find(".product-grid-container"),$skus=jQuery.map($gridContainer.find("input[type='hidden'].sku"),function(o){return o.value}),skusId=$(this).data("skusId"),futureStockUrl=$(this).data("skusFutureStockUrl"),postData={skus:$skus,productCode:skusId},hideFutureStockInfo=$(this).parent().find(".hide_future_stock_info"),showFutureStockLink=$(this);$.ajax({url:futureStockUrl,type:"POST",data:postData,traditional:!0,dataType:"json",success:function(data){ACC.productorderform.updateFuture($gridContainer,$skus,data,skusId,showFutureStockLink,hideFutureStockInfo)},error:function(xht,textStatus,ex){alert("Failed to get delivery modes. Error details ["+xht+", "+textStatus+", "+ex+"]")}})})},bindHideFutureStockInfo:function(hideFutureStockInfoLink){$("body").on("click",hideFutureStockInfoLink,function(event){event.preventDefault();var gridContainer=$(this).parent().parent().find(".product-grid-container");$(this).parent().find(".update_future_stock_button").show(),$(this).hide(),gridContainer.find("[data-sku-id]").children(".future_stock, .out-of-stock").remove()})},updateFuture:function(gridContainer,skus,freshData,callerId,showFutureStockInfoLink,hideFutureStockInfo){ACC.productorderform.$omsErrorMessageContainer.find("div").remove(),null!==freshData&&void 0!==freshData["basket.page.viewFuture.unavailable"]?$.tmpl(ACC.productorderform.$omsErrorMessageTemplate,{errorMessage:freshData["basket.page.viewFuture.unavailable"]}).appendTo(ACC.productorderform.$omsErrorMessageContainer):function(obj){return Object.keys(obj).length<=0}(freshData)||(showFutureStockInfoLink.hide(),hideFutureStockInfo.css("display","block"),$.each(skus,function(index,skuId){var stocks=freshData[skuId],cell=gridContainer.find("[data-sku-id='"+skuId+"']"),isCurrentlyInStock=-1!=cell[0].attributes.class.nodeValue.indexOf("in-stock"),futureStockPresent=void 0!==stocks&&null!==stocks&&null!==stocks[0]&&void 0!==stocks[0];cell.children(".future_stock, .out-of-stock").remove(),futureStockPresent?(isCurrentlyInStock||cell.addClass("future-stock"),$.tmpl(ACC.productorderform.$futureTooltipTemplate,{formattedDate:stocks[0].formattedDate,availabilities:stocks}).appendTo(cell)):isCurrentlyInStock||(cell[0].attributes.class.nodeValue="td_stock out-of-stock")}))},toJSON:function(gridForm,skipZeroQuantity){for(var skus=gridForm.find("input.sku").map(function(index,element){return element.value}),skuQuantities=gridForm.find("input.sku-quantity").map(function(index,element){return parseInt(element.value)}),skusAsJSON=[],i=0;i<skus.length;i++)skipZeroQuantity&&0===skuQuantities[i]||skusAsJSON.push({product:{code:skus[i]},quantity:skuQuantities[i]});return JSON.stringify({cartEntries:skusAsJSON})},formatTotalsCurrency:function(amount){return Currency.formatMoney(Number(amount).toFixed(2),Currency.money_format[ACC.common.currentCurrency])},cleanValues:function(){if(0!==$(".orderForm_grid_group").length){var formattedTotal=ACC.productorderform.formatTotalsCurrency("0.00");$(".js-total-price").html(formattedTotal),$("#quantity, .js-total-items-count").html(0),$("#quantityValue, #avgPriceValue, #subtotalValue, .js-total-price-value").val(0),ACC.productorderform.$emptySkuQuantityInputs.val(0),ACC.productorderform.$totalGridValues.html("")}},calculateGrid:function(){ACC.productorderform.$nonEmptySkuQuantityInputs.trigger("focusout")},bindProductDetailToggle:function(productDetailToggle){productDetailToggle.on("click",function(event){event.preventDefault(),$(this).parents(".product-details").toggleClass("open")})},showSelectedVariant:function(currentVariant){$.tmpl(ACC.productorderform.$variantSummaryTemplate,{variants:ACC.productorderform.selectedVariants}).appendTo(currentVariant),$(".variant-summary .variant-property").html($(".variant-detail").data("variant-property")),currentVariant.data(ACC.productorderform.selectedVariantData,ACC.productorderform.selectedVariants),currentVariant.removeClass("currentVariant")},bindVariantSelect:function(variantSelectBtn,parentId){variantSelectBtn.on("click",function(event){event.preventDefault();var currentVariant=$(this).parents("table");currentVariant.data(ACC.productorderform.selectedVariantData)?ACC.productorderform.selectedVariants=currentVariant.data(ACC.productorderform.selectedVariantData):ACC.productorderform.selectedVariants=[];var titleHeader=variantSelectBtn.html(),tableWrap=$("#"+parentId).clone().empty().attr("id",parentId+"Variant");currentVariant.addClass("currentVariant");var popupContent=$(this).parents(".orderForm_grid_group").clone();currentVariant.removeClass("currentVariant"),$(popupContent).find(".currentVariant").siblings().remove(),tableWrap.html(popupContent),tableWrap.find(".hidden-xs").removeClass("hidden-xs"),tableWrap.find(".hide").removeClass("hide"),scrollTopPos=$("body").scrollTop(),$("body").scrollTop(0),ACC.colorbox.open(titleHeader,{html:tableWrap,width:"100%",reposition:!1,className:"variantSelectMobile",onCleanup:function(){ACC.productorderform.$addToCartOrderForm.find(".selected").length>0?ACC.productorderform.$addToCartBtn.removeAttr("disabled"):ACC.productorderform.$addToCartBtn.attr("disabled","disabled"),$("body").scrollTop(scrollTopPos)}})})},cancelVariantModal:function(closeVariantModal){$("body").on("click",closeVariantModal,function(event){event.preventDefault(),ACC.colorbox.close()})},resetSelectedVariant:function(){ACC.productorderform.selectedVariants=[],$(".product-grid-container table").removeData(ACC.productorderform.selectedVariantData).removeClass("selected").removeClass("currentVariant")},addToCartOrderGridForm:function(){$("#AddToCartOrderForm").keypress(function(event){"13"==event.which&&event.preventDefault()}),ACC.productorderform.$addToCartBtn.click(function(){ACC.productorderform.$addToCartBtn.attr("disabled","disabled"),$.ajax({url:ACC.productorderform.$addToCartOrderForm.attr("action"),type:"POST",dataType:"json",contentType:"application/json",data:ACC.productorderform.toJSON(ACC.productorderform.$addToCartOrderForm,!0),async:!1,success:function(response){$(window).off("beforeunload",ACC.productorderform.beforeUnloadHandler),ACC.product.displayAddToCartPopup(response),ACC.productorderform.cleanValues(),ACC.productorderform.resetSelectedVariant()},error:function(jqXHR,textStatus,errorThrown){console.log("The following error occured: "+textStatus,errorThrown)}})})},beforeUnloadHandler:function(){return ACC.productorderform.$addToCartOrderForm.attr("data-grid-confirm-message")},enableBeforeUnloadEvent:function(quantityAfter,currentTotalItems){ACC.orderform||quantityAfter>0&&currentTotalItems>0&&$(window).off("beforeunload",ACC.productorderform.beforeUnloadHandler).on("beforeunload",ACC.productorderform.beforeUnloadHandler)},filterSkuEntry:function(quantityInput){return/\D/g.test(quantityInput)?quantityInput.replace(/\D/g,""):quantityInput},coreTableScrollActions:function($scrollContent){if($scrollContent.hasClass("visible")){ACC.productorderform.orderGridScroll($scrollContent);var scrollRight=$scrollContent.parent().find(".order-form-scroll.right"),scrollLeft=$scrollContent.parent().find(".order-form-scroll.left"),scrollUp=$scrollContent.parent().find(".order-form-scroll.up"),scrollDown=$scrollContent.parent().find(".order-form-scroll.down"),widthReference=$scrollContent.find(".widthReference").outerWidth(),heightReference=$scrollContent.find(".product-grid-container table").eq(0).height()/2,maxWidth=0,maxHeight=0,widthDiff=0,heightDiff=0;$scrollContent.find(".product-grid-container table").each(function(){$(this).outerWidth()>maxWidth&&(maxWidth=$(this).outerWidth())}),$scrollContent.find(".orderForm_grid_group").each(function(){maxHeight+=$(this).height()}),widthDiff=maxWidth-$scrollContent.outerWidth(),heightDiff=maxHeight-$scrollContent.height()+14,$scrollContent.scroll(function(){$(this).scrollLeft()>0?scrollLeft.show():scrollLeft.hide(),$(this).scrollLeft()>=widthDiff?scrollRight.hide():scrollRight.show(),$(this).scrollTop()>0?scrollUp.show():scrollUp.hide(),$(this).scrollTop()>=heightDiff?scrollDown.hide():scrollDown.show(),$scrollContent.find(".update-future-stock").css("margin-right",-$(this).scrollLeft())}),$scrollContent.parent().find(".order-form-scroll").click(function(){var pos={left:$scrollContent.scrollLeft(),top:$scrollContent.scrollTop()};$(this).hasClass("right")?$scrollContent.scrollLeft(pos.left+widthReference):$(this).hasClass("left")?$scrollContent.scrollLeft(pos.left-widthReference):$(this).hasClass("up")?$scrollContent.scrollTop(pos.top-heightReference):$scrollContent.scrollTop(pos.top+heightReference)})}},orderGridScroll:function(scrollContent){var showRight=!1,calcHeight=0,maxWidth=$(scrollContent).find(".orderForm_grid_group").innerWidth(),maxHeight=$(scrollContent).innerHeight()-18;$(scrollContent).find(".product-grid-container table").each(function(){$(this).width()>maxWidth&&(showRight=!0),calcHeight+=$(this).height()}),showRight&&$(scrollContent).parent().find(".order-form-scroll.right").show(),calcHeight>maxHeight&&$(scrollContent).parent().find(".order-form-scroll.down").show()},calculateVariantTotal:function(_this,quantityToAdd){var $gridGroup=_this.parents(".orderForm_grid_group"),currentIndex=parseInt(_this.attr("id").match("[0-9]+")),currentPrice=$("input[id='productPrice["+currentIndex+"]']").val(),$gridTotalValue=$gridGroup.find("[data-grid-total-id=total_value_"+currentIndex+"]");quantityToAdd>0&&$gridTotalValue.html(ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice)*parseInt(quantityToAdd)))}},ACC.savedcarts={_autoload:[["bindRestoreSavedCartClick",0!=$(".js-restore-saved-cart").length],["bindDeleteSavedCartLink",0!=$(".js-delete-saved-cart").length],["bindDeleteConfirmLink",0!=$(".js-savedcart_delete_confirm").length],["bindSaveCartForm",0!=$(".js-save-cart-link").length||0!=$(".js-update-saved-cart").length],["bindUpdateUploadingSavedCarts",0!=$(".js-uploading-saved-carts-update").length]],$savedCartRestoreBtn:{},$currentCartName:{},bindRestoreSavedCartClick:function(){$(".js-restore-saved-cart").click(function(event){event.preventDefault();var popupTitle=$(this).data("restore-popup-title"),cartId=$(this).data("savedcart-id"),url=ACC.config.encodedContextPath+"/my-account/saved-carts/"+cartId+"/restore";$.get(url).done(function(data){ACC.colorbox.open(popupTitle,{html:data,width:500,onComplete:function(){ACC.common.refreshScreenReaderBuffer(),ACC.savedcarts.bindRestoreModalHandlers(),ACC.savedcarts.bindPostRestoreSavedCartLink()},onClosed:function(){ACC.common.refreshScreenReaderBuffer()}})})})},bindRestoreModalHandlers:function(){ACC.savedcarts.$savedCartRestoreBtn=$(".js-save-cart-restore-btn"),ACC.savedcarts.$currentCartName=$(".js-current-cart-name"),$(".js-prevent-save-active-cart").on("change",function(event){if(!0===$(this).prop("checked"))ACC.savedcarts.$currentCartName.attr("disabled","disabled"),ACC.savedcarts.$savedCartRestoreBtn.removeAttr("disabled");else{ACC.savedcarts.$currentCartName.removeAttr("disabled");var inputVal=ACC.savedcarts.$currentCartName.val();""==inputVal&&0===inputVal.length&&ACC.savedcarts.$savedCartRestoreBtn.attr("disabled","disabled")}}),ACC.savedcarts.$currentCartName.on("focus",function(event){$(".js-restore-current-cart-form").removeClass("has-error"),$(".js-restore-error-container").html("")}),ACC.savedcarts.$currentCartName.on("blur",function(event){""==this.value&&0===this.value.length?ACC.savedcarts.$savedCartRestoreBtn.attr("disabled","disabled"):ACC.savedcarts.$savedCartRestoreBtn.removeAttr("disabled")})},bindPostRestoreSavedCartLink:function(){var keepRestoredCart=!0,preventSaveActiveCart=!1;$(document).on("click",".js-keep-restored-cart",function(event){keepRestoredCart=$(this).prop("checked")}),$(document).on("click",".js-prevent-save-active-cart",function(event){preventSaveActiveCart=$(this).prop("checked")}),$(document).on("click",".js-save-cart-restore-btn",function(event){event.preventDefault();var cartName=$("#activeCartName").val(),url=$(this).data("restore-url"),postData={preventSaveActiveCart:preventSaveActiveCart,keepRestoredCart:keepRestoredCart,cartName:cartName};$.post(url,postData).done(function(result,data,status){if("200"==result){var url=ACC.config.encodedContextPath+"/cart";window.location.replace(url)}else{var errorMsg=status.responseText.slice(1,-1);$(".js-restore-current-cart-form").addClass("has-error"),$(".js-restore-error-container").html(errorMsg),$(".js-savedcart_restore_confirm_modal").colorbox.resize()}})}),$(document).on("click",".js-cancel-restore-btn",function(event){ACC.colorbox.close()})},bindDeleteSavedCartLink:function(){$(document).on("click",".js-delete-saved-cart",function(event){event.preventDefault();var cartId=$(this).data("savedcart-id"),popupTitle=$(this).data("delete-popup-title");ACC.colorbox.open(popupTitle,{inline:!0,className:"js-savedcart_delete_confirm_modal",href:"#popup_confirm_savedcart_delete_"+cartId,width:"500px",onComplete:function(){$(this).colorbox.resize()}})})},bindDeleteConfirmLink:function(){$(document).on("click",".js-savedcart_delete_confirm",function(event){event.preventDefault();var cartId=$(this).data("savedcart-id"),url=ACC.config.encodedContextPath+"/my-account/saved-carts/"+cartId+"/delete";$.ajax({url:url,type:"DELETE",success:function(response){ACC.colorbox.close();var url=ACC.config.encodedContextPath+"/my-account/saved-carts";window.location.replace(url)}})}),$(document).on("click",".js-savedcart_delete_confirm_cancel",function(event){ACC.colorbox.close()})},bindSaveCartForm:function(){var form=$("#saveCartForm"),saveCart=!1,showSaveCartFormCallback=function(){var title=$("#saveCart").data("saveCartTitle");ACC.colorbox.open(title,{href:"#saveCart",inline:!0,width:"620px",onOpen:function(){$("#saveCartName").val()&&ACC.savedcarts.disableSaveCartButton(!1)},onComplete:function(){$(this).colorbox.resize(),saveCart=!1},onClosed:function(){saveCart&&form.submit(),document.getElementById("saveCartForm").reset(),ACC.savedcarts.disableSaveCartButton(!0)}})};$(document).on("click",".js-save-cart-link, .js-update-saved-cart",function(e){e.preventDefault(),ACC.common.checkAuthenticationStatusBeforeAction(showSaveCartFormCallback)}),$(document).on("click","#saveCart #cancelSaveCartButton",function(e){e.preventDefault(),$.colorbox.close()}),$("#saveCartName").keyup(function(){$("#saveCart #saveCartButton").prop("disabled",""==this.value.trim());var tlength=$(this).val().length;$(this).val($(this).val().substring(0,255));var tlength=$(this).val().length;remain=255-parseInt(tlength),$("#saveCartName").text(remain)}),$(document).on("click","#saveCart #saveCartButton",function(e){e.preventDefault(),saveCart=!0,$.colorbox.close()})},disableSaveCartButton:function(value){$("#saveCart #saveCartButton").prop("disabled",value)},bindUpdateUploadingSavedCarts:function(){var cartIdRowMapping=$(".js-uploading-saved-carts-update").data("idRowMapping"),refresh=$(".js-uploading-saved-carts-update").data("refreshCart");if(cartIdRowMapping&&refresh){var interval=$(".js-uploading-saved-carts-update").data("refreshInterval"),arrCartIdAndRow=cartIdRowMapping.split(","),mapCartRow=new Object,cartCodes=[];for(i=0;i<arrCartIdAndRow.length;i++){var arrValue=arrCartIdAndRow[i].split(":");""!=arrValue&&(mapCartRow[arrValue[0]]=arrValue[1],cartCodes.push(arrValue[0]))}cartCodes.length>0&&setTimeout(function(){ACC.savedcarts.refreshWorker(cartCodes,mapCartRow,interval)},interval)}},refreshWorker:function(cartCodes,mapCartRow,interval){$.ajax({dataType:"json",url:ACC.config.encodedContextPath+"/my-account/saved-carts/uploadingCarts",data:{cartCodes:cartCodes},type:"GET",traditional:!0,success:function(data){if(void 0!=data){for(i=0;i<data.length;i++){var cart=data[i],index=$.inArray(cart.code,cartCodes);index>-1&&cartCodes.splice(index,1);var rowIdIndex=mapCartRow[cart.code];if(void 0!=rowIdIndex){var rowSelector="#row-"+rowIdIndex;$(rowSelector+" .js-saved-cart-name").removeClass("not-active"),$(rowSelector+" .js-saved-cart-date").removeClass("hidden"),$(rowSelector+" .js-file-importing").remove(),$(rowSelector+" .js-saved-cart-description").text(cart.description);var numberOfItems=cart.entries.length;$(rowSelector+" .js-saved-cart-number-of-items").text(numberOfItems),$(rowSelector+" .js-saved-cart-total").text(cart.totalPrice.formattedValue),numberOfItems>0&&$(rowSelector+" .js-restore-saved-cart").removeClass("hidden"),$(rowSelector+" .js-delete-saved-cart").removeClass("hidden")}}}cartCodes.length>0&&setTimeout(function(){ACC.savedcarts.refreshWorker(cartCodes,mapCartRow,interval)},interval)}})}},ACC.multidgrid={populateAndShowGridOverlay:function(element,event){event.preventDefault();var itemIndex=$(element).data("index"),gridEntries=$("#grid"+itemIndex),strSubEntries=gridEntries.data("sub-entries"),productName=gridEntries.data("product-name"),arrSubEntries=strSubEntries.split(","),firstVariantCode=arrSubEntries[0].split(":")[0],targetUrl=gridEntries.data("target-url")+"?productCode="+firstVariantCode;ACC.colorbox.open(productName,{href:targetUrl,className:"read-only-grid",close:'<span class="glyphicon glyphicon-remove"></span>',width:window.innerWidth>parseInt(cboxOptions.maxWidth)?cboxOptions.maxWidth:cboxOptions.width,height:window.innerHeight>parseInt(cboxOptions.maxHeight)?cboxOptions.maxHeight:cboxOptions.height,onComplete:function(){$("body").addClass("offcanvas");var oH=$("#cboxLoadedContent").height();$("#cboxLoadedContent").height(oH-$("#cboxTitle").height()+"px")},onClosed:function(){$("body").removeClass("offcanvas")}})},populateAndShowGrid:function(element,event,readOnly){var itemIndex=$(element).data("index");grid=$("#ajaxGrid"+itemIndex);var gridEntries=$("#grid"+itemIndex);if($(element).toggleClass("open"),!grid.is(":hidden"))return void grid.slideUp();if(""!=grid.html())return void grid.slideToggle("slow");var strSubEntries=gridEntries.data("sub-entries"),arrSubEntries=strSubEntries.split(","),firstVariantCode=arrSubEntries[0].split(":")[0],targetUrl=gridEntries.data("target-url");$.ajax({url:targetUrl,data:{productCode:firstVariantCode},type:"GET",success:function(data){grid.html(data),grid.slideDown("slow")},error:function(xht,textStatus,ex){alert("Failed to get variant matrix. Error details ["+xht+", "+textStatus+", "+ex+"]")}})}};var ACC=ACC||{};$("#quickOrder").length>0&&(ACC.quickorder={_autoload:["bindClearQuickOrderRow","bindAddSkuInputRow","bindResetFormBtn","bindAddToCartClick"],$quickOrderContainer:$(".js-quick-order-container"),$quickOrderMinRows:Number($(".js-quick-order-container").data("quickOrderMinRows")),$quickOrderMaxRows:Number($(".js-quick-order-container").data("quickOrderMaxRows")),$productExistsInFormMsg:$(".js-quick-order-container").data("productExistsInFormMsg"),$quickOrderLeavePageMsg:$("#quickOrder").data("gridConfirmMessage"),$hiddenSkuInput:"input.js-hidden-sku-field",$addToCartBtn:$("#js-add-to-cart-quick-order-btn-top, #js-add-to-cart-quick-order-btn-bottom"),$resetFormBtn:$("#js-reset-quick-order-form-btn-top, #js-reset-quick-order-form-btn-bottom"),$productInfoContainer:".js-product-info",$skuInputField:".js-sku-input-field",$qtyInputField:".js-quick-order-qty",$jsLiContainer:"li.js-li-container",$removeQuickOrderRowBtn:".js-remove-quick-order-row",$skuValidationContainer:".js-sku-validation-container",$qtyValidationContainer:".js-qty-validation-container",$productItemTotal:".js-quick-order-item-total",$classHasError:"has-error",bindResetFormBtn:function(){ACC.quickorder.$resetFormBtn.on("click",ACC.quickorder.clearForm)},bindAddToCartClick:function(){ACC.quickorder.$addToCartBtn.on("click",ACC.quickorder.addToCart)},bindAddSkuInputRow:function(){$(ACC.quickorder.$skuInputField).on("focusin",ACC.quickorder.addInputRow).on("focusout",ACC.quickorder.handleFocusOutOnSkuInput)},bindClearQuickOrderRow:function(){$(ACC.quickorder.$removeQuickOrderRowBtn).on("mousedown",ACC.quickorder.clearQuickOrderRow)},addToCart:function(){$.ajax({url:ACC.quickorder.$quickOrderContainer.data("quickOrderAddToCartUrl"),type:"POST",dataType:"json",contentType:"application/json",data:ACC.quickorder.getJSONDataForAddToCart(),async:!1,success:function(response){ACC.quickorder.handleAddToCartSuccess(response)},error:function(jqXHR,textStatus,errorThrown){console.log("The following error occurred: "+textStatus,errorThrown)}})},handleAddToCartSuccess:function(response){$(response.quickOrderErrorData).size()>0&&ACC.quickorder.disableBeforeUnloadEvent();var lookup={};response.quickOrderErrorData.forEach(function(el){lookup[el.sku]=el.errorMsg}),$(ACC.quickorder.$qtyInputField).each(function(){var parentLi=ACC.quickorder.getCurrentParentLi(this),sku=ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuInputField).val(),errorMsg=lookup[sku];errorMsg?ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuValidationContainer).text(errorMsg):ACC.quickorder.findElement(parentLi,ACC.quickorder.$removeQuickOrderRowBtn).trigger("mousedown")}),ACC.quickorder.handleBeforeUnloadEvent(),ACC.product.displayAddToCartPopup(response)},getJSONDataForAddToCart:function(){var skusAsJSON=[];return $(ACC.quickorder.$qtyInputField).each(function(){var qty=Number($(this).val());if(qty>0){var sku=jQuery.trim(ACC.quickorder.findElementInCurrentParentLi(this,ACC.quickorder.$skuInputField).val());skusAsJSON.push({product:{code:sku},quantity:qty})}}),JSON.stringify({cartEntries:skusAsJSON})},handleFocusOutOnSkuInput:function(event){ACC.quickorder.handleGetProduct(event),ACC.quickorder.handleBeforeUnloadEvent()},handleFocusOutOnQtyInput:function(event){ACC.quickorder.validateAndUpdateItemTotal(event),ACC.quickorder.enableDisableAddToCartBtn()},clearForm:function(){window.location.reload()},validateAndUpdateItemTotal:function(event){var parentLi=ACC.quickorder.getCurrentParentLi(event.target),qtyValue=jQuery.trim(ACC.productorderform.filterSkuEntry($(event.target).val()));if(isNaN(qtyValue)||""==qtyValue)qtyValue=0,$(event.target).removeClass(ACC.quickorder.$classHasError),ACC.quickorder.findElement(parentLi,ACC.quickorder.$qtyValidationContainer).text(""),$(event.target).val(0);else{qtyValue=Number(qtyValue),$(event.target).val(qtyValue);var maxQty=jQuery.trim(ACC.quickorder.findElement(parentLi,ACC.quickorder.$qtyInputField).data("maxProductQty")),stockLevelStatus=jQuery.trim(ACC.quickorder.findElement(parentLi,ACC.quickorder.$qtyInputField).data("stockLevelStatus"));if(maxQty=$.isEmptyObject(maxQty)&&"inStock"==stockLevelStatus?"FORCE_IN_STOCK":Number(maxQty),!isNaN(maxQty)&&qtyValue>maxQty){$(event.target).addClass(ACC.quickorder.$classHasError);var qtyValidationContainer=ACC.quickorder.findElement(parentLi,ACC.quickorder.$qtyValidationContainer);qtyValidationContainer.text(qtyValidationContainer.data("maxProductQtyMsg")),qtyValue=maxQty,$(event.target).val(maxQty)}else $(event.target).removeClass(ACC.quickorder.$classHasError),ACC.quickorder.findElement(parentLi,ACC.quickorder.$qtyValidationContainer).text("")}if(qtyValue>0){var itemPrice=parseFloat(ACC.quickorder.findElement(parentLi,".js-product-price").data("productPrice"));ACC.quickorder.findElement(parentLi,ACC.quickorder.$productItemTotal).html(ACC.productorderform.formatTotalsCurrency(itemPrice*qtyValue))}else ACC.quickorder.findElement(parentLi,ACC.quickorder.$productItemTotal).text("")},clearQuickOrderRow:function(){var quickOrderMinRows=ACC.quickorder.$quickOrderMinRows,parentLi=ACC.quickorder.getCurrentParentLi(this);$(".js-ul-container li.js-li-container").length>quickOrderMinRows?(parentLi.remove(),ACC.quickorder.bindClearQuickOrderRow()):(ACC.quickorder.findElement(parentLi,ACC.quickorder.$productInfoContainer).remove(),ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuValidationContainer).text(""),ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuInputField).val(""),ACC.quickorder.findElement(parentLi,ACC.quickorder.$hiddenSkuInput).val("")),ACC.quickorder.enableDisableAddToCartBtn(),ACC.quickorder.handleBeforeUnloadEvent()},addInputRow:function(event){if($(".js-quick-order-container li.js-li-container:last-child").find(ACC.quickorder.$skuInputField).is($(event.target))&&$(ACC.quickorder.$jsLiContainer).length<ACC.quickorder.$quickOrderMaxRows){var liClone=$(".js-quick-order-container li.js-li-container:first").clone();ACC.quickorder.findElement(liClone,ACC.quickorder.$productInfoContainer).remove(),ACC.quickorder.findElement(liClone,ACC.quickorder.$skuValidationContainer).text(""),ACC.quickorder.findElement(liClone,ACC.quickorder.$hiddenSkuInput).val("");var currentSkuInputField=ACC.quickorder.findElement(liClone,ACC.quickorder.$skuInputField);currentSkuInputField.val(""),currentSkuInputField.focusin(ACC.quickorder.addInputRow).focusout(ACC.quickorder.handleFocusOutOnSkuInput),ACC.quickorder.findElement(liClone,ACC.quickorder.$removeQuickOrderRowBtn).click(ACC.quickorder.clearQuickOrderRow),$(".js-ul-container").append(liClone)}},handleGetProduct:function(event){var parentLi=ACC.quickorder.getCurrentParentLi(event.target),productCode=$.trim(event.target.value);$(event.target).val(productCode),ACC.quickorder.isCurrentSkuSameAsPrevious(parentLi,productCode)||(productCode.length>0?(ACC.quickorder.findElement(parentLi,ACC.quickorder.$productInfoContainer).remove(),ACC.quickorder.isDuplicateSku(event.target,productCode)?ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuValidationContainer).text(ACC.quickorder.$productExistsInFormMsg):ACC.quickorder.getAndDisplayProductInfo(event,parentLi,productCode),ACC.quickorder.findElement(parentLi,ACC.quickorder.$hiddenSkuInput).val(productCode)):($(event.target).removeClass(ACC.quickorder.$classHasError),ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuValidationContainer).text(""),ACC.quickorder.findElement(parentLi,ACC.quickorder.$productInfoContainer).remove()))},isCurrentSkuSameAsPrevious:function(parentLi,productCode){return ACC.quickorder.findElement(parentLi,ACC.quickorder.$hiddenSkuInput).val()==productCode},isDuplicateSku:function(currentInput,productCode){var exists=!1
;return $(ACC.quickorder.$skuInputField).each(function(){if($(this).val()==productCode&&!$(this).is($(currentInput)))return exists=!0,!1}),exists},getAndDisplayProductInfo:function(event,parentLi,productCode){var url=ACC.config.encodedContextPath+"/quickOrder/productInfo?code="+productCode;$.getJSON(url,function(result){if(null!=result.errorMsg&&result.errorMsg.length>0)$(event.target).addClass(ACC.quickorder.$classHasError),ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuValidationContainer).text(result.errorMsg);else{$(event.target).removeClass(ACC.quickorder.$classHasError),ACC.quickorder.findElement(parentLi,ACC.quickorder.$skuValidationContainer).text(""),$("#quickOrderRowTemplate").tmpl(result.productData).insertAfter(ACC.quickorder.findElement(parentLi,".js-sku-container"));var qtyInputField=ACC.quickorder.findElement(parentLi,ACC.quickorder.$qtyInputField);qtyInputField.focusout(ACC.quickorder.handleFocusOutOnQtyInput);"outOfStock"==result.productData.stock.stockLevelStatus.code?(qtyInputField.val(0),qtyInputField.prop("disabled",!0)):qtyInputField.focus().select(),ACC.quickorder.enableDisableAddToCartBtn()}})},handleBeforeUnloadEvent:function(){ACC.quickorder.isAnySkuPresent()?(ACC.quickorder.disableBeforeUnloadEvent(),ACC.quickorder.enableBeforeUnloadEvent()):ACC.quickorder.disableBeforeUnloadEvent()},disableBeforeUnloadEvent:function(){$(window).off("beforeunload",ACC.quickorder.beforeUnloadHandler)},enableBeforeUnloadEvent:function(){$(window).on("beforeunload",ACC.quickorder.beforeUnloadHandler)},beforeUnloadHandler:function(){return ACC.quickorder.$quickOrderLeavePageMsg},enableDisableAddToCartBtn:function(){ACC.quickorder.shouldAddToCartBeEnabled()?ACC.quickorder.$addToCartBtn.removeAttr("disabled"):ACC.quickorder.$addToCartBtn.attr("disabled","disabled")},shouldAddToCartBeEnabled:function(){var sum=0,enable=!1;return $(ACC.quickorder.$qtyInputField).each(function(){var str=this.value.trim();if(str&&(sum+=parseInt(str,10)),sum>=1)return enable=!0,!1}),enable},isAnySkuPresent:function(){var present=!1;return $(ACC.quickorder.$skuInputField).each(function(){if(jQuery.trim(this.value))return present=!0,!1}),present},getCurrentParentLi:function(currentElement){return $(currentElement).closest(ACC.quickorder.$jsLiContainer)},findElement:function(currentElement,toFind){return $(currentElement).find(toFind)},findElementInCurrentParentLi:function(currentElement,toFind){return $(currentElement).closest(ACC.quickorder.$jsLiContainer).find(toFind)}}),ACC.login={_config:{element:{popup:"#sign-in__popup",sentEmailPopup:"#js-sent-email-popup",globalMsgWrapper:".js-login-global-msg-wrapper",globalMsg:".js-login-global-msg",usernameMsg:".js-login-username-msg",passwordMsg:".js-login-pwd-msg",verifyBtn:".js-login-verify-btn",loginBtn:".js-login-btn",username:"#j_username",password:"#j_password",phoneVerify:".js-verify-phone",captchaMsg:".js-login-captcha-miss",otpCaptchaMsg:".js-login-otp-captcha-miss",loginForm:".js-login-form",userInfo:".js-user--info",blockContent:"#sign-in__popup .modal-content"}},_autoload:[["initLocalIP",document.location.pathname.indexOf("delivery-address")<0],["bindSigninButton",document.location.pathname.indexOf("delivery-address")<0],["updateUserInfo",document.location.pathname.indexOf("delivery-address")<0]],data:{accountType:"",account:"",localIp:""},initLocalIP:function(){if(ACC.login.data.localIp="_UNDEFINED_",window.RTCPeerConnection=window.RTCPeerConnectiaccon||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,void 0!==window.RTCPeerConnection){var pc=new RTCPeerConnection({iceServers:[]}),noop=function(){};void 0!==pc.createDataChannel&&(pc.createDataChannel(""),pc.createOffer(pc.setLocalDescription.bind(pc),noop),pc.onicecandidate=function(ice){var ipRegex,myIP;ice&&ice.candidate&&ice.candidate.candidate&&(ipRegex=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(ice.candidate.candidate),myIP="","object"==typeof ipRegex&&ipRegex.length>1&&(myIP=ipRegex[1]),ACC.login.data.localIp=myIP,pc.onicecandidate=noop)})}},initDefaultForm:function(){ACC.common.loadModuleElements(ACC.login),this.popup.on("hidden.bs.modal",function(){ACC.login.refreshLoginForm(!0)}),this.popup.on("shown.bs.modal",function(){ACC.login.username.focus()}),this.refreshLoginForm(!0)},bindSigninButton:function(element){element=element||$(".js-sign-in__popup"),element.click(function(e){ACC.login.show()})},bindLoginSubmit:function(){this.loginBtn.click(function(event){event.preventDefault();var username=ACC.login.username.val().trim(),password=ACC.login.password.val(),url=ACC.common.attachCaptchaParameter("#sign-in__popup",ACC.config.localLoginUrl),data={j_username:username,j_password:password,localIp:ACC.login.data.localIp};ACC.login.block(),$.postJSONCallback(url,JSON.stringify(data),function(result){ACC.login.refreshLoginForm(),ACC.login.unblock(),result&&(result.showCaptcha&&ACC.captcha.renderWidget("js-login-captcha"),1===result.code?(ACC.login.globalMsg.html(result.globalMsg),ACC.login.globalMsgWrapper.show(),ACC.login.verifyBtn.show(),ACC.login.data.accountType=result.accountType,ACC.login.data.account=username,ACC.login.loginForm.addClass("has-error")):2===result.code?(ACC.login.globalMsg.html(result.globalMsg),ACC.login.globalMsgWrapper.show(),ACC.login.loginForm.addClass("has-error")):3===result.code?(ACC.login.usernameMsg.html(result.usernameMsg),ACC.login.passwordMsg.html(result.passwordMsg),ACC.login.loginForm.addClass("has-error"),ACC.captcha.showError("js-login-captcha",result.captchaMsg)):4===result.code&&ACC.login.handleLoginSuccess(username))},function(){ACC.login.unblock()})})},bindVerifyAccount:function(){this.verifyBtn.click(function(event){if(event.preventDefault(),ACC.login.data.accountType&&"email"===ACC.login.data.accountType.toLowerCase()&&ACC.login.data.account)$.get(ACC.config.sendLoginEmailUrl+"?username="+ACC.login.data.account,function(result){ACC.login.popup.modal("hide"),ACC.login.showEmailPopup()});else{ACC.login.block();var okHandler=function(response,textStatus,response){var otpHash=response.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,ACC.login.unblock(),ACC.login.hide(),ACC.adrOtpPopup.showInSuccess({phone:ACC.login.data.account},ACC.login.handleConfirmOtp)},errorHandler=function(jqXHR){var otpHash=jqXHR.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,ACC.login.unblock(),ACC.login.hide(),ACC.adrOtpPopup.showInError({phone:ACC.login.data.account},jqXHR.responseJSON.message,ACC.login.handleConfirmOtp)},data={createNew:!0,action:ACC.secureOTP.ACTIONS.PROFILE_VERIFY_PHONE};ACC.secureOTP.sendOTP(data,okHandler,errorHandler)}})},refreshLoginForm:function(all){all&&this.username.val(""),ACC.captcha.reset("js-login-captcha"),this.usernameMsg.html(""),this.passwordMsg.html(""),this.password.val(""),this.globalMsg.html(""),this.globalMsgWrapper.hide(),this.verifyBtn.hide()},handleLoginSuccess:function(username){this.hide(),location.reload(),ACC.minicart.clearCartPreview()},handlePageLoaded:function(){window.addEventListener("load",function(){})},handleCommentForm:function(){$("#anonymous-info").hide()},handleConfirmOtp:function(phone,otpCode){var data={otpCode:otpCode,username:phone};ACC.adrOtpPopup.block();var okHandler=function(result){ACC.adrOtpPopup.unblock(),ACC.adrOtpPopup.hide(),location.reload(),ACC.login.updateUserInfo(!0),ACC.suggestvinid.processSuggestVinID(phone)},errorHandler=function(jqXHR){ACC.adrOtpPopup.unblock(),ACC.adrOtpPopup.errorMsg.html(jqXHR.responseJSON.message),ACC.adrOtpPopup.successMsg.hide(),ACC.adrOtpPopup.resetCaptCha()};ACC.secureOTP.verifyOTP(otpCode,data,ACC.secureOTP.ACTIONS.PROFILE_VERIFY_PHONE,okHandler,errorHandler,"#js-otp-popup")},updateUserInfo:function(isForce){if(!(!isForce&&"true"!==ACC.config.isLogin)){var uidd="#userInfoDropdown";$(document).on("show.bs.dropdown",uidd,function(){ACC.requests.requestVinidInfo(),ACC.requests.requestUserMeta()}),$(uidd).hover(function(e){ACC.requests.requestVinidInfo(),ACC.requests.requestUserMeta()}),enquire.register("(max-width: 768px)",{match:function(){ACC.requests.requestVinidInfo()},deferSetup:!0})}},hide:function(){this.popup&&(this.refreshLoginForm(!0),this.popup.modal("hide"))},loadModal:function(callback){var _this=this;_this.popup?"function"==typeof callback&&callback():(ACC.helpers.showLoader(),$.ajax({url:"/popup-login",type:"GET",success:function(data){$("body").append(data),document.location.pathname.indexOf("delivery-address")<0&&(_this.initDefaultForm(),_this.bindLoginSubmit(),_this.bindVerifyAccount(),_this.bindFormSignUp()),ACC.helpers.hideLoader(),"function"==typeof callback&&callback()},error:function(data){ACC.helpers.hideLoader()}}))},showEmailPopup:function(options){var _this=this;options=options||{},this.loadModal(function(){"checkout"===options.type?_this.sentEmailPopup.find(".btn-shop-now").attr("data-dismiss","modal"):_this.sentEmailPopup.find(".btn-shop-now").removeAttr("data-dismiss","modal"),_this.sentEmailPopup.modal("show")})},show:function(){var _this=this;this.loadModal(function(){$.get(ACC.config.checkCaptchaUrl+"?localip="+ACC.login.data.localIp,function(result){result&&ACC.captcha.renderWidget("js-login-captcha")}),ACC.login.loginForm.removeClass("has-error"),_this.popup.modal("show")})},block:function(){this.blockContent.block()},unblock:function(){this.blockContent.unblock()},bindFormSignUp:function(){$(".js--open-sign-in__popup").click(function(e){ACC.login.hide(),ACC.register.show()})},updateUserEmail:function(email){window.mediator.publish("updateUserEmail",email)}},ACC.socialLogin={_config:{element:{popup:"#sign-in-social__popup",existing_popup:"#social-login-existing"}},_autoload:[],initElements:function(){ACC.common.loadModuleElements(ACC.socialLogin)},loadModal:function(callback){var _this=this;_this.popup?"function"==typeof callback&&callback():(ACC.helpers.showLoader(),$.ajax({url:"/popup-social",type:"GET",success:function(data){$("body").append(data),_this.initElements(),_this.initPageEvents(),_this.initResendOnClick(),ACC.helpers.hideLoader(),"function"==typeof callback&&callback()},error:function(data){ACC.helpers.hideLoader()}}))},showNotSupport:function(){var _this=this;_this.loadModal(function(){_this.popup.modal("show")})},showExistingPopup:function(email,provider,externalid,name,autoLogin){var _this=this;_this.loadModal(function(){_this.existing_popup.modal("show"),$("#userId1").text(email),$("#userId2").text(email),$("#providerId").text(provider),$("#externalId").text(externalid),$("#name").text(name),$("#autoLogin").val(autoLogin)})},initPageEvents:function(){$(document).on("click","#verificationAccountId",function(){var otpCode=$("#inputVerifyCodeId").val(),email=$("#userId2").text(),provider=$("#providerId").text(),externalId=$("#externalId").text(),autoLogin=$("#autoLogin").val(),formData={otpCode:otpCode,provider:provider,externalId:externalId};$("#social-login-existing").block();var success=function(){$("#social-login-existing").unblock(),$("#social-login-existing").modal("hide"),ACC.common.resetForm($("#social-login-existing")),autoLogin?window.location.href="/checkout":(location.reload(),ACC.suggestvinid.processSuggestVinID(email))},error=function(jqXHR){$("#social-login-existing").unblock(),ACC.suggestvinid.addErrorMessageToField($("#inputVerifyCodeId"),jqXHR.responseJSON.message)};ACC.secureOTP.verifyOTP(otpCode,formData,ACC.secureOTP.ACTIONS.SOCIAL_MAP_ADR,success,error)})},addErrorMessageToField:function(fieldGroup,error){var parentElement=fieldGroup.parent(),errorContainer=parentElement.find("p.error-message");"OK"===error?errorContainer.text(""):errorContainer.text(error)},initResendOnClick:function(){$(document).on("click","#resendOTPEmailId",function(event){event.preventDefault(),ACC.suggestvinid.addErrorMessageToField($("#inputVerifyCodeId"),""),ACC.common.resetForm($("#social-login-existing")),$("#social-login-existing").block();var success=function(){$("#social-login-existing").unblock(),$(".js-social-otp-resend-msg").removeClass("hide")},error=function(jqXHR){jqXHR.responseJSON&&($(".js-social-otp-resend-msg").addClass("hide"),$("#social-login-existing").unblock(),ACC.suggestvinid.addErrorMessageToField($("#inputVerifyCodeId"),jqXHR.responseJSON.message))};ACC.secureOTP.sendOTP(ACC.secureOTP.ACTIONS.SOCIAL_MAP_ADR,success,error)})}},ACC.register={_autoload:["bindSignUpButton"],formData:{signUpForm:"#sign-up__popup",modalContent:"#sign-up__popup .modal-content",formVinIdInfo:".signup-by-vinid__form",formAccountExisting:".signup-acc-existed__form",formEmailMissing:".sign-up-missing-email__form",formVerifyOtp:".sign-up-verifyotp__form",formControl:"input.form-control",formErrValidate:".error-message",signupRegisterVinForm:"#sign-up__registerVINID_form",itemVinId:".vinIdAccount__item",itemPwd:".pwd__item",itemCheckPwd:".checkPwd__item",itemEmailMiss:".email-missing__item",itemAccExisted:".account-existed__item",itemOtp:".otp__item",itemPhoneNumer:".phone__item",itemPhoneNumberHidden:".phone-hidden__item",itemEmailHidden:".email-hidden__item",itemCardNumberHidden:".card-hidden__item",itemOKOTPMessage:".vin03-otp-success",btnResendOtp:".resend-otp__button",btnForwardSignUpByVinId:".forward-signup-by-vinid__button",btnForwardLogin:".forward-login__button",btnForwardForgotPwd:".forward-forgotpwd__button",captchaVerifyOtpForm:"verify-otp-form__captcha",captchaVinIdForm:"vinid-form__captcha",captchaAccExistingForm:"account-existing-form__captcha",captchaNormalSignupForm:"js-signup-normal-register-captcha",captchaPhoneRegisterForm:"js-signup-phone-register-captcha",captchaErr:"VIN_CORE_010",otpNotMatch:"VIN_CORE_006",otpEmpty:"VIN_CORE_004",labelInfo2:".info2__label",labelInfo3:".info3__label",labelThanksRegistration:".thanks_registration_label",labelThanksMapping:".thanks_registration_mapping_label"},otpAction:"",dataTranfer:{customerFullName:"",email:"",emailHidden:"",password:"",confirmPassword:"",vinID:"",vinIdHidden:"",phoneNumber:"",phoneNumberHidden:"",identifyNumber:"",verifyOtpCode:"",verifyOtpType:ACC.config.otpRequestType.SINGUP_MAPPING_EXISTED_VINID_TO_NEW_ADR,gender:"",dateOfBirth:""},initElements:function(){ACC.common.loadModuleElements(ACC.register)},funcForwardLoginPage:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.btnForwardLogin).click(function(event){event.preventDefault(),$(ACC.register.formData.signUpForm).modal("hide"),ACC.login.show()})},funcForwardSignUpByVinIdPage:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.btnForwardSignUpByVinId).click(function(event){event.preventDefault();var elements=$(ACC.register.formData.signUpForm).find(ACC.register.formData.formControl);elements&&elements.val("");var formClear=$(ACC.register.formData.signUpForm).find(ACC.register.formData.formVinIdInfo);ACC.register.clearFormErrorMessage(formClear,ACC.register.formData.captchaVinIdForm),ACC.captcha.renderWidget(ACC.register.formData.captchaVinIdForm),ACC.captcha.reset(ACC.register.formData.captchaVinIdForm),ACC.common.stepEventModal(ACC.register.formData.signUpForm,10)})},funcOptResend:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.btnResendOtp).click(function(event){event.preventDefault(),$(ACC.register.formData.modalContent).block();var okHandler=function(response){ACC.captcha.renderWidget(ACC.register.formData.captchaVerifyOtpForm),$(ACC.register.formData.modalContent).unblock(),ACC.register.showSentOTPOkMessage(),ACC.register.removeErrorsOnVerifyOTP()},errorHandler=function(error){ACC.register.hideSentOTPOkMessage(),ACC.captcha.reset(ACC.register.formData.captchaVerifyOtpForm),ACC.register.showOTPError(error.responseJSON.message),$(ACC.register.formData.modalContent).unblock()};ACC.secureOTP.sendOTP(ACC.register.otpAction,okHandler,errorHandler)})},showOTPError:function(mes){ACC.register.clearFormErrorMessage($(ACC.register.formData.formVerifyOtp),ACC.register.formData.captchaVerifyOtpForm),$(ACC.register.formData.formVerifyOtp).find(ACC.register.formData.itemOtp).after("<p class='error-message'>"+mes+"</p>")},removeErrorsOnVerifyOTP:function(){ACC.register.clearFormErrorMessage($(ACC.register.formData.formVerifyOtp),ACC.register.formData.captchaVerifyOtpForm)},funcSubmitVinIdForm:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.formVinIdInfo).submit(function(event){event.preventDefault();var form=ACC.register.formData.formVinIdInfo;ACC.register.funcRegisterSend(form,ACC.register.formData.captchaVinIdForm)})},funcSubmitAccExistingForm:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.formAccountExisting).submit(function(event){event.preventDefault();var form=ACC.register.formData.formAccountExisting;ACC.register.funcRegisterSend(form,ACC.register.formData.captchaAccExistingForm)})},funcSubmitVinEmailMissing:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.formEmailMissing).submit(function(event){event.preventDefault(),$(ACC.register.formData.modalContent).block();var url=ACC.config.validateVinIdEmailMissingUrl,formEmailMiss=$(ACC.register.formData.signUpForm).find(ACC.register.formData.formEmailMissing),inputEmail=formEmailMiss.find(ACC.register.formData.itemEmailMiss),data={email:inputEmail.val()};$.postJSONCallback(url,JSON.stringify(data),function(result){if($(ACC.register.formData.modalContent).unblock(),"ERROR"==result){return void ACC.common.stepEventModal(ACC.register.formData.signUpForm,31)}var jsonObj=($(ACC.register.formData.signUpForm).find(ACC.register.formData.formEmailMissing),JSON.parse(result));if(jsonObj.exc){Number(jsonObj.exc.code);return ACC.register.dataTranfer.email=data.email,ACC.register.dataTranfer.emailHidden=jsonObj.exc.content.emailHidden,ACC.register.clearFormErrorMessage($(ACC.register.formData.formVerifyOtp),ACC.register.formData.captchaVerifyOtpForm),void ACC.register.moveToScreenVerifyOTP()}ACC.register.clearFormErrorMessage(formEmailMiss,"capchaId"),inputEmail.after("<p class='error-message'>"+jsonObj.content+"</p>")})})},functionSubmitVerifyOtp:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.formVerifyOtp).submit(function(event){event.preventDefault(),$(ACC.register.formData.modalContent).block();var itemOtp=$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemOtp);ACC.register.dataTranfer.verifyOtpCode=itemOtp.val();var formVerifyOtp=ACC.register.formData.formVerifyOtp,okHandler=(ACC.common.attachCaptchaParameter(formVerifyOtp,ACC.config.registerValidateOTPUrl),function(result){if(ACC.register.dataTranfer.otherAssociatedEmail=void 0,$(ACC.register.formData.modalContent).unblock(),"SUCCESS"==result)return $(ACC.register.formData.signUpForm).find(ACC.register.formData.itemEmailHidden).html(ACC.register.dataTranfer.email),void ACC.common.stepEventModal(ACC.register.formData.signUpForm,4);if("ERROR"==result)return void ACC.common.stepEventModal(ACC.register.formData.signUpForm,31);ACC.captcha.reset(ACC.register.formData.captchaVerifyOtpForm);var msgArr=JSON.parse(result).msg;if(msgArr&&msgArr.length>0)for(var i=0;i<msgArr.length;i++)msgArr[i].code==ACC.register.formData.captchaErr&&ACC.captcha.showError(ACC.register.formData.captchaVerifyOtpForm,msgArr[i].content),msgArr[i].code==ACC.register.formData.otpNotMatch?ACC.register.showOTPError(msgArr[i].content):msgArr[i].code==ACC.register.formData.otpEmpty&&ACC.register.showOTPError(msgArr[i].content)}),errorHandler=function(error){ACC.register.dataTranfer.otherAssociatedEmail=void 0,ACC.captcha.reset(ACC.register.formData.captchaVerifyOtpForm),ACC.register.showOTPError(error.responseJSON.message),$(ACC.register.formData.modalContent).unblock()};ACC.register.dataTranfer.otherAssociatedEmail=ACC.register.dataTranfer.email,ACC.secureOTP.verifyOTP(ACC.register.dataTranfer.verifyOtpCode,ACC.register.dataTranfer,ACC.register.otpAction,okHandler,errorHandler,ACC.register.formData.formVerifyOtp)})},funcRegisterSend:function(identifyForm,captchaId){$(ACC.register.formData.modalContent).block();var url=ACC.common.attachCaptchaParameter(identifyForm,ACC.config.validateVinIdFormUrl),formSelector=$(identifyForm),data={vinIdAccount:formSelector.find(ACC.register.formData.itemVinId).val(),pwd:formSelector.find(ACC.register.formData.itemPwd).val(),checkPwd:formSelector.find(ACC.register.formData.itemCheckPwd).val()};$.postJSONCallback(url,JSON.stringify(data),function(result,textStatus,response){if(ACC.captcha.reset(captchaId),result){var jsonObj=JSON.parse(result),excNextScreen=jsonObj.exc;if(excNextScreen){var nextScreen=Number(excNextScreen.code),data=excNextScreen.content;if($(ACC.register.formData.modalContent).unblock(),12==nextScreen)return void ACC.common.stepEventModal(ACC.register.formData.signUpForm,nextScreen);if(11==nextScreen&&(ACC.register.clearFormErrorMessage($(ACC.register.formData.formEmailMissing),ACC.register.formData.captchaVerifyOtpForm),ACC.common.stepEventModal(ACC.register.formData.signUpForm,nextScreen)),ACC.register.dataTranfer.customerFullName=data.customerFullName,ACC.register.dataTranfer.email=data.email,ACC.register.dataTranfer.emailHidden=data.emailHidden,ACC.register.dataTranfer.vinID=data.vinID,ACC.register.dataTranfer.vinIdHidden=data.vinIdHidden,ACC.register.dataTranfer.password=data.password,ACC.register.dataTranfer.confirmPassword=data.confirmPassword,ACC.register.dataTranfer.phoneNumber=data.phoneNumber,ACC.register.dataTranfer.phoneNumberHidden=data.phoneNumberHidden,ACC.register.dataTranfer.identifyNumber=data.identifyNumber,3==nextScreen)return ACC.register.clearFormErrorMessage($(ACC.register.formData.formVerifyOtp),ACC.register.formData.captchaVerifyOtpForm),ACC.register.dataTranfer.customerFullName=data.customerFullName,ACC.register.dataTranfer.email=data.email,ACC.secureOTP.otpHash=response.getResponseHeader("otpHash"),void ACC.register.moveToVerifyRegisterAdrByVinIDOTP();13==nextScreen&&(ACC.captcha.renderWidget(ACC.register.formData.captchaAccExistingForm),data.emailHidden?$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemAccExisted).html(data.emailHidden):data.phoneNumberHidden&&$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemAccExisted).html(data.phoneNumberHidden),ACC.common.stepEventModal(ACC.register.formData.signUpForm,nextScreen))}else{ACC.register.clearFormErrorMessage(formSelector,captchaId);var msgArr=jsonObj.msg;if(msgArr&&msgArr.length>0)for(var i=0;i<msgArr.length;i++)"captcha"==msgArr[i].code&&ACC.captcha.showError(captchaId,msgArr[i].content),formSelector.find("."+msgArr[i].code+"__item").after("<p class='error-message'>"+msgArr[i].content+"</p>");$(ACC.register.formData.modalContent).unblock()}}},function(error){$(ACC.register.formData.modalContent).unblock(),ACC.register.showErrorOnRegisterByVinID(error.responseJSON.message)})},showSentOTPOkMessage:function(){var container=$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemOKOTPMessage);container.hasClass("hidden")&&container.removeClass("hidden")},hideSentOTPOkMessage:function(){var container=$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemOKOTPMessage);container.hasClass("hidden")||container.addClass("hidden")},_config:{element:{popup:"#sign-up__popup",form:"#sign-up__popup_normal_register_form",buttonContinue:".js_button_normal_signup_continue",missedPhoneError:"#infor-missedPhone-error",buttonSignup:".js-sign-up__popup_button",normalSignupPassword:".js-normal-signup-password",clearTexts:".clearText"}},bindSignUpButton:function(element){element=element||$(".js-sign-up__popup_button"),element.off("click").click(function(event){event.preventDefault(),ACC.register.show()})},loadNormalSignup:function(){this.buttonContinue.off("click"),this.buttonContinue.click(function(event){event.preventDefault(),ACC.register.validateNormalSignupForm()}),this.form.submit(function(event){event.preventDefault(),ACC.register.validateNormalSignupForm()})},showLoginPage:function(){this.hide(),ACC.login.show()},validateNormalSignupForm:function(){var form=this.form,formDom=form.get(0),fullname=formDom.fullname.value,email=formDom.email.value,password=formDom.password.value,confirmPassword=formDom.confirmPassword.value,handleSuccessRespond=function(respond,textStatus,request){var otpHash=request.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,ACC.captcha.reset(ACC.register.formData.captchaNormalSignupForm),ACC.register.refeshNormalSignupError();var clearPassword=!0,data=respond.data,status=respond.status,errorCode=respond.errorCode,nextStep=respond.nextStep,errorMessage=(respond.title,respond.error);if(ACC.register.dataTranfer=data,"OK"==status)"createVINID"==nextStep?ACC.register.moveToScreenRegisterVinID():"verifyOTP"==nextStep&&ACC.register.moveToScreenSuggestToConnect();else if("FIELD_ERROR"==status){var fields=respond.fieldValidations;$.each(fields,function(name){"captcha"==name?ACC.captcha.showError(ACC.register.formData.captchaNormalSignupForm,fields[name]):ACC.register.addErrorMessageToField(formDom[name],fields[name])})}else if("FORM_MESSAGE"==status){if(ACC.register.showFormErrorMessage(errorMessage),"duplicatedEmail"==errorCode||"duplicatedPhone"==errorCode){var customerNeedToLogin=$(".js-normal-signup-login");customerNeedToLogin.off("click"),customerNeedToLogin.click(function(event){event.preventDefault(),ACC.register.showLoginPage()})}else if("existedVincard"==errorCode){clearPassword=!1;var verifyOTP=$(".js-normal-signup-continue-to-connect");verifyOTP.off("click"),verifyOTP.click(function(event){event.preventDefault(),ACC.register.moveToScreenVerifyOTP()})}}else"POP_UP_MESSAGE"==status&&ACC.common.stepEventModal(ACC.register.formData.signUpForm,12);clearPassword&&ACC.register.clearPasswordNormalSignup()},handleErrorResponse=function(xhr,ajaxOptions,thrownError){xhr&&xhr.responseJSON&&xhr.responseJSON.message&&ACC.register.showFormErrorMessage(xhr.responseJSON.message)};$.postJSONCallbackWithLoading(ACC.common.attachCaptchaParameter("#sign-up__popup_normal_register_form",ACC.config.validateNormalSignupUrl),JSON.stringify({customerFullName:fullname,email:email,pwd:password,checkPwd:confirmPassword}),handleSuccessRespond,handleErrorResponse,ACC.register.popup)},verifyADROTP:function(formVerifyOtp,successHandler,errorHandler){var url=ACC.common.attachCaptchaParameter(formVerifyOtp,ACC.config.signupValidateADROTPUrl);$.postJSONCallback(url,JSON.stringify(ACC.register.dataTranfer),function(result){successHandler(result),ACC.register.showSuccessData(),ACC.common.stepEventModal(ACC.register.formData.signUpForm,4)},function(error){errorHandler(error)})},verifyADROTPWithLoading:function(formVerifyOtp,successHandler,errorHandler){var onOK=function(result){successHandler(result),ACC.register.showSuccessData(),ACC.common.stepEventModal(ACC.register.formData.signUpForm,4)},onError=function(error){errorHandler(error)},otpCode=ACC.register.dataTranfer.verifyOtpCode;ACC.secureOTP.verifyOTP(otpCode,ACC.register.dataTranfer,ACC.secureOTP.ACTIONS.REGISTER_MAPPING_VINID,onOK,onError,formVerifyOtp,ACC.register.popup)},refeshNormalSignupError:function(){var form=this.form,formDom=form.get(0);ACC.register.addErrorMessageToField(formDom.fullname,""),ACC.register.addErrorMessageToField(formDom.email,""),ACC.register.addErrorMessageToField(formDom.password,""),ACC.register.addErrorMessageToField(formDom.confirmPassword,""),ACC.register.showFormErrorMessage(""),ACC.register.showErrorOnRegisterByVinID(""),ACC.captcha.reset(ACC.register.formData.captchaNormalSignupForm)},showPopupUpError:function(){this.hide(),this.missedPhoneError.modal("show")},addErrorMessageToField:function(fieldGroup,error){$(fieldGroup).parent().find("p.error-message").text(error)},showFormErrorMessage:function(errorMessage){this.form.parent().find("div.errorContainer").html(errorMessage)},clearFormErrorMessage:function(formClear,captchaId){formClear.find(ACC.register.formData.itemPwd).val(""),formClear.find(ACC.register.formData.itemCheckPwd).val("");var errField=formClear.find(ACC.register.formData.formErrValidate).not("#"+captchaId+"-error");errField&&errField.remove()},moveToScreenVerifyOTP:function(){ACC.register.removeErrorsOnVerifyOTP(),ACC.register.hideSentOTPOkMessage(),$(ACC.register.formData.formVerifyOtp).find(ACC.register.formData.itemOtp).val(""),$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemPhoneNumberHidden).html(ACC.register.dataTranfer.phoneNumberHidden),ACC.captcha.renderWidget(ACC.register.formData.captchaVerifyOtpForm),ACC.captcha.reset(ACC.register.formData.captchaVerifyOtpForm),ACC.common.stepEventModal(ACC.register.formData.signUpForm,3);var okHandler=(ACC.register.dataTranfer.vinID,ACC.config.otpRequestType.SINGUP_MAPPING_EXISTED_VINID_TO_NEW_ADR,function(response,textStatus,request){var otpHash=request.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,$(ACC.register.formData.modalContent).unblock()}),errorHandler=function(error){var errField=$(ACC.register.formData.formVerifyOtp).find(ACC.register.formData.formErrValidate).not("#"+ACC.register.formData.captchaVerifyOtpForm+"-error");errField&&errField.remove();var otpHash=error.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,ACC.captcha.reset(ACC.register.formData.captchaVerifyOtpForm),$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemOtp).after("<p class='error-message'>"+error.responseJSON.message+"</p>")};ACC.register.otpAction=ACC.secureOTP.ACTIONS.REGISTER_MAPPING_VINID;var data={createNew:!0,action:ACC.register.otpAction};ACC.secureOTP.sendOTP(data,okHandler,errorHandler)},moveToVerifyRegisterAdrByVinIDOTP:function(){ACC.register.removeErrorsOnVerifyOTP(),ACC.register.hideSentOTPOkMessage(),$(ACC.register.formData.formVerifyOtp).find(ACC.register.formData.itemOtp).val(""),$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemPhoneNumberHidden).html(ACC.register.dataTranfer.phoneNumberHidden),ACC.captcha.renderWidget(ACC.register.formData.captchaVerifyOtpForm),ACC.captcha.reset(ACC.register.formData.captchaVerifyOtpForm),ACC.common.stepEventModal(ACC.register.formData.signUpForm,3),ACC.register.otpAction=ACC.secureOTP.ACTIONS.REGISTER_ADR_BY_VINID},senADROTP:function(resend){var dataForSend={vinId:ACC.register.dataTranfer.vinID,type:ACC.config.otpRequestType.SINGUP_MAPPING_EXISTED_VINID_TO_NEW_ADR};return resend&&(dataForSend.resend=!0),ACC.otp.sendADROTP(dataForSend,ACC.otp.func.signInUp)},sendADROTPWithLoading:function(successHandler,errorHandler,resend){var otpAction=ACC.register.otpAction;_.isEmpty(otpAction)&&(otpAction=ACC.secureOTP.ACTIONS.REGISTER_MAPPING_VINID),ACC.secureOTP.sendOTP(otpAction,successHandler,errorHandler,void 0,ACC.register.popup)},moveToScreenRegisterVinID:function(){ACC.captcha.renderWidget(ACC.register.formData.captchaPhoneRegisterForm),ACC.captcha.reset(ACC.register.formData.captchaPhoneRegisterForm),ACC.common.stepEventModal(ACC.register.formData.signUpForm,ACC.registerVinID.id),ACC.registerVinID.initData()},moveToScreenSuggestToConnect:function(){ACC.registerSuggestConnect.initData(),ACC.common.stepEventModal(ACC.register.formData.signUpForm,ACC.registerSuggestConnect.id)},showErrorOnRegisterByVinID:function(mes){$(ACC.register.formData.signUpForm).find(ACC.register.formData.formVinIdInfo).parent().find(".errorContainer").text(mes)},clearPasswordNormalSignup:function(){this.normalSignupPassword.val("")},showSuccessData:function(){$(ACC.register.formData.signUpForm).find(ACC.register.formData.itemEmailHidden).html(ACC.register.dataTranfer.email)},hide:function(){this.popup&&this.popup.modal("hide")},show:function(){var _this=this;_this.loadModal(function(){ACC.register.refreshSignupForm(),ACC.captcha.renderWidget(ACC.register.formData.captchaNormalSignupForm),_this.popup.modal("show"),_this.popup.on("shown.bs.modal",function(){$('#sign-up__popup_normal_register_form [name="fullname"]').focus()})})},loadModal:function(callback){var _this=this;_this.popup?"function"==typeof callback&&callback():(ACC.helpers.showLoader(),$.ajax({url:"/popup-signup",type:"GET",success:function(data){
$("body").append(data),ACC.helpers.hideLoader(),ACC.multistep.init(),_this.initElements(),_this.funcForwardLoginPage(),_this.funcForwardSignUpByVinIdPage(),_this.funcOptResend(),_this.funcSubmitVinIdForm(),_this.funcSubmitAccExistingForm(),_this.funcSubmitVinEmailMissing(),_this.functionSubmitVerifyOtp(),_this.loadNormalSignup(),ACC.registerVinID.initElements(),ACC.registerVinID.initRegisterVinIDForm(),ACC.registerSuggestConnect.initElements(),ACC.registerSuggestConnect.initForm(),ACC.verifyVinOTP.initElements(),ACC.verifyVinOTP.bindResendVinOTP(),ACC.verifyVinOTP.bindVerifyVinOTP(),"function"==typeof callback&&callback()},error:function(data){ACC.helpers.hideLoader()}}))},refreshSignupForm:function(){ACC.register.clearTexts.val(""),ACC.register.refeshNormalSignupError()}},ACC.registerVinID={id:2,canSubmit:!0,_config:{element:{popup:"#sign-up__popup",form:"#sign-up__registerVINID_form",customerPhoneInput:".vinID-customer-phone",errorExistedPhoneContainer:".js-phone-number-existed",errorExistedMappingAdr:".js-existed-vin-mapped-with-adr",customerNeedToLogin:".js_register_vinid_need_to_login",buttonRegisterVinID:".js-sign-up-button-register-vin-id",errorVinIDCardContainer:".js-vinID17-card-number",errorEmailContainer:".js-vinID17-email",clickToConnectWithVinID:".js-vinID17-connectWithVinID",serverErrorContainer:".js-server-errorContainer"}},vinIDData:{fullname:"",identificationCardNumber:"",dob:"",email:"",hiddenEmail:"",phoneNumber:"",hiddenPhoneNumber:"",gender:"",address:"",subcribePromotion:"",vinIDCardNumber:"",hiddenVinIDCardNumber:""},_autoload:[],initElements:function(){ACC.common.loadModuleElements(ACC.registerVinID)},showServerErrorMessage:function(error){error?(ACC.registerVinID.serverErrorContainer.hasClass("hidden")&&ACC.registerVinID.serverErrorContainer.removeClass("hidden"),ACC.registerVinID.serverErrorContainer.text(error)):(ACC.registerVinID.serverErrorContainer.addClass("hidden"),ACC.registerVinID.serverErrorContainer.text(""))},initData:function(){this.customerPhoneInput.focusin(),this.resetForm()},initRegisterVinIDForm:function(){this.customerPhoneInput.off("change"),this.customerPhoneInput.change(function(event){event.preventDefault();var value=this.value;$.getJSON(ACC.config.validateVinIDPhoneURL,{phone:value},function(data){var object=$.parseJSON(data);"NOT_OK"==object.status?(ACC.registerVinID.resetErrors(),ACC.registerVinID.canSubmit=!1,ACC.registerVinID.showErrorExistedPhoneInADRSystem(object.data)):(ACC.registerVinID.canSubmit=!0,ACC.registerVinID.hideErrorExistedPhoneInADRSystem())})}),this.customerNeedToLogin.off("change"),this.customerNeedToLogin.click(function(event){event.preventDefault(),ACC.registerVinID.showLoginPage()}),this.buttonRegisterVinID.click(function(event){event.preventDefault(),ACC.registerVinID.handlerFormSubumit()}),this.form.submit(function(event){event.preventDefault(),ACC.registerVinID.handlerFormSubumit()}),this.clickToConnectWithVinID.off("click"),this.clickToConnectWithVinID.click(function(event){event.preventDefault(),ACC.register.dataTranfer.vinID=ACC.registerVinID.vinIDData.vinIDCardNumber,ACC.register.dataTranfer.vinIdHidden=ACC.registerVinID.vinIDData.hiddenVinIDCardNumber,ACC.register.dataTranfer.phoneNumber=ACC.registerVinID.vinIDData.phoneNumber,ACC.register.dataTranfer.phoneNumberHidden=ACC.registerVinID.vinIDData.hiddenPhoneNumber,ACC.register.moveToScreenVerifyOTP()})},handlerFormSubumit:function(){if(ACC.registerVinID.canSubmit){var form=ACC.registerVinID.form,phoneNumber=form.find("input[name=phoneNumber]").val(),day=form.find("select[name=day]").val(),month=form.find("select[name=month]").val(),year=form.find("select[name=year]").val(),gender=form.find("input:radio[name=gender]:checked").val(),identityNumber=form.find("input[name=identityCardNumber]").val(),address=form.find("input[name=address]").val(),subcribePromotion=form.find("input:checkbox[name=subcribePromotion]:checked").val(),url=ACC.common.attachCaptchaParameter("#sign-up__registerVINID_form",ACC.config.validateVinIDFormURL);$.postJSONCallbackWithLoading(url,JSON.stringify({email:ACC.register.dataTranfer.email,fullname:ACC.register.dataTranfer.customerFullName,phoneNumber:phoneNumber,dayOfBirth:day,monthOfBirth:month,yearOfBirth:year,gender:gender,address:address,identityCardNumber:identityNumber,subscribeVINIDPromotion:subcribePromotion,origin:"register_page"}),ACC.registerVinID.handleRegisterVinID,function(error){error.responseJSON.code&&ACC.registerVinID.showServerErrorMessage(error.responseJSON.message)},ACC.registerVinID.popup)}},handleRegisterVinID:function(respond,textStatus,request){var otpHash=request.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,ACC.registerVinID.resetErrors();var status=respond.status,nextStep=respond.nextStep,data=(respond.errorCode,respond.data);if(ACC.registerVinID.vinIDData=data,"OK"==status)ACC.register.dataTranfer.gender=ACC.registerVinID.vinIDData.gender,ACC.register.dataTranfer.dateOfBirth=ACC.registerVinID.vinIDData.dob,"verifyByVinOTP"==nextStep?ACC.registerVinID.moveToScreenVerifyByVinID():"suggestToConnect"==nextStep&&(ACC.register.dataTranfer.vinID=ACC.registerVinID.vinIDData.vinIDCardNumber,ACC.register.dataTranfer.vinIdHidden=ACC.registerVinID.vinIDData.hiddenVinIDCardNumber,ACC.register.dataTranfer.phoneNumber=ACC.registerVinID.vinIDData.phoneNumber,ACC.register.dataTranfer.phoneNumberHidden=ACC.registerVinID.vinIDData.hiddenPhoneNumber,ACC.register.dataTranfer.identifyNumber=ACC.registerVinID.vinIDData.identificationCardNumber,ACC.register.moveToScreenSuggestToConnect());else if("FIELD_ERROR"==status){var fields=respond.fieldValidations;ACC.registerVinID.showFieldErrors(fields)}else"FORM_MESSAGE"==status?ACC.registerVinID.showErrorExistedVinIDMappedWithADR():"POP_UP_MESSAGE"==status&&ACC.common.stepEventModal(ACC.register.formData.signUpForm,12)},moveToScreenVerifyByVinID:function(){ACC.verifyVinOTP.initData(),ACC.common.stepEventModal(ACC.register.formData.signUpForm,ACC.verifyVinOTP.id)},showFieldErrors:function(fields){var formDom=ACC.registerVinID.form.get(0);$.each(fields,function(name){"captcha"==name?ACC.captcha.showError(ACC.register.formData.captchaPhoneRegisterForm,fields[name]):ACC.registerVinID.addErrorMessageToField(formDom[name],fields[name])})},resetForm:function(){var form=ACC.registerVinID.form;form.find("input.clearText,select").val(""),form.find("select").val(""),form.find("input[name=gender]").val([""]),form.find("input[name=subcribePromotion]").prop("checked",!0),ACC.registerVinID.customerPhoneInput.val(""),ACC.registerVinID.customerPhoneInput.focusin(),ACC.registerVinID.resetErrors(),ACC.captcha.reset(ACC.register.formData.captchaPhoneRegisterForm)},resetErrors:function(){ACC.registerVinID.showFieldErrors({phoneNumber:"",dob:"",identityCardNumber:"",genderError:""}),ACC.registerVinID.hideErrorExistedVinIDMappedWithADR(),ACC.registerVinID.hideErrorExistedPhoneInADRSystem(),ACC.registerVinID.showServerErrorMessage(!1),ACC.captcha.reset(ACC.register.formData.captchaPhoneRegisterForm)},showErrorExistedVinIDMappedWithADR:function(){ACC.registerVinID.errorExistedMappingAdr.removeClass("hidden"),ACC.registerVinID.errorVinIDCardContainer.text(ACC.registerVinID.vinIDData.hiddenVinIDCardNumber),ACC.registerVinID.errorEmailContainer.text(ACC.registerVinID.vinIDData.hiddenEmail)},hideErrorExistedVinIDMappedWithADR:function(){ACC.registerVinID.errorExistedMappingAdr.addClass("hidden"),ACC.registerVinID.errorVinIDCardContainer.text(""),ACC.registerVinID.errorEmailContainer.text("")},showErrorExistedPhoneInADRSystem:function(phoneNumber){ACC.registerVinID.errorExistedPhoneContainer.removeClass("hidden"),ACC.registerVinID.errorExistedPhoneContainer.find("span.js-registerVinid-existed-phoneNumber").text(phoneNumber)},hideErrorExistedPhoneInADRSystem:function(){ACC.registerVinID.errorExistedPhoneContainer.addClass("hidden"),ACC.registerVinID.errorExistedPhoneContainer.find("span.js-registerVinid-existed-phoneNumber").text("")},addErrorMessageToField:function(fieldGroup,error){$(fieldGroup).parent().find("p.error-message").text(error)},showLoginPage:function(){this.hide(),ACC.login.show()},hide:function(){this.popup.modal("hide")},show:function(){this.popup.modal("show")}},ACC.registerSuggestConnect={_autoload:[],id:17,captchaFormID:"#sign-up_suggestVinID",captchaID:"js-vin17-captcha",_config:{element:{popup:"#sign-up__popup",form:"#sign-up_suggestVinID",resendOTPButton:"#js-vin17-adr-otp-resend",otpInput:"#js-vin17-otp-input",btnVerifyOtp:"#js-vin17-verify-otp-btn",cardNumberContainer:".js-vin17-cardNumber",phoneNumberContainer:".js-vin17-phoneNumber",otpErrorContainer:".js-vin17-errorOTPContainer",okMessageContainer:".vin17-ok"}},initElements:function(){ACC.common.loadModuleElements(ACC.registerSuggestConnect)},showOTPError:function(mes){ACC.registerSuggestConnect.otpErrorContainer.text(mes)},verifyOtp:function(){ACC.register.dataTranfer.verifyOtpCode=ACC.registerSuggestConnect.otpInput.val(),ACC.register.verifyADROTPWithLoading(ACC.registerSuggestConnect.captchaFormID,function(data){},function(error){error.responseJSON&&ACC.registerSuggestConnect.showOTPError(error.responseJSON.message)})},initForm:function(){ACC.registerSuggestConnect.resendOTPButton.click(function(event){event.preventDefault(),ACC.registerSuggestConnect.sendOTP(),ACC.registerSuggestConnect.resetForm()}),ACC.registerSuggestConnect.btnVerifyOtp.click(function(event){event.preventDefault(),ACC.registerSuggestConnect.verifyOtp(),ACC.registerSuggestConnect.resetForm()})},initData:function(){ACC.captcha.renderWidget(ACC.registerSuggestConnect.captchaID),ACC.registerSuggestConnect.cardNumberContainer.text(ACC.register.dataTranfer.vinIdHidden),ACC.registerSuggestConnect.phoneNumberContainer.text(ACC.register.dataTranfer.phoneNumberHidden),ACC.registerSuggestConnect.resetForm()},sendOTP:function(){var okHandler=function(data){ACC.registerSuggestConnect.resetForm(),ACC.registerSuggestConnect.showOKMessage()},errorHandler=function(error){ACC.registerSuggestConnect.resetForm(),ACC.registerSuggestConnect.showOTPError(error.responseJSON.message),ACC.registerSuggestConnect.hideOKMessage()};ACC.register.sendADROTPWithLoading(okHandler,errorHandler,!0)},showOKMessage:function(){ACC.registerSuggestConnect.okMessageContainer.hasClass("hidden")&&ACC.registerSuggestConnect.okMessageContainer.removeClass("hidden")},hideOKMessage:function(){ACC.registerSuggestConnect.okMessageContainer.addClass("hidden")},resetForm:function(){ACC.captcha.reset(ACC.registerSuggestConnect.captchaID),ACC.registerSuggestConnect.otpInput.val(""),ACC.registerSuggestConnect.otpErrorContainer.text(""),ACC.registerSuggestConnect.hideOKMessage()}},ACC.verifyVinOTP={id:33,captchaID:"verify-vinotp-form__captcha",_config:{element:{form:"#step-33-sign-up-verify-vinotp__form",btnResend:".vin-33-resend-vinotp__button",itemVinOtp:".vin-33-vinotp__item",btnVerify:".vin-33-verify-vinotp-form__button",phoneHidden:".vin-33-phone-hidden__item",successOTPMessage:".vin-33-send-vinotp-success"}},_autoload:[],initElements:function(){ACC.common.loadModuleElements(ACC.verifyVinOTP)},initData:function(){ACC.captcha.renderWidget(ACC.verifyVinOTP.captchaID),ACC.register.dataTranfer.gender=ACC.registerVinID.vinIDData.gender,ACC.register.dataTranfer.dateOfBirth=ACC.registerVinID.vinIDData.dob,ACC.register.dataTranfer.phoneNumber=ACC.registerVinID.vinIDData.phoneNumber,ACC.register.dataTranfer.phoneNumberHidden=ACC.registerVinID.vinIDData.phoneNumberHidden,ACC.register.dataTranfer.identifyNumber=ACC.registerVinID.vinIDData.identificationCardNumber,ACC.verifyVinOTP.phoneHidden.text(ACC.registerVinID.vinIDData.hiddenPhoneNumber),ACC.verifyVinOTP.resetForm()},reSendVinIdOTP:function(){$(ACC.register.formData.modalContent).block(),$(".send-vinotp-success").attr("style","display:none");var onOK=function(response){ACC.verifyVinOTP.showOKMessage(),$(ACC.register.formData.modalContent).unblock()},onError=function(error){$(ACC.register.formData.modalContent).unblock(),error.responseJSON&&($(ACC.verifyVinOTP._config.element.form).find(".vin-33-vinotp-error").html(error.responseJSON.message),ACC.verifyVinOTP.hideOKMessage())};ACC.secureOTP.sendOTP(ACC.secureOTP.ACTIONS.REGISTER_NEW_VINID,onOK,onError)},bindResendVinOTP:function(){ACC.verifyVinOTP.btnResend.click(function(event){event.preventDefault(),ACC.verifyVinOTP.reSendVinIdOTP()})},bindVerifyVinOTP:function(){ACC.verifyVinOTP.btnVerify.click(function(event){event.preventDefault();var otpCode=ACC.verifyVinOTP.itemVinOtp.val();ACC.register.dataTranfer.verifyOtpCode=otpCode,ACC.register.dataTranfer;ACC.common.attachCaptchaParameter(ACC.verifyVinOTP._config.element.form,ACC.config.signupValidateVinOTPUrl);$(ACC.register.formData.modalContent).block();var onOK=function(response){$(ACC.register.formData.modalContent).unblock(),ACC.register.showSuccessData(),ACC.common.stepEventModal(ACC.register.formData.signUpForm,4)},onError=function(error){$(ACC.register.formData.modalContent).unblock(),ACC.captcha.reset(ACC.verifyVinOTP.captchaID),error.responseJSON&&(error.responseJSON.message.includes("captcha")?ACC.captcha.showError(ACC.verifyVinOTP.captchaID,error.responseJSON.message):$(ACC.verifyVinOTP._config.element.form).find(".vin-33-vinotp-error").text(error.responseJSON.message))},otpCode=ACC.register.dataTranfer.verifyOtpCode;ACC.secureOTP.verifyOTP(otpCode,ACC.register.dataTranfer,ACC.secureOTP.ACTIONS.REGISTER_NEW_VINID,onOK,onError,ACC.verifyVinOTP._config.element.form)})},resetForm:function(){ACC.verifyVinOTP.itemVinOtp.val(""),$(ACC.verifyVinOTP._config.element.form).find(".vin-33-vinotp-error").html(""),ACC.verifyVinOTP.hideOKMessage(),ACC.captcha.reset(ACC.verifyVinOTP.captchaID)},showOKMessage:function(){ACC.verifyVinOTP.successOTPMessage.hasClass("hidden")&&ACC.verifyVinOTP.successOTPMessage.removeClass("hidden")},hideOKMessage:function(){ACC.verifyVinOTP.successOTPMessage.hasClass("hidden")||ACC.verifyVinOTP.successOTPMessage.addClass("hidden")}},ACC.otp={func:{signInUp:"SIGN_IN_UP",resetPass:"RESET_PASS",social:"SOCIAL",checkout:"CHECKOUT",autoCreate:"AUTO_CREATE"},sendADROTP:function(formData,otpFunc){return $.ajax({url:ACC.config.sendOTPUrl+"?otpfunc="+otpFunc,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},verifyADROTP:function(otpCode,url){var formData={otpCode:otpCode};return $.ajax({url:url||ACC.config.verifyOTPUrl,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},verifyVinIdOTP:function(formData,url){return $.ajax({url:url||ACC.config.verifyVinIdOTPUrl,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},resendVinIdOTP:function(formData,otpFunc){return $.ajax({url:ACC.config.reSendVinIdOTPUrl+"?otpfunc="+otpFunc,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},verifyAndMapADROTP:function(formData,url){return $.ajax({url:url||ACC.config.verifyOTPUrl,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},verifyAndMapADROTPFromProfile:function(formData,url){return $.ajax({url:url,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},verifyADROTPEmail:function(otpCode,email,provider,externalid,url,autoLogin){var formData={otpCode:otpCode,username:email,provider:provider,externalId:externalid,autoLogin:autoLogin};return $.ajax({url:url||ACC.config.verifyOTPUrl,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8"})},verifyADRVinIDRedeemOTP:function(formData,url){return $.ajax({url:url||ACC.config.verifyOTPADRRedeemUrl,type:"post",data:JSON.stringify(formData),dataType:"html",contentType:"application/json; charset=utf-8"})}},ACC.secureOTP={otpHash:"",ACTIONS:{FORGOT_PASSWORD:"FORGOT_PASSWORD",PROFILE_MAP_VINID:"PROFILE_MAP_VINID",PROFILE_NEW_VINID:"PROFILE_NEW_VINID",REGISTER_MAPPING_VINID:"REGISTER_MAPPING_VINID",REGISTER_NEW_VINID:"REGISTER_NEW_VINID",LOGGED_IN_NEW_VINID:"LOGGED_IN_NEW_VINID",LOGGED_IN_MAP_VINID:"LOGGED_IN_MAP_VINID",CHECKOUT_ORDER_PHONE_VERIFY:"CHECKOUT_ORDER_PHONE_VERIFY",CHECK_OUT_MAPPING_VINID:"CHECK_OUT_MAPPING_VINID",CHECK_OUT_NEW_VINID:"CHECK_OUT_NEW_VINID",SOCIAL_MAP_ADR:"MAP_ADR",REGISTER_ADR_BY_VINID:"REGISTER_ADR_BY_VINID",PROFILE_VERIFY_PHONE:"PROFILE_VERIFY_PHONE"},sendAjax:function(url,data,success,error,formID,loading){var newUrl=url;if(!_.isEmpty(formID)){var recaptchaVal=$(formID+" .g-recaptcha-response").val();newUrl=recaptchaVal&&null!=recaptchaVal?ACC.common.attachCaptchaParameter(formID,newUrl):newUrl+"?g-recaptcha-response="+ACC.captcha.getResponse(formID)}if(_.isEmpty(loading))return $.ajax({url:newUrl,type:"post",data:JSON.stringify(data),dataType:"json",success:success,error:error,contentType:"application/json; charset=utf-8"});var blockContainer=null;blockContainer=loading instanceof String?$(loading):loading;var beforeSendHandler=function(){blockContainer&&blockContainer.find(".ui-ajax-block").block()},completeHandler=function(){blockContainer&&blockContainer.find(".ui-ajax-block").unblock()};return $.ajax({url:newUrl,type:"post",data:JSON.stringify(data),dataType:"json",success:success,error:error,beforeSend:beforeSendHandler,complete:completeHandler,contentType:"application/json; charset=utf-8"})},sendOTP:function(data,success,error,capchaId,loading){var url=ACC.config.sendSecureOTPUrl,otpHash=null;otpHash="string"==typeof data||data instanceof String?{otpHash:ACC.secureOTP.otpHash,action:data}:data,ACC.secureOTP.sendAjax(url,otpHash,success,error,capchaId,loading)},verifyOTP:function(otpCode,formData,action,success,error,capchaId,loading){var url=ACC.config.verifySecureOTPUrl,data={otpHash:ACC.secureOTP.otpHash,otpToken:otpCode,action:action,data:JSON.stringify(formData)};ACC.secureOTP.sendAjax(url,data,success,error,capchaId,loading)},clearOTPHash:function(){ACC.secureOTP.otpHash=""}},ACC.adrOtpPopup={_config:{element:{popup:"#js-otp-popup",phoneLabel:".js-phone-number",resendOtpBtn:".js-resend-otp",confirmOtpBtn:".js-confirm-otp",otpTxt:".js-otp-txt",errorMsg:".js-otp-error-msg",successMsg:".js-otp-success-msg",rightPanel:".js-otp-right-panel",blockContent:"#js-otp-popup .modal-content"}},phone:null,onConfirm:null,init:function(){ACC.common.loadModuleElements(ACC.adrOtpPopup),this.popup.on("hidden.bs.modal",function(){ACC.adrOtpPopup.refresh()}),this.refresh()},bindConfirmOtp:function(){this.confirmOtpBtn.click(function(event){event.preventDefault();var otp=ACC.adrOtpPopup.otpTxt.val();ACC.adrOtpPopup.phone&&ACC.adrOtpPopup.onConfirm&&""!==otp.trim()&&ACC.adrOtpPopup.onConfirm(ACC.adrOtpPopup.phone,otp)})},bindResendOtp:function(){this.resendOtpBtn.click(function(event){if(event.preventDefault(),ACC.adrOtpPopup.phone){ACC.adrOtpPopup.block();var okhandler=function(response){ACC.adrOtpPopup.unblock(),ACC.adrOtpPopup.successMsg.show(),ACC.adrOtpPopup.errorMsg.html("")},errorHandler=function(jqXHR){ACC.adrOtpPopup.unblock(),jqXHR.responseJSON&&(ACC.adrOtpPopup.errorMsg.html(jqXHR.responseJSON.message),ACC.adrOtpPopup.successMsg.hide())};ACC.secureOTP.sendOTP(ACC.secureOTP.ACTIONS.PROFILE_VERIFY_PHONE,okhandler,errorHandler)}})},refresh:function(){this.errorMsg.html(""),this.otpTxt.val(""),this.successMsg.hide()},hide:function(){this.popup?(this.refresh(),this.popup.modal("hide")):$("#js-otp-popup")&&(this.refresh(),$("#js-otp-popup").hide()),this.unblock()},loadModal:function(callback){var _this=this;_this.popup?"function"==typeof callback&&callback():(ACC.helpers.showLoader(),$.ajax({url:"/popup-otp",type:"GET",success:function(data){$("body").append(data),_this.init(),_this.bindConfirmOtp(),_this.bindResendOtp(),ACC.helpers.hideLoader(),"function"==typeof callback&&callback()},error:function(data){ACC.helpers.hideLoader()}}))},showInSuccess:function(opt,onConfirm){var _this=this;_this.loadModal(function(){_this.phone=opt.phone,opt.ignoreRightPanel&&_this.rightPanel.hide(),_this.onConfirm=onConfirm,ACC.captcha.renderWidget("js-otp-captcha"),_this.phoneLabel.html(ACC.common.hidePhoneNumber(opt.phone)),_this.popup.modal("show")})},showInError:function(opt,errorMsg,onConfirm){var _this=this;_this.loadModal(function(){_this.phone=opt.phone,opt.ignoreRightPanel&&_this.rightPanel.hide(),_this.onConfirm=onConfirm,ACC.captcha.renderWidget("js-otp-captcha"),_this.phoneLabel.html(ACC.common.hidePhoneNumber(opt.phone)),_this.errorMsg.html(errorMsg),_this.successMsg.hide(),_this.popup.modal("show")})},attachCaptchaData:function(url){return ACC.common.attachCaptchaParameter("#js-otp-popup",url)},resetCaptCha:function(){ACC.captcha.reset("js-otp-captcha")},block:function(){this.blockContent.block()},unblock:function(){this.blockContent.unblock()}},ACC.otpCheckout={_config:{element:{paymentForm:"#vinPaymentDetailsForm"}},_autoload:["initElements","_bindOtpCheckout","_bindConfirmOtp","_bindResendOtp","_bindOtpReviewCheckout","_bindClose"],onConfirm:null,vinId:null,initElements:function(){ACC.common.loadModuleElements(ACC.otpCheckout)},_bindOtpCheckout:function(){$(document).on("click",".js-payment-checkout",function(e){e.preventDefault(),$(this).data("isoneclick")?$(ACC.otpCheckout._config.element.paymentForm).submit():ACC.otpCheckout.open({onFinish:function(){$(ACC.otpCheckout._config.element.paymentForm).submit()}})}),$(document).on("click",".js-payment-checkout-thankyou",function(e){e.preventDefault(),ACC.otpCheckout.validateCart({onFinish:function(){ACC.otpCheckout.open({onFinish:function(){$(ACC.otpCheckout._config.element.paymentForm).submit()}})}})})},_bindOtpReviewCheckout:function(){$(document).on("click",".js-payment-checkout-review",function(e){var entryNumber=$(".sidebar-product__item .js-remove-entry-button").attr("remove-entry"),disEntryNumber=$(".disable-entry-block").attr("disable-entry");void 0==entryNumber&&void 0==disEntryNumber&&(e.preventDefault(),ACC.otpCheckout.open({onFinish:function(){$(ACC.otpCheckout._config.element.paymentForm).submit()}})),"undefined"!=typeof gtmCheckoutSubmitFinal&&"function"==typeof gtmCheckoutSubmitFinal&&gtmCheckoutSubmitFinal($("#vinPaymentDetailsForm").serializeArray(),"Express")})},_bindConfirmOtp:function(){$(document).on("submit","#js-otp-checkout-confirm-form",function(e){e.preventDefault(),$.colorbox.resize();var otp=$(".js-otp-checkout-otp-input").val();if(""!==otp.trim()){var onFinish=ACC.otpCheckout.onFinish?ACC.otpCheckout.onFinish:function(){},data={otpCode:otp},onOkHandler=(ACC.config.otpCheckoutVerifyUrl,ACC.captcha.getResponse("js-otp-checkout-captcha"),function(result){ACC.colorbox.close(),onFinish()}),onErrorHandler=function(jqXHR){$(".js-otp-checkout-error-msg").html(jqXHR.responseJSON.message),$(".js-otp-checkout-success-msg").hide(),ACC.captcha.reset("js-otp-checkout-captcha"),$.colorbox.resize()};ACC.secureOTP.verifyOTP(otp,data,ACC.secureOTP.ACTIONS.CHECKOUT_ORDER_PHONE_VERIFY,onOkHandler,onErrorHandler,"js-otp-checkout-captcha")}})},_bindResendOtp:function(){$(document).on("click",".js-otp-checkout-resend-btn",function(e){e.preventDefault();var onSuccess=function(response){$(".js-otp-checkout-error-msg").html(""),$(".js-otp-checkout-success-msg").show(),ACC.colorbox.resize()},onError=function(jqXHR){$(".js-otp-checkout-error-msg").html(jqXHR.responseJSON.message),$(".js-otp-checkout-success-msg").hide(),ACC.colorbox.resize()};ACC.secureOTP.sendOTP(ACC.secureOTP.ACTIONS.CHECKOUT_ORDER_PHONE_VERIFY,onSuccess,onError)})},_bindClose:function(){$(document).on("click",".js-otp-checkout-close",function(e){e.preventDefault(),ACC.colorbox.close()})},open:function(options){this.onFinish=options.onFinish,$.blockUI();var onFinish=this.onFinish?this.onFinish:function(){};if("true"===ACC.config.checkout.requireCheckOtp){var data=$(ACC.otpCheckout._config.element.paymentForm).serialize();$.ajax({url:ACC.config.otpCheckoutNeededUrl,type:"POST",data:data,success:function(result,status,jqXHR){if(result){var otpHash=jqXHR.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,jqXHR.getResponseHeader("content-type").indexOf("text/html")>=0&&-1!=result.indexOf("page-cartPage")&&(window.location.href=ACC.config.contextPath+"/cart"),$.unblockUI(),ACC.otpCheckout._display(!1)}else onFinish()},error:function(jqXHR){ACC.otpCheckout._display(!0,jqXHR.responseJSON.message)}})}else onFinish()},validateCart:function(options){this.onFinish=options.onFinish,$.blockUI();var onFinish=this.onFinish?this.onFinish:function(){},data=$(ACC.otpCheckout._config.element.paymentForm).serialize();$.ajax({url:ACC.config.validateCartUrl,type:"POST",data:data,success:function(result){result?onFinish():$(ACC.otpCheckout._config.element.paymentForm).submit()}})},close:function(){ACC.colorbox.close()},_display:function(error,message){ACC.otpCheckout.colorbox=ACC.colorbox.open("",{href:ACC.config.otpCheckoutPopupUrl,maxWidth:"100%",width:"375px",reposition:!0,className:"popup-otp",scrolling:!1,onComplete:function(){ACC.captcha.renderWidgetForPopup("js-otp-checkout-captcha"),error&&($(".js-otp-checkout-success-msg").hide(),$(".js-otp-checkout-error-msg").html(message),$(".js-otp-checkout-error-msg").show()),$.colorbox.resize()},onOpen:function(){$("body").addClass("modal-open")},onClosed:function(){$("body").removeClass("modal-open")}})}},ACC.checkoutLogin={_config:{element:{txt_username:"#username",txt_password:"#password",f_form:"#js-checkout-login-form",btn_submit:"#js-checkout-login-form button[type=submit]",hidden_disabledUsername:"#disabledUsername",label_error:"#js-checkout-login-form .error-message",label_global_error:".checkout-block .alert.alert-warning"}},_autoload:[["initDefaultForm",$("#js-checkout-login-form").length>0],["autoFocusHandling",$("#js-checkout-login-form").length>0],["initLocalIP",$("#jlocalIp").length>0],["renderCaptcha",$("#js-checklogin-captcha").length>0]],initLocalIP:function(){if(window.RTCPeerConnection=window.RTCPeerConnectiaccon||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,void 0!==window.RTCPeerConnection){var pc=new RTCPeerConnection({iceServers:[]}),noop=function(){};void 0!==pc.createDataChannel&&(pc.createDataChannel(""),pc.createOffer(pc.setLocalDescription.bind(pc),noop),pc.onicecandidate=function(ice){var ipRegex,myIP;ice&&ice.candidate&&ice.candidate.candidate&&(ipRegex=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(ice.candidate.candidate),myIP="","object"==typeof ipRegex&&ipRegex.length>1&&(myIP=ipRegex[1]),$("#jlocalIp").val(myIP),pc.onicecandidate=noop)})}},renderCaptcha:function(){var captchaWidget=$("#js-checklogin-captcha");captchaWidget&&captchaWidget.length>0&&ACC.captcha.renderWidget("js-checklogin-captcha")},initDefaultForm:function(){ACC.common.loadModuleElements(ACC.checkoutLogin);var jsUserType=$("#js-checkout-login-form input[name=userType]"),jsPwd=$("#js-checkout-login-form .js-pwd");"G"==$("#js-checkout-login-form input[name=userType]:checked").val()&&jsPwd.hide(),jsUserType.on("change",function(){ACC.checkoutLogin.removeErrorMessage(),"C"==$("#js-checkout-login-form input[name=userType]:checked").val()?(jsPwd.show(),ACC.checkoutLogin.btn_submit.html(ACC.checkoutLogin.btn_submit.data("txt-login")),ACC.checkoutLogin.renderCaptcha()):(jsPwd.hide(),ACC.checkoutLogin.btn_submit.html(ACC.checkoutLogin.btn_submit.data("txt-payment")),$("#js-checklogin-captcha")&&$("#js-checklogin-captcha").html(""))}),$("#js-checkout-notacc").click(function(event){ACC.checkoutLogin.removeErrorMessage(),ACC.checkoutLogin.txt_username.prop("readonly",!1),ACC.checkoutLogin.txt_username.val(""),ACC.checkoutLogin.txt_username.focus(),ACC.checkoutLogin.hidden_disabledUsername.val(!1),ACC.checkoutLogin.renderCaptcha(),$("#login-type-selector").removeClass("hide")}),$("#login-type-selector").on("click",function(){$("#js-checkout-login-form #username").focus()}),$(".js-checkout-login-verify-btn").on("click",function(e){e.preventDefault();var username=$("#unverifiedUsername").val();"true"===$("#isEmailType").val()?($.blockUI(),$.get(ACC.config.sendLoginEmailUrl+"?username="+username,function(result){$.unblockUI(),ACC.login.showEmailPopup({type:"checkout"})})):($.blockUI(),ACC.otp.sendADROTP({username:username,type:ACC.config.otpRequestType.SIGNIN_VERIFY_PHONE},ACC.otp.func.signInUp).then(function(response){$.unblockUI(),ACC.adrOtpPopup.showInSuccess({phone:username},ACC.checkoutLogin.handleConfirmOtp)},function(jqXHR){$.unblockUI(),ACC.adrOtpPopup.showInError({phone:username},jqXHR.responseJSON.message,ACC.checkoutLogin.handleConfirmOtp)}))}),$("#js-checkout-login-form .btn-primary").click(function(){setTimeout(function(){$("#js-checkout-login-form .btn-primary").prop("disabled",!0)},0)})},autoFocusHandling:function(){ACC.checkoutLogin.f_form.find(":text, :password").each(function(){if(!this.disabled&&!this.readOnly)return this.focus(),!1})},removeErrorMessage:function(){ACC.checkoutLogin.label_global_error.remove(),ACC.checkoutLogin.label_error.remove()},handleConfirmOtp:function(phone,otpCode){var data=JSON.stringify({otpCode:otpCode,username:phone}),url=ACC.adrOtpPopup.attachCaptchaData(ACC.config.verifyLoginOTPUrl);ACC.adrOtpPopup.block(),$.postJSONCallback(url,data,function(result){ACC.adrOtpPopup.unblock(),ACC.adrOtpPopup.hide(),location.reload()},function(jqXHR){ACC.adrOtpPopup.unblock(),ACC.adrOtpPopup.errorMsg.html(jqXHR.responseJSON.message),ACC.adrOtpPopup.successMsg.hide(),ACC.adrOtpPopup.resetCaptCha()})}},ACC.adrFacet={_autoload:[["initFacet",$(".js-facet").length>0],"mobile_slide_product_stopper","mobile_slide_touch_coupons","slideProductStopper","ajax_add_discount_stopper_slide","copy_slide_discount_list","promotionFilter",["mobileSubCat",$(".pageType-CategoryPage").length>0]],initScroll:function($elem){$elem.find(".js-facet-list").hasClass("facet-list-scroll")},clickMoreFacet:function(element,action){if("more"==action){for(i=0;i<=19;i++){var position=$("."+element).find("li.hide:first").index();$("."+element).find("li").eq(position).removeClass("hide").attr("style","display:block"),"mobile"==ACC.devices.name&&$("."+element).find("li").eq(position).removeClass("hide").attr("style","display:block")}0==$("."+element).find("li.hide").length&&($(".show-more-facet-"+element).addClass("hide").attr("style","display:none"),$(".show-less-facet-"+element).removeClass("hide").attr("style","display:block"))}else{for(i=0;i<=100;i++){if(4==$("."+element).find('li[class=""]').length)return $(".show-more-facet-"+element).removeClass("hide").attr("style","display:block"),void $(".show-less-facet-"+element).addClass("hide").attr("style","display:none");var position=$("."+element).find('li[class=""]:last').index();$("."+element).find("li").eq(position).addClass("hide").attr("style","display:none"),"mobile"==ACC.devices.name&&$("."+element).find("li").eq(position).addClass("hide").attr("style","display:none")}4==$("."+element).find('li[class=""]').length&&($(".show-more-facet-"+element).removeClass("hide").attr("style","display:block"),$(".show-less-facet-"+element).addClass("hide").attr("style","display:none"))}},initMore:function($elem){var $list=$elem.find(".js-facet-list"),$items=$list.find(">li").not(".facet-btn");$items.length<=5||($items.filter(function(index,item){return index>=5}).hide(),$list.find(".js-facet-more").on("click",function(){$(this).toggleClass("is-more"),$items.filter(function(index,item){return index>=5}).toggle()}))},initFilter:function($elem){var $input,_this=this;$input=$elem.find(".js-facet-filter-input"),$input.on("input",function(){var txt,$this=$(this);if(""!=(txt=ACC.helpers.removeUnicode($.trim($this.val())))){var ulSec=$this.parent().next();$(ulSec).next().hide(),$(ulSec).find("li").removeClass("hide"),$(ulSec).parent().find(".facet-showmore").hide(),$(ulSec).parent().find(".facet-showless").hide()}else{var ulSec=$this.parent().next();$(ulSec).find("li").length>4?($(ulSec).find("li:gt(3)").addClass("hide"),$(ulSec).next().show(),$(ulSec).parent().find(".facet-showmore").removeClass("hide"),
$(ulSec).parent().find(".facet-showless").hide()):$(ulSec).find("li").removeClass("hide")}_this.applyFilter({keyword:txt,$list:$elem.find(".js-facet-list li")})})},initColor:function($elem){$elem.find(".facet-color").on("mouseover",function(){$(this).addClass("hover")}).on("mouseleave",function(){$(this).removeClass("hover")})},applyFilter:function(options){var $list=options.$list,keyword=options.keyword;$list.each(function(){var label,$item=$(this);label=ACC.helpers.removeUnicode($.trim($item.attr("data-label"))),label.match(keyword)?$item.removeClass("hidden"):$item.addClass("hidden")})},initFacet:function(){var swipe_button_length=0,facet_lsit=$(".js-custom-facet").find(".facet-list");$(".facet-group-title--new-version").on("click",function(){$(this).parent().toggleClass("zip-it"),$(this).find("i").hasClass("icon-decrease")?$(this).find("i").removeClass("icon-decrease").addClass("icon-increase"):$(this).find("i").removeClass("icon-increase").addClass("icon-decrease")}),$(".section__sidebar-title--new-version").on("click",function(){$(this).parent().toggleClass("zip-it"),$(this).find("i").hasClass("icon-decrease")?$(this).find("i").removeClass("icon-decrease").addClass("icon-increase"):$(this).find("i").removeClass("icon-increase").addClass("icon-decrease")}),window.innerWidth<480&&(facet_lsit.find("li").each(function(){swipe_button_length+=$(this).width()}),facet_lsit.css({width:(swipe_button_length+12*(facet_lsit.find("li").length+30))/2+"px"}));var _this=this;_this.$elem=$(".js-facet"),_this.$groups=_this.$elem.find(".js-facet-group"),_this.$groups.each(function(){var $this=$(this);$("body").width()>1023?_this.initScroll.call(_this,$this):_this.initMore.call(_this,$this),_this.initFilter.call(_this,$this),_this.initColor.call(_this,$this),_this.initEvent.call(_this,$this)})},mobile_slide_product_stopper:function(){if($("body").width()<=480){var hvlist=$("<div>",{class:"discount__tag--hover-list"}).html($(".discount__tag__container .discount__tag--list-slider").html()),content=$("<div>",{class:"discount__tag--content"}).html('<span class="title">Mã giảm giá</span><a href="#" class="close">×</a>').append(hvlist),listmob=$("<div>",{class:"discount__tag--hover"}).html(content);$(".discount__tag__container").append(listmob),$(".discount__tag--viewall").on("click",function(){$(".discount__tag--hover").parent().addClass("discount__list__show"),0==$(".page-couponsPage").length&&$("body, html").addClass("bodynoscrollable"),$(".discount__tag--hover .close, .discount__list__show .discount__tag--hover").click(function(e){e.target===this&&($(e.target).hasClass("close")&&e.preventDefault(),$(this).closest(".discount__list__show").removeClass("discount__list__show"),$("body, html").removeClass("bodynoscrollable"))})})}},slideProductStopper:function(){var buttonnext=$(".discount__tag--list-slider").find(".am-next"),buttonprev=$(".discount__tag--list-slider").find(".am-prev");$(".discount__tag--slider .owl-carousel").owlCarousel({loop:!1,margin:16,dots:!1,responsiveClass:!0,navText:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"><div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i>\n                        </div>\n                      </div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"><div class="d-icon f-row a-j-center"><i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i></div></div>'],navClass:[buttonnext,buttonprev],mouseDrag:!0,touchDrag:!0,responsive:{0:{items:1,autoWidth:!0,nav:!0,margin:8},480:{items:2,nav:!0},767:{items:3,nav:!0},1e3:{items:3,nav:!0},1200:{items:4,nav:!0}}}),$(".discount__tag--slider .owl-carousel .owl-item").length<=4&&$(".discount__tag--slider .owl-carousel .owl-nav").addClass("hide")},copy_slide_discount_list:function(){$(".js-discount-slide-tag__btncopy").on("click",function(event){event.preventDefault();var copyText=$(this).parent().parent().find(".js-discount-slide-tag__copymessage"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).find(".discount__tag--noti");$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3)})},ajax_add_discount_stopper_slide:function(){$(".js-discount-tag_btn_save_slide").on("click",function(){var _self=this;if(!$(_self).hasClass("add-active")){var dataString={dataId:$(_self).attr("data-id")};$.ajax({url:ACC.config.encodedContextPath+"/productDetail/addStopper",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){console.log(response);var spanStatus=$(_self).find(".discount__tag--noti").children("span"),messageBox=$(_self).find(".discount__tag--noti");$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3),"success"===response?($(_self).addClass("discount__tag--used").addClass("add-active"),$(_self).children("span").text("Đã lấy"),$(messageBox).removeClass("error").addClass("success"),$(spanStatus[1]).hide(),$(spanStatus[2]).hide()):($(messageBox).addClass("error").removeClass("success"),$(spanStatus[0]).hide(),$(spanStatus[2]).hide())}})}})},initEvent:function(){$(".js-open-filter").on("click",function(e){e.preventDefault(),$("#sidebar-wrapper").addClass("open"),$(".sort-menu__items").removeClass("open"),$(".sort-menu__backdrop").removeClass("show"),$("body").addClass("overflow-hidden")}),$(".js-close-filter").on("click",function(e){e.preventDefault(),$("#sidebar-wrapper").removeClass("open"),$(".sort-menu__items").removeClass("open"),$(".sort-menu__backdrop").removeClass("show"),$("body").removeClass("overflow-hidden")}),$(".js-open-sort").on("click",function(e){e.preventDefault(),$(".sort-menu__items").addClass("open"),$(".sort-menu__backdrop").addClass("show"),$("#sidebar-wrapper").removeClass("open"),$("body").addClass("overflow-hidden")}),$(".js-close-sort").on("click",function(e){e.preventDefault(),$(".sort-menu__items").removeClass("open"),$(".sort-menu__backdrop").removeClass("show"),$("#sidebar-wrapper").removeClass("open"),$("body").removeClass("overflow-hidden")}),$(".js-filter-price").on("click",function(){var from=$("input[name='formPrice']").val(),to=$("input[name='toPrice']").val();if(from&&to){var path=window.location.href;path=-1!==path.indexOf("Arelevance")?window.location.href+"%3AcustomPriceRange%3A["+from+"+-+"+to+"đ]":-1!==path.indexOf("?")?window.location.href+"&q=%3Arelevance%3AcustomPriceRange%3A["+from+"+-+"+to+"đ]":window.location.href+"?q=%3Arelevance%3AcustomPriceRange%3A["+from+"+-+"+to+"đ]",window.location.href=path}}),$(".js-facet-form").on("mousewheel DOMMouseScroll",function(e){var scrollTo=null;"mousewheel"===e.type?scrollTo=-1*e.originalEvent.wheelDelta:"DOMMouseScroll"===e.type&&(scrollTo=40*e.originalEvent.detail),scrollTo&&(e.preventDefault(),$(this).scrollTop(scrollTo+$(this).scrollTop()))})},mobile_slide_touch_coupons:function(){function simulateMouseEvent(event,simulatedType){if(!(event.originalEvent.touches.length>1)){event.preventDefault();var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent("MouseEvents");simulatedEvent.initMouseEvent(simulatedType,!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),event.target.dispatchEvent(simulatedEvent)}}if($.support.touch="ontouchend"in document,$.support.touch){var touchHandled,mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,_mouseDestroy=mouseProto._mouseDestroy;mouseProto._touchStart=function(event){var self=this;!touchHandled&&self._mouseCapture(event.originalEvent.changedTouches[0])&&(touchHandled=!0,self._touchMoved=!1,simulateMouseEvent(event,"mouseover"),simulateMouseEvent(event,"mousemove"),simulateMouseEvent(event,"mousedown"))},mouseProto._touchMove=function(event){touchHandled&&(this._touchMoved=!0,simulateMouseEvent(event,"mousemove"))},mouseProto._touchEnd=function(event){touchHandled&&(simulateMouseEvent(event,"mouseup"),simulateMouseEvent(event,"mouseout"),this._touchMoved||simulateMouseEvent(event,"click"),touchHandled=!1)},mouseProto._mouseInit=function(){var self=this;self.element.bind({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd")}),_mouseInit.call(self)},mouseProto._mouseDestroy=function(){var self=this;self.element.unbind({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd")}),_mouseDestroy.call(self)}}},promotionFilter:function(){$(".promotion-item .promotion-item-checkbox").on("click",function(){var type=$(this).closest(".promotion-item-checkbox").attr("data-type"),href=window.location.href,re=new RegExp(type+"=true");if(href=href.match(/\?page=[\d]+/)?href.match(/\?page=[\d]+\&/)?href.replace(/page=[\d]+\&/,""):href.replace(/\?page=[\d]+/,""):href.replace(/\&page=[\d]+/,""),re.test(href)){var _re=new RegExp("&"+type+"=true"),re_=new RegExp(type+"=true&"),reAlone=new RegExp("\\?"+type+"=true");href=_re.test(href)?href.replace(_re,""):re_.test(href)?href.replace(re_,""):reAlone.test(href)?href.replace(reAlone,""):href.replace(re,""),$(this).closest(".promotion-item-checkbox").removeClass("checked")}else href+=href.match(/\?/)?"&"+type+"=true":"?"+type+"=true",$(this).closest(".promotion-item-checkbox").addClass("checked");window.location.href=href})},mobileSubCat:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$(".pageType-CategoryPage").length&&$(".product-list__header").length){var newcatlist=$(".pageType-CategoryPage #sidebar-wrapper .section__category.section__sidebar--new-version").clone(),newcatlist2=$(".pageType-CategoryPage #sidebar-wrapper .section__category.section__sidebar--new-version").clone(),newCloneCatabList=$("<div/>",{class:"col-md-12 col-lg-12 subcat-bar"}).html(newcatlist),newCloneCatabListModal=$("<div/>",{class:"section__category-modal"}).html(newcatlist2);$(".product-list__header > .row:first-child").append(newCloneCatabList),$("body").append(newCloneCatabListModal),$(".btn-toogle-subcat").on("click",function(e){$("body").toggleClass("category-modal-open")}),$(document).on("click",".section__category-modal .category-menu .active.category-item",function(e){e.stopPropagation()}),$(document).on("click",".section__category-modal",function(e){$("body").toggleClass("category-modal-open")})}}},ACC.helpers={_autoload:["init",["initPopover",$(".js-pop-hover").length>0],["initShippingArea",$(".js-shippingArea").length>0],["initBootstrapDropDownForComponent",$('[data-toggle="dropdown"]').length>0],"bindTocrosswordForm","initTopMegaMenu"],formData:{formWidgetId:"#contactUs__form",helperLoader:"#loader",btnSumbitForm:"#btnCustomerSubmitRequest",btnCrossWord:"#btnCrossword",formCrossWord:"#crosswordForm",formCaptchaWidgetId:"js-contactUs-captcha",modalSuccessId:"#contactus-request-success__modal",modalErrorId:"#contactus-request-error__modal"},showLoader:function(){this.timeout=setTimeout(function(){$(ACC.helpers.formData.helperLoader).show().removeClass("hidden")},200)},hideLoader:function(){var _this=this;clearTimeout(_this.timeout),$(ACC.helpers.formData.helperLoader).hide().addClass("hidden")},deleteCookie:function(name){document.cookie=name+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},init:function(){$(ACC.helpers.formData.btnSumbitForm).off("click"),$(ACC.helpers.formData.btnSumbitForm).click(function(event){$("#btnCustomerSubmitRequest").attr("disabled","disabled"),event.preventDefault(),ACC.helpers.createTicketForCustomer()})},bindTocrosswordForm:function(){var $btnCrossword=$(ACC.helpers.formData.btnCrossWord);$(document).on("submit",ACC.helpers.formData.btnCrossWord,function(e){e.preventDefault()}),$btnCrossword.on("click",function(e){$("#crosswordForm").ajaxSubmit({success:function(response){if($("#nameError").html(""),$("#phoneError").html(""),$("#emailError").html(""),$("#answerError").html(""),"success"==response.status&&($("#crosswordForm").hide("slow"),$("#cwalreadyanswered").show("slow")),"duplicate"==response.status&&($("#crosswordForm").hide("slow"),$("#cwalreadyanswered").show("slow")),"fail"==response.status)for(errorInfo="",i=0;i<response.result.length;i++)"answer"==response.result[i].field&&($("#answerError").html(response.result[i].code),$("#answerError").show("slow")),"name"==response.result[i].field&&($("#nameError").html(response.result[i].code),$("#nameError").show("slow")),"phone"==response.result[i].field&&($("#phoneError").html(response.result[i].code),$("#phoneError").show("slow")),"email"==response.result[i].field&&($("#emailError").html(response.result[i].code),$("#emailError").show("slow"))},error:function(e){}}),e.preventDefault()})},createTicketForCustomer:function(){ACC.helpers.showLoader();var url=ACC.common.attachCaptchaParameter(".contact-form",ACC.config.contactUsUrl),dataObj=ACC.helpers.serializeObject($(ACC.helpers.formData.formWidgetId).serializeArray());$.postJSONCallback(url,JSON.stringify(dataObj),function(response){if(ACC.captcha.reset(ACC.helpers.formData.formCaptchaWidgetId),ACC.helpers.clearFormErrorMessage(),response&&"500"!=response.status||(ACC.helpers.hideLoader(),$(ACC.helpers.formData.modalErrorId).modal("show"),$("#btnCustomerSubmitRequest").prop("disabled",!1)),"400"==response.status){ACC.helpers.hideLoader();for(var i=0;i<response.result.length;i++)"name"==response.result[i].field&&($("#nameError").html(response.result[i].code),$("#nameError").show("slow")),"phone"==response.result[i].field&&($("#phoneError").html(response.result[i].code),$("#phoneError").show("slow")),"email"==response.result[i].field&&($("#emailError").html(response.result[i].code),$("#emailError").show("slow")),"orderNumber"==response.result[i].field&&($("#orderNumberError").html(response.result[i].code),$("#orderNumberError").show("slow")),"type"==response.result[i].field&&($("#typeError").html(response.result[i].code),$("#typeError").show("slow")),"subject"==response.result[i].field&&($("#subjectError").html(response.result[i].code),$("#subjectError").show("slow")),"description"==response.result[i].field&&($("#descError").html(response.result[i].code),$("#descError").show("slow")),"captcha"==response.result[i].field&&ACC.captcha.showError(ACC.helpers.formData.formCaptchaWidgetId,response.result[i].code);return $("#info").hide("slow"),$("#error").show("slow"),void $("#btnCustomerSubmitRequest").prop("disabled",!1)}if("200"==response.status){ACC.helpers.hideLoader();var string=$("#successText").html(),new_string=string.replace("Anonymous",name);return $("#successText").html(new_string),$(ACC.helpers.formData.modalSuccessId).modal("show"),$(ACC.helpers.formData.formWidgetId).trigger("reset"),void $("#btnCustomerSubmitRequest").prop("disabled",!1)}})},clearFormErrorMessage:function(){$("#nameError").html(""),$("#phoneError").html(""),$("#emailError").html(""),$("#orderNumberError").html(""),$("#typeError").html(""),$("#subjectError").html(""),$("#descError").html("")},serializeObject:function(formData){var o={};return $.each(formData,function(){o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o},initEventListener:function(){$("#js-toggle-help-menu").on("click",function(event){event.stopPropagation(),$(".section__sidebar-help").toggleClass("open")}),$(document).click(function(e){var container=$(".section__sidebar-help");container.is(e.target)||0!==container.has(e.target).length||container.removeClass("open")})},removeUnicode:function(str){return str?(str=str.toLowerCase(),str=str.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),str=str.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),str=str.replace(/ì|í|ị|ỉ|ĩ/g,"i"),str=str.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),str=str.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),str=str.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),str=str.replace(/đ/g,"d")):""},initPopover:function(argument){$(document).on("click",".js-pop-hover",function(e){var $target=$(e.target);($target.is(".pop-hover-static")||$target.parents(".pop-hover-static").length)&&e.stopPropagation()})},initBootstrapDropDownForComponent:function(){$('[data-toggle="dropdown"]').each(function(){var $parent=$(this).parent(),component=$(this).data("component"),idTmp=_.uniqueId("dropDown_");_.isEmpty($parent.attr("id"))&&(void 0!==component&&(idTmp=_.uniqueId(component+"_")),$parent.attr("id",idTmp))})},initShippingArea:function(){var els={contentSel:$("#content"),blockingEl:{overlay:".blockOverlay",message:".blockMsg"},floatEl:{sel:$(".pop-hover-floating"),closeBtn:".location-notify .close",openBtn:".open-shipping-area"},mainEl:".js-shippingArea",shipping:{address:"#deliveryRecentAddress a",city:"#shipping--zone-city",street:"#shipping--zone-street",district:"#shipping--zone-district",ward:"#shipping--zone-ward",submit:"#btnSubmit"}},setShippingAddress=function(){_.isEmpty(ACC.delivery.selectedProvince)||(ACC.selectize.set(els.shipping.city,ACC.delivery.selectedProvince,"silent"),ACC.selectize.unblock(els.shipping.city)),_.isEmpty(ACC.delivery.selectedDistrict)||(ACC.requests.location.district(els.shipping.district,ACC.delivery.selectedProvince,0),ACC.selectize.set(els.shipping.district,ACC.delivery.selectedDistrict,"silent"),ACC.selectize.unblock(els.shipping.district)),_.isEmpty(ACC.delivery.selectedWard)||(ACC.requests.location.ward(els.shipping.ward,ACC.delivery.selectedProvince,ACC.delivery.selectedDistrict,0),ACC.selectize.set(els.shipping.ward,ACC.delivery.selectedWard,"silent"),ACC.selectize.unblock(els.shipping.ward))};ACC.helpers.loadTriggerCompoLocation=!1,ACC.helpers.loadCompoLocation=function(){if(!ACC.helpers.loadTriggerCompoLocation){ACC.selectize.init(".js-selectize-lazy");var delvz_els=ACC.delivery.deliveryZone.elements;ACC.requests.triggerComboLocation(delvz_els.city,delvz_els.district,delvz_els.ward,delvz_els.street,{province:ACC.delivery.selectedProvince,district:ACC.delivery.selectedDistrict,ward:ACC.delivery.selectedWard},1),ACC.helpers.loadTriggerCompoLocation=!0}},$(document).on("click",".js-change_delivery, .js-change_delivery_pdp, .js-change_delivery_nonTextChange",function(e){e.preventDefault(),e.stopPropagation();var id="#shippingArea_2";$(id).hasClass("open")||(ACC.helpers.loadCompoLocation(),$(id).addClass("open"),$(els.mainEl).removeClass("is-default-active"),setShippingAddress()),$("html, body").animate({scrollTop:0},"fast")}),ACC.helpers.loadTriggerCompoLocation=!1,$(document).on("show.bs.dropdown",els.mainEl,function(e){ACC.helpers.loadCompoLocation(),$(els.mainEl).removeClass("is-default-active"),setShippingAddress(),ACC.helpers.deleteCookie("adayroi_notify_delivery_zone_cookie")}),$(document).on("hidden.bs.dropdown",els.mainEl,function(e){els.contentSel.unblock()}),$(document).on("click",els.floatEl.closeBtn,function(e){$(els.mainEl).removeClass("is-default-active"),els.floatEl.sel.css("display","none"),ACC.helpers.deleteCookie("adayroi_notify_delivery_zone_cookie")}),$(document).on("click",els.floatEl.openBtn,function(e){e.stopPropagation(),ACC.helpers.loadCompoLocation(),$(els.mainEl).removeClass("is-default-active"),$(els.mainEl).addClass("open"),ACC.helpers.deleteCookie("adayroi_notify_delivery_zone_cookie"),setShippingAddress()})},buildTopMegaMenu:function(){if(ACC.topMegamenuData){var html="";ACC.topMegamenuData.forEach(function(data){if(data){if(html+='<li class="menu__cat-item">',html+='<a class="menu__cat-link" href="'+data.url+'" data-uid="'+data.uid+'" '+data.responsiveImageUrl+" "+data.responsiveImageAlt+" "+data.respImageSubUrl0+" "+data.respImageSubUrl1+" "+data.respImageSubUrl2+" "+data.respImageSubUrl3+" "+data.respImageSubUrl4+" "+data.respImageSubUrl5+">"+data.name+"</a>",html+='<div class="menu__cat-list menu__cat-list--child">',data.topChildItems&&data.topChildItems.length>0&&(html+='<div class="menu__cat-hot-link">',data.topChildItems.forEach(function(topChildItem){html+='<a href="'+topChildItem.url+'"><h3 class="have__hot-icon"><span class="infor-sale">'+topChildItem.name+"</span>",topChildItem.cssClass?html+='<i class="'+topChildItem.cssClass+'"></i>':topChildItem.iconUrl&&(html+='<img class="icon-mb" alt="" src="'+topChildItem.iconUrl+'" alt="">'),html+="</h3></a>"}),html+="</div>",html+="<hr/>"),data.childItems){var count=Math.ceil(data.childItems.length/2),index=0;html+='<div class="sub-categories"> <div class="row"> <div class="col-xs-6">',data.childItems.forEach(function(childItem){index>0&&index%count==0&&(html+='</div><div class="col-xs-6">'),html+='<div class="sub-categories-item">',html+='<h3 class="h3-style"><a href="'+childItem.url+'" class="item-strong">'+childItem.name+"</a></h3>",childItem.childItems&&(html+="<ul>",childItem.childItems.forEach(function(item){html+="<li>",item.url?html+='<a href="'+item.url+'">'+item.name+"</a>":html+='<a href="#">'+item.name+"</a>",html+="</li>"}),html+="</ul>"),html+="</div>",html+="</h3></a>",index++}),html+="</div> </div> </div>"}html+='<div class="view-all-submenu"> <hr/> <a class="c-button--category-content" href="'+data.url+'"> <div> <span>Xem tất cả '+data.name+'</span> </div> <div class="c-icon"> <i class="polish-version-icon-arrow-right"></i> </div> </a> </div>',html+="</div>"}})}return html},buildHomeItemMegaMenu:function(id){var parent="#"+id;if($(parent).find(".menu__cat-content").length>0)return!1;var html="";if(void 0!==ACC.homeMegaMenu&&null!==ACC.homeMegaMenu){for(var dataMenu={},i=0;i<ACC.homeMegaMenu.length;i++)if(ACC.homeMegaMenu[i].parentId===id){dataMenu=ACC.homeMegaMenu[i];break}if(html="",null!==dataMenu){var maxCount=window.megaMenuMaxItem,itemCols=3,cols=1;dataMenu.childItems&&(itemCols=Math.ceil(dataMenu.childItems.length/maxCount),cols=Math.floor(12/itemCols));var clsOneCol="";if(12==cols&&(clsOneCol="one-col"),html+='<div class="menu__cat-content"><div class="menu__cat-content--inner">',html+='<div class="menu__cat-list menu__cat-list--child '+clsOneCol+'">',dataMenu.topChildItems&&dataMenu.topChildItems.length>0&&(html+='<div class="menu__cat-hot-link">',dataMenu.topChildItems.forEach(function(topChildItem){html+='<a href="'+topChildItem.url+'"><h3 class="have__hot-icon"><span class="infor-sale">'+topChildItem.name+"</span>",topChildItem.cssClass?html+='<i class="'+topChildItem.cssClass+'"></i>':topChildItem.iconUrl&&(html+='<img class="icon-mb" alt="" src="'+topChildItem.iconUrl+'" alt="">'),html+="</h3></a>"}),html+="</div>",html+="<hr/>"),dataMenu.childItems){var index=0,classCol="col-md-"+cols;html+='<div class="sub-categories"> <div class="row"> <div class="'+classCol+'">',dataMenu.childItems.forEach(function(childItem){childItem&&(index>0&&index%maxCount==0&&(html+='</div><div class="'+classCol+'">'),html+='<div class="sub-categories-item">',html+='<h3 class="h3-style"><a href="'+childItem.url+'" class="item-strong">'+childItem.name+"</a></h3>",childItem.childSub&&(html+="<ul>",childItem.childSub.forEach(function(item){html+="<li>",item.url?html+='<a class="p-b-2" href="'+item.url+'">'+item.name+"</a>":html+='<a class="p-b-2" href="#">'+item.name+"</a>",html+="</li>"}),html+="</ul>"),html+="</div>",html+="</h3></a>",index++)}),html+="</div> </div> </div>"}html+="</div>",html+='<div class="menu__cat-list menu__cat-list--banner">',html+=ACC.helpers.buildBannerHomeMegaMenu(dataMenu),html+="</div></div></div>",$(parent).append(html)}}},buildBannerHomeMegaMenu:function(data){var html="";return html+='<div class="banner-inner">',null!=data.banners&&void 0!==data.banners.responsiveBanner&&null!==data.banners.responsiveBanner&&""!==data.banners.responsiveBanner.img&&(html+="<a href='"+data.banners.responsiveBanner.url+"' class='responsive-banner'><img src='"+data.banners.responsiveBanner.img+"' /></a>"),null!=data.banners&&null!=data.banners.bannerItems&&data.banners.bannerItems.length>0&&data.banners.bannerItems.forEach(function(childItem){html+="<a href='"+childItem.url+"'><img src='"+childItem.img+"' /></a>"}),html+="</div>"},initTopMegaMenu:function(){var that=this,builtTopMegaMenu=!1;$(".header__links__segment_mega_menu__toggle").on("mouseover",function(){if(!builtTopMegaMenu){var html=that.buildTopMegaMenu();$(".header__links__segment_mega_menu__toggle .menu__cat-list.menu__cat-list--parent").html(html),ACC.navigation.initMainNavigation(),builtTopMegaMenu=!0}})}},window.megaMenuMaxItem=3,ACC.csvimport={TEXT_CSV_CONTENT_TYPE:"text/csv",APP_EXCEL_CONTENT_TYPE:"application/vnd.ms-excel",_autoload:[["changeFileUploadAppearance",0!=$(".js-file-upload").length],["bindImportCSVActions",0!=$(".js-import-csv").length]],changeFileUploadAppearance:function(){$(".js-file-upload__input").on("change",function(){$(".js-file-upload__file-name").text(this.value.toLowerCase().replace(/c:\\fakepath\\/g,"")),$(".js-file-upload").parents("#cboxLoadedContent").length>0&&ACC.colorbox.resize()})},bindImportCSVActions:function(){$("#chooseFileButton").on("click",function(event){ACC.csvimport.clearGlobalAlerts()}),$("#importButton").on("click",function(event){if(event.preventDefault(),ACC.csvimport.clearGlobalAlerts(),!($(".js-file-upload__input").val().trim().length>0))return void ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-no-file-chosen-error-message"});var selectedFile=document.getElementById("csvFile").files[0];if(ACC.csvimport.isSelectedFileValid(selectedFile)){var form=document.getElementById("importCSVSavedCartForm"),formData=new window.FormData(form);formData.append("csvFile",selectedFile),ACC.csvimport.displayGlobalAlert({type:"warning",messageId:"import-csv-upload-message"}),ACC.csvimport.enableDisableActionButtons(!1),$.ajax({url:form.action,type:"POST",data:formData,contentType:!1,processData:!1,success:function(){ACC.csvimport.displayGlobalAlert({type:"info",message:""}),$("#import-csv-alerts .alert-info").append($("#import-csv-success-message").html()),ACC.csvimport.clearChosenFile()},error:function(jqXHR){if(400==jqXHR.status&&jqXHR.responseJSON)return void ACC.csvimport.displayGlobalAlert({type:"error",message:jqXHR.responseJSON});ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-generic-error-message"})},complete:function(){ACC.csvimport.enableDisableActionButtons(!0)}})}})},isSelectedFileValid:function(selectedFile){if(window.File&&window.Blob){if(selectedFile){if(selectedFile.type!=ACC.csvimport.TEXT_CSV_CONTENT_TYPE&&selectedFile.type!=ACC.csvimport.APP_EXCEL_CONTENT_TYPE)return ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-file-csv-required"}),!1;var fileName=selectedFile.name;if(!fileName||!/\.csv$/i.test(fileName))return ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-file-csv-required"}),!1}var fileMaxSize=$(".js-file-upload__input").data("file-max-size");if($.isNumeric(fileMaxSize)&&selectedFile&&selectedFile.size>parseFloat(fileMaxSize))return ACC.csvimport.displayGlobalAlert({type:"error",messageId:"import-csv-file-max-size-exceeded-error-message"}),!1}return!0},displayGlobalAlert:function(options){ACC.csvimport.clearGlobalAlerts();var alertTemplateSelector;switch(options.type){case"error":alertTemplateSelector="#global-alert-danger-template";break;case"warning":alertTemplateSelector="#global-alert-warning-template";break;default:alertTemplateSelector="#global-alert-info-template"}void 0!==options.message&&$("#import-csv-alerts").append($(alertTemplateSelector).tmpl({message:options.message})),void 0!==options.messageId&&$("#import-csv-alerts").append($(alertTemplateSelector).tmpl({message:$("#"+options.messageId).text()}))},clearGlobalAlerts:function(){$("#import-csv-alerts").empty()},clearChosenFile:function(){document.getElementById("csvFile").value="",$(".js-file-upload__file-name").text("")},enableDisableActionButtons:function(enable){$("#chooseFileButton").attr("disabled",!enable),$("#importButton").prop("disabled",!enable)}},ACC.suggestvinid={_config:{element:{connectCurrentVinIDBtn:"#js-connect-current-vinid-btn",connectOtherVinIDLink:"#js-connect-other-vinid-link",connectOtherVinIDBtn:"#js-connect-other-vinid-btn",resendOTPBtn:"#js-adr-otp-resend",resendOTP2Btn:"#js-adr-otp-resend2",resendOTPVinIdSystemBtn:"#js-vinid-system-otp-resend",verifyOTPBtn:"#js-verify-otp-btn",verifyOTP2Btn:"#js-verify-otp2-btn",registerVinIdBtn:"#js-signin-register-vinid-btn",verifyOTPVinIdSystemBtn:"#js-verify-otp-vinid-system-btn",optionConnectVinIdPopup:"#sign-in__suggest_connect",connectVinIdPopup:"#sign-in__connect_vinid",verifyOTPConnectVinIdPopup:"#sign-in__verify_opt_connect_vinid",verifyOTPConnectVinIdPopup2:"#sign-in__verify_opt_connect_vinid2",verifyOTPConnectVinIdSystemPopup:"#sign-in__verify_opt_connect_vinid_system",registerVinIdCardPopup:"#sign-in__register_vinid_card",vinidCardErrorPopup:"#sign-in__vinid_card_error",registerVinIdCardSuccessPopup:"#sign-in__register_vinid_card_success",suggestConnectSuccessPopup:"#sign-in__suggest_connect_success",registerRewardBlock:"#js-register-reward",registerRewardPoint:"#js-register-reward-point",connectRewardBlock:"#js-connect-reward",connectRewardPoint:"#js-connect-reward-point",optionConnectRewardBlock:"#js-option-connect-reward",optionConnectRewardPoint:"#js-option-connect-reward-point",username:"",phoneNumber:"",formDataVinId:""}},_autoload:[],initElements:function(){ACC.common.loadModuleElements(ACC.suggestvinid)},loadModal:function(callback){var _this=this;_this.loaded?"function"==typeof callback&&callback.apply(_this):(ACC.helpers.showLoader(),$.ajax({url:"/popup-suggest-vinid",type:"GET",success:function(data){$("body").append(data),_this.initElements(),_this.submitConnectCurrentVinId(),_this.submitConnectOtherVinId(),_this.bindConnectOtherVinId(),_this.bindResendADROTP(),_this.bindResendADROTP2(),_this.bindResendVinIdOTP(),_this.bindRegisterVinId(),_this.verifyADROTP(),_this.verifyADROTP2(),_this.verifyOTPVinIdSystem(),_this.initDataForPopup(),ACC.helpers.hideLoader(),_this.loaded=!0,"function"==typeof callback&&callback.apply(_this)},error:function(data){ACC.helpers.hideLoader()}}))},processSuggestVinID:function(username){ACC.suggestvinid.username=username,ACC.suggestvinid.isConnectADR="true",$.getJSON(ACC.config.suggestVinIDUrl+"?username="+username,function(result,textStatus,request){var otpHash=request.getResponseHeader("otpHash");otpHash&&null!=otpHash&&(ACC.secureOTP.otpHash=otpHash),"REGISTER_VINID_CARD"===result.page?ACC.suggestvinid.showRegisterVinIdPopup():"CONNECT_OPTION_PAGE"===result.page?ACC.suggestvinid.showPopupOptionConnectVinId(result):"CONNECT_VINID_PAGE"===result.page?ACC.suggestvinid.showPopupVerifyADROTP2(result):"VIN_CARD_ERROR"===result.page&&ACC.suggestvinid.showVinCardErrorPopup(),$.unblockUI()})},submitConnectCurrentVinId:function(){ACC.suggestvinid.connectCurrentVinIDBtn.click(function(event){event.preventDefault(),$("#sign-in__suggest_connect .modal-content").block();var userNameHasVinID=$(".js-customerid-suggest").val();ACC.suggestvinid.hideOptionConnectVinIdPopup(),$.get(ACC.config.connectCurrentVinIDUrl+"?username="+ACC.suggestvinid.username+"&userNameHasVinID="+userNameHasVinID,function(result){"CONNECT_SUCCESS_PAGE"===result&&ACC.suggestvinid.showSuggestConnectSuccessPopup(),$("#sign-in__suggest_connect .modal-content").unblock()})})},submitConnectOtherVinId:function(){ACC.suggestvinid.connectOtherVinIDBtn.click(function(event){event.preventDefault(),$("#sign-in__connect_vinid .modal-content").block();var errorMsgs=$("#js-connect-other-vinid-form").find("p.error-message");errorMsgs&&errorMsgs.remove();var formData={vinId:$("#js-connect-other-vinid-vinid").val()},url=ACC.common.attachCaptchaParameter("#sign-in__connect_vinid",ACC.config.connectOtherVinIDUrl);$.ajax({url:url,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){
if(result.status)ACC.suggestvinid.sendADROTP(result.vinId),ACC.suggestvinid.hideConnectOtherVinIdPopup(),ACC.suggestvinid.showPopupVerifyADROTP(result),$("#sign-in__connect_vinid .modal-content").unblock();else{ACC.captcha.reset("js-connect-other-vinid-captcha");var errors=JSON.parse(result.errorMessage);for(var key in errors)$("#js-connect-other-vinid-"+key).after("<p class='error-message'>"+errors[key]+"</p>");$("#sign-in__connect_vinid .modal-content").unblock()}},error:function(error,textStatus,errorThrown){if(ACC.captcha.reset("js-connect-other-vinid-captcha"),error.responseJSON){var errors=JSON.parse(error.responseJSON.errorMessage);for(var key in errors)$("#js-connect-other-vinid-"+key).after("<p class='error-message'>"+errors[key]+"</p>")}$("#sign-in__connect_vinid .modal-content").unblock()}})})},mapADRAndVinId:function(vinId){var formData={vinId:vinId};$.ajax({url:ACC.config.mapADRAndVinIDUrl,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8",success:function(data){ACC.suggestvinid.showSuggestConnectSuccessPopup()},error:function(data,textStatus,errorThrown){}})},bindConnectOtherVinId:function(){ACC.suggestvinid.connectOtherVinIDLink.click(function(event){event.preventDefault(),ACC.suggestvinid.hideOptionConnectVinIdPopup(),ACC.suggestvinid.showPopupConnectVinId()})},bindResendADROTP:function(){ACC.suggestvinid.resendOTPBtn.click(function(event){event.preventDefault();var vinId=$(".js-vinid-send-opt").val();ACC.suggestvinid.sendADROTP(vinId,!0)})},bindResendADROTP2:function(){ACC.suggestvinid.resendOTP2Btn.click(function(event){event.preventDefault();var vinId=$(".js-vinid-send-opt2").val();ACC.suggestvinid.sendADROTP2(vinId,!0)})},bindResendVinIdOTP:function(){ACC.suggestvinid.resendOTPVinIdSystemBtn.click(function(event){event.preventDefault(),ACC.suggestvinid.formDataVinId.identifyNumber=ACC.suggestvinid.formDataVinId.identify,ACC.suggestvinid.reSendVinIdOTP()})},verifyADROTP:function(){ACC.suggestvinid.verifyOTPBtn.click(function(event){event.preventDefault(),$("#sign-in__verify_opt_connect_vinid .modal-content").block();var otpCode=$("#js-otp-input").val(),vinId=$(".js-vinid-send-opt").val(),formData={otpCode:otpCode,vinId:vinId},url=ACC.common.attachCaptchaParameter("#sign-in__verify_opt_connect_vinid",ACC.config.verifyOTPADRUrl);ACC.otp.verifyAndMapADROTP(formData,url).then(function(response){ACC.suggestvinid.hideVerifyADROTPPopup(),ACC.suggestvinid.showSuggestConnectSuccessPopup(),$("#sign-in__verify_opt_connect_vinid .modal-content").unblock()},function(error){ACC.captcha.reset("js-captcha-sign-in__verify_otp"),error.responseJSON&&(error.responseJSON.message.includes("captcha")?ACC.captcha.showError("js-captcha-sign-in__verify_otp",error.responseJSON.message):ACC.suggestvinid.addErrorMessageToField($("#js-otp-input"),error.responseJSON.message)),$("#sign-in__verify_opt_connect_vinid .modal-content").unblock()})})},verifyADROTP2:function(){ACC.suggestvinid.verifyOTP2Btn.click(function(event){event.preventDefault(),$("#sign-in__verify_opt_connect_vinid2 .modal-content").block();var otpCode=$("#js-otp-input2").val(),vinId=$(".js-vinid-send-opt2").val(),formData={otpCode:otpCode,vinId:vinId},okHandler=function(response){ACC.suggestvinid.hideVerifyADROTP2Popup(),ACC.suggestvinid.showSuggestConnectSuccessPopup(),$("#sign-in__verify_opt_connect_vinid2 .modal-content").unblock()},errorHandler=function(error){ACC.captcha.reset("js-captcha-sign-in__verify_otp2"),error.responseJSON&&(error.responseJSON.message.includes("captcha")?ACC.captcha.showError("js-captcha-sign-in__verify_otp2",error.responseJSON.message):ACC.suggestvinid.addErrorMessageToField($("#js-otp-input2"),error.responseJSON.message)),$("#sign-in__verify_opt_connect_vinid2 .modal-content").unblock()};ACC.secureOTP.verifyOTP(otpCode,formData,ACC.secureOTP.ACTIONS.LOGGED_IN_MAP_VINID,okHandler,errorHandler,"#sign-in__verify_opt_connect_vinid2")})},verifyOTPVinIdSystem:function(){ACC.suggestvinid.verifyOTPVinIdSystemBtn.click(function(event){event.preventDefault(),$("#sign-in__verify_opt_connect_vinid_system .modal-content").block();var otpCode=$("#js-otp-input-vinid-system").val(),identifyNumber=$(".js-identify-number-otp").val(),formData={otpCode:otpCode,identifyNumber:identifyNumber,phoneNumber:ACC.suggestvinid.phoneNumber,isConnectADR:ACC.suggestvinid.isConnectADR},onOK=(ACC.common.attachCaptchaParameter("#sign-in__verify_opt_connect_vinid_system",ACC.config.verifyOTPVinIDSystemUrl),ACC.common.attachCaptchaParameter("#sign-in__verify_opt_connect_vinid_system",ACC.config.verify),function(response){ACC.suggestvinid.hideVerifyVinIdOTPPopup(),ACC.suggestvinid.hideVerifyADROTPPopup(),window.location.pathname.indexOf("profile")>=0?location.reload():window.location.pathname.indexOf("checkout")>=0&&window.location.pathname.indexOf("orderConfirmation")<0?ACC.vinidredeem.refreshVinIDRedeem():ACC.suggestvinid.showRegisterVinIdSuccessPopup(response),$("#sign-in__verify_opt_connect_vinid_system .modal-content").unblock()}),onError=function(error){ACC.captcha.reset("js-captcha-sign-in__verify_otp3"),error.responseJSON&&(error.responseJSON.message.includes("captcha")?ACC.captcha.showError("js-captcha-sign-in__verify_otp3",error.responseJSON.message):ACC.suggestvinid.addErrorMessageToField($("#js-otp-input-vinid-system"),error.responseJSON.message)),$("#sign-in__verify_opt_connect_vinid_system .modal-content").unblock()};ACC.secureOTP.verifyOTP(otpCode,formData,ACC.secureOTP.ACTIONS.PROFILE_NEW_VINID,onOK,onError,"#sign-in__verify_opt_connect_vinid_system")})},bindRegisterVinId:function(){ACC.suggestvinid.registerVinIdBtn.click(function(event){event.preventDefault(),$("#sign-in__register_vinid_card .modal-content").block();var errorMsgs=$("#js-register-vinid-card-form").find("p.error-message");errorMsgs&&errorMsgs.remove(),ACC.suggestvinid.isConnectADR="true";var email=$("#js-register-vinid-card-email").val(),phoneNumber=$("#js-register-vinid-card-phone").val(),dayOfBirth=$("#js-register-vinid-card-day option:selected").val(),monthOfBirth=$("#js-register-vinid-card-month option:selected").val(),yearOfBirth=$("#js-register-vinid-card-year option:selected").val(),gender=$("input[name=js-register-vinid-card-gender]:checked").val(),address=$("#js-register-vinid-card-address").val(),identityCardNumber=$("#js-register-vinid-card-indentity").val(),isRecievePromotion="checked"===$("#js-register-vinid-card-promotion").attr("checked"),formData={email:$("#js-register-vinid-card-email").val(),phoneNumber:$("#js-register-vinid-card-phone").val(),dayOfBirth:$("#js-register-vinid-card-day option:selected").val(),monthOfBirth:$("#js-register-vinid-card-month option:selected").val(),yearOfBirth:$("#js-register-vinid-card-year option:selected").val(),gender:$("input[name=js-register-vinid-card-gender]:checked").val(),address:$("#js-register-vinid-card-address").val(),identityCardNumber:$("#js-register-vinid-card-indentity").val(),isRecievePromotion:$("#js-register-vinid-card-promotion").attr("checked"),captchaEnabled:$("#captcha-enabled").val()},url=ACC.config.validateRegisterVinIDUrl;url=ACC.common.attachCaptchaParameter("#js-register-vinid-card-form",ACC.config.validateRegisterVinIDUrl),$.ajax({url:url,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8",success:function(data){if(data.status){var formDataVinId={fullName:data.fullName,phoneNumber:phoneNumber,email:email,birthday:yearOfBirth+monthOfBirth+dayOfBirth,gender:gender,address:address,identify:identityCardNumber,isRecievePromotion:isRecievePromotion};ACC.suggestvinid.formDataVinId=formDataVinId,ACC.suggestvinid.sendVinIdOTP(formDataVinId),ACC.suggestvinid.hideRegisterVinIdPopup(),ACC.suggestvinid.showPopupVerifyVinIdOTP(identityCardNumber,phoneNumber),$("#sign-in__register_vinid_card .modal-content").unblock()}else{ACC.captcha.reset("js-register-vinid-card-captcha"),$("#sign-in__register_vinid_card .modal-content").unblock();var errors=JSON.parse(data.errorMessage);for(var key in errors)$("#js-register-vinid-card-"+key).after("<p class='error-message'>"+errors[key]+"</p>")}},error:function(data,textStatus,errorThrown){ACC.captcha.reset("js-register-vinid-card-captcha"),$("#sign-in__register_vinid_card .modal-content").unblock();var errors=JSON.parse(data.responseJSON.errorMessage);for(var key in errors)$("#js-register-vinid-card-"+key).after("<p class='error-message'>"+errors[key]+"</p>")}})})},addErrorMessageToField:function(fieldGroup,error){var parentElement=fieldGroup.parent(),errorContainer=parentElement.find("p.error-message");"OK"===error?errorContainer.text(""):errorContainer.text(error)},showPopupConnectVinId:function(){this.loadModal(function(){ACC.captcha.renderWidget("js-connect-other-vinid-captcha"),this.connectVinIdPopup.modal("show")})},showPopupVerifyADROTP:function(result){this.loadModal(function(){ACC.captcha.renderWidget("js-captcha-sign-in__verify_otp"),$("#js-phone-opt").text(result.phoneEncrypt),$(".js-vinid-send-opt").val(result.vinId),this.verifyOTPConnectVinIdPopup.modal("show")})},showPopupVerifyADROTP2:function(result){this.loadModal(function(){ACC.captcha.renderWidget("js-captcha-sign-in__verify_otp2"),$("#js-vinid-opt2").text(result.vinIdEncrypt),$("#js-phone-opt2").text(result.phoneEncrypt),$(".js-vinid-send-opt2").val(result.vinId);var orderCode=$(ACC.vinidDetail.formData.orderCodeHidden).val();if(orderCode&&0!=Object.keys(orderCode).length){var rewardPointUrl=ACC.config.suggestRewardPointUrl+"?orderCode="+orderCode;$.get(rewardPointUrl,function(result){""!=result?(ACC.suggestvinid.optionConnectRewardPoint.text(result),ACC.suggestvinid.optionConnectRewardBlock.show()):ACC.suggestvinid.optionConnectRewardBlock.hide(),ACC.suggestvinid.verifyOTPConnectVinIdPopup2.modal("show")})}else ACC.suggestvinid.optionConnectRewardBlock.hide(),this.verifyOTPConnectVinIdPopup2.modal("show")})},showPopupVerifyVinIdOTP:function(identityCardNumber,phoneNumber){this.loadModal(function(){ACC.captcha.renderWidget("js-captcha-sign-in__verify_otp3"),$(".js-identify-number-otp").val(identityCardNumber),$("#js-phone-opt-vinid-system").text(ACC.common.hidePhoneNumber(phoneNumber)),ACC.suggestvinid.phoneNumber=phoneNumber,this.verifyOTPConnectVinIdSystemPopup.modal("show")})},showPopupOptionConnectVinId:function(result){this.loadModal(function(){ACC.suggestvinid.bindKeyPressEvent(this.optionConnectVinIdPopup),$("#js-vinid-suggest").text(result.vinIdEncrypt),$("#js-customerid-suggest").text(result.customerIdEncrypt),$(".js-customerid-suggest").val(result.customerId);var orderCode=$(ACC.vinidDetail.formData.orderCodeHidden).val();if(orderCode&&0!=Object.keys(orderCode).length){var rewardPointUrl=ACC.config.suggestRewardPointUrl+"?orderCode="+orderCode;$.get(rewardPointUrl,function(result){ACC.suggestvinid.connectRewardPoint.text(result),ACC.suggestvinid.connectRewardBlock.show(),ACC.suggestvinid.optionConnectVinIdPopup.modal("show")})}else ACC.suggestvinid.connectRewardBlock.hide(),ACC.suggestvinid.optionConnectVinIdPopup.modal("show")})},showRegisterVinIdPopup:function(){this.loadModal(function(){ACC.captcha.renderWidget("js-register-vinid-card-captcha");var orderCode=$(ACC.vinidDetail.formData.orderCodeHidden).val();if(orderCode&&0!=Object.keys(orderCode).length){var rewardPointUrl=ACC.config.suggestRewardPointUrl+"?orderCode="+orderCode;$.get(rewardPointUrl,function(result){""!=result?(ACC.suggestvinid.registerRewardPoint.text(result),ACC.suggestvinid.registerRewardBlock.show(),ACC.suggestvinid.registerVinIdCardPopup.modal("show")):(ACC.suggestvinid.registerRewardBlock.hide(),ACC.suggestvinid.registerVinIdCardPopup.modal("show"))})}else ACC.suggestvinid.registerRewardBlock.hide(),ACC.suggestvinid.registerVinIdCardPopup.modal("show")})},showVinCardErrorPopup:function(){this.loadModal(function(){this.vinidCardErrorPopup.modal("show")})},showRegisterVinIdSuccessPopup:function(response){this.loadModal(function(){ACC.suggestvinid.bindKeyPressEvent(this.registerVinIdCardSuccessPopup),$("#js-vinid-system-created").text(response.vinId),this.registerVinIdCardSuccessPopup.modal("show")})},showSuggestConnectSuccessPopup:function(){this.loadModal(function(){ACC.suggestvinid.bindKeyPressEvent(this.suggestConnectSuccessPopup),this.suggestConnectSuccessPopup.modal("show")})},hideOptionConnectVinIdPopup:function(){this.optionConnectVinIdPopup&&this.optionConnectVinIdPopup.modal("hide")},hideVerifyVinIdOTPPopup:function(){this.verifyOTPConnectVinIdSystemPopup&&(this.verifyOTPConnectVinIdSystemPopup.modal("hide"),ACC.common.resetForm($("#sign-in__verify_opt_connect_vinid_system")))},hideRegisterVinIdPopup:function(){this.registerVinIdCardPopup&&(this.registerVinIdCardPopup.modal("hide"),ACC.common.resetForm($("#sign-in__register_vinid_card")),$(".js-gender-man").prop("checked",!0),$("#js-register-vinid-card-promotion").prop("checked",!0),$("#js-register-vinid-card-day option:first").prop("selected",!0),$("#js-register-vinid-card-month option:first").prop("selected",!0),$("#js-register-vinid-card-year option:first").prop("selected",!0))},hideVerifyADROTPPopup:function(){this.verifyOTPConnectVinIdPopup&&(this.verifyOTPConnectVinIdPopup.modal("hide"),ACC.common.resetForm($("#sign-in__verify_opt_connect_vinid")))},hideVerifyADROTP2Popup:function(){this.verifyOTPConnectVinIdPopup2&&(this.verifyOTPConnectVinIdPopup2.modal("hide"),ACC.common.resetForm($("#sign-in__verify_opt_connect_vinid2")))},hideConnectOtherVinIdPopup:function(){this.connectVinIdPopup&&(ACC.common.resetForm($("#sign-in__connect_vinid")),this.connectVinIdPopup.modal("hide"))},hideRegisterVinIdSuccessPopup:function(){this.registerVinIdCardSuccessPopup&&this.registerVinIdCardSuccessPopup.modal("hide")},hideSuggestConnectSuccessPopup:function(){this.suggestConnectSuccessPopup&&this.suggestConnectSuccessPopup.modal("hide")},sendADROTP:function(vinId,isResend){isResend&&$(".adr-otp-sent-notify").attr("style","display:none"),$("#sign-in__verify_opt_connect_vinid .modal-content").block();var data={vinId:vinId,type:ACC.config.otpRequestType.SIGNIN_MAPPING_VINID_TO_ADR};isResend&&(data.resend=!0),ACC.otp.sendADROTP(data,ACC.otp.func.signInUp).then(function(response){isResend&&$(".adr-otp-sent-notify").attr("style","display:block"),$("#sign-in__verify_opt_connect_vinid .modal-content").unblock()},function(error){error.responseJSON&&(ACC.suggestvinid.addErrorMessageToField($("#js-otp-input"),error.responseJSON.message),isResend&&$(".adr-otp-sent-notify").attr("style","display:none")),$("#sign-in__verify_opt_connect_vinid .modal-content").unblock()})},sendADROTP2:function(vinId,isResend){$("#sign-in__verify_opt_connect_vinid2 .modal-content").block(),isResend&&$(".adr-otp-sent-notify2").attr("style","display:none");var data={vinId:vinId,type:ACC.config.otpRequestType.SIGNIN_MAPPING_VINID_TO_ADR};isResend&&(data.resend=!0);var okHandler=function(response){isResend&&$(".adr-otp-sent-notify2").attr("style","display:block"),$("#sign-in__verify_opt_connect_vinid2 .modal-content").unblock()},errorHandler=function(error){error.responseJSON&&(ACC.suggestvinid.addErrorMessageToField($("#js-otp-input2"),error.responseJSON.message),isResend&&$(".adr-otp-sent-notify2").attr("style","display:none")),$("#sign-in__verify_opt_connect_vinid2 .modal-content").unblock()};ACC.secureOTP.sendOTP(ACC.secureOTP.ACTIONS.LOGGED_IN_MAP_VINID,okHandler,errorHandler)},sendVinIdOTP:function(formDataVinId){$("#sign-in__verify_opt_connect_vinid_system .modal-content").block(),$.ajax({url:ACC.config.signUpVinIdUrl+"?otpfunc="+ACC.otp.func.signInUp,type:"post",data:JSON.stringify(formDataVinId),dataType:"json",contentType:"application/json; charset=utf-8",success:function(data,textStatus,request){var otpHash=request.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,$("#sign-in__verify_opt_connect_vinid_system .modal-content").unblock()},error:function(error,textStatus,errorThrown){error.responseJSON&&ACC.suggestvinid.addErrorMessageToField($("#js-otp-input-vinid-system"),error.responseJSON.message),$("#sign-in__verify_opt_connect_vinid_system .modal-content").unblock()}})},reSendVinIdOTP:function(){$("#sign-in__verify_opt_connect_vinid_system .modal-content").block(),$(".vinid-system-otp-sent-notify").attr("style","display:none");var onSuccess=function(response){$(".vinid-system-otp-sent-notify").attr("style","display:block"),$("#sign-in__verify_opt_connect_vinid_system .modal-content").unblock()},onError=function(error){error.responseJSON&&(ACC.suggestvinid.addErrorMessageToField($("#js-otp-input-vinid-system"),error.responseJSON.message),$(".vinid-system-otp-sent-notify").attr("style","display:none")),$("#sign-in__verify_opt_connect_vinid_system .modal-content").unblock()};ACC.secureOTP.sendOTP(ACC.secureOTP.ACTIONS.PROFILE_NEW_VINID,onSuccess,onError)},initDataForPopup:function(){for(var daySelect=$("#js-register-vinid-card-day"),i=1;i<32;i++){var day=i;i<10&&(day="0"+i);var option=$('<option value="'+day+'">'+day+"</option>");daySelect.append(option)}for(var monthSelect=$("#js-register-vinid-card-month"),i=1;i<13;i++){var month=i;month<10&&(month="0"+month);var option=$('<option value="'+month+'">'+month+"</option>");monthSelect.append(option)}for(var yearSelect=$("#js-register-vinid-card-year"),currentYear=(new Date).getFullYear(),i=currentYear;i>=1918;i--){var option=$('<option value="'+i+'">'+i+"</option>");yearSelect.append(option)}},bindKeyPressEvent:function(popup){popup.keypress(function(event){"13"==(event.keyCode?event.keyCode:event.which)&&popup.find("button.btn-primary").trigger("click")})}},ACC.assistedservice={_autoload:["bindEvents"],bindEvents:function(){this.views.bindEvents(),this.model.initData()},model:{adjustOrderReq:{},orderNumber:"",initData:function(){this.initEmptyAdjustReq(),this.orderNumber=$("#currentOrderNumber").val()},initEmptyAdjustReq:function(){this.adjustOrderReq={reason:"",involvedDepartment:"",budget:"",adjustAmount:"",applyType:"",orderItems:[],notes:"",shippingFeeType:""}}},services:{showCreateRequestForm:function(){var _services=this;$.blockUI(),ACC.assistedservice.ajax(ACC.config.assistedService.createAdjustOrderFormUrl,"GET").then(function(res){$.unblockUI(),ACC.assistedservice.views.showAdjustOrderRequestForm(res),ACC.assistedservice.model.initEmptyAdjustReq(),_services.loadReasons(),_services.loadInvolvedDepartments(),_services.loadApplyTypes(),_services.loadAllBudgets()},function(jqXHR){$.unblockUI(),ACC.assistedservice.views.showError(jqXHR)})},loadReasons:function(){ACC.assistedservice.ajax(ACC.config.assistedService.adjustmentOrderReasonsUrl,"GET").then(function(res){ACC.assistedservice.views.buildReasons(res.reasons)},function(jqXHR){console.log(jqXHR)})},loadInvolvedDepartments:function(){ACC.assistedservice.ajax(ACC.config.assistedService.involvedDepartmentUrl,"GET").then(function(res){ACC.assistedservice.views.buildInvolvedDepartments(res.enums)},function(jqXHR){console.log(jqXHR)})},loadApplyTypes:function(){ACC.assistedservice.ajax(ACC.config.assistedService.applyTypeUrl,"GET").then(function(res){ACC.assistedservice.views.buildApplyOn(res.enums)},function(jqXHR){console.log(jqXHR)})},loadAllBudgets:function(){ACC.assistedservice.ajax(ACC.config.assistedService.budgetUrl,"GET").then(function(res){var budgets=res.budgets,options=[];$.each(budgets,function(index,budget){options.push({code:budget.code,description:"{name} - amount: {amount}".replace("{name}",budget.name).replace("{amount}",budget.amount)})}),ACC.assistedservice.views.buildBudgets(options)},function(jqXHR){console.log(jqXHR)})},postAdjustOrderRequest:function(){$.blockUI(),ACC.assistedservice.views.hideErrorMessage(),ACC.assistedservice.model.adjustOrderReq.orderNumber=ACC.assistedservice.model.orderNumber,ACC.assistedservice.ajax(ACC.config.assistedService.adjustRequestUrl,"POST",ACC.assistedservice.model.adjustOrderReq).then(function(res){$.unblockUI(),ACC.assistedservice.model.initEmptyAdjustReq(),ACC.assistedservice.views.showSuccess(),ACC.assistedservice.views.resetForm()},function(jqXHR){$.unblockUI();var message=jqXHR.responseJSON.message;ACC.assistedservice.views.showErrorMessage(message)})}},views:{selectors:{adjustOrderPopup:"#js-adjust-order-popup",adjustOrderBtn:".js-create-adjust-amount",selectApplyOn:"select.js-application-types",selectAdjustBudget:"select.js-adjust-budget",selectInvolvedDepartment:"select.js-involved-departments",selectAdjustOrderItems:"select.js-adjust-order-items",selectAdjustReason:"select.js-adjust-reasons",selectShippingFee:".js-adjust-shiping-fee",orderItemGroup:".js-adjust-order-group",shippingFeeGroup:".js-adjust-shipping-fee-group",adjustOrderForm:".js-adjust-order-form",submitRequestBtn:"button.js-submit-adjust-request",errorMessage:".js-error-message",successMessage:".js-success-message",warningFreeShipMessage:".js-adjust-shipping-fee-warning-message",closeSuccessMessage:".js-success-message .glyphicon-remove"},buildReasons:function(reasons){this.buildOptions($(this.selectors.selectAdjustReason),reasons)},buildInvolvedDepartments:function(departments){this.buildOptions($(this.selectors.selectInvolvedDepartment),departments)},buildApplyOn:function(types){this.buildOptions($(this.selectors.selectApplyOn),types)},buildBudgets:function(types){this.buildOptions($(this.selectors.selectAdjustBudget),types)},buildShippingFees:function(types){this.buildOptions($(this.selectors.selectShippingFee),types)},buildOptions:function(selectElm,values){selectElm.find("option").remove();var options=[{code:"",description:""}];$.each(values,function(index,value){options.push(value)}),$.each(options,function(index,option){selectElm.append(new Option(option.description,option.code))})},bindEvents:function(){$(document).on("click",this.selectors.adjustOrderBtn,function(e){ACC.assistedservice.services.showCreateRequestForm()}),$(document).on("change",this.selectors.selectApplyOn,function(e){var applyType=$(this).val();"ORDER_ITEMS"===applyType?(ACC.assistedservice.views.showWarningFreeShipOrder(!1),$(ACC.assistedservice.views.selectors.orderItemGroup).show(),$(ACC.assistedservice.views.selectors.shippingFeeGroup).hide(),ACC.assistedservice.views.clearSelectOrderItems(),ACC.assistedservice.views.initOrderItemsSelect()):"SHIPPING_FEE"===applyType&&($(ACC.assistedservice.views.selectors.orderItemGroup).hide(),ACC.assistedservice.views.initShippingFeeTypes())}),$(document).on("click",this.selectors.submitRequestBtn,function(e){e.preventDefault(),ACC.assistedservice.views.updateModel(),ACC.assistedservice.services.postAdjustOrderRequest()}),$(document).on("keyup","#_asmPersonifyForm input[name='cartId']",function(){formValidate(this,8,!0),isErrorDisplayed()&&($("input[name='cartId']").removeClass("ASM-input-error"),$(".ASM_alert")&&$(".ASM_alert").remove())}),$(document).on("keyup",".js-adjust-order-form input[name='adjustAmount']",function(){var viewVal=$(this).val(),realValue=viewVal.replace(/\./g,""),newVal=ACC.common.formatThousands(realValue),lengthDiff=newVal.length-viewVal.length;lengthDiff=-1==lengthDiff?0:lengthDiff;var start=this.selectionStart+lengthDiff,end=this.selectionEnd+lengthDiff;$(this).val(newVal),this.setSelectionRange(start,end)}),$(document).on("click",this.selectors.closeSuccessMessage,function(){$(ACC.assistedservice.views.selectors.successMessage).hide()})},initOrderItemsSelect:function(){var url=ACC.config.assistedService.orderEntriesUrl.replace("{orderCode}",ACC.assistedservice.model.orderNumber);ACC.assistedservice.ajax(url,"GET").then(function(res){var orderEntries=res.orderEntries,entries=[];orderEntries&&$.each(orderEntries,function(index,item){var orderEntry=item.orderEntry,entry={id:item.pk,text:function(){var product=orderEntry.product,offer=product.currentOffer,name=offer.code+" - ";return offer.name?name+=offer.name:name+=product.name,name+", quantity: "+item.quantity+", total price: "+item.totalPrice.formattedValue}()};entries.push(entry)}),ACC.assistedservice.selectizeItems=$(ACC.assistedservice.views.selectors.selectAdjustOrderItems).selectize({plugins:["remove_button"],maxItems:null,valueField:"id",labelField:"text",searchField:"text",options:entries})},function(jqXHR){console.error(jqXHR)})},clearSelectOrderItems:function(){void 0!==ACC.assistedservice.selectizeItems&&void 0!==ACC.assistedservice.selectizeItems[0]&&"undefined"!==ACC.assistedservice.selectizeItems[0].selectize&&ACC.assistedservice.selectizeItems[0].selectize.clear()},initShippingFeeTypes:function(){var url=ACC.config.assistedService.shippingFeeTypesUrl.replace("{orderCode}",ACC.assistedservice.model.orderNumber);$(ACC.assistedservice.views.selectors.warningFreeShipMessage).show(),ACC.assistedservice.ajax(url,"GET").then(function(res){var shippingFees=res.enums;shippingFees.length>0?($(ACC.assistedservice.views.selectors.shippingFeeGroup).show(),ACC.assistedservice.views.buildShippingFees(shippingFees)):ACC.assistedservice.views.showWarningFreeShipOrder(!0)},function(jqXHR){console.error(jqXHR)})},showWarningFreeShipOrder:function(isShow){if(isShow){var warningMessage=$("#js-free-shipping-warning-message").val();$(ACC.assistedservice.views.selectors.warningFreeShipMessage).is(":visible")&&$(ACC.assistedservice.views.selectors.warningFreeShipMessage).html(warningMessage)}else $(ACC.assistedservice.views.selectors.warningFreeShipMessage).html(""),$(ACC.assistedservice.views.selectors.warningFreeShipMessage).hide()},showAdjustOrderRequestForm:function(html){$(this.selectors.adjustOrderPopup).html(html),$(this.selectors.adjustOrderPopup).modal("show")},showError:function(jqXHR){if($.unblockUI(),"403"==jqXHR.status){$(this.selectors.adjustOrderPopup).html('<div class="modal-body"><div class="modal-dialog" role="document"><div class="modal-content"><button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></button><div class="modal-header"></div><div class="modal-body"><p style="color: #f39000">Phiên đăng nhập của bạn đã kết thúc. Vui lòng đăng nhập lại.</p>'),$(this.selectors.adjustOrderPopup).modal("show")}},showErrorMessage:function(message){$(this.selectors.errorMessage).html(message),$(this.selectors.errorMessage).addClass("error"),$(this.selectors.errorMessage).show()},hideErrorMessage:function(){$(this.selectors.errorMessage).html(""),$(this.selectors.errorMessage).removeClass("error"),$(this.selectors.errorMessage).hide()},showSuccess:function(){$(ACC.assistedservice.views.selectors.successMessage).fadeIn(),setTimeout(function(){$(ACC.assistedservice.views.selectors.successMessage).fadeOut()},5e3)},resetForm:function(){$(this.selectors.adjustOrderForm).find("select[name='reason']").val(""),$(this.selectors.adjustOrderForm).find("select[name='involvedDepartment']").val(""),$(this.selectors.adjustOrderForm).find("select[name='budget']").val(""),$(this.selectors.adjustOrderForm).find("input[name='adjustAmount']").val(""),$(this.selectors.adjustOrderForm).find("select[name='applyType']").val("").change(),$(this.selectors.adjustOrderForm).find("input[name='notes']").val(""),$(this.selectors.selectShippingFee).val(""),$(this.selectors.shippingFeeGroup).hide(),ACC.assistedservice.views.clearSelectOrderItems(),$(this.selectors.selectAdjustOrderItems).val(""),$(this.selectors.orderItemGroup).hide()},updateModel:function(){var model=ACC.assistedservice.model.adjustOrderReq;model.reason=$(this.selectors.adjustOrderForm).find("select[name='reason']").val(),model.involvedDepartment=$(this.selectors.adjustOrderForm).find("select[name='involvedDepartment']").val(),model.budget=$(this.selectors.adjustOrderForm).find("select[name='budget']").val(),model.adjustAmount=$(this.selectors.adjustOrderForm).find("input[name='adjustAmount']").val().replace(/\./g,""),model.applyType=$(this.selectors.adjustOrderForm).find("select[name='applyType']").val(),model.note=$(this.selectors.adjustOrderForm).find("input[name='notes']").val(),"ORDER_ITEMS"==model.applyType&&(model.orderItems=$(this.selectors.selectAdjustOrderItems).val()),"SHIPPING_FEE"==model.applyType&&(model.shippingFeeType=$(this.selectors.selectShippingFee).val())}},ajax:function(url,method,data){var config={url:url,type:method,cache:!1,contentType:"application/json"};return"GET"!==method&&"get"!=method?(config.data=JSON.stringify(data),config.dataType="json"):config.data=data,$.ajax(config)}},ACC.customerProfile={_autoload:["init"],init:function(){this.initEventListener(),$(document).on("click","#acc_sendVerificationEmail",function(e){e.preventDefault();var dataString="verificationEmail="+$("#acc_pu_verficationEmail").text();$.ajax({url:ACC.config.encodedContextPath+"/my-account/verify-profile-email",type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:dataString,success:function(response){"success"==response&&($(this).attr("href","#modal-cpp-2"),$(this).click())}})}),$(document).on("click","#acc_sendOtpMessage",function(e){e.preventDefault();var phone=$("#acc_phone").html(),okHandler=function(response,textStatus,response){var otpHash=response.getResponseHeader("otpHash");ACC.secureOTP.otpHash=otpHash,ACC.adrOtpPopup.showInSuccess({phone:phone,ignoreRightPanel:!0},ACC.customerProfile.handleConfirmOtp)},errorHandler=function(jqXHR){ACC.adrOtpPopup.showInError({phone:phone,ignoreRightPanel:!0},jqXHR.responseJSON.message,ACC.customerProfile.handleConfirmOtp)},data={createNew:!0,action:ACC.secureOTP.ACTIONS.PROFILE_VERIFY_PHONE};ACC.secureOTP.sendOTP(data,okHandler,errorHandler)}),$(document).on("focusout","#acc_profile_phone_update_text",function(e){e.preventDefault(),ACC.customerProfile.sendEmailPhoneValidation()}),$(document).on("focusout","#acc_profile_email_update_text",function(e){e.preventDefault(),ACC.customerProfile.sendEmailPhoneValidation()}),$(document).ready(function(e){$(".number-only").keypress(function(e){if(isNaN(this.value+""+String.fromCharCode(e.charCode)))return!1})})},removeVinID:function(){$.blockUI(),$.ajax({url:"/my-account/profile/remove-vinid",type:"post",success:function(data){window.location.reload()},error:function(error,textStatus,errorThrown){$.unblockUI()}})},sendEmailPhoneValidation:function(){var email=$("#acc_profile_email_update_text").val(),phone=$("#acc_profile_phone_update_text").val(),dataString={email:email,phone:phone};$.ajax({url:ACC.config.encodedContextPath+"/my-account/profile/validate",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),success:function(response){var error=jQuery.parseJSON(response);$("#phone\\.errors").length?($("#acc_phone_error").text(""),$("#phone\\.errors").text(void 0!=error.phone?error.phone:"")):$("#acc_phone_error").text(void 0!=error.phone?error.phone:""),$("#email\\.errors").length?($("#acc_email_error").text(""),$("#email\\.errors").text(void 0!=error.email?error.email:"")):$("#acc_email_error").text(void 0!=error.email?error.email:"")}})},handleConfirmOtp:function(phone,otpCode){var data={otpCode:otpCode,username:phone},okHandler=function(result){ACC.adrOtpPopup.hide(),$("#acc_sendOtpMessage").hide()},errorHandler=function(jqXHR){ACC.adrOtpPopup.errorMsg.html(jqXHR.responseJSON.message),ACC.adrOtpPopup.successMsg.hide(),ACC.adrOtpPopup.resetCaptCha()};ACC.secureOTP.verifyOTP(otpCode,data,ACC.secureOTP.ACTIONS.PROFILE_VERIFY_PHONE,okHandler,errorHandler,"#js-otp-popup")},initEventListener:function(){$(".js-toggle-profile-menu").on("click",function(event){event.stopPropagation(),$(".section__sidebar-profile").toggleClass("open")}),$(".js-remove-connect-vinid").on("click",function(event){ACC.customerProfile.removeVinID()}),$(document).click(function(e){var container=$(".section__sidebar-profile");container.is(e.target)||0!==container.has(e.target).length||container.removeClass("open")})}},ACC.myCoupons={
_autoload:["initMyCoupons","copyTextUseButton","showModalAddCoupon","removeConfirmationModalCoupon","socialShareCoupon","ajaxAddCouponPage","initCopyDiscountTag","copyCouponShowing","ajaxAddCouponShowingLanding","couponViewAllMenu",["couponShowingImage",$(".js-image-showing-coupon").length>0],["initCopyCouponCollection",$(".js-discount-tag__btncopy-collection").length>0]],initMyCoupons:function(){if(0!=$(".page-couponsPage").length){$(window).unbind("scroll"),$(document).keypress(function(e){13==e.which&&$(".discount__modal--input").is(":focus")&&ajaxAddCouponDiscount(null)});var backtotop=$(".btn-goto-top");$(window).scroll(function(){var scrollHeight=600;$(window).width()<768&&(scrollHeight=400),$(window).scrollTop()>scrollHeight?backtotop.addClass("show-btt"):backtotop.removeClass("show-btt")}),backtotop.on("click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},"300")})}$(".discount__tag .discount__tag--desc").each(function(i,e){$(this).attr("title",$(this).text())})},copyCouponShowing:function(){$(".js-discount-tag__btncopy_showing_coupon").on("click",function(event){event.preventDefault();var copyText=$(this).prev().find(".js-discount-mine-tag__copytext"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).find(".discount__tag--noti");$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3)})},ajaxAddCouponShowingLanding:function(){$(".js-add-coupon-showing-landing").on("click",function(){var _self=this;if(!$(_self).hasClass("add-active")){var dataString={dataId:$(_self).attr("data-id")};$.ajax({url:ACC.config.encodedContextPath+"/productDetail/addStopper",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){var spanStatus=$(_self).find(".discount__tag--noti").children("span"),messageBox=$(_self).find(".discount__tag--noti");$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3),"success"===response?($(_self).addClass("discount__tag--used").addClass("add-active"),$(_self).children("span").text("Đã lấy"),$(messageBox).removeClass("error").addClass("success"),$(spanStatus[1]).hide(),$(spanStatus[2]).hide()):($(messageBox).addClass("error").removeClass("success"),$(spanStatus[0]).hide(),$(spanStatus[2]).hide())}})}})},showModalAddCoupon:function(){$(".js-discount-mine-tag--btnadd").on("click",function(e){e.preventDefault();var _self=this;$(".discount-mine-modal").addClass("discount_modal_show"),$(".discount__tag__modal .discount__modal-add").show(),$(".discount__modal--input").focus(),$(".discount__tag__modal .discount__modal-remove").hide(),$(".discount__modal--body .wrong-code").hide(),$(".js-discount__modal--btn_add").unbind("click"),$(".discount__tag__modal .close").click(function(){$(".discount-mine-modal").removeClass("discount_modal_show")}),$(".js-discount__modal--btn_add").click(function(){ajaxAddCouponDiscount(_self)})})},removeConfirmationModalCoupon:function(){$(".js-discount-mine-tag_btnremove").on("click",function(e){e.preventDefault();var _self=this;$(".discount-mine-modal").addClass("discount_modal_show"),$(".discount__tag__modal .discount__modal-add").hide(),$(".discount__tag__modal .discount__modal-remove").show(),$(".discount__tag__modal .js-discount__modal--btn_remove").unbind("click"),$(".discount__tag__modal .discount__modal--backbtn").click(function(){$(".discount-mine-modal").removeClass("discount_modal_show")}),$(".discount__tag__modal .js-discount__modal--btn_remove").click(function(){removeDiscountTagAction(_self)})})},copyTextUseButton:function(){$(".js-discount-mine-tag__btnuse").on("click",function(event){event.preventDefault();var copyText=$(this).prev().find(".js-discount-mine-tag__copytext"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).find(".discount__tag--noti");$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3)})},couponViewAllMenu:function(){"mobile"==ACC.devices.name&&($(".product__tab__list--viewall").unbind("click"),$(".product__tab__list--viewall").on("click",function(){var newtablist=$(".product__tab__list").clone(),newCloneTabList=$("<div/>",{class:"product__tab__list__modal"}).html(newtablist);$(".product__tab__list__modal").length>0&&$(".product__tab__list__modal").remove(),$("body").addClass("modal-open").append(newCloneTabList),$(".product__tab__list__modal, .product__tab__list__modal .product__tab__list--viewall i").on("click",function(e){e.target==this&&($(".product__tab__list__modal").remove(),$("body").removeClass("modal-open"))})}))},socialShareCoupon:function(){const open_social_share_list=$(".js-open-social-share-list1"),modal=$(".js-modal");var removeCouponPopup=function(){$("body").find(".coupon__share__popup").remove(),$("html").css({overflow:"unset"})};$(".js-function-modal-button").on("click",function(){$(this).parent().parent().addClass("hide"),$("html").css({overflow:"unset"})}),$(".js-modal").on("click",function(event){const _this=$(this);-1!==event.target.className.indexOf("js-modal")&&(_this.addClass("hide"),_this.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")),$("html").css({overflow:"unset"}),removeCouponPopup()}),isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),open_social_share_list.on("click",function(){const _this=$(this);if(isMobile){$("html").css({overflow:"hidden"});var sharepopup=_this.siblings(".js-modal").clone(),_sharepopup=$("<div/>",{class:"coupon__share__popup"}).html(sharepopup);$("body").find(".coupon__share__popup").length>0&&removeCouponPopup(),sharepopup.removeClass("hide"),sharepopup.on("click",function(){removeCouponPopup()}),$("body").append(_sharepopup)}else _this.siblings().find(".d-modal__content").removeClass("d-modal__content--active-pop-up"),_this.siblings(".js-modal").removeClass("hide"),setTimeout(function(){_this.siblings().find(".d-modal__content").addClass("d-modal__content--active-pop-up")},100)}),$(document).on("click",".js-coupon-share-fb",function(e){closeModalShare()}),$(document).on("click",".js-copy-coupon-url",function(e){var url_coupon_share=$(this).attr("data-url-sharing"),textArea=document.createElement("input");textArea.value=url_coupon_share,document.body.appendChild(textArea),ACC.requests.copyToClipboard(textArea),document.body.removeChild(textArea),closeModalShare()}),$(document).on("click",function(e){modal.find(".d-modal__content--active-pop-up").length>0&&null==e.target.closest(".js-modal")&&closeModalShare()});var closeModalShare=function(){modal.addClass("hide"),modal.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")}},ajaxAddCouponPage:function(){$(".js-coupon-page-list").on("click",function(){var _self=this;if(!$(_self).hasClass("add-active")){var dataString={dataId:$(_self).attr("data-id")};$.ajax({url:ACC.config.encodedContextPath+"/productDetail/addStopper",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){var spanStatus=$(_self).find(".discount__tag--noti").children("span"),messageBox=$(_self).find(".discount__tag--noti");$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3),"success"===response?($(_self).addClass("discount__tag--used").addClass("add-active"),$(_self).children("span").text("Đã lấy"),$(messageBox).removeClass("error").addClass("success"),$(spanStatus[1]).hide(),$(spanStatus[2]).hide()):($(messageBox).addClass("error").removeClass("success"),$(spanStatus[0]).hide(),$(spanStatus[2]).hide())}})}})},initCopyDiscountTag:function(){$(".js-discount-tag__btncopycoupon").on("click",function(event){event.preventDefault();var copyText=$(this).parent().parent().find(".js-discount-mine-tag__copytext"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).parent().find(".js-discount-tag__copymessage");messageBox.fadeIn(),messageBox.toggleClass("open"),setTimeout(function(){messageBox.fadeOut(),messageBox.toggleClass("open")},1e3)})},initCopyCouponCollection:function(){$(".js-discount-tag__btncopy-collection").on("click",function(event){event.preventDefault();var copyText=$(this).parent().parent().find(".js-discount-tag__copytext"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).parent().find(".js-discount-tag__copymessage-collection");messageBox.fadeIn(),messageBox.toggleClass("open"),setTimeout(function(){messageBox.fadeOut(),messageBox.toggleClass("open")},1e3)})},copyToClipboard:function(el){if(el="string"==typeof el?document.querySelector(el):el,navigator.userAgent.match(/ipad|ipod|iphone/i)){var editable=el.contentEditable,readOnly=el.readOnly;el.contentEditable=!0,el.readOnly=!0;var range=document.createRange();range.selectNodeContents(el);var selection=window.getSelection();selection.removeAllRanges(),selection.addRange(range),el.setSelectionRange(0,999999),el.contentEditable=editable,el.readOnly=readOnly}else el.select();document.execCommand("copy")},couponShowingImage:function(){$(".js-image-showing-coupon").each(function(){var img=$(this),componentWidth=img.parent().width(),pageWidth=$("body").width(),src="";src="mobile"==ACC.devices.name?img.attr("data-img-mobile"):pageWidth/2>componentWidth?img.attr("data-img-half"):img.attr("data-img-desktop"),img.attr("src",src)})}},removeDiscountTagAction=function(attr){var _self=attr,dataString={dataId:$(_self).attr("data-id")};$.ajax({url:ACC.config.encodedContextPath+"/productDetail/removeStopper",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){if(console.log(response),"success"===response){$(_self).parent().parent().parent(".card").remove();$(".discount-mine-modal").removeClass("discount_modal_show"),refreshPageMyDiscountEmpty()}else alert("Không thể xóa mã này. Vui lòng thử lại sau")}})},ajaxAddCouponDiscount=function(btn){var data=$(".discount__modal--body .discount__modal--input").val();if(""!==data){var dataString={couponCode:data};$.ajax({url:ACC.config.encodedContextPath+"/my-account/coupons/add",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){"success"===response?location.reload():$(".discount__modal--body .wrong-code").show()}})}else $(".discount__modal--body .wrong-code").show()},refreshPageMyDiscountEmpty=function(){var activeBlock=$(".discount__tag--content > div").length-1,expireBlock=$(".discount__tag--content > div.expired__taglist .discount__tag--item").length;console.log(activeBlock+"-"+expireBlock)},ACC.adrBrandMerchant={_autoload:[["initNav",$(".menu__section-vendor").length>0]],initNav:function(){$(".js-vendor-nav__item").length>0&&($(".js-vendor-nav__item").hasClass("active")||$(".js-vendor-nav__item").first().addClass("active"));var startX,scrollLeft,jsNavBar=document.getElementById("js-vendor-navbar"),isDown=!1;jsNavBar.addEventListener("mousedown",function(e){isDown=!0,jsNavBar.classList.add("active"),startX=e.pageX-jsNavBar.offsetLeft,scrollLeft=jsNavBar.scrollLeft}),jsNavBar.addEventListener("mouseleave",function(e){isDown=!1,jsNavBar.classList.remove("active")}),jsNavBar.addEventListener("mouseup",function(e){isDown=!1,jsNavBar.classList.remove("active")}),jsNavBar.addEventListener("mousemove",function(e){if(isDown){e.preventDefault();var x=e.pageX-jsNavBar.offsetLeft,walk=3*(x-startX);jsNavBar.scrollLeft=scrollLeft-walk}})}},ACC.vinidDetail={_autoload:["bindRegisterVinId","bindConnectVinId","submitConnectVinId","verifyADROTP","resendADROTP","autoFocusOnShow"],formData:{connectVinCardForm:"#js-profile-connect-vincard-form",connectVinCardBtn:".js-profile-connect-vincard-btn",registerVinCardBtn:".js-profile-register-vincard-btn",vinCardNumberInput:".js-profile-connect-vincard-number",vinCardNumberHidden:".js-profile-hidden-otp-vinid",originPage:".js-origin",connectVinCardPopup:".js-profile-connect-vincard-popup",errorMessage:"p.error-message",verifyVinOtpForm:"#js-profile-verify-otp-form",vinOtpInput:".js-profile-otp-input",profileUsername:".js-profile-username",resendVinOtp:".js-profile-otp-resend",verifyVinOtpPopup:".js-profile-otp-popup",phoneCryptLabel:".js-profile-phone-otp",sendOtpNotify:".js-profile-otp-notify",vinidCardErrorPopup:"#js-profile-vinid_card_error",orderCodeHidden:"#js-order-code-hidden",vinIdEncriptLabel:"#js-vinid-number-hidden",rewardPointLabel:"#js-reward-point-otp",blockHidden:"#js-reward-otp-hidden"},autoFocusOnShow:function(){$(ACC.vinidDetail.formData.connectVinCardPopup).on("shown.bs.modal",function(e){$(e.currentTarget).find("form").find(":text,:radio,:checkbox,select,textarea").each(function(){this.readOnly||this.disabled||this.focus()})})},bindRegisterVinId:function(){$(ACC.vinidDetail.formData.registerVinCardBtn).click(function(event){ACC.suggestvinid.showRegisterVinIdPopup()})},bindConnectVinId:function(){$(document).on("click",".js-profile-connect-vincard-btn",function(event){event.preventDefault(),ACC.vinidDetail.showPopupConnectVinId()})},submitConnectVinId:function(){$(ACC.vinidDetail.formData.connectVinCardForm).submit(function(event){event.preventDefault(),$.blockUI();var formData={vinId:$(ACC.vinidDetail.formData.vinCardNumberInput).val(),orderCode:$(ACC.vinidDetail.formData.orderCodeHidden).val()},urlWithCaptcha=ACC.common.attachCaptchaParameter("#profile-connect-vincard",ACC.config.connectVinIDWithoutCaptchaUrl);$.ajax({url:urlWithCaptcha,type:"post",data:JSON.stringify(formData),dataType:"json",contentType:"application/json; charset=utf-8",success:function(result,textStatus,request){var otpHash=request.getResponseHeader("otpHash"),vinidBox=$(ACC.vinidDetail.formData.connectVinCardPopup).find(".vinid-error");vinidBox.text("");var captchaEl=$(ACC.vinidDetail.formData.connectVinCardPopup).find("#profile-connect-vincard-error");if(captchaEl&&captchaEl.text(""),ACC.captcha.reset("profile-connect-vincard"),result.status)result.page&&"VIN_CARD_ERROR"===result.page?(ACC.vinidDetail.hideConnectVinIdPopup(),ACC.vinidDetail.showVinCardErrorPopup()):(ACC.secureOTP.otpHash=otpHash,ACC.vinidDetail.hideConnectVinIdPopup(),ACC.vinidDetail.showPopupVerifyADROTP(result),$(ACC.vinidDetail.formData.vinCardNumberHidden).val(result.vinId));else if(void 0!=result.errorMessage){var errors=JSON.parse(result.errorMessage);vinidBox.text(errors.vinid),captchaEl&&(captchaEl.text(errors.captcha),captchaEl.attr("style","display: block !important"))}else $(ACC.vinidDetail.formData.connectVinCardPopup).find(ACC.vinidDetail.formData.errorMessage).text(result.message);$.unblockUI()},error:function(error,textStatus,errorThrown){$.unblockUI();var vinidBox=$(ACC.vinidDetail.formData.connectVinCardPopup).find(".vinid-error");vinidBox.text("");var captchaEl=$(ACC.vinidDetail.formData.connectVinCardPopup).find("#profile-connect-vincard-error");if(captchaEl&&captchaEl.text(""),ACC.captcha.reset("profile-connect-vincard"),error.responseJSON)if(void 0!=error.responseJSON.errorMessage){var errors=JSON.parse(error.responseJSON.errorMessage);vinidBox.text(errors.vinid),captchaEl&&(captchaEl.text(errors.captcha),captchaEl.attr("style","display: block !important"))}else{var errorContainer=$(ACC.vinidDetail.formData.connectVinCardPopup).find(".vinid-error");errorContainer.text(error.responseJSON.message)}}})})},verifyADROTP:function(){$(ACC.vinidDetail.formData.verifyVinOtpForm).submit(function(event){event.preventDefault(),$.blockUI();var otpCode=$(ACC.vinidDetail.formData.vinOtpInput).val(),username=$(ACC.vinidDetail.formData.profileUsername).val(),vinId=$(ACC.vinidDetail.formData.vinCardNumberHidden).val(),originPage="profile_page";$(ACC.vinidDetail.formData.originPage)&&(originPage=$(ACC.vinidDetail.formData.originPage).val());var formData={otpCode:otpCode,vinId:vinId,username:username,origin:originPage},success=function(data){ACC.vinidDetail.hideVerifyADROTPPopup(),$.unblockUI(),location.reload()},error=function(error){$.unblockUI(),error.responseJSON?ACC.vinidDetail.addErrorMessageToField($(ACC.vinidDetail.formData.vinOtpInput),error.responseJSON.message):200==error.status&&(ACC.vinidDetail.hideVerifyADROTPPopup(),$.unblockUI(),location.reload()),ACC.captcha.reset("js-profile-vinid-otp-captcha")};ACC.secureOTP.verifyOTP(otpCode,formData,ACC.secureOTP.ACTIONS.PROFILE_MAP_VINID,success,error,"js-profile-vinid-otp-captcha")})},resendADROTP:function(){$(ACC.vinidDetail.formData.resendVinOtp).click(function(event){var vinId=$(ACC.vinidDetail.formData.vinCardNumberHidden).val();ACC.vinidDetail.resetForm($(ACC.vinidDetail.formData.verifyVinOtpForm)),ACC.vinidDetail.sendADROTP(vinId,!0)})},sendADROTP:function(vinId,isResend){$.blockUI(),$(ACC.vinidDetail.formData.sendOtpNotify).attr("style","display:none");var data={vinId:vinId,type:ACC.config.otpRequestType.SIGNIN_MAPPING_VINID_TO_ADR};isResend&&(data.resend=!0);var success=function(response){$.unblockUI(),isResend&&$(ACC.vinidDetail.formData.sendOtpNotify).attr("style","display:block")},error=function(error){$.unblockUI(),error.responseJSON&&(ACC.suggestvinid.addErrorMessageToField($(ACC.vinidDetail.formData.vinOtpInput),error.responseJSON.message),$(ACC.vinidDetail.formData.sendOtpNotify).attr("style","display:none"))},data={otpHash:ACC.secureOTP.otpHash,action:ACC.secureOTP.ACTIONS.PROFILE_MAP_VINID};ACC.secureOTP.sendOTP(data,success,error)},closeConnectVinPopUp:function(){event.preventDefault(),$(".js-profile-connect-vincard-popup .close").click(function(event){ACC.vinidDetail.hideConnectVinIdPopup()})},closeVerifyOTPPopUp:function(){event.preventDefault(),$(".js-profile-otp-popup .close").click(function(event){ACC.vinidDetail.hideVerifyADROTPPopup()})},showPopupConnectVinId:function(){this.resetForm($(ACC.vinidDetail.formData.connectVinCardForm)),ACC.captcha.renderWidget("profile-connect-vincard"),$(ACC.vinidDetail.formData.connectVinCardPopup).modal("show")},showPopupVerifyADROTP:function(result){$(ACC.vinidDetail.formData.phoneCryptLabel).text(result.phoneEncrypt),$(ACC.vinidDetail.formData.vinIdEncriptLabel).text(result.vinIdEncrypt),result.rewardPoint?($(ACC.vinidDetail.formData.blockHidden).show(),$(ACC.vinidDetail.formData.rewardPointLabel).text(result.rewardPoint)):$(ACC.vinidDetail.formData.blockHidden).hide(),this.resetForm($(ACC.vinidDetail.formData.verifyVinOtpForm)),ACC.captcha.renderWidget("js-profile-vinid-otp-captcha"),$(ACC.vinidDetail.formData.verifyVinOtpPopup).modal("show")},showVinCardErrorPopup:function(){$(ACC.vinidDetail.formData.vinidCardErrorPopup).modal("show")},hideVerifyADROTPPopup:function(){$(ACC.vinidDetail.formData.verifyVinOtpPopup).modal("hide")},hideConnectVinIdPopup:function(){$(ACC.vinidDetail.formData.connectVinCardPopup).modal("hide")},addErrorMessageToField:function(fieldGroup,error){var parentElement=fieldGroup.parent(),errorContainer=parentElement.find(ACC.vinidDetail.formData.errorMessage);"OK"===error?errorContainer.text(""):errorContainer.text(error)},resetForm:function($form){$form.find(".error-message").html(""),$form.resetForm()}},ACC.adrExpandCollapse={_autoload:[["init",$(".js-height-toggle").length>0],["productDescriptionToggle",$(".js-height-toggle-description").length>0]],init:function(){$(".js-height-toggle").each(function(){var $content,$toggle,$expand,$collapse,maxHeight,itemHeight,total,item,$item=$(this);$content=$item.find('[data-role="content"]'),$toggle=$item.find('[data-role="toggle"]'),$expand=$item.find('[data-role="expand"]'),$collapse=$item.find('[data-role="collapse"]'),item=$content.attr("data-item"),total=parseFloat($content.attr("data-total"))||5,itemHeight=item?$(item).eq(0).height():parseFloat($content.attr("data-item-height"))||0,maxHeight=itemHeight*total,$content.height()>maxHeight&&($toggle.show(),$content.css({"max-height":maxHeight,overflow:"hidden"}),$item.css("max-height","none"),$collapse.hide()),$expand.on("click",function(event){event.preventDefault(),$content.css({"max-height":"none"}),$collapse.show(),$expand.hide()}),$collapse.on("click",function(event){event.preventDefault(),$content.css({"max-height":maxHeight,overflow:"hidden"}),$expand.show(),$collapse.hide()})})},productDescriptionToggle:function(){for(var index,$item=$(".js-height-toggle-description"),length=$item.find(".short-des__content ul li").length,counttmp=0,i=0;i<length;i++)if((counttmp+=$item.find(".short-des__content ul li").eq(i).height())>=120){index=i;break}for(var count=100,j=0;j<index;j++)count+=5;$item.find(".short-des__expand").on("click",function(){$item.find(".short-des__content").height("auto"),$item.find(".short-des__expand").hide(),$item.find(".short-des__collapse").show()}),$item.find(".short-des__collapse").on("click",function(){$item.find(".short-des__content").height(count),$item.find(".short-des__expand").show(),$item.find(".short-des__collapse").hide()});var initToggle=function(){$item.find(".short-des__content").height()>120?($item.find(".short-des__content").height(count),$item.find(".short-des__expand").show(),$item.find(".short-des__collapse").hide()):$item.find(".short-des__toggle").hide()};initToggle(),$("window").on("resize",function(){initToggle()})}},ACC.adrProductDetail={_autoload:["initWishListAction","initDefaultGallery",["init",$(".product-detail__section").length>0],["initMenuDetail",$(".js-menu-detail_swiper").length>0],["initVoucher",$(".product-detail__section.product-detail__deal").length>0],["viewMoreReviewComment",$(".js-view-more-review").length>0],["initDatePicker",$(".datepicker").length>0],["bindDisplayWithNoPrice",$(".product-detail__section").length>0],["bindTimeCountDown",$(".properties-list-info-deal, .deal-expiration-date-text").length>0],["bindNicescrollManyCities",$(".js-properties-list__city").length>0],["unblockAddToCart",$("#addToCartButton").length>0],["bindCautionPopup",$(".pageType-CategoryPage, .page-search, .pageType-ProductPage").length>0],"initCopyDiscountTag","pdpSeemoreAction","bindCountDownClock","ajaxAddStopper",["selectedPaymentInstallmentMode",$("#product__installment__payment").length>0],["addActionShowPopupPaymentMode",$("#product__installment__payment").length>0],["reloadPaymentModeRequest",$("#product__installment__payment").length>0],"ux_pdp_discount_mobile","handle_touch_pdp_discount_mobile",["init360Media","undefined"!=typeof json360Media]],isQuickView:function(){return!("undefined"==typeof quickViewJs||!quickViewJs)},initDefaultGallery:function(){$("#detailImageThumbs").length>0?ACC.adrProductDetail.initGalleryv2DataByJson():ACC.adrProductDetail.initGalleryDataByJson()},show:function(){var _this=this;this.loadModal(function(){$.get(ACC.config.checkCaptchaUrl+"?localip="+ACC.login.data.localIp,function(result){result&&ACC.captcha.renderWidget("js-login-captcha")}),ACC.login.loginForm.removeClass("has-error"),_this.popup.modal("show")})},init:function(){var _this=this;if(_this.DOM={$stickyHeader:$(".js-product-detail__sticky-header"),$message:$(".js-location-message"),$mapList:$(".js-map-address")},_this.initPopover(),_this.initSpecification(),_this.initIframeInDetail(),_this.initProductReference(),_this.DOM.$stickyHeader.length>0&&_this.initStickyHeader(),_this.initMap(),$(".js-view-merchant").on("click",function(event){event.preventDefault();var target,offset,$this=$(this);target=$this.attr("data-target"),(offset=$(target).offset())&&$("html, body").animate({scrollTop:offset.top})}),$(".js-product-suggestion-btn").on("click",function(event){event.preventDefault(),$(".js-product-suggestion-container").addClass("show-all")}),$("#showAllMerchants").on("click",function(event){$(".adr-table-row.order-item.adr-order-hidden").toggleClass("hidden"),event.preventDefault(),event.stopPropagation();var showallMsg=$(this).data("showall-message"),collapseMsg=$(this).data("collapse-message"),curMsg=$(this).text(),nextMsg=curMsg===showallMsg?collapseMsg:showallMsg;$(this).text(nextMsg)}),$("#showAllMerchantsMiniBuyBox").on("click",function(event){$(".mini-buy-box-adr-order-hidden").toggleClass("hidden"),$(".mini-buy-box-adr-order-hidden").hasClass("hidden")?$(".btn-expand .caret").removeClass("expand"):$(".btn-expand .caret").addClass("expand"),event.preventDefault(),event.stopPropagation()}),$(".js-map-address li:nth-child(1)").addClass("active"),$(".js-map-address li a").click(function(){$(this).parent().addClass("active").siblings().removeClass("active")}),$(".product-detail__variants").length>0&&$(".product-detail__variants").eq(0).attr("id","productVariants"),$(".swiper-button-disabled").removeClass("swiper-button-disabled"),this.initMessage(),$('input[name="srcIframeMap"]').length>0){var $window=$(window),windowHeight=$window.height(),windowWidth=$window.width(),windowScrollTop=0,mapScriptLoaded=!1,timerInitMap=null,deferTimerInitMap=null;window.init_prod_map=function(){if(mapScriptLoaded)return!1;windowScrollTop=$window.scrollTop();var offset=windowWidth>980?400:300;if($("#mapAddressSection").offset().top-windowScrollTop-offset>1*windowHeight)return!0;if(!window.mapLibLoaded){$(".map-google-section-desktop").addClass("loading-library");var api_key="undefined"!=typeof googleMapApiKey?googleMapApiKey:"AIzaSyB1Kn6kJqW2qWaXd-g1a54hzWJHk2VTUjQ";$("body").append('<script src="https://maps.googleapis.com/maps/api/js?key='+api_key+'&callback=prod_map_loaded"><\/script>')}if(!window.mapLibLoaded)return!0;var params=$("#mapAddressSection").find('input[name="srcIframeMap"]:first').val(),latitude=$("#mapAddressSection").find('input[name="latitude"]:first').val(),longitude=$("#mapAddressSection").find('input[name="longitude"]:first').val();if(""!=latitude&&""!=longitude)_this.loadGoogleMapByCoordinates([$(".map-google-section-desktop"),$("#mapAddressSection").find(".map-google-section-mobile:first")],latitude,longitude);else{var ifrmElement=_this.createIframeGoogleMap(params);$(".map-google-section-desktop").append(ifrmElement),$("#mapAddressSection").find(".map-google-section-mobile:first").append(ifrmElement)}$("#mapAddressSection").getNiceScroll().resize(),mapScriptLoaded=!0},window.prod_map_loaded=function(){window.mapLibLoaded=!0,init_prod_map(),$(".map-google-section-desktop").removeClass("loading-library")},window.init_prod_map(),$window.on("scroll",function(){timerInitMap&&clearTimeout(timerInitMap),timerInitMap=setTimeout(function(){init_prod_map()},300)}),$window.on("resize",function(){deferTimerInitMap&&clearTimeout(deferTimerInitMap),deferTimerInitMap=setTimeout(function(){windowHeight=$window.height(),windowWidth=$window.width(),init_prod_map()},600)}),$(document).on("click",".redemption-location-item",function(event){_this.toogleDisplayGoogleMap(this);var googleMap4Desktop=$(".map-google-section-desktop"),googleMap4Mobile=$(this).next();googleMap4Desktop.empty(),googleMap4Mobile.empty();var $parent=$(this).parent(),params=$parent.find('input[name="srcIframeMap"]:first').val(),latitude=$parent.find('input[name="latitude"]:first').val(),longitude=$parent.find('input[name="longitude"]:first').val();""!=latitude&&""!=longitude?_this.loadGoogleMapByCoordinates([googleMap4Desktop,googleMap4Mobile],latitude,longitude):(googleMap4Desktop.append(_this.createIframeGoogleMap(params)),googleMap4Mobile.append(_this.createIframeGoogleMap(params))),event.preventDefault(),event.stopPropagation()})}$("#product-detail__similar-product").length>0&&$(".status-no-stock").click(function(){$("html, body").animate({scrollTop:$("#product-detail__similar-product").offset().top-80},"slow")}),$(".js-product-list__container .product-item").length>3&&($(".js-product-list__container").css("max-height","159px"),$(".js-product-list__container").css("overflow","hidden"),$(".product__toggle--expand").show()),$(".product__toggle--expand").on("click",function(event){event.preventDefault(),$(".js-product-list__container").css("max-height","100%"),$(this).hide(),$(".product__toggle--collapse").show()}),$(".product__toggle--collapse").on("click",function(event){event.preventDefault(),$(".js-product-list__container").css("max-height","159px"),$(this).hide(),$(".product__toggle--expand").show()}),$(".js-discount__collapse").on("click",function(event){event.preventDefault();var popOverEl=$($(this).closest(".popover__wrapper").find(".popover__content_wrap"));"none"===popOverEl.css("display")?$(popOverEl).css("display","block"):$(popOverEl).css("display","none")})},initWishListAction:function(){$(".wishliscon-productdetails").unbind("click"),$(".wishliscon-productdetails").on("click",function(e){var productCode=$("#addtowishLink").attr("data-product"),cobj=$(this);if("anonymous"===ACC.userInfo.uid)return $("#modal-quick-view").length>0&&$("#modal-quick-view").modal("hide"),void ACC.login.show();if(!cobj.data("requestRunning")){cobj.data("requestRunning",!0);var res=$.ajax({url:"/addwish?pcode="+productCode,method:"GET",success:function(response){if("0"===response){var exCount=eval($("#wishCount").attr("data-count"));$("#wishCount").html(""),$(".wishliscon-productdetails > #wishiconprod").removeClass("polish-version-icon-heart-shape").addClass("polish-version-icon-heart-1").css({color:"#E53935"})}else if("1"===response){var exCount=eval($("#wishCount").attr("data-count"));$("#wishCount").html("")}},complete:function(){cobj.data("requestRunning",!1),ACC.common.bindWishPopup(productCode)}})}})},initItemThumbsForImage:function(){var itemThumbs=7;return $("#detailImageThumbs").length>0&&(itemThumbs=$("#detailImageThumbs").data("itemthumbs")),"undefined"!=typeof pageType&&"voucher"===pageType.toLowerCase()&&(itemThumbs=6),
"undefined"!=typeof pageType&&"fashion"===pageType.toLowerCase()&&"mobile"===ACC.devices.name.toLowerCase()&&(itemThumbs=6),itemThumbs},copyToClipboard:function(el){if(navigator.userAgent.match(/ipad|ipod|iphone/i)){console.log("ipohone");var oldContentEditable=el.contentEditable,oldReadOnly=el.readOnly,range=document.createRange();el.contentEditable=!0,el.readOnly=!1,range.selectNodeContents(el);var s=window.getSelection();s.removeAllRanges(),s.addRange(range),el.setSelectionRange(0,999999),el.contentEditable=oldContentEditable,el.readOnly=oldReadOnly}else console.log("no iphone"),el.select();document.execCommand("copy")},initVoucher:function(){var _this=this;$(document).on("change","#pdpStartReferredDate",function(){var value=$(this).val();$(this).parents(".addtocart-component").find("#addToCartForm").find(".js-startdate-referred-input").val(value)}),$(document).on("change","#pdpEndReferredDate",function(){var value=$(this).val();$(this).parents(".addtocart-component").find("#addToCartForm").find(".js-enddate-referred-input").val(value)}),_this.initAddToCartValidation()},initIframeInDetail:function(){$(".detail__info iframe").wrap('<div class="video-container"></div>')},initMessage:function(){var _this=this;_this.DOM.$message.length>0&&($(document).on("click",function(){_this.DOM.$message.fadeOut()}),$(window).on("load",function(){setTimeout(function(){_this.DOM.$message.fadeOut()},3e3)}))},initMap:function(){var niceScrollOpts,_this=this,$domMapAddress=$(".js-map-address");niceScrollOpts={cursorwidth:"6px",cursorborderradius:"0",cursorborder:"1px solid transparent",cursorcolor:"#666",autohidemode:!1,background:"#d8d8d8",horizrailenabled:!1,disablemutationobserver:!0,railpadding:{top:1,right:1,left:1,bottom:1}},$domMapAddress.length>0&&$domMapAddress.find("li").length>0&&$domMapAddress.niceScroll(niceScrollOpts),$("body").width()<parseInt(screenSm)&&enquire.register("(max-width: 768px)",{match:function(){$domMapAddress.getNiceScroll().resize(),$(".map-address__address-item, .redemption-location-item").addClass("is-xs")},unmatch:function(){$(".map-address__address-item, .redemption-location-item").removeClass("is-xs")},setup:function(){},deferSetup:!0}),_this.DOM.$mapList.length>0&&_this.DOM.$mapList.find("li").length>0&&$(document).on("click",".map-address__address-item",function(event){_this.toogleDisplayGoogleMap(this);var googleMap4Desktop=$(".map-google-popup-desktop"),googleMap4Mobile=$(this).next();googleMap4Desktop.empty(),googleMap4Mobile.empty();var $parent=$(this).parent(),params=$parent.find('input[name="srcIframeMap"]:first').val(),latitude=$parent.find('input[name="latitude"]:first').val(),longitude=$parent.find('input[name="longitude"]:first').val();""!=latitude&&""!=longitude?_this.loadGoogleMapByCoordinates([googleMap4Desktop,googleMap4Mobile],latitude,longitude):(googleMap4Desktop.append(_this.createIframeGoogleMap(params)),googleMap4Mobile.append(_this.createIframeGoogleMap(params))),event.preventDefault(),event.stopPropagation()}),window.init_redemption_map=function(){if(!window.mapLibLoaded){$("#redemptionLocations .map-google-popup-desktop").addClass("loading-library");var api_key="undefined"!=typeof googleMapApiKey?googleMapApiKey:"AIzaSyB1Kn6kJqW2qWaXd-g1a54hzWJHk2VTUjQ";$("body").append('<script src="https://maps.googleapis.com/maps/api/js?key='+api_key+'&callback=redemption_map_loaded"><\/script>')}if(!window.mapLibLoaded)return!0;var latitude=$("#mapAddressPopup").find('input[name="latitude"]:first').val(),longitude=$("#mapAddressPopup").find('input[name="longitude"]:first').val();if(""!=latitude&&""!=longitude)_this.loadGoogleMapByCoordinates([$(".map-google-popup-desktop"),$("#mapAddressPopup").find(".map-google-popup-mobile:first")],latitude,longitude);else{var params=$("#mapAddressPopup").find('input[name="srcIframeMap"]:first').val(),ifrmElement=_this.createIframeGoogleMap(params);$(".map-google-popup-desktop").append(ifrmElement),$("#mapAddressPopup").find(".map-google-popup-mobile:first").append(ifrmElement)}$("#mapAddressPopup").getNiceScroll().resize()},window.redemption_map_loaded=function(){window.mapLibLoaded=!0,init_redemption_map(),$("#redemptionLocations .map-google-popup-desktop").removeClass("loading-library")},$("#redemptionLocations").on("show.bs.modal",function(){window.mapLibLoaded||$("#redemptionLocations .map-google-popup-desktop").addClass("loading-library")}),$("#redemptionLocations").on("shown.bs.modal",function(){init_redemption_map()})},loadGoogleMapByCoordinates:function(elementArray,latitude,longitude){$.each(elementArray,function(index,mapItem){var uluru={lat:Number(latitude),lng:Number(longitude)},map=new google.maps.Map(mapItem.get(0),{zoom:15,center:uluru});new google.maps.Marker({position:uluru,map:map});mapItem.find("iframe").attr("src",""),mapItem.find("iframe").hide()})},createIframeGoogleMap:function(src){var iframe=document.createElement("iframe");return iframe.width="100%",iframe.height="370",iframe.frameborder="0",iframe.style="border: 0",iframe.allowfullscreen="true",iframe.src=src,iframe},toogleDisplayGoogleMap:function(element){if($(element).attr("class").indexOf("is-xs")>0){$(element).not($(element)).removeClass("is-map-show"),$(element).toggleClass("is-map-show"),$(".map-google").addClass("hidden"),$(element).hasClass("is-map-show")&&$(element).next(".map-google").removeClass("hidden"),$(".js-map-address").getNiceScroll().resize()}},initStickyHeader:function(){var _this=this;if($("body").width()<parseInt(screenSm))return!1;$(window).on("scroll",function(){var scrollTop=$(this).scrollTop();$("#place-show__sticky").offset().top-60<=scrollTop?_this.DOM.$stickyHeader.addClass("sticky slideInDown"):_this.DOM.$stickyHeader.removeClass("sticky slideInDown")}).trigger("scroll")},initTheatreImage:function(){$("#modal-theatre-image").on("shown.bs.modal",function(){var $swiper,$list,swiper,$this=$(this);$swiper=$this.find(".js-theatre-image__swiper"),$list=$this.find(".js-theatre-image__list");var listSwiperOpts,mediaQuery,handle;listSwiperOpts={direction:"vertical",slidesPerView:"auto",spaceBetween:8,autoHeight:!0,mousewheelControl:!0,mousewheelForceToAxis:!0,mousewheelReleaseOnEdges:!0,mousewheelInvert:!0,scrollbar:".swiper-scrollbar",scrollbarHide:!1,scrollbarDraggable:!0,scrollbarSnapOnRelease:!0},swiper=$swiper.swiper({}),$list.swiper(),mediaQuery={tablet:_.template("screen and (min-width: <%= size %>)")({size:screenSmMin}),mobile:_.template("screen and (max-width: <%= size %>)")({size:screenXsMax})},handle={tablet:function(){$swiper[0].swiper.destroy(!1,!0),swiper=$swiper.swiper({keyboardControl:!0}),$list[0].swiper.destroy(!1,!0),$list.swiper(listSwiperOpts)},mobile:function(){$swiper[0].swiper.destroy(!1,!0),swiper=$swiper.swiper(),$list[0].swiper.destroy(!1,!0),listSwiperOpts.direction="horizontal",$list.swiper(listSwiperOpts)}},enquire.register(mediaQuery.tablet,{match:function(){handle.tablet()},unmatch:function(){handle.mobile()}}),enquire.register(mediaQuery.mobile,{match:function(){handle.mobile()},unmatch:function(){handle.tablet()}}),swiper.on("slideChangeEnd",function(w){var swiperIndex,listIndex,$listEl;$list.find(".theatre-image__list-item").removeClass("active"),swiperIndex=$(w.slides[w.activeIndex]).find(".theatre-image__stage-item").attr("data-index"),$listEl=$list.find('.theatre-image__list-item[data-index="'+swiperIndex+'"]'),listIndex=$listEl.parent().index(),$listEl.addClass("active"),$list[0].swiper.slideTo(listIndex)}),$list.find(".theatre-image__list-item").removeClass("active"),$list.find('.theatre-image__list-item[data-type="image"]').first().addClass("active"),$list.find(".theatre-image__list-item").on("click",function(event){event.preventDefault();var listIndex,swiperIndex;listIndex=$(this).attr("data-index"),swiperIndex=$swiper.find('.theatre-image__stage-item[data-index="'+listIndex+'"]').parent().index(),swiper.slideTo(parseInt(swiperIndex))}),$swiper.find(".swiper-button-next").off("click").on("click",function(event){event.preventDefault(),swiper.slideNext()}),$swiper.find(".swiper-button-prev").off("click").on("click",function(event){event.preventDefault(),swiper.slidePrev()})})},initMenuDetail:function(){var menuDetail,menuDetailModal;menuDetailModal=$("#modal-cpp-menu-details-images-info"),menuDetailModal.on("show.bs.modal",function(){menuDetailModal.find("iframe[data-src]").length&&menuDetailModal.find("iframe[data-src]").each(function(){$(this).attr("src",$(this).data("src"))})}),menuDetailModal.on("shown.bs.modal",function(){menuDetail=new Swiper(".js-menu-detail_swiper",{autoHeight:!0,slidesPerView:1,nextButton:"#modal-cpp-menu-details-images-info .swiper-button-next",prevButton:"#modal-cpp-menu-details-images-info .swiper-button-prev",spaceBetween:0})})},initAddToCartValidation:function(){$(document).on("click","#addToCartButton",function(e){e.preventDefault(),ACC.adrProductDetail.sendCartValidation($(this))})},initDatePicker:function(){var startDateDom,endDateDom;$(".input-range").length>0&&$(".input-range").each(function(){var drpDomData,drpFormat,drpStartDate,drpEndDate,dateRangePickerOptions;drpDomData={format:$(this).attr("data-datepicker-format"),currentDate:$(this).attr("data-datepicker-current-date"),startDate:$(this).attr("data-datepicker-start-date"),endDate:$(this).attr("data-datepicker-end-date")},drpFormat="dd/mm/yyyy",drpStartDate=drpDomData.currentDate,drpEndDate="",_.isEmpty(drpDomData.format)||(drpFormat=drpDomData.format),!_.isEmpty(drpDomData.startDate)&&$.datepicker.parseDate("dd/mm/yy",drpDomData.startDate)>$.datepicker.parseDate("dd/mm/yy",drpDomData.currentDate)&&(drpStartDate=drpDomData.startDate),_.isEmpty(drpDomData.endDate)||(drpEndDate=drpDomData.endDate),dateRangePickerOptions={format:drpFormat,language:"vi",inputs:$(".datepicker"),startDate:drpStartDate,templates:{leftArrow:"&#60;",rightArrow:"&#62;"}},_.isEmpty(drpEndDate)||(dateRangePickerOptions.endDate=drpEndDate),$(".input-range").datepicker(dateRangePickerOptions)}),$(".datepicker").each(function(){var dataPickerOptions,nowDate,currentDate,startDate,endDate;nowDate=new Date,new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate(),0,0,0,0),currentDate=$(this).attr("data-current-date"),startDate=$(this).attr("data-start-date"),endDate=$(this).attr("data-end-date"),void 0!==endDate&&""!==endDate&&$.datepicker.parseDate("dd/mm/yy",currentDate)>$.datepicker.parseDate("dd/mm/yy",endDate)&&$(this).closest(".product-detail__deal-col").remove(),dataPickerOptions={format:"dd/mm/yyyy",language:"vi",autoclose:!1,templates:{leftArrow:"&#60;",rightArrow:"&#62;"}},(void 0===startDate||$.datepicker.parseDate("dd/mm/yy",currentDate)>$.datepicker.parseDate("dd/mm/yy",startDate))&&(startDate=currentDate),dataPickerOptions.startDate=startDate,void 0!==endDate&&(dataPickerOptions.endDate=endDate),$(this).datepicker(dataPickerOptions)}),startDateDom=".datepicker.startdate",endDateDom=".datepicker.enddate ";var $addToCartComponent=$(startDateDom).parents(".addtocart-component"),$addToCartBtn=$addToCartComponent.find("#addToCartButton");$(startDateDom).datepicker().on("changeDate",function(e){if(null!==$(this).datepicker("getDate")){$(this).datepicker("hide"),$(endDateDom).datepicker("setStartDate",e.date);var startDateVal=$(startDateDom).datepicker("getDate"),endDateVal=$(endDateDom).datepicker("getDate");null===endDateVal&&($(endDateDom).datepicker("clearDates"),$(endDateDom).datepicker("update"),$(endDateDom).datepicker("show"),$addToCartBtn.addClass("disabled")),null!==startDateVal&&null!==endDateVal&&$addToCartBtn.removeClass("disabled")}}),$(startDateDom).datepicker().on("clearDate",function(e){var startDateVal=$(startDateDom).datepicker("getDate"),endDateVal=$(endDateDom).datepicker("getDate");$addToCartBtn.addClass("disabled"),$(startDateVal).datepicker("clearDates"),$(startDateVal).datepicker("show"),null===startDateVal&&null===endDateVal&&$addToCartBtn.removeClass("disabled")}),$(endDateDom).datepicker().on("changeDate",function(e){if(null!==$(this).datepicker("getDate")){$(endDateDom).datepicker("hide");var startDateVal=$(startDateDom).datepicker("getDate"),endDateVal=$(endDateDom).datepicker("getDate");null!==startDateVal&&null!==endDateVal&&$addToCartBtn.removeClass("disabled")}}),$(endDateDom).datepicker().on("clearDate",function(e){console.log(startDateVal,endDateVal);var startDateVal=$(startDateDom).datepicker("getDate"),endDateVal=$(endDateDom).datepicker("getDate");$addToCartBtn.addClass("disabled"),$(endDateVal).datepicker("clearDates"),$(endDateVal).datepicker("show"),null===startDateVal&&null===endDateVal&&$addToCartBtn.removeClass("disabled")})},sendCartValidation:function(self){if($("#startReferredDateStr").length>0){var code=$("input[name*='productCodePost']").val(),startDate=$("#startReferredDateStr").val(),endDate=$("#endReferredDateStr").val(),dataString={productCode:code,startReferredDateStr:startDate,endReferredDateStr:endDate};$.ajax({url:ACC.config.encodedContextPath+"/cart/validate",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){if("OK"==response.status)$("#addtocartErrorMsg").text(""),$(".addtocartErrorMsg").addClass("hidden");else{var errors=response.fieldValidations;void 0!=errors&&($(".addtocartErrorMsg").removeClass("hidden"),$("#addtocartErrorMsg").text(errors.startReferredDate))}}})}},initProductReference:function(){0==$("#count-product-together").children().size()&&$("#product-detail__together-viewed").hide(),0==$("#count-product-together-mobile").children().size()&&$("#product-detail__together-viewed-mobile").hide()},initSpecification:function(){$(".product-specs__view").on("click",function(e){e.preventDefault(),$("#allClassificationAtrrModal").on("shown.bs.modal",function(){if($("body").width()<parseInt(screenSm))return!1;var instance,$scroll=$(this).find("#js-product-detail__specs");instance=$scroll.getNiceScroll(),instance&&instance[0]?instance.resize():$scroll.niceScroll({cursorwidth:"5px",cursorborderradius:"0",cursorborder:"1px solid transparent",cursorcolor:"#cc2023",autohidemode:!1,background:"#d8d8d8",horizrailenabled:!1,disablemutationobserver:!0,railpadding:{top:1,right:1,left:1,bottom:1}})}).modal("show")}),$("#allClassificationAtrrModal").blur(function(){$(this).modal("hide")})},initPopover:function(){$('.product-detail__section [data-toggle="popover"]').popover({trigger:"manual",container:"body",animation:!0,viewport:{selector:".product-detail__section > .container",padding:20},html:!0,content:function(){var target,$this=$(this);return target=$this.attr("data-target"),target?$(target).html():$this.attr("data-content")}}).on("click",function(e){e.preventDefault()}).on("mouseenter",function(){var _this=this;$(this).popover("show"),$(".popover").on("mouseleave",function(){$(_this).popover("hide")})}).on("mouseleave",function(){var _this=this;setTimeout(function(){$(".popover:hover").length||$(_this).popover("hide")},100)})},initLocation:function(){$('.product-detail__sidebar__location-checker select[name="city"]').selectize({onChange:function(value){this.$dropdown_content.find(".current").removeClass("current"),this.$dropdown_content.find('[data-value="'+value+'"]').addClass("current")}}),$('.product-detail__sidebar__location-checker select[name="district_only"]').selectize({plugins:["restore_on_backspace"],onInitialize:function(){this.$dropdown.append('<div class="no-result"><a href="">Không có địa chỉ của bạn</a></div>')},onChange:function(value){this.$dropdown_content.find(".current").removeClass("current"),this.$dropdown_content.find('[data-value="'+value+'"]').addClass("current")}}),$('.product-detail__sidebar__location-checker select[name="district"]').selectize({plugins:["restore_on_backspace"],onInitialize:function(){this.$dropdown.append('<div class="no-result"><a href="">Không có địa chỉ của bạn</a></div>')},onChange:function(value){this.$dropdown_content.find(".current").removeClass("current"),this.$dropdown_content.find('[data-value="'+value+'"]').addClass("current")}}),$('.product-detail__sidebar__location-checker select[name="ward"]').selectize({plugins:["restore_on_backspace"],onInitialize:function(){this.$dropdown.append('<div class="no-result"><a href="">Không có địa chỉ của bạn</a></div>')}})},initGallery:function(){var $stage,zoom,$thumbs,$gallery=$(".js-product-detail__gallery"),width=$(".product-detail__info").width();if($stage=$gallery.find(".product-gallery__stage img.stage"),void 0!==$stage&&0!=$stage.length||($stage=$gallery.find(".ict_product-gallery__stage img.stage")),$thumbs=$gallery.find(".gallery-thumbnail__item"),$gallery.find(".product-item__overlay").removeClass("hidden"),$("body").width()<parseInt(screenMd))return $thumbs.on("click",function(){var img,$this=$(this);img=$this.attr("data-image"),$stage.attr({src:img,"data-image":img,"data-zoom-image":$this.attr("data-zoom-image")})}),!1;$stage.ezPlus({borderSize:1,borderColour:"#eee",zoomWindowPosition:1,zoomWindowOffsetx:16,easing:!1,zoomEnabled:!0,zoomWindowWidth:width,zoomWindowHeight:width}),zoom=$stage.data("ezPlus"),void 0!=zoom&&null!=zoom&&(zoom.onImageSwap=function(){zoom.zoomEnabled=!1,$(".zoomContainer").hide()},zoom.onImageSwapComplete=zoom.onZoomedImageLoaded=function(){zoom.options.zoomEnabled=!0,$(".zoomContainer").show()}),$thumbs.on("mouseenter",function(){var $thisItem=$(this);switch($thisItem.addClass("active").siblings(".active").removeClass("active"),$thisItem.attr("data-type")){case"image":zoom.swaptheimage($thisItem.attr("data-image"),$thisItem.attr("data-zoom-image")),$stage.removeClass("hidden"),$("#youtubePlayer").addClass("hidden"),$("#youtubePlayer").attr("src",""),$(".zoomContainer").show();break;case"video_youtube":$(".zoomContainer").hide(),ACC.adrProductDetail.initGalleryYoutubeVideoItem($thisItem)}})},viewMoreReviewComment:function(){var length,current,$reviewWrapper=$(".js-view-more-review"),next=15;$("body").on("click",".js-view-more-review .btn-view-more-review",function(){length=$reviewWrapper.find(".review-list").attr("data-totalReviews"),current=next,next=current+10,length<=next&&(next=length,$reviewWrapper.find(".btn-view-more-review").addClass("hidden"));for(var j=current;j<next;j++)$reviewWrapper.find(".product-comment__item").eq(j).removeClass("hidden");$(".js-ratingCalc").each(function(){var rating=$(this).data("rating");$(this).find(".js-greenStars").width($(this).width()*(parseFloat(rating.rating,10)/rating.total))})})},bindFocusRatingComment:function(){$(document).on("click","#js-focus-ratingbox",function(e){$("html, body").animate({scrollTop:$("#reviewComment").offset().top-190},500),$("#reviewComment").focus()})},lightSliderInit:function(){$("#product-detail__gallery_mobile").lightSlider({gallery:!0,adaptiveHeight:!0,item:1,thumbItem:5,thumbMargin:8,slideMargin:0,loop:!0,prevHtml:'\n                    <div class="d-icon f-row a-j-center">\n                        <i class="polish-version-icon-arrow-left"></i>\n                    </div>\n            ',nextHtml:'\n                    <div class="d-icon f-row a-j-center">\n                        <i class="polish-version-icon-arrow-right"></i>\n                    </div>\n            ',onSliderLoad:function(){$("#product-detail__gallery_mobile").removeClass("cS-hidden")},extendBtn:void 0!=json360Media.desktopUrl&&void 0!=json360Media.mobileUrl&&json360Media.mobileUrl.length>0&&json360Media.desktopUrl.length>0?[{e_class:"view__360deg__btn"}]:"",currentPagerPosition:"left"}),ACC.adrProductDetail.isQuickView()||$(".lSSlideWrapper").find("li").each(function(e){$(this).on("click",function(){$("#modal-theatre-image").modal("show");var element=document.getElementById("theatre-image__content_swipe_vertical"),mc=new Hammer(element);mc.get("swipe").set({direction:Hammer.DIRECTION_ALL}),mc.on("swipeleft",function(){}),mc.on("swiperight",function(){}),mc.on("swipeup",function(){$("#modal-theatre-image").modal("hide")}),mc.on("swipedown",function(){$("#modal-theatre-image").modal("hide")})})}),void 0!==$(".product-gallery-mobile__stopper").html()&&""!=$(".product-gallery-mobile__stopper").html().trim()&&($(".product-gallery-mobile__stopper").removeClass("hide"),$(".product-detail__gallery_mobile-css .lSSlideWrapper").prepend($(".product-gallery-mobile__stopper")))},initGalleryDataByJson:function(){if("undefined"!=typeof productJsonMedias&&productJsonMedias.length>0){var stageImageIndex;stageImageIndex=0;var slidesPerView=ACC.adrProductDetail.initItemThumbsForImage();if(productJsonMedias.length>0){for(var i=0;i<productJsonMedias.length;i++)if("image"===productJsonMedias[i].type.toLowerCase()){stageImageIndex=i;break}var stageImage=productJsonMedias[stageImageIndex];$(".product-gallery__stage").append(ACC.adrProductDetail.markupGalleryItem.stage_image(stageImage)),stageImage.altText&&""!=stageImage.altText||(stageImage.altText="No Image"),$("#sticky-header_img").attr("src",stageImage.url),$("#sticky-header_img").attr("alt",stageImage.altText)}for(var i=0;i<productJsonMedias.length;i++){var swiperStageHtml,swiperListHtml;swiperStageHtml="",swiperListHtml="";var jssorListHtml="",thumbHtml="";"undefined"==typeof pageType||"voucher"!==pageType.toLowerCase()&&"tablebooking"!==pageType.toLowerCase()?i<4&&(thumbHtml="",thumbHtml='<div class="col-xs-2-5"><div class="gallery-thumbnail__item-wrapper">',"image"===productJsonMedias[i].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItem.thumb_image(productJsonMedias[i])),"video"===productJsonMedias[i].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItem.thumb_video(productJsonMedias[i])),"video_youtube"===productJsonMedias[i].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItemv2.thumb_video_youtube(productJsonMedias[i])),thumbHtml+="</div></div>",$(".product-gallery__thumbnail .row").append(thumbHtml)):(thumbHtml="","image"===productJsonMedias[i].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItemv2.thumb_image(productJsonMedias[i])),"video"===productJsonMedias[i].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItem.thumb_video(productJsonMedias[i])),"video_youtube"===productJsonMedias[i].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItemv2.thumb_video_youtube(productJsonMedias[i])),$(".swiper-container.gallery-thumbs.voucher .swiper-wrapper").append(thumbHtml)),"image"===productJsonMedias[i].type.toLowerCase()&&(swiperStageHtml+=ACC.adrProductDetail.markupGalleryItem.swiper_stage(productJsonMedias[i],i)),swiperListHtml+=ACC.adrProductDetail.markupGalleryItem.swiper_list(productJsonMedias[i],i),jssorListHtml+=ACC.adrProductDetail.markupGalleryItem.jssor_item(productJsonMedias[i],i),("mobile"==ACC.devices.name||ACC.adrProductDetail.isQuickView())&&$(".lightslider-mobile").append(jssorListHtml),$(".js-theatre-image__swiper .swiper-wrapper").append(swiperStageHtml),$(".js-theatre-image__list .swiper-wrapper").append(swiperListHtml)}if(productJsonMedias.length>5)$(".product-gallery__thumbnail .row").append(ACC.adrProductDetail.markupGalleryItem.thumb_more(productJsonMedias[4])),$(".js-gallery-thumbnail__count").text("+"+(productJsonMedias.length-4));else if(void 0!==productJsonMedias[4]){var thumbHtml;thumbHtml='<div class="col-xs-2-5"><div class="gallery-thumbnail__item-wrapper">',"image"===productJsonMedias[4].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItem.thumb_image(productJsonMedias[4])),"video"===productJsonMedias[4].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItem.thumb_video(productJsonMedias[4])),"video_youtube"===productJsonMedias[4].type.toLowerCase()&&(thumbHtml+=ACC.adrProductDetail.markupGalleryItemv2.thumb_video_youtube(productJsonMedias[4])),thumbHtml+="</div></div>",$(".product-gallery__thumbnail .row").append(thumbHtml)}if("desktop"!=ACC.devices.name.toLowerCase()||ACC.adrProductDetail.isQuickView())ACC.adrProductDetail.lightSliderInit(),ACC.adrProductDetail.initTheatreImage(),ACC.adrProductDetail.initGalleryVideoItem();else{new Swiper(".gallery-thumbs",{spaceBetween:8,slidesPerView:slidesPerView,navigation:{nextEl:"#js-next",prevEl:"#js-prev"},nextButton:"#js-next",prevButton:"#js-prev"});ACC.adrProductDetail.initGalleryv2(),productJsonMedias.length>slidesPerView&&($("#js-next").removeClass("hide"),$("#js-prev").removeClass("hide"))}}},initGalleryVideoItem:function(){$("body").on("click",".gallery-thumbnail__item-video, .theatre-image__video-item",function(){var videoTitle,videoUrl,videoHtml;videoTitle=$(this).attr("data-title"),videoUrl=$(this).attr("data-url"),videoHtml="",videoHtml+=ACC.adrProductDetail.markupGalleryItem.popup_video_youtube(videoUrl),$("#modal-theatre-video .product-detail__theatre-title span").html(videoTitle),$("#modal-theatre-video .product-detail__theatre-content").html(videoHtml),$("#modal-theatre-video").modal("show")}),$(".modal").on("hidden.bs.modal",function(){$("#ifrPopup").attr("src","")})},markupGalleryItem:{stage_image:function(data){var markup;return markup="",markup+='<img class="stage" src="'+data.carouselUrl+'" data-zoom-image="'+data.zoomUrl+'" data-image="'+data.carouselUrl+'" height="auto">'},thumb_image:function(data){var markup;return markup="",markup+='<div class="gallery-thumbnail__item gallery-thumbnail__item-image swiper-slide" data-type="'+data.type.toLowerCase()+'" data-image="'+data.carouselUrl+'" data-zoom-image="'+data.zoomUrl+'"><img class="img-responsive" src="'+data.url+'" height="auto" /></div>'},thumb_video:function(data){var markup;return markup="",markup+='<a class="gallery-thumbnail__item gallery-thumbnail__item-video" data-type="'+data.type.toLowerCase()+'" data-title="'+data.description+'" data-url="'+data.url+'"><div class="vertical-alignment-helper"><div class="vertical-align-center"><i class="adr-icon icon-play"></i></div></div></a>'},thumb_more:function(data){var markup;return markup="",markup+='<div class="col-xs-2-5 js-gallery-thumbnail__more"><div class="gallery-thumbnail__item-wrapper"><a class="gallery-thumbnail__item gallery-thumbnail__item-gallery" data-type="'+data.type.toLowerCase()+'"  data-title="'+data.description+'"  href="#modal-theatre-image" data-toggle="modal"> <img class="img-responsive" src="'+data.url+'"> <div class="gallery-thumbnail__mask"><div class="vertical-alignment-helper"><div class="vertical-align-center js-gallery-thumbnail__count"></div></div></div></a></div></div>'},swiper_stage:function(data,index){var markup,dataIndex;return markup="",dataIndex="","image"===data.type.toLowerCase()&&(dataIndex=' data-index="'+index+'"'),markup+='<div class="swiper-slide"><a class="theatre-image__stage-item" href="#" data-type="'+data.type.toLowerCase()+'" '+dataIndex+'><img  class="img-responsive lazy" src="'+data.carouselUrl+'" alt=""></a></div>'},swiper_list:function(data,index){var markup,dataIndex;if(markup="",dataIndex="",dataIndex=' data-index="'+index+'"',"image"===data.type.toLowerCase())markup+='<div class="swiper-slide"><a class="theatre-image__list-item" data-type="'+data.type.toLowerCase()+'" href="#" '+dataIndex+'><img class="img-responsive lazy" src="'+data.carouselUrl+'" alt=""></a></div>';else if("video_youtube"===data.type.toLowerCase()){var videoId=data.url.substring(data.url.lastIndexOf("/")+1,data.url.length),youtubeUrl=data.url+"?rel=0&showinfo=0&autoplay=1&loop=1&modestbranding=1&playlist="+videoId;markup+='<div class="swiper-slide"><a class="theatre-image__list-item theatre-image__video-item" data-type="'+data.type.toLowerCase()+'" href="#"  data-url="'+youtubeUrl+'"'+dataIndex+'><img class="img-responsive lazy" src="'+data.carouselUrl+'" alt="" /><div class="play-video-holder"><i class="adr-icon icon-play"></i></div></a></div>'}else markup+='<div class="swiper-slide"><a class="theatre-image__list-item theatre-image__video-item" data-type="'+data.type.toLowerCase()+'" data-title="'+data.description+'" data-url="'+data.url+'" href="#" '+dataIndex+'><i class="adr-icon icon-play"></i></a></div>';return markup},jssor_item:function(data,index){var markup;if(markup="",' data-index="'+index+'"',"image"===data.type.toLowerCase())markup+='<li style="" data-thumb="'+data.url+'"><img src="'+data.carouselUrl+'" style="width: 100%; height: auto" />';else if("video_youtube"===data.type.toLowerCase()){var videoId=data.url.substring(data.url.lastIndexOf("/")+1,data.url.length),youtubeUrl=data.url+"?rel=0&showinfo=0&autoplay=1&loop=1&modestbranding=1&playlist="+videoId;markup+='<li data-thumb="'+data.carouselUrl+'"><iframe id="ifrWap" frameborder="0"  src="'+youtubeUrl+'" style="height: 360px; width: 100%" class="youtube-player" type="text/html"></iframe></li>'}return markup},popup_video:function(videoUrl){var markup;return markup="",void 0!==videoUrl&&videoUrl.length>0&&(markup+='<div class="embed-responsive embed-responsive-16by9"><video class="embed-responsive-item" controls width="640" height="360"><source src="'+videoUrl+'" type="video/mp4"/><p>Your browser does not support video tag</p></video></div>'),markup},popup_video_youtube:function(videoUrl){var markup;return markup="<div>",void 0!==videoUrl&&videoUrl.length>0&&(markup+='<div class="embed-responsive-item"><iframe id="ifrPopup" class="youtube-player" type="text/html" src="'+videoUrl+'" style="width: 100%; height: 360px" iframeborder="0"></iframe></div>'),markup+="</div>"}},bindDisplayWithNoPrice:function(){var classNameList=".addtocart-component, .suggest__product,.variant-section, .product-detail__sidebar__merchant, .sticky-header__info-price";"true"===outofstockFlag?$(classNameList).addClass("hide"):$(classNameList).removeClass("hide")},bindTimeCountDown:function(){var exprDate=$("#expiryDate").val();$("#info-deal").countdown(exprDate,function(event){$(this).text(event.strftime("%D Ngày, %H:%M':%S''"))}),$(".deal-expiration-date-text").each(function(event){var $text=$(this),expirationDate=$text.prev("input:first").val();""!=expirationDate?$text.countdown(expirationDate,function(event){event.offset.totalDays>0?$(this).text(event.strftime("Còn %D ngày")):event.offset.hours>0||event.offset.minutes>0||event.offset.seconds>0?$(this).text(event.strftime("Còn %H:%M':%S''")):$(this).text("Còn 00 ngày")}):$(this).text("Còn 00 ngày")})},bindNicescrollManyCities:function(){var $listCities=$(".dropdown-menu .js-properties-list__city");$listCities.find("li").length>16&&$listCities.niceScroll({cursorwidth:"4px",cursorborder:"none",autohidemode:!1,cursorcolor:"#dddddd",disablemutationobserver:!0}),$(".dropdown-menu").mouseover(function(){$(this).show()})},unblockAddToCart:function(){$(window).load(function(){$("#addToCartButton").removeClass("disabled")})},checkCookiesModal:function(){var cookie_name=$(".modal-check").attr("id")+"_"+$(".modal-check").attr("name"),my_cookie=$.cookie(cookie_name);$("#popup-caution").length>0&&("true"===my_cookie||$("#popup-caution").modal({backdrop:"static",keyboard:!1})),$(".btn-caution-ok").on("click",function(e){return ACC.adrProductDetail.updateCookieValue(),!0}),$(".btn-caution-cancel").on("click",function(e){return!0})},updateCookieValue:function(){var $validCheck=$(".modal-check").prop("checked"),cookie_name=$(".modal-check").attr("id")+"_"+$(".modal-check").attr("name");$validCheck?$.cookie(cookie_name,!0,{path:"/",expires:1}):$.cookie(cookie_name,!1,{path:"/",expires:1})},bindCautionPopup:function(){ACC.adrProductDetail.checkCookiesModal()},initGalleryv2DataByJson:function(){if("undefined"!=typeof productJsonMedias&&productJsonMedias.length>0){var stageImageIndex=0;if(productJsonMedias.length>0){for(var i=0;i<productJsonMedias.length;i++)if("image"===productJsonMedias[i].type.toLowerCase()){stageImageIndex=i;break}var stageImage=productJsonMedias[stageImageIndex];$(".ict_product-gallery__stage").append(ACC.adrProductDetail.markupGalleryItemv2.stage_image(stageImage)),stageImage.altText&&""!=stageImage.altText||(stageImage.altText="No Image"),$("#sticky-header_img").attr("src",stageImage.url),$("#sticky-header_img").attr("alt",stageImage.altText)}
for(var thumbsHtml="",i=0;i<productJsonMedias.length;i++)"video_youtube"===productJsonMedias[i].type.toLowerCase()&&(thumbsHtml+=ACC.adrProductDetail.markupGalleryItemv2.thumb_video_youtube(productJsonMedias[i])),"image"===productJsonMedias[i].type.toLowerCase()&&(thumbsHtml+=ACC.adrProductDetail.markupGalleryItemv2.thumb_image(productJsonMedias[i]));$(".js-galleryv2-thumbnail__item").html(thumbsHtml),productJsonMedias.length>ACC.adrProductDetail.initItemThumbsForImage()&&($(".swiper-button-next.next-v2").removeClass("hidden"),$(".swiper-button-prev.prev-v2").removeClass("hidden")),"desktop"==ACC.devices.name.toLowerCase()?ACC.adrProductDetail.initGalleryv2():ACC.adrProductDetail.lightSliderInit()}},initGalleryYoutubeVideoItem:function(el){var $stage=$(".ict_product-gallery__stage");if(0===$stage.length&&($stage=$(".product-gallery__stage")),$stage.length>0){$stage.find("img").addClass("hidden");if("video_youtube"===$(el).data("type")){var youtubeUrl=$(el).data("url"),height=504;"undefined"==typeof pageType||"voucher"!==pageType.toLowerCase()&&"tablebooking"!==pageType.toLowerCase()||(height=456);var player='<iframe id="youtubePlayer" width="100%" height="'+height+'" src="'+youtubeUrl+'" frameborder="0" class="youtube-player" type="text/html"></iframe>';void 0!==$("#youtubePlayer")&&$("#youtubePlayer").length>0?($("#youtubePlayer").removeClass("hidden"),$("#youtubePlayer").attr("src")!==youtubeUrl&&($("#youtubePlayer").attr("src",youtubeUrl),$("#youtubePlayer").removeClass("hidden"))):$stage.append(player)}}},markupGalleryItemv2:{stage_image:function(data){var markup;return markup="",markup+='<img class="stage" src="'+data.carouselUrl+'" data-zoom-image="'+data.zoomUrl+'" data-image="'+data.carouselUrl+'" height="auto">'},thumb_image:function(data){var markup;return markup="",markup+='<div class="gallery-thumbnail__item gallery-thumbnail__item-image swiper-slide" data-type="'+data.type.toLowerCase()+'" data-image="'+data.carouselUrl+'" data-zoom-image="'+data.zoomUrl+'"><a href="#" class="small-thumbnail"><img class="img-responsive" src="'+data.url+' " style="max-width: 100%"/></a></div>'},thumb_video_youtube:function(data){var markup,videoId=data.url.substring(data.url.lastIndexOf("/")+1,data.url.length),youtubeUrl=data.url+"?rel=0&showinfo=0&autoplay=1&loop=1&modestbranding=1&playlist="+videoId;return markup="",markup+='<div class="gallery-thumbnail__item gallery-thumbnail__item-video theatre-image__list-item swiper-slide" data-type="'+data.type.toLowerCase()+'" data-title="'+data.description+'" data-url="'+youtubeUrl+'">',markup+='<a href="#" class="play-video-action small-thumbnail"><img src="'+data.carouselUrl+'" class="img-responsive" /><div class="play-video-holder"><i class="adr-icon icon-play"></i></div></a></div>'}},initGalleryv2:function(){var $stage,zoom,$thumbs,$gallery=$(".js-product-detail__gallery"),width=$(".product-detail__info").width();if($stage=$gallery.find(".product-gallery__stage img.stage"),void 0!==$stage&&0!=$stage.length||($stage=$gallery.find(".ict_product-gallery__stage img.stage")),$thumbs=$gallery.find(".gallery-thumbnail__item"),$gallery.find(".product-item__overlay").removeClass("hidden"),$("body").width()<parseInt(screenMd))return $thumbs.on("click",function(){var img,$this=$(this);img=$this.attr("data-image"),$stage.attr({src:img,"data-image":img,"data-zoom-image":$this.attr("data-zoom-image")})}),!1;ACC.adrProductDetail.initSwiperImageThumbs("#detailImageThumbs"),$stage.ezPlus({borderSize:1,borderColour:"#eee",zoomWindowPosition:1,zoomWindowOffsetx:16,easing:!1,zoomEnabled:!0,zoomWindowWidth:width,zoomWindowHeight:width}),zoom=$stage.data("ezPlus"),void 0!=zoom&&null!=zoom&&(zoom.onImageSwap=function(){zoom.zoomEnabled=!1,$(".zoomContainer").hide()},zoom.onImageSwapComplete=zoom.onZoomedImageLoaded=function(){zoom.options.zoomEnabled=!0,$(".zoomContainer").show()}),$thumbs.on("mouseenter",function(){var $thisItem=$(this);switch($thisItem.addClass("active").siblings(".active").removeClass("active"),$thisItem.attr("data-type")){case"image":zoom.swaptheimage($thisItem.attr("data-image"),$thisItem.attr("data-zoom-image")),$stage.removeClass("hidden"),$gallery.find(".product-item__overlay").removeClass("hidden"),$("#youtubePlayer").addClass("hidden"),$("#youtubePlayer").attr("src",""),$(".zoomContainer").show();break;case"video_youtube":$(".zoomContainer").hide(),ACC.adrProductDetail.initGalleryYoutubeVideoItem($thisItem)}})},initSwiperImageThumbs:function(el){var has360Img=!1;void 0!=json360Media.desktopUrl&&void 0!=json360Media.mobileUrl&&json360Media.mobileUrl.length>0&&json360Media.desktopUrl.length>0&&(has360Img=!0,$("#detailImageThumbs").attr("style","margin-top:0px;height:380px"));new Swiper(el,{direction:"vertical",loop:!1,slidesPerView:0==has360Img?ACC.adrProductDetail.initItemThumbsForImage():ACC.adrProductDetail.initItemThumbsForImage()-1,spaceBetween:0,navigation:{nextEl:".next-v2",prevEl:".prev-v2"},nextButton:".next-v2",prevButton:".prev-v2",onInit:function(){if(has360Img){$(".gallery-thumbs-v2").prepend('<div class="btn__360"><a href="#" class="btn__360-img small-thumbnail"  data-toggle="modal" data-target="#product__360deg__view"></a></div>')}}})},initGalleryForMobile:function(){if("undefined"!=typeof productJsonMedias&&productJsonMedias.length>0){var stageImageIndex;stageImageIndex=0;ACC.adrProductDetail.initItemThumbsForImage();if(productJsonMedias.length>0){for(var i=0;i<productJsonMedias.length;i++)if("image"===productJsonMedias[i].type.toLowerCase()){stageImageIndex=i;break}var stageImage=productJsonMedias[stageImageIndex];$(".product-gallery__stage").append(ACC.adrProductDetail.markupGalleryItem.stage_image(stageImage)),stageImage.altText&&""!=stageImage.altText||(stageImage.altText="No Image")}}},initCopyDiscountTag:function(){$(".js-discount-tag__btncopy").on("click",function(event){event.preventDefault();var copyText=$(this).find(".js-discount-tag__copytext"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).find(".js-discount-tag__copymessage");messageBox.fadeIn(),messageBox.toggleClass("open"),setTimeout(function(){messageBox.fadeOut(),messageBox.toggleClass("open")},1e3)})},pdpSeemoreAction:function(){var obj=$(".product-detail__section .panel-product-detail .product-detail__description"),longest="desktop"==ACC.devices.name?500:30*$(window).height()/100;if(void 0!==obj&&$(obj).height()>longest){$(obj).addClass("colapsed").css({height:longest});var btn_viewmore=$("<a/>").attr({href:"#",class:"viewmore__btn"}).html("Xem thêm nội dung"),viewmore=$("<div/>").addClass("viewmore__pdpdetail").html(btn_viewmore);viewmore.bind({click:function(e){e.preventDefault(),$(this).hasClass("colapse")?($("html, body").animate({scrollTop:$($(".product-detail__section .product-detail__description")).closest(".panel-product-detail").offset().top-60},500),$(this).removeClass("colapse"),setTimeout(function(){$(obj).addClass("colapsed").css({height:longest}),$(btn_viewmore).html("Xem thêm nội dung")},500)):($(obj).removeClass("colapsed").css({height:"auto"}),$(this).addClass("colapse"),$(btn_viewmore).html("Thu gọn nội dung"))}}),$(obj).append(viewmore)}},ux_pdp_discount_mobile:function(){$("body").width()<=480&&$(".discount__tag--list").on("click",function(){$(".discount__tag--group").addClass("discount__list__show"),$(".discount__list__show .discount__tag--content .close").length||$(".discount__list__show .discount__tag--content").prepend('<a href="#" class="close">×</a>'),0==$(".page-couponsPage").length&&$("body, html").addClass("bodynoscrollable"),$(".discount__tag--group .close, .discount__list__show .discount__tag--hover").click(function(e){e.target===this&&($(e.target).hasClass("close")&&e.preventDefault(),$(this).closest(".discount__tag--group").removeClass("discount__list__show"),$("body, html").removeClass("bodynoscrollable"))})})},handle_touch_pdp_discount_mobile:function(){function simulateMouseEvent(event,simulatedType){if(!(event.originalEvent.touches.length>1)){event.preventDefault();var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent("MouseEvents");simulatedEvent.initMouseEvent(simulatedType,!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),event.target.dispatchEvent(simulatedEvent)}}if($.support.touch="ontouchend"in document,$.support.touch){var touchHandled,mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,_mouseDestroy=mouseProto._mouseDestroy;mouseProto._touchStart=function(event){var self=this;!touchHandled&&self._mouseCapture(event.originalEvent.changedTouches[0])&&(touchHandled=!0,self._touchMoved=!1,simulateMouseEvent(event,"mouseover"),simulateMouseEvent(event,"mousemove"),simulateMouseEvent(event,"mousedown"))},mouseProto._touchMove=function(event){touchHandled&&(this._touchMoved=!0,simulateMouseEvent(event,"mousemove"))},mouseProto._touchEnd=function(event){touchHandled&&(simulateMouseEvent(event,"mouseup"),simulateMouseEvent(event,"mouseout"),this._touchMoved||simulateMouseEvent(event,"click"),touchHandled=!1)},mouseProto._mouseInit=function(){var self=this;self.element.bind({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd")}),_mouseInit.call(self)},mouseProto._mouseDestroy=function(){var self=this;self.element.unbind({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd")}),_mouseDestroy.call(self)}}},ajaxAddStopper:function(){$(".js-discount-tag_btn_save").on("click",function(){var _self=this;if(!$(_self).hasClass("add-active")){var dataString={dataId:$(_self).attr("data-id")};$.ajax({url:ACC.config.encodedContextPath+"/productDetail/addStopper",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(dataString),dataType:"json",success:function(response){console.log(response);var spanStatus=$(_self).find(".discount__tag--noti").children("span"),messageBox=$(_self).find(".discount__tag--noti");$(messageBox).closest(".tag__hover--item").addClass("active"),setTimeout(function(){$(messageBox).closest(".tag__hover--item").removeClass("active")},3e3),"success"===response?($(_self).addClass("discount__tag--used").addClass("add-active"),$(_self).children("span").text("Đã lấy"),$(messageBox).removeClass("error").addClass("success"),$(spanStatus[1]).hide(),$(spanStatus[2]).hide()):($(messageBox).addClass("error").removeClass("success"),$(spanStatus[0]).hide(),$(spanStatus[2]).hide())}})}})},initCopyDiscountTag:function(){$(".js-discount-tag__btncopy").on("click",function(event){event.preventDefault();var copyText=$(this).parent().parent().find(".js-discount-tag__copytext"),textAreaEl=document.createElement("textarea");textAreaEl.value=copyText.text().trim(),$(this).append(textAreaEl),ACC.adrProductDetail.copyToClipboard(textAreaEl),textAreaEl.remove();var messageBox=$(this).parent().find(".js-discount-tag__copymessage");$(messageBox).closest(".tag__hover--item").addClass("active"),setTimeout(function(){$(messageBox).closest(".tag__hover--item").removeClass("active")},3e3)})},bindCountDownClock:function(){$(document).ready(function(){$(".flash-sale-pdp-countdown--time").each(function(){$(this).length&&(data_time_end=$(this).data("countdown"),data_current_time=$(this).data("currenttime"),data_adjusted_end_time=ACC.flashsalecomponent.getFinalDate(data_time_end,data_current_time),$(this),$(this).countdown(data_adjusted_end_time,{elapse:!0}).on("update.countdown",function(event){var $this=$(this);event.elapsed||$this.html(event.strftime('<div class="c-clock__item c-clock__item--hours rel box-24 radius-4 bg-black col-cc"><div class="c-clock__time"><span class="white h5-bo hours">%H</span></div></div><div class="c-clock__item c-clock__item--minutes rel box-24 radius-4 bg-black col-cc ml-6px"><div class="c-clock__time"><span class="white h5-bo minutes">%M</span></div></div><div class="c-clock__item c-clock__item--seconds box-24 radius-4 bg-black col-cc ml-6px"><div class="c-clock__time"><span class="white h5-bo seconds">%S</span></div></div>'))}))})})},selectedPaymentInstallmentMode:function(){$("#product__installment__payment .installment__payment--banklist li").on("click",function(){if(!$(this).hasClass("active")||$(this).hasClass("first-load")){$("#product__installment__payment .installment__payment--banklist li").removeClass("active").removeClass("first-load"),$(this).addClass("active"),$(this).find("input[type=radio]").prop("checked",!0);var paymentCode=$(this).attr("data-id"),priceProduct=$("#salePriceProduct").val();$.ajax({url:ACC.config.encodedContextPath+"/productDetail/getInstallmentPeriod/"+paymentCode,type:"POST",data:JSON.stringify({priceProduct:priceProduct}),contentType:"application/json; charset=UTF-8",timeout:3e4,beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},error:function(){$.unblockUI(),ACC.adrProductDetail.displayPartPaymentModeRequest(!1)},success:function(response){ACC.adrProductDetail.displayPartPaymentModeRequest(!0),null==response||""==response?$(".installment__payment--month").html(""):ACC.adrProductDetail.renderPeriodPaymentHTML(response)}})}})},renderPeriodPaymentHTML:function(data){var periods=data.periods,installmentPeriods=$(".installment__payment--month"),htmlPeriods="<ul>";periods.forEach(function(item){htmlPeriods+='<li><div class="textleft">'+item.numMonth+' Tháng</div><div class="textright"><span>'+item.valueMonth+"</span>/tháng</div></li>"}),htmlPeriods+="</ul>",installmentPeriods.html(htmlPeriods);var defaultLink=$(".default-link-popup").attr("href"),buttonLink=null!=data.guideLink&&""!=data.guideLink?data.guideLink:defaultLink;$(".js-button-detail-payment-popup").prop("href",buttonLink)},addActionShowPopupPaymentMode:function(){$(".prd-installment").children("a").on("click",function(e){e.preventDefault();var installmentPeriods=$(".installment__payment--month");$(".default-link-popup").prop("href",$(this).attr("href")),ACC.adrProductDetail.displayPartPaymentModeRequest(!0),""===installmentPeriods.html()&&$("#product__installment__payment .installment__payment--banklist li.active").click(),$("#product__installment__payment").modal("show")})},displayPartPaymentModeRequest:function(showFlag){showFlag?($(".installment__payment--month").show(),$(".installment__payment--footer").show(),$(".installment__payment--diff").show(),$(".installment__payment--error").hide()):($(".installment__payment--month").hide(),$(".installment__payment--footer").hide(),$(".installment__payment--diff").hide(),$(".installment__payment--error").show())},reloadPaymentModeRequest:function(){$(".js-payment-mode-refresh").on("click",function(){$("#product__installment__payment .installment__payment--banklist li.active").addClass("first-load").click()})},getFinalDate:function(countdown,current){var adjustedFinalTime,finalTime=moment(countdown),serverOffset=(moment(current),moment(),$("input#serverOffset").val()),clientOffset=60*(new Date).getTimezoneOffset()*1e3,diff=parseInt(serverOffset)+parseInt(clientOffset);return adjustedFinalTime=finalTime.toDate().getTime()-diff,new Date(adjustedFinalTime)},init360Media:function(media){var desktopUrl,mobileUrl,speed,compUid,sourceBtn,imgClazz;if(void 0!==media?(json360Media=media,compUid=json360Media.compUid,desktopUrl=json360Media.media.desktopUrl,mobileUrl=json360Media.media.mobileUrl,speed=json360Media.media.speed,sourceBtn=".view__360deg__btn_"+compUid,imgClazz="product__360deg--img_"+compUid):(compUid="product__360deg__view",desktopUrl=json360Media.desktopUrl,mobileUrl=json360Media.mobileUrl,speed=json360Media.speed,sourceBtn=".view__360deg__btn",imgClazz="product__360deg--img"),""!=compUid&&void 0!=desktopUrl&&void 0!=mobileUrl&&mobileUrl.length>0&&desktopUrl.length>0){var popup360='<div class="modal fade product__360deg__view" id="'+compUid+'" role="dialog">\n    <div class="modal-dialog modal-lg">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal">&times;</button>\n            </div>\n            <div class="modal-body">\n                <img src="../../theme-alpha/images/icons/AjaxLoader.gif" class="product__360deg--img '+imgClazz+'">\n            </div>\n        </div>\n    </div>\n</div>';0==$("#"+compUid).length&&$("body").append(popup360),$(document).on("click",sourceBtn,function(){$("#"+compUid).modal()});var url="desktop"==json360Media.device?desktopUrl:mobileUrl;$("."+imgClazz).attr("src",url[0]),$("#"+compUid).on("shown.bs.modal",function(){$("."+imgClazz).reel({images:url,speed:speed,cw:!0,inversed:!0,frames:url.length,laziness:6}),$("."+imgClazz).trigger("play")}),$("#"+compUid).on("hidden.bs.modal",function(){$("."+imgClazz).trigger("stop")})}},init360MediaComponent:function(json360Media){$.each(json360Media,function(idx,media){ACC.adrProductDetail.init360Media(media)})}},ACC.giftcoderedeem={isInitPopover:!1,_config:{element:{giftcodeValue:"#js-giftcode-input",giftcodeSuccessPopup:".js-giftcode-success",giftcodeErrorMessage:".js-giftcode-error",giftcodeErrorPopup:"#js-giftcode-error-detail",giftcodeShow:"#js-giftcode-response",giftcodeDiscount:"#js-giftcode-discount",giftcodeBlockPopup:"#js-giftcode-block",giftcodeRemove:"#js-giftcode-remove",giftcodeAllRemove:"#js-giftcode-redeem",cartDetail:".js-payment-method-cart-detail",paymentoptionFragment:".js-paymentoption-fragment-form",paymentoptions:"#vinPaymentDetailsForm",giftcodeDiv:"#js-giftcode-redemption",buttonCouponCodeData:".js-button-coupon-code-data",listMyCouponCheckout:".js-list-coupon-mine-checkout",myCouponPopupCheckout:"#myCouponsPopup",customerClickApplyButtonCheckoutMap:{}}},_autoload:["initElements","bindMoreGiftcodeBlockPopup","bindApplyGiftcode","bindRemoveGiftcode","bindRefreshCartDetail","bindGiftCodeBox","bindRemoveAllGiftcode","bindListCouponPopup","pressApplyButtonMyCoupon","clickShowMoreDetailCheckout","socialShareCouponForCheckout"],initElements:function(){ACC.common.loadModuleElements(ACC.giftcoderedeem)},bindMoreGiftcodeBlockPopup:function(){$(ACC.giftcoderedeem._config.element.giftcodeBlockPopup).popover()},bindGiftCodeBox:function(){$(document).on("change",".js-giftcode-checkout-block input",function(event){var checked=$(this).is(":checked"),$block=$(this).closest(".checkout-block").find(".checkout-block__body");checked?(0==ACC.giftcoderedeem.isInitPopover&&(ACC.giftcoderedeem.isInitPopover=!0,ACC.checkout.initPopover()),$block.stop().slideDown()):$block.stop().slideUp()})},bindListCouponPopup:function(){$(document).on("click",ACC.giftcoderedeem._config.element.listMyCouponCheckout,function(event){event.preventDefault();var popupDiv=$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout+" .discount__tag--hover-list");""!=$(popupDiv).html().replace(" ","")?$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).modal("show"):$.ajax({url:ACC.config.listCouponsUrl,type:"post",data:{CSRFToken:ACC.config.CSRFToken},dataType:"json",contentType:"application/json; charset=utf-8",timeout:2e4,beforeSend:function(){$.blockUI()},error:function(){$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).hasClass("in")&&$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).modal("hide"),alert("Hiện tại không lấy được mã giãm giá, vui lòng thử lại sau")},complete:function(){$.unblockUI()},success:function(data){data.length>0?(popupDiv=$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout+" .discount__tag--hover-list"),$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout+" .discount__tag--emptylist").remove(),ACC.giftcoderedeem.renderPopupMyCouponList(data,popupDiv)):(0===$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout+" .discount__tag--emptylist").length&&$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout+" .modal-body").prepend('<div class="discount__tag--emptylist"></div>'),popupDiv=$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout+" .discount__tag--emptylist"),ACC.giftcoderedeem.renderPopupMyCouponEmpty(popupDiv)),$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).modal("show")}})})},pressApplyButtonMyCoupon:function(){$(document).on("click",ACC.giftcoderedeem._config.element.buttonCouponCodeData,function(){var _self=this,couponCode=$(_self).parent().find(".discount__tag--code > span").text(),popup=$(document).find(ACC.giftcoderedeem._config.element.giftcodeSuccessPopup).last();$(_self).hasClass("discount__tag--used")||$(_self).hasClass("discount__tag--unused")||$.ajax({url:ACC.config.applyGiftcodeUrl+"?giftcode="+couponCode,type:"post",data:{CSRFToken:ACC.config.CSRFToken},dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},success:function(data){"timedout"==data.result&&location.reload(!0),ACC.giftcoderedeem.processResultData(data,popup,_self,couponCode),window.mediator.publish("refreshPaymentOptionsInPaymentMethod")}})})},renderPopupMyCouponEmpty:function(popup){$(popup).html("");$(popup).append('<div class="emptylist__icon"><img src="/_ui/responsive/common/images/my_coupon.png" alt="couponIcon"></div><div class="emptylist__message"><span>Rất tiếc ! Quý khách chưa có mã giảm giá</span></div><a href="/ma-giam-gia" target="_blank" rel="noopener noreferrer" class="goto-coupons-page"><div class="d-button">Tới trang mã giảm giá</div></a>')},renderPopupMyCouponList:function(data,popup){var gifts=[];$(".checkout-payment__using-giftcode__result").each(function(index){gifts.push($(this).children("span.gifcode").text().toUpperCase())}),data.forEach(function(item){var expireDate;if(item.expiredDate.length>6)expireDate="HSD: "+item.expiredDate;else if(item.expiredDate.length>1){var time=item.expiredDate.split("-");expireDate='<span class="discount__tag--expired-soon">HSD: Chỉ còn '+time[0]+" giờ "+time[1]+" phút</span>"}else expireDate='<span class="discount__tag--expired-soon">HSD: Chỉ còn '+item.expiredDate+" ngày</span>";expireDate=item.amountCoupon>999?expireDate+" - Còn nhiều lượt":expireDate+" - Còn "+item.amountCoupon+" lượt";var pressState=gifts.indexOf(item.couponCode.toUpperCase()),usedClass="js-button-coupon-code-data",buttonContent="Sử dụng";-1!==pressState&&(usedClass="discount__tag--used",buttonContent="Đã sử dụng");var urlSharing="https://www.adayroi.com/ma-giam-gia/"+item.titleDecodeUnicode+"-"+item.dataId.longValueAsString,cardItem='<div class="tag__hover--item"><a target="_blank" rel="noopener noreferrer" class="js-url-sharing-coupon" href="/ma-giam-gia/'+item.titleDecodeUnicode+"-"+item.dataId.longValueAsString+'" title="Bấm vào đây để xem chi tiết"><div class="discount__tag--item">'+item.title+'</div></a><div class="discount__tag--code">Mã:<span>'+item.couponCode.toUpperCase()+'</span></div><div class="discount__tag--getbtn '+usedClass+'"><span>'+buttonContent+'</span><div class="discount__tag--noti success"></div></div><div class="discount__tag--desc"><span>'+item.description+'</span></div><div class="discount__tag--expired">'+expireDate+'</div><div class="discount__tag--tool">'+ACC.giftcoderedeem.renderShareCouponfunction(urlSharing)+"</div></div>";$(popup).append(cardItem)}),ACC.myCoupons.socialShareCoupon()},renderShareCouponfunction:function(urlSharing){return'<section class="d-social-action-sheet"><a class="d-button js-open-social-share-list-for-checkout d-social-action-sheet__share-button"><div class="d-icon f-row a-j-center"><i class="polish-version-icon-share-icon hot-fix-share-button__icon-share"></i></div></a><section class="d-modal d-modal--action-list js-modal f-col a-center f-end hide"><div class="d-modal__content"><div class="d-modal--header">Chia sẻ</div><ul class="f-col"><li><span  class="js-copy-coupon-url-for-checkout" data-url-sharing="'+urlSharing+'"><a class="d-button d-button--no-radius space-box-16px bor-b f-row a-center full-w j-start"><div class="d-icon f-row a-j-center"><i class="polish-version-icon-copy d-social-action-sheet__copy-icon color-2"></i></div><span class="space-row-left-16px h4-rbt-re color-2">Sao chép URL</span></a></span></li><li><span ><a href="https://facebook.com/sharer/sharer.php?u='+urlSharing+'"  target="_blank" class="d-button d-button--no-radius space-box-16px bor-b f-row a-center full-w j-start"><div class="d-icon f-row a-j-center"><div class="adr_bg_color-fb"></div></div><span class="space-row-left-16px h4-rbt-re color-2">Facebook</span></a></span></li></ul></div></section></section>'},socialShareCouponForCheckout:function(){const modal=$(".js-modal");var removeCouponPopup=function(){$("body").find(".coupon__share__popup").remove(),$("html").css({overflow:"unset"})};$(document).on("click",".js-function-modal-button",function(){$(this).parent().parent().addClass("hide"),$("html").css({overflow:"unset"})}),$(document).on("click",".js-modal",function(event){const _this=$(this);-1!==event.target.className.indexOf("js-modal")&&(_this.addClass("hide"),_this.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")),$("html").css({overflow:"unset"}),removeCouponPopup()}),isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),$(document).on("click",".js-open-social-share-list-for-checkout",function(e){e.preventDefault();const _this=$(this);if(isMobile){$("html").css({overflow:"hidden"});var sharepopup=_this.siblings(".js-modal").clone(),_sharepopup=$("<div/>",{class:"coupon__share__popup"}).html(sharepopup);$("body").find(".coupon__share__popup").length>0&&removeCouponPopup(),sharepopup.removeClass("hide"),sharepopup.on("click",function(){removeCouponPopup()}),$("body").append(_sharepopup)}else _this.siblings().find(".d-modal__content").removeClass("d-modal__content--active-pop-up"),_this.siblings(".js-modal").removeClass("hide"),setTimeout(function(){_this.siblings().find(".d-modal__content").addClass("d-modal__content--active-pop-up")},100)}),$(document).on("click",".js-coupon-share-fb",function(e){closeModalShare()}),$(document).on("click",".js-copy-coupon-url-for-checkout",function(e){var url_coupon_share=$(this).attr("data-url-sharing");console.log(url_coupon_share);var textArea=document.createElement("input");textArea.value=url_coupon_share,document.body.appendChild(textArea),ACC.adrProductDetail.copyToClipboard(textArea),document.body.removeChild(textArea),closeModalShare()}),$(document).on("click",function(e){modal.find(".d-modal__content--active-pop-up").length>0&&null==e.target.closest(".js-modal")&&closeModalShare()});var closeModalShare=function(){modal.addClass("hide"),modal.find(".d-modal__content--active-pop-up").removeClass("d-modal__content--active-pop-up")}},clickShowMoreDetailCheckout:function(){$(document).on("click","#js-giftcode-error-more",function(event){event.preventDefault(),event.stopPropagation(),$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).hasClass("in")&&$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).modal("hide")})},showPopupMessageError:function(buttonClick,classCss,message){if(null!=buttonClick){var messageBox=$(buttonClick).find(".discount__tag--noti");$(messageBox).hasClass("success")&&$(messageBox).removeClass("success"),$(messageBox).hasClass("error")&&$(messageBox).removeClass("error"),$(messageBox).addClass(classCss).html(message),0!=$(messageBox).find("#js-giftcode-error-more").length&&$(messageBox).find("#js-giftcode-error-more").remove(),$(messageBox).show(),setTimeout(function(){$(messageBox).hide()},3e3)}},processCheckClickActionCustomerClickApply:function(buttonClick,couponCode){if(null!=couponCode){var customerClickApplyButtonCheckoutMap=ACC.giftcoderedeem._config.element.customerClickApplyButtonCheckoutMap;console.log(customerClickApplyButtonCheckoutMap[couponCode]),customerClickApplyButtonCheckoutMap[couponCode]>1?$(buttonClick).addClass("discount__tag--unused"):void 0===customerClickApplyButtonCheckoutMap[couponCode]?customerClickApplyButtonCheckoutMap[couponCode]=1:customerClickApplyButtonCheckoutMap[couponCode]=customerClickApplyButtonCheckoutMap[couponCode]+1}},checkAjaxLoginStatusForGuest:function(data){if("string"==typeof data){return-1!==data.search("currentStepCheckout = 'login'")}return!1},bindApplyGiftcode:function(){$(document).on("keydown",".js-giftcode-input, .js-giftcode-submit-form-btn",function(e){if(13==e.keyCode)return e.preventDefault(),$(".js-giftcode-submit-form-btn").click(),!1}),$(document).on("click",".js-giftcode-submit-form-btn",function(event){event.preventDefault();var giftcode=$(document).find(ACC.giftcoderedeem._config.element.giftcodeValue).val(),popup=$(document).find(ACC.giftcoderedeem._config.element.giftcodeSuccessPopup).last();$.ajax({url:ACC.config.applyGiftcodeUrl+"?giftcode="+giftcode,type:"post",data:{CSRFToken:ACC.config.CSRFToken},dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},success:function(data){"timedout"==data.result&&location.reload(!0),ACC.giftcoderedeem.processResultData(data,popup,null,null),window.mediator.publish("refreshPaymentOptionsInPaymentMethod")}})})},bindRemoveGiftcode:function(){$(document).on("click",ACC.giftcoderedeem._config.element.giftcodeRemove,function(event){event.preventDefault(),$.blockUI();var popup=this.closest(ACC.giftcoderedeem._config.element.giftcodeSuccessPopup),giftcode=$(popup).find(ACC.giftcoderedeem._config.element.giftcodeShow).text();$.ajax({url:ACC.config.removeGiftcodeUrl+"?giftcode="+giftcode,type:"post",data:{CSRFToken:ACC.config.CSRFToken},contentType:"application/json; charset=utf-8",beforeSend:function(){$.blockUI()},complete:function(){$.unblockUI()},success:function(data){if(ACC.giftcoderedeem.checkAjaxLoginStatusForGuest(data))location.reload(!0);else if($.unblockUI(),$(popup).addClass("hide"),window.mediator.publish("refreshAppliedGiftcode"),window.mediator.publish("refreshCartInPaymentMethod"),window.mediator.publish("refreshPaymentOptionsInPaymentMethod"),
"undefined"!=typeof coupons&&Array.isArray(coupons)){var index=coupons.indexOf(giftcode);-1!=index&&coupons.splice(index,1)}},error:function(data,textStatus,errorThrown){$.unblockUI()}})})},bindRemoveAllGiftcode:function(){$(document).on("change",ACC.giftcoderedeem._config.element.giftcodeAllRemove,function(event){$(this).is(":checked")||$.ajax({url:ACC.config.removeAllGiftcodeUrl,type:"post",data:{CSRFToken:ACC.config.CSRFToken},success:function(data,textStatus,xhr){200==xhr.status&&(window.mediator.publish("refreshCartInPaymentMethod"),window.mediator.publish("refreshPaymentOptionsInPaymentMethod"),ACC.giftcoderedeem.resetSuccess(),ACC.giftcoderedeem.resetError(),coupons=[])}})})},processResultData:function(response,divSuccess,btnPopup,couponCode){if("ACTIVE"==response.result){if(response.isRefeshAppliedCodes)window.mediator.publish("refreshAppliedGiftcode"),null!=btnPopup&&($(".modal-backdrop").remove(),setTimeout(function(){$(ACC.giftcoderedeem._config.element.listMyCouponCheckout).click()},200));else{ACC.giftcoderedeem.resetError();var newDivSuccess=$(divSuccess).clone(!0,!0);newDivSuccess.find(ACC.giftcoderedeem._config.element.giftcodeShow).html(response.giftCode),newDivSuccess.removeClass("hide"),newDivSuccess.find(ACC.giftcoderedeem._config.element.giftcodeDiscount).html(response.couponMessage),$(document).find(ACC.giftcoderedeem._config.element.giftcodeValue).val(""),$(newDivSuccess.get(0).outerHTML).insertAfter($(divSuccess)),"undefined"!=typeof coupons&&Array.isArray(coupons)&&(coupons[coupons.length]=response.giftCode)}response.isRefundAndReem?ACC.vinidredeem.refundAndRedeemVinID():window.mediator.publish("refreshCartInPaymentMethod"),null!=btnPopup&&($(btnPopup).addClass("discount__tag--used"),$(btnPopup).find("span").text("Đã sử dụng"),1==$(".discount__tag--getbtn").length&&$(ACC.giftcoderedeem._config.element.myCouponPopupCheckout).modal("hide")),ACC.giftcoderedeem.showPopupMessageError(btnPopup,"success","Bạn đã được giảm "+response.couponMessage.replace("-",""))}else"INACTIVE"==response.result?(ACC.giftcoderedeem.resetError(),$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorPopup).html(response.couponDescription),$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorMessage).removeClass("hide"),$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorMessage).html(response.couponMessage),$(document).find(ACC.giftcoderedeem._config.element.giftcodeValue).val(""),ACC.giftcoderedeem.processCheckClickActionCustomerClickApply(btnPopup,couponCode),ACC.giftcoderedeem.showPopupMessageError(btnPopup,"error","Mã khuyến mại không có hiệu lực")):"INVALID"==response.result&&(ACC.giftcoderedeem.resetError(),$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorMessage).removeClass("hide"),$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorMessage).html(response.couponMessage),$(document).find(ACC.giftcoderedeem._config.element.giftcodeValue).val(""),ACC.giftcoderedeem.processCheckClickActionCustomerClickApply(btnPopup,couponCode),ACC.giftcoderedeem.showPopupMessageError(btnPopup,"error","Mã khuyến mại không có hiệu lực"))},resetError:function(){$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorMessage).addClass("hide"),$(document).find(ACC.giftcoderedeem._config.element.giftcodeErrorPopup).removeClass("in")},resetSuccess:function(){$(document).find(ACC.giftcoderedeem._config.element.giftcodeSuccessPopup).addClass("hide")},getParameter:function(name){var results=new RegExp("[?&]"+name+"=([^&#]*)").exec(window.location.search);return null==results?null:decodeURI(results[1])||0},bindRefreshCartDetail:function(){window.mediator.subscribe("refreshCartInPaymentMethod",function(){if(typeof IS_INSTALLMENT_CHECKOUT==typeof!0&&IS_INSTALLMENT_CHECKOUT){var paymentMode=$(".installment-instant-payment-mode.d-list__item-wrapper--active");void 0!==paymentMode&&paymentMode.click()}var $showIconLoad=$(".js-payment-method-cart-detail .sidebar-product__order .iconLoad");$showIconLoad.show();var refreshCartUrl=ACC.config.refreshCartUrl,urlParam=ACC.giftcoderedeem.getParameter("adrIC");null!=urlParam&&(refreshCartUrl=refreshCartUrl+"?adrIC="+urlParam),$.get(refreshCartUrl,function(result){$showIconLoad.hide(),result&&$(ACC.giftcoderedeem._config.element.cartDetail).html(result)})}),window.mediator.subscribe("refreshPaymentOptionsInPaymentMethod",function(){var paymentOptionUrl=ACC.config.refreshPaymentOptionsUrl,urlParam=ACC.giftcoderedeem.getParameter("adrIC");if(null!=urlParam&&(paymentOptionUrl=paymentOptionUrl+"?adrIC="+urlParam),"undefined"!=typeof currentStepCheckout){var urlParams=ACC.giftcoderedeem.getParameter("adrIC");paymentOptionUrl=null!=urlParams?paymentOptionUrl+"&currentstep="+currentStepCheckout:paymentOptionUrl+"/?currentstep="+currentStepCheckout}$.get(paymentOptionUrl,function(result){if(result){var doc=$(result);if(void 0!==doc){var el=doc.find(".oneclickoptionhaserror");if(el&&el.length>0){var url=ACC.config.encodedContextPath+"/checkout/multi/payment-method/add",urlParams=ACC.giftcoderedeem.getParameter("adrIC");return null!=urlParams&&(url=url+"?adrIC="+urlParams),void window.location.replace(url)}}var $form=$(ACC.giftcoderedeem._config.element.paymentoptions).find(".js-checkout-paymentoption-fragment"),$clone=$form.clone(!0),$formInDoc=doc.find(".js-checkout-paymentoption-fragment");$clone.html($formInDoc.html()),$form.replaceWith($clone);var $this=$(".js-payment-method .adr-radio-input");if($this.each(function(index){var $parent=$(this).parents(".checkout-payment-methods"),$detail=$(this).parents(".js-payment-method").siblings(".checkout-payment-method-detail");$(this).is(":checked")&&($detail.slideDown(),$parent.find(".checkout-payment-method-detail").not($detail).slideUp())}),void 0!==doc&&void 0!=doc[0])for(var scripts=doc[0].getElementsByTagName("script"),i=0;i<scripts.length;++i){var script=scripts[i];eval(script.innerHTML)}ACC.checkout.initInstallmentPeriod()}})}),window.mediator.subscribe("refreshAppliedGiftcode",function(){var refreshAppliedCodeURL=ACC.config.refreshAppliedGiftcode,urlParams=ACC.giftcoderedeem.getParameter("adrIC");null!=urlParams&&(refreshAppliedCodeURL=refreshAppliedCodeURL+"?adrIC="+urlParams),$.get(refreshAppliedCodeURL,function(result){result&&$(ACC.giftcoderedeem._config.element.giftcodeDiv).html(result)})})}},ACC.autocreateuser={_config:{element:{passwordSubmit:"#js-auto-create-password-form",passwordValue:".js-auto-create-user-password-input",passwordError:".js-auto-create-password-error",passwordDialog:"#js-auto-create-user-password",otpDialog:"#js-auto-create-user-otp",otpValue:".js-auto-create-user-otp-input",otpCancel:".js-auto-create-user-otp-cancel",otpSubmit:"#js-auto-create-user-otp-form",otpResend:".js-auto-create-user-otp-resend",otpResendMessage:".js-auto-create-user-otp-resend-message",otpError:".js-auto-create-user-otp-error",phone:".js-auto-create-user-phone"}},_autoload:["initElements","showSetPasswordDialog","bindPasswordSubmit","bindResendOtp","bindOtpSubmit"],initElements:function(){ACC.common.loadModuleElements(ACC.autocreateuser)},bindPasswordSubmit:function(){$(document).on("submit",ACC.autocreateuser._config.element.passwordSubmit,function(event){event.preventDefault(),$.blockUI(),$(ACC.autocreateuser._config.element.passwordError).text("");var passwordValue=$(ACC.autocreateuser._config.element.passwordValue).val(),data={password:passwordValue,CSRFToken:ACC.config.CSRFToken};$.ajax({url:ACC.config.setPasswordUrl,type:"post",data:JSON.stringify(data),dataType:"json",contentType:"application/json; charset=utf-8",success:function(data){$.unblockUI(),$(ACC.autocreateuser._config.element.passwordDialog).modal("hide"),0!=$(ACC.autocreateuser._config.element.otpDialog).length?(ACC.autocreateuser.sendOtp(),ACC.captcha.renderWidgetForPopup("js-auto-create-user-otp-captcha"),$(ACC.autocreateuser._config.element.otpDialog).modal("show")):(ACC.login.updateUserInfo(!0),ACC.suggestvinid.processSuggestVinID($(ACC.autocreateuser._config.element.phone).text()))},error:function(data,textStatus,errorThrown){$.unblockUI(),$(ACC.autocreateuser._config.element.passwordError).text(data.responseJSON)}})})},sendOtp:function(){ACC.otp.sendADROTP({type:ACC.config.otpRequestType.AUTO_CREATE_VERIFY_PHONE,resend:!1,username:$(ACC.autocreateuser._config.element.phone).text(),CSRFToken:ACC.config.CSRFToken},ACC.otp.func.autoCreate)},bindResendOtp:function(){$(document).on("click",ACC.autocreateuser._config.element.otpResend,function(e){e.preventDefault(),$.blockUI(),ACC.autocreateuser.hideError();var phone=$(ACC.autocreateuser._config.element.phone).text();ACC.otp.sendADROTP({type:ACC.config.otpRequestType.AUTO_CREATE_VERIFY_PHONE,resend:!0,username:phone,CSRFToken:ACC.config.CSRFToken},ACC.otp.func.autoCreate).then(function(response){$.unblockUI(),$(ACC.autocreateuser._config.element.otpResendMessage).removeClass("hide"),ACC.autocreateuser.hideError(),ACC.login.updateUserInfo(!0)},function(jqXHR){$.unblockUI(),$(ACC.autocreateuser._config.element.otpResendMessage).addClass("hide"),ACC.autocreateuser.showError(jqXHR.responseJSON.message)})})},bindOtpSubmit:function(){$(document).on("submit",ACC.autocreateuser._config.element.otpSubmit,function(event){event.preventDefault(),$.blockUI(),ACC.autocreateuser.hideError();var otpValue=$(ACC.autocreateuser._config.element.otpValue).val(),data=JSON.stringify({otpCode:otpValue,CSRFToken:ACC.config.CSRFToken}),url=ACC.config.autoCreateVerifyOtpUrl+"?g-recaptcha-response="+ACC.captcha.getResponse("js-auto-create-user-otp-captcha");$.postJSONCallback(url,data,function(result){$.unblockUI(),$(ACC.autocreateuser._config.element.otpDialog).modal("hide"),ACC.suggestvinid.processSuggestVinID($(ACC.autocreateuser._config.element.phone).text())},function(jqXHR){$.unblockUI(),ACC.autocreateuser.showError(jqXHR.responseJSON.message),ACC.captcha.reset("js-auto-create-user-otp-captcha")})})},showSetPasswordDialog:function(){var setPasswordDialog=$(ACC.autocreateuser._config.element.passwordDialog);0!=setPasswordDialog.length&&(setPasswordDialog.modal("show"),window.onbeforeunload=function(){$.postJSONCallback("/checkout/auto-create/sendPassword",function(){})})},showError:function(msg){$(ACC.autocreateuser._config.element.otpError).html(msg),$(ACC.autocreateuser._config.element.otpError).show()},hideError:function(){$(ACC.autocreateuser._config.element.otpError).hide()}},ACC.adrLandingPage={_autoload:[["initNav",$(".lp-section.lp-navigation").length>0],["initPopupYoutubeLandingPage",$(".popup__open-youtube-ldpage").length>0],["bindTabOnClick",$(".js-lb-tab-component").length>0],["handleHashPart",$(".pageType-LandingPage").length>0],["lazyLoadProduct",$(".lp-product-content.tab-content").length>0]],initNav:function(){var _this=this;$("body").width()>=parseInt(screenSm)?_this.calculateNav():$("#js-lp-navigation").addClass("calculated")},initTabGroup:function(){var activeTab=window.location.hash;if(""!=activeTab)$(".js-lb-tab-component .tab-pane").removeClass("active"),$(activeTab).addClass("active");else{var firstTab=$(".call-witch-tab").eq(0);activeTab=$(firstTab).attr("data-target"),$(firstTab).addClass("active"),$(activeTab).addClass("active");var $firstTabChild=$(".lp-product-header-tabs li");$firstTabChild.removeClass("active"),$firstTabChild.eq(0).addClass("active")}},bindTabOnClick:function(){$(".call-witch-tab").on("shown.bs.tab",function(e){var hash=$(e.target).attr("href");hash||(hash=$(this).data("target"));var tabid=hash.replace("#",""),curr_page=window.location.href.substr(0,window.location.href.indexOf("#")),reload_page="";reload_page=curr_page.indexOf("tabid")>-1?curr_page.replace(/(tabid=).*/,"$1"+tabid)+hash:curr_page.indexOf("?")>-1?curr_page+"&tabid="+tabid+hash:curr_page+"?tabid="+tabid+hash,history.pushState(null,"",reload_page)})},initPopupYoutubeLandingPage:function(){$(".popup__open-youtube-ldpage").click(function(){$(".popup__open-youtube .modal").modal("show");var $this=$(this),$iframe=$("<iframe>").attr("src",$this.data("link")),$title=$("<h1>").text($this.data("title")).css("display","none");$("#video-view .modal-body").html($title).append($iframe),$iframe.wrap("<div class='class-video embed-responsive embed-responsive-16by9'>")})},calculateNav:function(){var $nav,$dropDown,navWidth,$parent=$("#js-lp-navigation"),tmpWidth=0;$nav=$parent.find(".navbar-main"),$dropDown=$parent.find(".navbar-more li.dropdown .dropdown-menu"),$dropDown.find("> li").appendTo($nav),$navItems=$nav.find("> li"),navWidth=$nav.width(),$navItems.each(function(){var w,$item=$(this);w=$item.outerWidth(),(tmpWidth+=w)>=navWidth&&($item.prependTo($dropDown),$dropDown.parents(".navbar-more").show())}),$parent.addClass("calculated")},handleHashPart:function(){var $hashPart=window.location.hash,$this=($hashPart.substring($hashPart.indexOf("#")+0),$(".call-witch-tab"));$this.each(function(){var $link=$(this).attr("data-target");return $link!=$hashPart||($(this).parent().addClass("active"),!1)})},lazyLoadProduct:function(){$(".lp-product-content.tab-content img.lazy").lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"})}},ACC.CSRF={_autoload:[],initPull:function(){this.updateCSRF()},updateCSRF:function(){return $.ajax({type:"GET",url:"/getCSRF",success:function(result){null!=result&&void 0!=result&&result!=ACC.config.CSRFToken&&(ACC.config.CSRFToken=result)}})}},ACC.mobileCharge={_autoload:[["init",$(".mobile-charge").length>0],["initFirstTab",$("#js-mobile-charge__type li.active").length>0]],currentProvider:_.isEmpty(ACC.topup)||_.isEmpty(ACC.topup.currentProvider)?"VT":ACC.topup.currentProvider,currentProviderByPhone:_.isEmpty(ACC.topup)||_.isEmpty(ACC.topup.currentProvider)?"VT":ACC.topup.currentProvider,currentProviderPlanCode:_.isEmpty(ACC.topup)||_.isEmpty(ACC.topup.currentCardProductNumber)?"50":ACC.topup.currentCardProductNumber,topupTypes:{TOPUP:"TOPUP",BUYCARD:"BUYCARD",DATACARD:"DATACARD",GAMECARD:"GAMECARD"},errorCodes:{LESS_THAN_MIN_QTY:"VIN_CORE_099",LARGER_THAN_MAX_QTY:"VIN_CORE_100"},init:function(){ACC.mobileCharge.setProviderActive(!1),$(window).on("load",_.debounce(ACC.mobileCharge.calculateTotalPriceFromOffer,ACC.requests.timeout)),$(document).on("click",".js-mini-cart-close-button, .js-mini-cart-off",function(e){var $body=$("body");e.preventDefault(),ACC.colorbox.close(),$body.removeClass("modal-open")}),$(".list-number li").on("click",function(){var $getPhone=$(this).text();$("#number-phone").val($getPhone),$(".js-mobile-charge__phone-number").trigger("change")}),$(".js-mobile-charge__phone-number").on("input change",function(){var $this=$(this),text=$.trim($this.val()),listPrefix=_.flatten(_.toArray(ACC.topup.phonePrefixNumberConfig)),numberInPrefix=!1,providerByPhone=!1,validatePrefix=ACC.mobileCharge.matchStartNumber(text,listPrefix);if(0===text.length&&($("#js-card-submit").attr("disabled","true"),$this.siblings(".mobile-charge__input-error-2").hide().html(""),$this.siblings(".mobile-charge__input-error").show().html("Quý khách vui lòng không để trống số điện thoại")),text.length>0&&0==validatePrefix?($this.siblings(".mobile-charge__input-error").hide().html(""),$this.siblings(".mobile-charge__input-error-2").show().html(ACC.message.topupProviderNotSupport),$("#js-card-submit").attr("disabled","true")):$this.siblings(".mobile-charge__input-error-2").hide().html(""),text&&!/^(84|0)((1(2([0-9])|6([2-9])|86|88|99))|(9([0-9]))|((86|88|89))|(8([1,2,3,4,5]))|(3([2-9]))|(7([0,6,7,8,9])|(5([6,8,9]))))([0-9]{7})$/.test(text))$this.siblings(".mobile-charge__input-error-2").hide().html(""),$this.siblings(".mobile-charge__input-error").show().html("Số điện thoại không hợp lệ! Quý khách vui lòng kiểm tra lại."),$("#js-card-submit").attr("disabled","true");else{var type=$("#js-mobile-charge__type li.active")[0].id;$this.siblings(".mobile-charge__input-error").hide().html(""),type===ACC.mobileCharge.topupTypes.TOPUP||type===ACC.mobileCharge.topupTypes.BUYCARD?_.each(ACC.topup.phonePrefixNumberConfig,function(prefixes,key,list){_.each(prefixes,function(prefix){if(0===text.indexOf(prefix)){numberInPrefix=!0,providerByPhone=key,ACC.mobileCharge.currentProviderByPhone=providerByPhone,$("#js-card-submit").removeAttr("disabled");var providerTpl=_.template(".js-mobile-charge__providers a<%= providerAttr %>"),$selectedProvider=$(providerTpl({providerAttr:_.template('[data-topup-service-provider="<%= provider %>"]')({provider:providerByPhone})}));if(!$selectedProvider.hasClass("disabled")){$(providerTpl({providerAttr:""})).removeClass("active"),$selectedProvider.addClass("active");var planCode=$selectedProvider.attr("data-current-code");ACC.mobileCharge.loadProviderOffers(providerByPhone,planCode,void 0,!1,void 0).then(function(){ACC.mobileCharge.renderQuantitySelectBox(),ACC.mobileCharge.calculateTotalPriceFromOffer()})}}})}):$("#js-card-submit").removeAttr("disabled")}}),$(document).on("click","#js-change-publisher .mobile-charge__provider-item",function(event){event.preventDefault();var $this=$(this),crCode=($("#js-mobile-charge__type li.active")[0].id,$(this).attr("data-current-code")),provider=$this.attr("data-topup-service-provider"),currentCode=crCode,$numberPhone=($("#provide-phone").val(),$.trim($(".js-mobile-charge__phone-number").val()));ACC.mobileCharge.loadProviderOffers(provider,currentCode,void 0,!1,!0).then(function(){ACC.mobileCharge.renderQuantitySelectBox(),ACC.mobileCharge.calculateTotalPriceFromOffer(),$this.hasClass("disabled")||$this.addClass("active").parents(".mobile-charge__providers").find(".active").not($this).removeClass("active"),$numberPhone.length<1&&$(".js-mobile-charge__phone-number").siblings(".mobile-charge__input-error").show().html("Số điện thoại không được để trống.")})}),$(document).on("click",".js-mobile-charge__price .mobile-charge__price-item",function(event){event.preventDefault();var $this=$(this);ACC.mobileCharge.setActiveQuantity($this)}),$(document).on("click","#js-mobile-charge__type .nav a",function(){var topupTypeId=$(this).closest("li.active").attr("id");ACC.mobileCharge.activeBannerComponent(topupTypeId),ACC.mobileCharge.setProviderActive(!0)}),$(document).on("change keyup","#pdpAddtoCartSelect,#pdpAddtoCartInput",function(){var val=$(this).val();isNaN(val)&&"pdpAddtoCartInput"===val&&(val=ACC.mobileCharge.getQuantity()),ACC.mobileCharge.updateQuantityDataOfAllPlan(val),ACC.mobileCharge.calculateTotalPriceFromOffer()}),$("#js-card-submit").on("click",function(e){e.preventDefault(),ACC.mobileCharge.addToInstantCart()}),ACC.mobileCharge.trackingGtmOnLoad()},initFirstTab:function(){var type=$("#js-mobile-charge__type li.active")[0].id;ACC.mobileCharge.activeBannerComponent(type)},activeBannerComponent:function(topupTypId){var topupTopComponent=$(".topupComponent");topupTopComponent.find(".topupBanner").hide();var bannerTop="."+topupTypId+"_TOP",bannerRight="."+topupTypId+"_RIGHT";topupTopComponent.find(bannerTop).show(),topupTopComponent.find(bannerRight).show()},setActiveQuantity:function(item){var type=$("#js-mobile-charge__type li.active")[0].id,code=item.attr("data-code"),currentQty=item.attr("data-quantity"),quantityHtml=ACC.template.topup.offerQuantity({minOrderQty:item.attr("data-min"),maxOrderQty:item.attr("data-max"),availableToSell:item.attr("data-available"),currentQuantity:currentQty});ACC.mobileCharge.currentProviderPlanCode=code,$(".mobile-charge__provider-item").attr("data-current-code",code),$(".js-qty-selector.js-product-order__quanity").replaceWith(quantityHtml),item.addClass("active").parents(".js-mobile-charge__price").find(".active").not(item).removeClass("active"),ACC.mobileCharge.renderQuantitySelectBox(currentQty);var priceObj={type:$("#js-mobile-charge__type li.active")[0].id,quantity:currentQty,price:item.attr("data-price"),dom:"#js-card-total"};type===ACC.mobileCharge.topupTypes.TOPUP&&$(".quantityshow").hide(),ACC.mobileCharge.calculateTotalPrice(priceObj)},setProviderActive:function(isClick){var dom,type=$("#js-mobile-charge__type li.active")[0].id;switch($("#js-mobile-charge__prepaid .js-mobile-charge__price .mobile-charge__price-item").trigger("change"),type){case ACC.mobileCharge.topupTypes.BUYCARD:case ACC.mobileCharge.topupTypes.TOPUP:case ACC.mobileCharge.topupTypes.DATACARD:case ACC.mobileCharge.topupTypes.GAMECARD:dom="#js-mobile-charge__prepaid .js-mobile-charge__price .mobile-charge__price-item"}$("#pdpAddtoCartSelect").val("1");var $prepaid=$("#js-mobile-charge__prepaid"),$message=$(".mobile-charge__input-hint"),prv="";type===ACC.mobileCharge.topupTypes.BUYCARD||type===ACC.mobileCharge.topupTypes.DATACARD||type===ACC.mobileCharge.topupTypes.GAMECARD?($prepaid.removeClass("hidden"),$message.addClass("hidden"),$(".bye-cart").show(),$(".top-up").hide(),$(".mobile-card").show(),$(".game-card").hide(),$(".lbPriceBuyCard").show(),$(".lbPricedataCard").hide(),$(".quantityshow").show(),$(".bannert").hide(),$("#img-"+type).show(),$("#imgdt-"+type).show(),prv=ACC.mobileCharge.currentProvider,type==ACC.mobileCharge.topupTypes.GAMECARD&&(prv=ACC.topup.currentProviderGame,$(".bannert").hide(),$("#img-"+type).show(),$("#imgdt-"+type).show(),$(".mobile-card").hide(),$(".game-card").show()),type==ACC.mobileCharge.topupTypes.DATACARD&&(prv=ACC.topup.currentProviderData,$(".bannert").hide(),$("#img-"+type).show(),$("#imgdt-"+type).show(),$(".lbPriceBuyCard").hide(),$(".lbPricedataCard").show())):type===ACC.mobileCharge.topupTypes.TOPUP&&(prv=ACC.mobileCharge.currentProvider,$(".quantityshow").hide(),$prepaid.removeClass("hidden"),$message.removeClass("hidden"),$(".bannert").hide(),$("#img-"+type).show(),$("#imgdt-"+type).show(),$(".top-up").show(),$(".bye-cart").hide());var crProviderPlanCode=ACC.mobileCharge.currentProviderPlanCode;ACC.mobileCharge.renderPublisher(prv,crProviderPlanCode,"",type,isClick),ACC.mobileCharge.loadProviderOffers(prv,crProviderPlanCode,void 0,isClick,void 0).then(function(){if(ACC.mobileCharge.calculateTotalPriceFromOffer(),type!==ACC.mobileCharge.topupTypes.TOPUP){var getItemQuantity=$(".item-offer a.active");ACC.mobileCharge.setActiveQuantity(getItemQuantity)}}),$(dom).attr("data-type",type)},renderPublisher:function(provider,currentCode,dom,type,isClick){if(!_.isUndefined(provider)){_.isUndefined(currentCode)&&(currentCode="");$("#js-mobile-charge__type li.active")[0].id,$(".js-mobile-charge__phone-number").val();dom="#js-change-publisher";var publisherHtml="",res="";switch(type){case ACC.mobileCharge.topupTypes.BUYCARD:res=ACC.topup.buycardPublishers;break;case ACC.mobileCharge.topupTypes.DATACARD:res=ACC.topup.datacardPublishers;break;case ACC.mobileCharge.topupTypes.GAMECARD:res=ACC.topup.gamecardPublishers;break;case ACC.mobileCharge.topupTypes.TOPUP:res=ACC.topup.buycardPublishers}if(!_.isEmpty(res)){var flagCurrent=!1;return _.each(res,function(publisher){var state="",onsite="";provider!=publisher.variantValueCategory.code||flagCurrent||(state=" active ",flagCurrent=!0),_.isEmpty(publisher.variantOption)&&(onsite="disabled"),publisherHtml+=ACC.template.topup.publisher({offerCode:publisher.variantOption.offerCode,serviceProvider:publisher.variantValueCategory.code,currentCode:"",label:publisher.variantValueCategory.name,active:state,onsite:onsite,imgSrc:publisher.variantOption.variantOptionQualifiers[0].image.url,alt:ACC.mobileCharge.generateAltForImg(type,publisher.variantValueCategory.name)})}),_.isElement($(dom)[0])&&$(dom).html(publisherHtml),publisherHtml}}},getCurrentProviderElm:function(){return $(".js-mobile-charge__providers").find(".mobile-charge__provider-item.active")},updateQuantityDataOfAllPlan:function(val){$(".js-mobile-charge__price .mobile-charge__price-item").each(function(index,item){var availableToSell=$(item).attr("data-available"),minQty=$(item).attr("data-min"),maxQty=$(item).attr("data-max"),isOnsite=$(item).attr("data-onsite"),maxAvailableQty=availableToSell,availableQty=1;isOnsite&&(void 0!==maxQty&&""!=maxQty&&(maxAvailableQty=Math.min(availableToSell,maxQty)),void 0!==minQty&&""!=minQty?availableQty=Math.min(availableToSell,minQty):minQty=1,val>=parseInt(minQty)&&val<=parseInt(maxAvailableQty)?$(item).attr("data-quantity",val):val>parseInt(maxAvailableQty)?$(item).attr("data-quantity",maxAvailableQty):$(item).attr("data-quantity",availableQty))})},addToInstantCart:function(){$.blockUI();var topupPhone=ACC.mobileCharge.getTopupPhone(),quantity=ACC.mobileCharge.getQuantity(),offerCode=ACC.mobileCharge.getOfferCode();if(""===offerCode||void 0===offerCode)return $.unblockUI(),ACC.mobileCharge.showMessage(ACC.mobileCharge.getEmptyOfferCodeMessage()),!1;$.ajax({url:ACC.config.topup.addToCartUrl,method:"POST",data:{topupPhone:topupPhone,productCodePost:offerCode,qty:quantity}}).then(function(res){res.hasError?($.unblockUI(),ACC.mobileCharge.showMessage(res.addToCartLayer),res.errorCode!=ACC.mobileCharge.errorCodes.LESS_THAN_MIN_QTY&&res.errorCode!=ACC.mobileCharge.errorCodes.LARGER_THAN_MAX_QTY||ACC.mobileCharge.reloadQuantityAndSetDefaultBy(res.errorCode)):(ACC.mobileCharge.trackingGtm(),window.location.href=ACC.config.contextPath+"/checkout?adrIC="+res.cartAnalyticsData.cartCode)},function(jqXHR){$.unblockUI(),"403"==jqXHR.status&&ACC.CSRF.updateCSRF().then(function(){ACC.mobileCharge.addToInstantCart()})})},loadProviderOffers:function(provider,currentCode,dom,isClick,isChangePublisher){if(isClick&&$(".js-mobile-charge__providers .mobile-charge__provider-item").each(function(){provider=$("#js-change-publisher a.active ").attr("data-topup-service-provider")}),!_.isUndefined(provider)){_.isUndefined(currentCode)&&(currentCode="");var offersObj={data:{type:$("#js-mobile-charge__type li.active")[0].id,provider:provider,phone:$(".js-mobile-charge__phone-number").val()}};if(_.isUndefined(dom))switch(offersObj.data.type){case ACC.mobileCharge.topupTypes.TOPUP:default:dom="#js-mobile-charge__prepaid .js-mobile-charge__price"}var offerReq=ACC.requests.topup.getOffers(offersObj);return offerReq.done(function(res){if(!_.isEmpty(res)){var offersHtml='<div class="row">',flagCurrent=!1,qtity=ACC.mobileCharge.getQuantity();_.each(res.topupOffers,function(offer,index){var state="",quantity=offer.isOnsite?qtity:0;quantity=isNaN(quantity)?1:quantity;var minAvailableQty=Math.min(offer.availableToSell,offer.minOrderQuantity),maxAvailableQty=Math.min(offer.availableToSell,offer.maxOrderQuantity);offer.isOnsite?(!isClick&&!isChangePublisher||flagCurrent?flagCurrent||currentCode!=offer.topupPlanCode||(state=" active ",flagCurrent=!0):(state=" active ",flagCurrent=!0),quantity<minAvailableQty?quantity=minAvailableQty:quantity>maxAvailableQty&&(quantity=maxAvailableQty)):state=" disabled ",offersHtml+=ACC.template.topup.offer({type:offersObj.data.type,min:offer.minOrderQuantity,max:offer.maxOrderQuantity,available:offer.availableToSell,offer:offer.offerCode,code:offer.topupPlanCode,label:offer.topupPlanLabel,provider:res.currentProvider,price:offer.price,quantity:quantity,active:state,onsite:offer.isOnsite})}),offersHtml+="</div>";var offsiteSpan=document.createElement("span");offsiteSpan.className="text-expired";var t=document.createTextNode("Hết hàng");if(offsiteSpan.appendChild(t),void 0!==res.topupOffers){var offProvider=_.every(res.topupOffers,function(offer){return!offer.isOnsite}),selector=$('.mobile-charge__provider-item[data-topup-service-provider="'+provider+'"]');offProvider&&"BUYCARD"===offersObj.data.type&&(selector.addClass("disabled").removeClass("active"),selector[0].childNodes[0].append(offsiteSpan)),offProvider&&"DATACARD"===offersObj.data.type&&(selector.addClass("disabled").removeClass("active"),selector[0].childNodes[0].append(offsiteSpan)),offProvider&&"GAMECARD"===offersObj.data.type&&(selector.addClass("disabled").removeClass("active"),selector[0].childNodes[0].append(offsiteSpan))}_.isElement($(dom)[0])&&$(dom).html(offersHtml)}}),offerReq}},checkProviderState:function(provider,currentCode){if(!_.isUndefined(provider)){_.isUndefined(currentCode)&&(currentCode="");var offersObj={data:{type:$("#js-mobile-charge__type li.active")[0].id,provider:provider,phone:$(".js-mobile-charge__phone-number").val()}},offerReq=ACC.requests.topup.getOffers(offersObj);return offerReq.done(function(res){if(!_.isEmpty(res)){return _.every(res.topupOffers,function(offer){return!offer.isOnsite})?void $('.mobile-charge__provider-item[data-topup-service-provider="'+provider+'"]').addClass("disabled"):void 0}}),offerReq}},renderQuantitySelectBox:function(currentQty){if($("#js-mobile-charge__type li.active")[0].id!==ACC.mobileCharge.topupTypes.TOPUP){var $currOffer=ACC.mobileCharge.getCurrentOfferDom(),currentQuantity=_.isUndefined(currentQty)?$currOffer.attr("data-quantity"):currentQty,quantityHtml=ACC.template.topup.offerQuantity({minOrderQty:$currOffer.attr("data-min"),maxOrderQty:$currOffer.attr("data-max"),availableToSell:$currOffer.attr("data-available"),currentQuantity:currentQuantity});$(".js-qty-selector.js-product-order__quanity").replaceWith(quantityHtml);var optionsOfSelectBox=$(".product-order__quanity-select option");if(void 0!==optionsOfSelectBox&&null!=optionsOfSelectBox&&optionsOfSelectBox.length>0){var length=optionsOfSelectBox.length;if("pdpAddtoCartInput"==optionsOfSelectBox[length-1].value&&length>2){var maximumSelectedOption=optionsOfSelectBox[length-2].value;!isNaN(maximumSelectedOption)&&currentQuantity>parseInt(maximumSelectedOption)&&($(".product-order__quanity-select").val("pdpAddtoCartInput").change(),$(".js-qty-selector-input").val(currentQuantity).change())}}}},getEmptyOfferCodeMessage:function(){var html='<div id="addToCartLayer" class="add-to-cart cart">';return html+='<div class="cart_popup_error_msg">',html+='<p class="alert alert-warning ">',html+='<i class="adr-icon icon-warning" style="top:0;"></i>',html+=ACC.topup.emptyTopupOfferMessage,html+="</p>",html+="</div>",html+='<a href="javascript:void(0);" class="js-mini-cart-off"></a>',html+="</div>"},reloadQuantityAndSetDefaultBy:function(errorCode){var currentProviderElm=ACC.mobileCharge.getCurrentProviderElm();if(!_.isUndefined(currentProviderElm)){var currentPlanCode=$(currentProviderElm).attr("data-current-code"),currentProvider=$(currentProviderElm).attr("data-topup-service-provider");ACC.mobileCharge.loadProviderOffers(currentProvider,currentPlanCode,void 0,!0,!0).then(function(res){if(errorCode==ACC.mobileCharge.errorCodes.LARGER_THAN_MAX_QTY){var currentPlan=ACC.mobileCharge.getCurrentPlanCodeBy(res.topupOffers,currentPlanCode);ACC.mobileCharge.renderQuantitySelectBox(currentPlan.maxOrderQuantity)}else ACC.mobileCharge.renderQuantitySelectBox();ACC.mobileCharge.calculateTotalPriceFromOffer()})}},getCurrentPlanCodeBy:function(topupOffers,planCode){var currentOffer={};return $.each(topupOffers,function(index,offer){if(planCode==offer.topupPlanCode)return currentOffer=offer,!1}),currentOffer},showMessage:function(textHtml){$.colorbox({html:textHtml,maxWidth:"100%",width:"335px",initialWidth:"120px",className:"error-limit-quanity",closeButton:!1})},calculateTotalPrice:function(priceObj){_.defaults(priceObj,{type:ACC.mobileCharge.topupTypes.BUYCARD,quantity:1,price:0,dom:""});var totalFormat,total=0;switch((isNaN(priceObj.price)||_.isEmpty(priceObj.price))&&(priceObj.price=0),_.isEmpty(priceObj.quantity)&&(priceObj.quantity=1),priceObj.type){case ACC.mobileCharge.topupTypes.BUYCARD:total=priceObj.price*parseInt(priceObj.quantity);break;case ACC.mobileCharge.topupTypes.TOPUP:total=1*priceObj.price;break;case ACC.mobileCharge.topupTypes.DATACARD:case ACC.mobileCharge.topupTypes.GAMECARD:total=priceObj.price*parseInt(priceObj.quantity);break;default:total=priceObj.price}return totalFormat=ACC.mobileCharge.addCommas(total),_.isElement($(priceObj.dom)[0])&&$(priceObj.dom).html(totalFormat),totalFormat},calculateTotalPriceFromOffer:function(priceObj){var type=$("#js-mobile-charge__type li.active")[0].id,currOffer=_.template(".js-mobile-charge__price .mobile-charge__price-item.active<%= typeAttr %>")({typeAttr:_.template('[data-type="<%= type %>"]')({type:type})}),$currOffer=$(currOffer),priceObj=priceObj||{};_.defaults(priceObj,{type:type,
quantity:$currOffer.attr("data-quantity"),price:$currOffer.attr("data-price"),dom:"#js-card-total"}),ACC.mobileCharge.calculateTotalPrice(priceObj)},getQuantity:function(){if($("#js-mobile-charge__type li.active")[0].id==ACC.mobileCharge.topupTypes.TOPUP)return 1;var qty=$("#pdpAddtoCartSelect").val();return"pdpAddtoCartInput"===qty&&(qty=$("#pdpAddtoCartInput").val()),qty=parseInt(qty)},getCurrentOfferDom:function(){var type=$("#js-mobile-charge__type li.active")[0].id,currOffer=_.template(".js-mobile-charge__price .mobile-charge__price-item.active<%= typeAttr %>")({typeAttr:_.template('[data-type="<%= type %>"]')({type:type})});return $(currOffer)},getOfferCode:function(){return ACC.mobileCharge.getCurrentOfferDom().attr("data-offer")},getTopupPhone:function(){return $("#number-phone").val()},addCommas:function(nStr){nStr+="",x=nStr.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var rgx=/(\d+)(\d{3})/;rgx.test(x1);)x1=x1.replace(rgx,"$1.$2");return x1+x2},matchStartNumber:function(num,numbers){for(var ix in numbers)if(num.startsWith(""+numbers[ix]))return!0;return!1},trackingGtm:function(){try{var type=$("#js-mobile-charge__type li.active")[0].id,productId=ACC.mobileCharge.getOfferCode(),provider=$("#js-change-publisher .mobile-charge__provider-item.active .mobile-charge__provider-name").text();if(""==provider||void 0==provider||null==provider){var currentProvider=ACC.mobileCharge.currentProviderByPhone;null!=currentProvider&&-1!=currentProvider.indexOf("_")&&(currentProvider=currentProvider.split("_")[0]),provider="VT"===currentProvider?"Viettel":"MB"===currentProvider?"Mobifone":"VP"===currentProvider?"Vinaphone":"VM"===currentProvider?"Vietnammobile":"GM"===currentProvider?"Gmobile":""}var valueElement=".js-mobile-charge__price .mobile-charge__price-item.active[data-type='"+type+"']",value=$(valueElement).text();dataLayer.push({event:"naptheFlow",product:{id:productId},napthe:{step:"2",name:"Order Submit",mode:type,telco:provider,value:value}})}catch(e){}},trackingGtmOnLoad:function(){window.setTimeout(function(){try{var type=$("#js-mobile-charge__type li.active")[0].id,productId=ACC.mobileCharge.getOfferCode(),provider=$("#js-change-publisher .mobile-charge__provider-item.active .mobile-charge__provider-name").text();if(""==provider||void 0==provider||null==provider){var currentProvider=ACC.mobileCharge.currentProviderByPhone;null!=currentProvider&&-1!=currentProvider.indexOf("_")&&(currentProvider=currentProvider.split("_")[0]),provider="VT"===currentProvider?"Viettel":"MB"===currentProvider?"Mobifone":"VP"===currentProvider?"Vinaphone":"VM"===currentProvider?"Vietnammobile":"GM"===currentProvider?"Gmobile":""}var valueElement=".js-mobile-charge__price .mobile-charge__price-item.active[data-type='"+type+"']",value=$(valueElement).text();dataLayer.push({event:"naptheFlow",product:{id:productId},napthe:{step:"1",name:"Telecom Page",mode:type,telco:provider,value:value}})}catch(e){}},1e3)},generateAltForImg:function(type,name){var altImg=name;switch(type){case ACC.mobileCharge.topupTypes.BUYCARD:altImg="Nạp thẻ điện thoại "+name+" online ";break;case ACC.mobileCharge.topupTypes.DATACARD:altImg="Nạp thẻ data 3G nhà mạng "+name;break;case ACC.mobileCharge.topupTypes.GAMECARD:altImg="Nạp thẻ game "+name+" online"}return altImg}},ACC.captcha={enable:!1,siteKey:null,isLoaded:!1,recaptchaRendered:{},registerCaptcha:function(){return $.ajax({url:ACC.config.encodedContextPath+"/register/captcha/widget/recaptcha",type:"GET",async:!1,cache:!1,success:function(html){if(html&&""!=html.trim()){ACC.captcha.enable=!0;var widget=$(html);widget.appendTo(".js-recaptcha-Vinrocketcaptcha"),ACC.captcha.siteKey=widget.filter(".g-recaptcha_widget").data("sitekey")}}})},renderWidget:function(widgetId){void 0!==window.grecaptcha?ACC.captcha.generateCaptchaBox(widgetId):$.when(ACC.captcha.registerCaptcha()).done(function(){ACC.captcha.enable&&$.getScript("https://www.google.com/recaptcha/api.js?hl="+document.documentElement.lang).done(function(){"false"==$("#recaptchaChallangeAnswered").val()&&$("#g-recaptcha_incorrect").show();var setIntervalID=setInterval(function(){void 0!==window.grecaptcha&&void 0!==window.grecaptcha.render&&(ACC.captcha.generateCaptchaBox(widgetId),clearInterval(setIntervalID))},300)})})},renderWidgetForPopup:function(widgetId){ACC.captcha.renderWidget(widgetId)},generateCaptchaBox:function(widgetId){if(ACC.captcha.enable&&void 0!=widgetId){if(void 0==ACC.captcha.recaptchaRendered[widgetId]){var captcha=window.grecaptcha.render(widgetId,{sitekey:ACC.captcha.siteKey});ACC.captcha.recaptchaRendered[widgetId]=captcha}else ACC.captcha.reset(widgetId);"js-otp-checkout-captcha"==widgetId&&$.colorbox.resize()}},reset:function(widgetId){if(ACC.captcha.enable&&void 0!==window.grecaptcha&&void 0!=ACC.captcha.recaptchaRendered[widgetId]){var weId="#"+widgetId+"-error";$(weId).html(""),$(weId).hide(),window.grecaptcha.reset(ACC.captcha.recaptchaRendered[widgetId])}},getResponse:function(widgetId){return ACC.captcha.enable&&void 0!==window.grecaptcha?window.grecaptcha.getResponse(ACC.captcha.recaptchaRendered[widgetId]):""},showError:function(widgetId,msg){if(ACC.captcha.enable&&void 0!==window.grecaptcha){var weId="#"+widgetId+"-error";$(weId).html(msg),$(weId).show()}}},ACC.comment={_autoload:[["showCommentBox",$("#vinReviewForm").length>0],"showCommentInfo",["bindFocusComment",$("#panel-review-container").length>0]],step1:"#step1",step2:"#step2",showCommentBox:function(){$(document).ready(function(){$(".comment-form").on("click",function(e){e.preventDefault(),$(ACC.comment.step1).fadeOut(100,function(){$(ACC.comment.step2).fadeIn(500)})})})},bindFocusComment:function(){$(document).on("click",".adr-rating-view",function(e){self.location.href="#panel-review-container"})},showCommentInfo:function(){$(document).on("click","#reviewComment",function(e){e.preventDefault(),$(".comment-form__navigation").fadeIn(500,function(){$("#reviewComment").animate({height:"100px"})})})}},ACC.flashsalecomponent={_autoload:["bindTimeFrameTabClick","bindCountDownClock","callCarousel"],$timeFrameTab:$(".timeFrameTab"),$mainBanner:$(".main-banner"),$flashHeader:$(".flash-header"),bindTimeFrameTabClick:function(){ACC.flashsalecomponent.$timeFrameTab.on("click",ACC.flashsalecomponent.handleTimeFrameClick)},callCarousel:function(){$(".flashSaleCarousel").owlCarousel({loop:!0,margin:16,responsiveClass:!0,navClass:["am-prev","am-next"],dotsEach:!0,nav:!0,navText:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"><div class="d-icon f-row a-j-center"><i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i></div></div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick"><div class="d-icon f-row a-j-center"><i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i></div></div>'],responsive:{480:{items:3,nav:!0},767:{items:4,nav:!0},1240:{items:5,nav:!0}}})},bindCountDownClock:function(){$(document).ready(function(){$(".flash-sale-countdown--time").each(function(){$(this).length&&(data_time_end=$(this).data("countdown"),data_current_time=$(this).data("currenttime"),data_adjusted_end_time=ACC.flashsalecomponent.getFinalDate(data_time_end,data_current_time),$(this),$(this).countdown(data_adjusted_end_time,{elapse:!0}).on("update.countdown",function(event){var $this=$(this);event.elapsed||$this.html(event.strftime("<span>%I</span><span>%M</span><span>%S</span>"))}))})})},getFinalDate:function(countdown,current){var adjustedFinalTime,finalTime=moment(countdown),serverOffset=(moment(current),moment(),$("input#serverOffset").val()),clientOffset=60*(new Date).getTimezoneOffset()*1e3,diff=parseInt(serverOffset)+parseInt(clientOffset);return adjustedFinalTime=finalTime.toDate().getTime()-diff,new Date(adjustedFinalTime)},handleTimeFrameClick:function(event){ACC.flashsalecomponent.hideAllSubcomponents(),ACC.flashsalecomponent.showCurrentSubcomponents($(this))},hideAllSubcomponents:function(event){ACC.flashsalecomponent.$flashHeader.each(function(){$(this).hasClass("hide")||$(this).addClass("hide")}),ACC.flashsalecomponent.$mainBanner.each(function(){$(this).hasClass("hide")||$(this).addClass("hide")})},showCurrentSubcomponents:function(currentTimeFrame){var flashheader=currentTimeFrame.data("flashheader-id");$("#"+flashheader).removeClass("hide");var mainBanner=currentTimeFrame.data("mainbanner-id");$("#"+mainBanner).removeClass("hide")}},String.format=function(){for(var theString=arguments[0],i=1;i<arguments.length;i++){var regEx=new RegExp("\\{"+(i-1)+"\\}","gm");theString=theString.replace(regEx,arguments[i])}return theString},$.fn.serializeObject=function(){var o={},a=this.serializeArray();return $.each(a,function(){void 0!==o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o},ACC.adrCustomerServicesInfo={_autoload:["init"],init:function(){$("#frmCustomerServicesInfo").validate({rules:{CustomerServicesFullName:{required:!0,maxlength:100},CustomerServicesPhoneNumber:{required:!0,digits:!0,rangelength:[10,15],maxlength:15},CustomerServicesEmail:{maxlength:100,validateEmail:!0},CustomerServicesNote:{maxlength:300}},messages:{CustomerServicesFullName:{required:"Vui lòng nhập họ và tên.",maxlength:"Độ dài của họ và tên không được vượt quá 100 ký tự!"},CustomerServicesPhoneNumber:{required:"Vui lòng nhập số điện thoại.",digits:"Vui lòng nhập đúng số điện thoại!",rangelength:"Độ dài của số điện thoại chỉ giới hạn từ 10 đến 15 số!"},CustomerServicesEmail:{validateEmail:"Địa chỉ email không hợp lệ.",maxlength:"Độ dài của email không được vượt quá 100 ký tự!"},CustomerServicesNote:{maxlength:"Độ dài của nội dung tư vấn không được quá 300 ký tự!"}},errorElement:"p",errorClass:"help-block",errorPlacement:function(error,element){element.closest("div").append(error)},highlight:function(element){$(element).closest(".form-group").addClass("has-error")},unhighlight:function(element){$(element).closest(".form-group").removeClass("has-error")},submitHandler:function(form){try{var apiUrl=ACC.common.attachCaptchaParameterLandingADR("#js-customer-service-info",ACC.landingADR.CustomerServicesInfoUrl),formData=$("#frmCustomerServicesInfo").serializeObject(),data={CustomerServicesEmailTo:formData.CustomerServicesEmailTo,CustomerServicesEmail:formData.CustomerServicesEmail,CustomerServicesFullName:formData.CustomerServicesFullName,CustomerServicesNote:formData.CustomerServicesNote,CustomerServicesPhoneNumber:formData.CustomerServicesPhoneNumber,CustomerServicesProductLink:window.location.href,Token:apiUrl};return $.ajax({type:"POST",url:ACC.landingADR.CustomerServicesInfoUrl,data:data,dataType:"jsonp",contentType:"application/json",crossDomain:!0,cache:!1,success:function(data){if(data.Status)$("#modalCustomerServicesInfo").modal("hide"),$.notify({title:"Bạn đã gửi yêu cầu thành công",message:"Cảm ơn quý khách đã gửi liên hệ đến Adayroi. Chúng tôi sẽ hồi đáp trong thời gian sớm nhất. Xin cảm ơn!"},{element:".desktop__nav",offset:0,type:"pastel-warning",delay:3e3,template:'<div class="container"><div data-notify="container" class="notification" role="alert"><div class="thumbnail"><i class="icon polish-version-icon-check-2"></i></div><div class="content"><div class="title" data-notify="title">{1}</div><div class="message" data-notify="message">{2}</div></div></div>'});else{var messages="";""!=data.Message&&(messages="<ul>{0}</ul>",messages=String.format(messages,data.Message)),$("#summary-validation").html(messages),$("#summary-validation").show("fast")}},error:function(jqXHR,textStatus,errorThrown){var messages="";""!=data.Message&&(messages='<div class="form-message-error border-radius">{0}</div>',messages=String.format(messages,errorThrown)),$("#summary-validation").html(messages),$("#summary-validation").show("fast")}}),!1}catch(e){console.log(e)}}}),jQuery.validator.addMethod("validateEmail",function(value,element){return ACC.adrCustomerServicesInfo.isValidEmailAddress(value)}),$(".modal-customer-service").on("hidden.bs.modal",function(){$("#frmCustomerServicesInfo").validate().resetForm(),$("#frmCustomerServicesInfo").trigger("reset"),$("#summary-validation").hide().html(""),ACC.captcha.reset("js-customer-service-info")}).on("shown.bs.modal",function(){$(".customer-services-info-wrapper").find(".product-detail__price").html("");var cloneHtml="";if($(".product-detail__info").find(".product-detail__price").find(".product-detail__price-info").length>0){for(var i=0;i<$(".product-detail__info").find(".product-detail__price").find(".product-detail__price-info").length;i++){cloneHtml+='<div class="product-detail__price-info">'+$(".product-detail__info").find(".product-detail__price").find(".product-detail__price-info").eq(i).clone().html()+"</div>"}$(".customer-services-info-wrapper").find(".product-detail__price").html(cloneHtml)}$("#frmCustomerServicesInfo").validate().resetForm()})},callback:function(data){},isValidEmailAddress:function(emailAddress){return new RegExp(/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/).test(emailAddress)}},ACC.bottombannercomponent={_autoload:["onCloseBanner"],cname:null,notShowAgainCookieTime:null,onLoad:function(){""==ACC.bottombannercomponent.getCookie()&&ACC.bottombannercomponent.visibleBanner("block")},setCookie:function(){var d=new Date;d.setTime(d.getTime()+60*ACC.bottombannercomponent.notShowAgainCookieTime*60*1e3);var expires="expires="+d.toGMTString();document.cookie=ACC.bottombannercomponent.cname+"="+ACC.bottombannercomponent.notShowAgainCookieTime+";"+expires+";path=/"},getCookie:function(){for(var name=ACC.bottombannercomponent.cname+"=",decodedCookie=decodeURIComponent(document.cookie),ca=decodedCookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""},visibleBanner:function(display){for(var arrayOfElements=document.getElementsByClassName("bottom-banner-component"),lengthOfArray=arrayOfElements.length,i=0;i<lengthOfArray;i++)arrayOfElements[i].style.display=display},onCloseBanner:function(){$(".bottom-banner-component .close-banner").on("click",function(){ACC.bottombannercomponent.setCookie(),ACC.bottombannercomponent.visibleBanner("none")})}},ACC.countdowncomponent={onLoad:function(){$(".section-countdown").length&&$(".section-countdown").each(function(){var $this=$(this);if($(".adr-clock-cd").length){var clock=$this.find(".adr-clock-cd"),douDate=clock.data("date"),nextTime=moment.tz(douDate,"Asia/Ho_Chi_Minh");clock.countdown(nextTime.toDate(),function(event){var str="";str=0==parseInt(event.strftime("%D"))?event.strftime('<div class="time-intro"><span class="time-number">%H</span> <span class="time-text">giờ</span></div><div class="time-intro"><span class="time-number">%M</span> <span class="time-text">phút</span></div> <div class="time-intro"><span class="time-number">%S</span> <span class="time-text">giây</span></div>'):event.strftime('<div class="time-intro"><span class="time-number">%D</span> <span class="time-text">ngày</span></div><div class="time-intro"><span class="time-number">%H</span> <span class="time-text">giờ</span></div> <div class="time-intro"><span class="time-number">%M</span> <span class="time-text">phút</span></div><div class="time-intro"><span class="time-number">%S</span> <span class="time-text">giây</span></div>'),$(this).html(str).on("finish.countdown",function(event){window.location.reload()})})}})}},ACC.wishlist={_autoload:[["initWishlistPage",0!=$(".page-wishlistpage").length]],searchText:"",initWishlistPage:function(){ACC.wishlist.clearSeach(),ACC.wishlist.searchText=$.trim($(".wishlist--search-input").val()),$(".wishlist-button.wishlist--sortby").on("click",function(e){$(this).toggleClass("open")}),$(".wishlist__mine__remove").on("click",function(e){e.preventDefault();var pcode=$(this).attr("data-pcode");$(".wishlist__modal form .wishlist__modal--btn").val(pcode),$("body").addClass("wishlist__modal_show"),$(".wishlist__modal .wishlist__modal--backbtn").click(function(){$("body").removeClass("wishlist__modal_show")})}),$(window).load(function(){var productCode=$("#addtowishLink").attr("data-product"),count=$("#wishCount-"+productCode).attr("data-count"),trimcount=$.trim(count);jQuery.isEmptyObject(trimcount)?$("#wishCounts-"+productCode).html():$("#wishCounts-"+productCode).html("("+trimcount+")")}),$(".wishlist-button.wishlist--tool").on("click",function(e){e.preventDefault(),$(this).toggleClass("active"),$(".acccount-wishlist-details.wishlist--content").toggleClass("quickact"),$(this).hasClass("active")?ACC.wishlist.wishlistBar.init():($(".wishlist__mine__remove-checkbox").unbind("click"),ACC.wishlist.wishlistBar.destroy())}),$(".wishlist--search-input").on("keyup",function(e){ACC.wishlist.clearSeach()}),$(document).ready(function(){$(".lazy").lazyload(),$(".owl-lazy").lazyload()}),("mobile"==ACC.devices.name||$("body").width()<=480)&&$(".section__sidebar-profile .list-group .list-group-item > a[href*=wish-list]").length>0&&$(".section__sidebar-profile .list-group .list-group-item > a[href*=wish-list]").parent().remove()},clearSeach:function(){var search_input=$(".wishlist--search-input");""!=search_input.val()?search_input.closest(".wishlist--search").addClass("clearsearch"):search_input.closest(".wishlist--search").removeClass("clearsearch"),$(".wishlist--search.clearsearch .polish-version-icon-remove-text").on("click",function(){search_input.val(""),search_input.closest(".wishlist--search").removeClass("clearsearch"),ACC.wishlist.searchText.length>0&&$(this).closest("form#search-form").submit()})},wishlistBar:{wlRemoveList:[],init:function(){if(0==$(".wishlist__tool_bar").length){$("body").append('<div class="wishlist__tool_bar">               <div class="container">                   <div class="bar">                       <div class="wishlist__bar__selected--count">                           <div class="number">0</div>                           <span>Sản phẩm đang được chọn</span>                       </div>                       <div class="wishlist__bar--cta">\n                           <div class="check__all"><i class="polish-version-icon-check-box"></i>Chọn tất cả</div>\n                           <div class="remove__all"><i class="polish-version-icon-trash"></i>Xóa</div>                       </div>                       <div class="wishlist__bar--close">Tắt thao tác nhanh</div>                   </div>               </div>           </div>')}ACC.wishlist.wishlistBar.setAction(),ACC.wishlist.wishlistBar.wlCheckedCount(),setTimeout(function(){$(".wishlist__tool_bar").addClass("active")},100)},destroy:function(){$(".wishlist__tool_bar").removeClass("active"),$(".wishlist__bar--cta .check__all, .wishlist__tool_bar .wishlist__bar--close, .wishlist__mine__remove-checkbox").unbind("click")},setAction:function(){$(".wishlist__mine__remove-checkbox").on("click",function(){var checkbox=$(this).find("i");checkbox.hasClass("polish-version-icon-check-box")?(checkbox.removeClass("polish-version-icon-check-box").addClass("polish-version-icon-checkbox-active"),$(this).find('input[type="checkbox"]').prop("checked",!0),$(this).closest(".product-item__wrapper").addClass("checked")):(checkbox.removeClass("polish-version-icon-checkbox-active").addClass("polish-version-icon-check-box"),$(this).find('input[type="checkbox"]').prop("checked",!1),$(this).closest(".product-item__wrapper").removeClass("checked")),ACC.wishlist.wishlistBar.wlCheckedCount()}),$(".wishlist__bar--cta .check__all").on("click",function(){$(this).toggleClass("active"),$(this).hasClass("active")?($(this).find("i").removeClass("polish-version-icon-check-box").addClass("polish-version-icon-checkbox-active"),$('.wishlist--list .wishlist--content .product-item__wrapper:not(".checked") .wishlist__mine__remove-checkbox').each(function(){$(this).find("i").removeClass("polish-version-icon-check-box").addClass("polish-version-icon-checkbox-active"),$(this).find('input[type="checkbox"]').prop("checked",!0),$(this).closest(".product-item__wrapper").addClass("checked")})):($(this).find("i").removeClass("polish-version-icon-checkbox-active").addClass("polish-version-icon-check-box"),$(".wishlist--list .wishlist--content .product-item__wrapper.checked .wishlist__mine__remove-checkbox").each(function(){$(this).find("i").removeClass("polish-version-icon-checkbox-active").addClass("polish-version-icon-check-box"),$(this).find('input[type="checkbox"]').prop("checked",!1),$(this).closest(".product-item__wrapper").removeClass("checked")})),ACC.wishlist.wishlistBar.wlCheckedCount()}),$(".wishlist__tool_bar .remove__all").on("click",function(e){if(wlRemoveList.length>0&&0==$(".wishlist__multidelete__modal").length){var new_confirm_modal=$(".wishlist__modal").clone().addClass("wishlist__multidelete__modal"),confirmBtn=new_confirm_modal.find(".wishlist__modal--btn").clone().addClass("multidelete__confirm");new_confirm_modal.find("form").replaceWith(confirmBtn),$("body").addClass("wishlist__modal_show").append(new_confirm_modal),new_confirm_modal.find(".wishlist__modal--backbtn").click(function(){$("body").removeClass("wishlist__modal_show"),$(".wishlist__multidelete__modal").remove(),new_confirm_modal.remove()}),new_confirm_modal.find(".multidelete__confirm").click(function(){window.location="/my-account/wish-list?removeoffer="+wlRemoveList})}}),$(".wishlist__tool_bar .wishlist__bar--close").on("click",function(){$(".wishlist-button.wishlist--tool").removeClass("active"),$(".acccount-wishlist-details.wishlist--content").removeClass("quickact"),ACC.wishlist.wishlistBar.destroy()})},setCheckedList:function(){wlRemoveList=[],$(".product-item__wrapper.checked").each(function(){var pcode=$(this).find('input[name="removegroup"]:checked').val();wlRemoveList.push(pcode)})},wlCheckedCount:function(){var count=$(".wishlist--list .wishlist--content .product-item__wrapper .polish-version-icon-checkbox-active").length;count=count>0?count:0,$(".wishlist__bar__selected--count .number").html(count),ACC.wishlist.wishlistBar.setCheckedList()}}},ACC.vinShortcutComponent=ACC.vinShortcutComponent||{},ACC.vinShortcutComponent={_autoload:["init"],initLazyLoad:function(elements){$(elements).lazyload({threshold:50,skip_invisible:!1,effect:"fadeIn"})},init:function(){var buttonnext=$(".vin-shortcut-component-wrapper").find(".owl-carousel").find(".am-next"),buttonprev=$(".vin-shortcut-component-wrapper").find(".owl-carousel").find(".am-prev");$(".vin-shortcut-component-wrapper").find(".owl-carousel").owlCarousel({loop:!0,margin:0,responsiveClass:!0,navText:['<div class="d-slide__button d-slide__button--back am-prev d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick">\n                        <div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-left f-col a-j-center color-1"></i>\n                        </div>\n                      </div>','<div class="d-slide__button d-slide__button--next am-next d-button d-button--caret-slide f-row a-j-center z-index-2 js-kick">\n                        <div class="d-icon f-row a-j-center">\n                          <i class="polish-version-icon-arrow-right f-col a-j-center color-1"></i>\n                        </div>\n                      </div>'],navClass:[buttonnext,buttonprev],dots:!0,center:!1,scrollPerPage:!0,responsive:{0:{items:4,nav:!0},480:{items:4,nav:!0},767:{items:4,nav:!0},1240:{items:8,nav:!0,slideBy:8}}}),ACC.vinShortcutComponent.initLazyLoad(".vin-shortcut-component-wrapper img.vinshortcut-lazy")},stringBeautifier:function(inputStr){return inputStr.replace("<![CDATA[","").replace("]]>","")}},$(function(){window.vinMemoryStorage={},window.vinStorage={},_autoload()});